var oA=Object.defineProperty;var lA=Object.getPrototypeOf;var cA=Reflect.get;var gx=e=>{throw TypeError(e)};var hA=(e,t,i)=>t in e?oA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var Ke=(e,t,i)=>hA(e,typeof t!="symbol"?t+"":t,i),y_=(e,t,i)=>t.has(e)||gx("Cannot "+i);var Kt=(e,t,i)=>(y_(e,t,"read from private field"),i?i.call(e):t.get(e)),ii=(e,t,i)=>t.has(e)?gx("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,i),Zi=(e,t,i,a)=>(y_(e,t,"write to private field"),a?a.call(e,i):t.set(e,i),i),Os=(e,t,i)=>(y_(e,t,"access private method"),i);var _x=(e,t,i)=>cA(lA(e),i,t);import"../chunks/CWj6FrbW.js";import{i as uA}from"../chunks/BNYSXTBN.js";import{a9 as v8,y as Yn,z as Ym,aa as dA,x as jg,D as fA,ab as y8,C as zm,ac as Ef,g as T,M as pA,A as mA,H as gA,B as vx,F as Uf,ad as Yc,ae as b8,af as _A,ag as ep,ah as vA,ai as xu,a4 as yA,aj as dv,ak as w8,al as x8,am as Zg,an as M8,ao as bA,ap as Og,aq as wA,ar as b_,as as tp,at as I8,au as xA,av as MA,aw as IA,R as gy,ax as A8,J as _y,ay as yx,az as AA,t as $r,aA as TA,aB as CA,aC as SA,aD as bx,aE as PA,G as Ng,aF as EA,aG as kA,aH as RA,aI as LA,aJ as zA,aK as FA,aL as DA,aM as BA,aN as GA,aO as VA,aP as _s,aQ as jA,aR as ZA,aS as OA,aT as NA,aU as UA,aV as HA,E as WA,aW as XA,aX as qA,b as Yu,aY as YA,aZ as T8,_ as KA,a_ as _o,a$ as $A,b0 as JA,b1 as C8,a6 as QA,I as vy,b2 as eT,a5 as fr,b3 as wx,O as Pt,b4 as gf,b5 as S8,b6 as fv,p as Ur,b7 as ht,a7 as pt,n as Rt,v as Gt,q as Tt,k as se,l as Hr,i as _t,j as lt,s as Ii,b8 as qr,a8 as wi,a as Yi,b9 as Tn,ba as pl,bb as Km,m as zr,w as xn,N as Xs,bc as tT,bd as rT,be as xx,bf as iT,bg as P8,bh as nT,o as pv}from"../chunks/BCb-bXPf.js";import{i as Qe,r as Ri,p as pi,b as ha,c as mo,s as sT}from"../chunks/CaLg0wbH.js";import{g as aT}from"../chunks/D4IbFQaT.js";function oT(){return Symbol(v8)}function mv(e,t,i){Yn&&Ym();var a=new fA(e),h=!dA();jg(()=>{var d=t();h&&d!==null&&typeof d=="object"&&(d={}),a.ensure(d,i)})}function ml(e,t){return t}function lT(e,t,i){for(var a=e.items,h=[],d=t.length,p=0;p<d;p++)xA(t[p].e,h,!0);var s=d>0&&h.length===0&&i!==null;if(s){var w=i.parentNode;MA(w),w.append(i),a.clear(),ho(e,t[0].prev,t[d-1].next)}IA(h,()=>{for(var A=0;A<d;A++){var z=t[A];s||(a.delete(z.k),ho(e,z.prev,z.next)),tp(z.e,!s)}})}function Mo(e,t,i,a,h,d=null){var p=e,s={flags:t,items:new Map,first:null},w=(t&A8)!==0;if(w){var A=e;p=Yn?zm(Ef(A)):A.appendChild(y8())}Yn&&Ym();var z=null,B=!1,D=new Map,V=pA(()=>{var ne=i();return x8(ne)?ne:ne==null?[]:w8(ne)}),W,S;function j(){cT(S,W,s,D,p,h,t,a,i),d!==null&&(W.length===0?z?M8(z):z=ep(()=>d(p)):z!==null&&bA(z,()=>{z=null}))}jg(()=>{S??(S=gy),W=T(V);var ne=W.length;if(B&&ne===0)return;B=ne===0;let te=!1;if(Yn){var Q=mA(p)===gA;Q!==(ne===0)&&(p=vx(),zm(p),Uf(!1),te=!0)}if(Yn){for(var N=null,re,oe=0;oe<ne;oe++){if(Yc.nodeType===b8&&Yc.data===_A){p=Yc,te=!0,Uf(!1);break}var ve=W[oe],Pe=a(ve,oe);re=gv(Yc,s,N,null,ve,Pe,oe,h,t,i),s.items.set(Pe,re),N=re}ne>0&&zm(vx())}if(Yn)ne===0&&d&&(z=ep(()=>d(p)));else if(vA()){var $=new Set,le=xu;for(oe=0;oe<ne;oe+=1){ve=W[oe],Pe=a(ve,oe);var Me=s.items.get(Pe)??D.get(Pe);Me?(t&(Og|Zg))!==0&&E8(Me,ve,oe,t):(re=gv(null,s,null,null,ve,Pe,oe,h,t,i,!0),D.set(Pe,re)),$.add(Pe)}for(const[Ve,Be]of s.items)$.has(Ve)||le.skipped_effects.add(Be.e);le.oncommit(j)}else j();te&&Uf(!0),T(V)}),Yn&&(p=Yc)}function cT(e,t,i,a,h,d,p,s,w){var ye,ge,Ye,We;var A=(p&AA)!==0,z=(p&(Og|Zg))!==0,B=t.length,D=i.items,V=i.first,W=V,S,j=null,ne,te=[],Q=[],N,re,oe,ve;if(A)for(ve=0;ve<B;ve+=1)N=t[ve],re=s(N,ve),oe=D.get(re),oe!==void 0&&((ye=oe.a)==null||ye.measure(),(ne??(ne=new Set)).add(oe));for(ve=0;ve<B;ve+=1){if(N=t[ve],re=s(N,ve),oe=D.get(re),oe===void 0){var Pe=a.get(re);if(Pe!==void 0){a.delete(re),D.set(re,Pe);var $=j?j.next:W;ho(i,j,Pe),ho(i,Pe,$),w_(Pe,$,h),j=Pe}else{var le=W?W.e.nodes_start:h;j=gv(le,i,j,j===null?i.first:j.next,N,re,ve,d,p,w)}D.set(re,j),te=[],Q=[],W=j.next;continue}if(z&&E8(oe,N,ve,p),(oe.e.f&b_)!==0&&(M8(oe.e),A&&((ge=oe.a)==null||ge.unfix(),(ne??(ne=new Set)).delete(oe))),oe!==W){if(S!==void 0&&S.has(oe)){if(te.length<Q.length){var Me=Q[0],Ve;j=Me.prev;var Be=te[0],q=te[te.length-1];for(Ve=0;Ve<te.length;Ve+=1)w_(te[Ve],Me,h);for(Ve=0;Ve<Q.length;Ve+=1)S.delete(Q[Ve]);ho(i,Be.prev,q.next),ho(i,j,Be),ho(i,q,Me),W=Me,j=q,ve-=1,te=[],Q=[]}else S.delete(oe),w_(oe,W,h),ho(i,oe.prev,oe.next),ho(i,oe,j===null?i.first:j.next),ho(i,j,oe),j=oe;continue}for(te=[],Q=[];W!==null&&W.k!==re;)(W.e.f&b_)===0&&(S??(S=new Set)).add(W),Q.push(W),W=W.next;if(W===null)continue;oe=W}te.push(oe),j=oe,W=oe.next}if(W!==null||S!==void 0){for(var me=S===void 0?[]:w8(S);W!==null;)(W.e.f&b_)===0&&me.push(W),W=W.next;var Ee=me.length;if(Ee>0){var Ne=(p&A8)!==0&&B===0?h:null;if(A){for(ve=0;ve<Ee;ve+=1)(Ye=me[ve].a)==null||Ye.measure();for(ve=0;ve<Ee;ve+=1)(We=me[ve].a)==null||We.fix()}lT(i,me,Ne)}}A&&_y(()=>{var ot;if(ne!==void 0)for(oe of ne)(ot=oe.a)==null||ot.apply()}),e.first=i.first&&i.first.e,e.last=j&&j.e;for(var $e of a.values())tp($e.e);a.clear()}function E8(e,t,i,a){(a&Og)!==0&&yx(e.v,t),(a&Zg)!==0?yx(e.i,i):e.i=i}function gv(e,t,i,a,h,d,p,s,w,A,z){var B=(w&Og)!==0,D=(w&wA)===0,V=B?D?yA(h,!1,!1):dv(h):h,W=(w&Zg)===0?p:dv(p),S={i:W,v:V,k:d,a:null,e:null,prev:i,next:a};try{if(e===null){var j=document.createDocumentFragment();j.append(e=y8())}return S.e=ep(()=>s(e,V,W,A),Yn),S.e.prev=i&&i.e,S.e.next=a&&a.e,i===null?z||(t.first=S):(i.next=S,i.e.next=S.e),a!==null&&(a.prev=S,a.e.prev=S.e),S}finally{}}function w_(e,t,i){for(var a=e.next?e.next.e.nodes_start:i,h=t?t.e.nodes_start:i,d=e.e.nodes_start;d!==null&&d!==a;){var p=I8(d);h.before(d),d=p}}function ho(e,t,i){t===null?e.first=i:(t.next=i,t.e.next=i&&i.e),i!==null&&(i.prev=t,i.e.prev=t&&t.e)}function k8(e,t,i=!1,a=!1,h=!1){var d=e,p="";$r(()=>{var s=gy;if(p===(p=t()??"")){Yn&&Ym();return}if(s.nodes_start!==null&&(TA(s.nodes_start,s.nodes_end),s.nodes_start=s.nodes_end=null),p!==""){if(Yn){Yc.data;for(var w=Ym(),A=w;w!==null&&(w.nodeType!==b8||w.data!=="");)A=w,w=I8(w);if(w===null)throw CA(),SA;bx(Yc,A),d=zm(w);return}var z=p+"";i?z=`<svg>${z}</svg>`:a&&(z=`<math>${z}</math>`);var B=PA(z);if((i||a)&&(B=Ef(B)),bx(Ef(B),B.lastChild),i||a)for(;Ef(B);)d.before(Ef(B));else d.before(B)}})}function hT(e,t){var i=void 0,a;jg(()=>{i!==(i=t())&&(a&&(tp(a),a=null),i&&(a=ep(()=>{Ng(()=>i(e))})))})}function R8(e){var t,i,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var h=e.length;for(t=0;t<h;t++)e[t]&&(i=R8(e[t]))&&(a&&(a+=" "),a+=i)}else for(i in e)e[i]&&(a&&(a+=" "),a+=i);return a}function Fm(){for(var e,t,i=0,a="",h=arguments.length;i<h;i++)(e=arguments[i])&&(t=R8(e))&&(a&&(a+=" "),a+=t);return a}function uT(e){return typeof e=="object"?Fm(e):e??""}const Mx=[...` 	
\r\fÂ \v\uFEFF`];function dT(e,t,i){var a=e==null?"":""+e;if(t&&(a=a?a+" "+t:t),i){for(var h in i)if(i[h])a=a?a+" "+h:h;else if(a.length)for(var d=h.length,p=0;(p=a.indexOf(h,p))>=0;){var s=p+d;(p===0||Mx.includes(a[p-1]))&&(s===a.length||Mx.includes(a[s]))?a=(p===0?"":a.substring(0,p))+a.substring(s+1):p=s}}return a===""?null:a}function Ix(e,t=!1){var i=t?" !important;":";",a="";for(var h in e){var d=e[h];d!=null&&d!==""&&(a+=" "+h+": "+d+i)}return a}function x_(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function fT(e,t){if(t){var i="",a,h;if(Array.isArray(t)?(a=t[0],h=t[1]):a=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var d=!1,p=0,s=!1,w=[];a&&w.push(...Object.keys(a).map(x_)),h&&w.push(...Object.keys(h).map(x_));var A=0,z=-1;const S=e.length;for(var B=0;B<S;B++){var D=e[B];if(s?D==="/"&&e[B-1]==="*"&&(s=!1):d?d===D&&(d=!1):D==="/"&&e[B+1]==="*"?s=!0:D==='"'||D==="'"?d=D:D==="("?p++:D===")"&&p--,!s&&d===!1&&p===0){if(D===":"&&z===-1)z=B;else if(D===";"||B===S-1){if(z!==-1){var V=x_(e.substring(A,z).trim());if(!w.includes(V)){D!==";"&&B++;var W=e.substring(A,B).trim();i+=" "+W+";"}}A=B+1,z=-1}}}}return a&&(i+=Ix(a)),h&&(i+=Ix(h,!0)),i=i.trim(),i===""?null:i}return e==null?null:String(e)}function Ys(e,t,i,a,h,d){var p=e.__className;if(Yn||p!==i||p===void 0){var s=dT(i,a,d);(!Yn||s!==e.getAttribute("class"))&&(s==null?e.removeAttribute("class"):t?e.className=s:e.setAttribute("class",s)),e.__className=i}else if(d&&h!==d)for(var w in d){var A=!!d[w];(h==null||A!==!!h[w])&&e.classList.toggle(w,A)}return d}function M_(e,t={},i,a){for(var h in i){var d=i[h];t[h]!==d&&(i[h]==null?e.style.removeProperty(h):e.style.setProperty(h,d,a))}}function Bi(e,t,i,a){var h=e.__style;if(Yn||h!==t){var d=fT(t,a);(!Yn||d!==e.getAttribute("style"))&&(d==null?e.removeAttribute("style"):e.style.cssText=d),e.__style=t}else a&&(Array.isArray(a)?(M_(e,i==null?void 0:i[0],a[0]),M_(e,i==null?void 0:i[1],a[1],"important")):M_(e,i,a));return a}function _v(e,t,i=!1){if(e.multiple){if(t==null)return;if(!x8(t))return EA();for(var a of e.options)a.selected=t.includes(Ax(a));return}for(a of e.options){var h=Ax(a);if(kA(h,t)){a.selected=!0;return}}(!i||t!==void 0)&&(e.selectedIndex=-1)}function pT(e){var t=new MutationObserver(()=>{_v(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),RA(()=>{t.disconnect()})}function Ax(e){return"__value"in e?e.__value:e.value}const _f=Symbol("class"),vf=Symbol("style"),L8=Symbol("is custom element"),z8=Symbol("is html");function Hl(e){if(Yn){var t=!1,i=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var a=e.value;pr(e,"value",null),e.value=a}if(e.hasAttribute("checked")){var h=e.checked;pr(e,"checked",null),e.checked=h}}};e.__on_r=i,_y(i),NA()}}function mT(e,t){var i=Ug(e);i.value===(i.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function gT(e,t){var i=Ug(e);i.checked!==(i.checked=t??void 0)&&(e.checked=t)}function _T(e,t){t?e.hasAttribute("selected")||e.setAttribute("selected",""):e.removeAttribute("selected")}function pr(e,t,i,a){var h=Ug(e);Yn&&(h[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||h[t]!==(h[t]=i)&&(t==="loading"&&(e[FA]=i),i==null?e.removeAttribute(t):typeof i!="string"&&F8(e).includes(t)?e[t]=i:e.setAttribute(t,i))}function vT(e,t,i,a,h=!1,d=!1){if(Yn&&h&&e.tagName==="INPUT"){var p=e,s=p.type==="checkbox"?"defaultChecked":"defaultValue";s in i||Hl(p)}var w=Ug(e),A=w[L8],z=!w[z8];let B=Yn&&A;B&&Uf(!1);var D=t||{},V=e.tagName==="OPTION";for(var W in t)W in i||(i[W]=null);i.class?i.class=uT(i.class):i[_f]&&(i.class=null),i[vf]&&(i.style??(i.style=null));var S=F8(e);for(const oe in i){let ve=i[oe];if(V&&oe==="value"&&ve==null){e.value=e.__value="",D[oe]=ve;continue}if(oe==="class"){var j=e.namespaceURI==="http://www.w3.org/1999/xhtml";Ys(e,j,ve,a,t==null?void 0:t[_f],i[_f]),D[oe]=ve,D[_f]=i[_f];continue}if(oe==="style"){Bi(e,ve,t==null?void 0:t[vf],i[vf]),D[oe]=ve,D[vf]=i[vf];continue}var ne=D[oe];if(!(ve===ne&&!(ve===void 0&&e.hasAttribute(oe)))){D[oe]=ve;var te=oe[0]+oe[1];if(te!=="$$")if(te==="on"){const Pe={},$="$$"+oe;let le=oe.slice(2);var Q=UA(le);if(GA(le)&&(le=le.slice(0,-7),Pe.capture=!0),!Q&&ne){if(ve!=null)continue;e.removeEventListener(le,D[$],Pe),D[$]=null}if(ve!=null)if(Q)e[`__${le}`]=ve,_s([le]);else{let Me=function(Ve){D[oe].call(this,Ve)};D[$]=VA(le,e,Me,Pe)}else Q&&(e[`__${le}`]=void 0)}else if(oe==="style")pr(e,oe,ve);else if(oe==="autofocus")jA(e,!!ve);else if(!A&&(oe==="__value"||oe==="value"&&ve!=null))e.value=e.__value=ve;else if(oe==="selected"&&V)_T(e,ve);else{var N=oe;z||(N=ZA(N));var re=N==="defaultValue"||N==="defaultChecked";if(ve==null&&!A&&!re)if(w[oe]=null,N==="value"||N==="checked"){let Pe=e;const $=t===void 0;if(N==="value"){let le=Pe.defaultValue;Pe.removeAttribute(N),Pe.defaultValue=le,Pe.value=Pe.__value=$?le:null}else{let le=Pe.defaultChecked;Pe.removeAttribute(N),Pe.defaultChecked=le,Pe.checked=$?le:!1}}else e.removeAttribute(oe);else re||S.includes(N)&&(A||typeof ve!="string")?(e[N]=ve,N in w&&(w[N]=OA)):typeof ve!="function"&&pr(e,N,ve)}}}return B&&Uf(!0),D}function Pi(e,t,i=[],a=[],h=[],d,p=!1,s=!1){LA(h,i,a,w=>{var A=void 0,z={},B=e.nodeName==="SELECT",D=!1;if(jg(()=>{var W=t(...w.map(T)),S=vT(e,A,W,d,p,s);D&&B&&"value"in W&&_v(e,W.value);for(let ne of Object.getOwnPropertySymbols(z))W[ne]||tp(z[ne]);for(let ne of Object.getOwnPropertySymbols(W)){var j=W[ne];ne.description===v8&&(!A||j!==A[ne])&&(z[ne]&&tp(z[ne]),z[ne]=ep(()=>hT(e,()=>j))),S[ne]=j}A=S}),B){var V=e;Ng(()=>{_v(V,A.value,!0),pT(V)})}D=!0})}function Ug(e){return e.__attributes??(e.__attributes={[L8]:e.nodeName.includes("-"),[z8]:e.namespaceURI===zA})}var Tx=new Map;function F8(e){var t=e.getAttribute("is")||e.nodeName,i=Tx.get(t);if(i)return i;Tx.set(t,i=[]);for(var a,h=e,d=Element.prototype;d!==h;){a=BA(h);for(var p in a)a[p].set&&i.push(p);h=DA(h)}return i}const yT=()=>performance.now(),vo={tick:e=>requestAnimationFrame(e),now:()=>yT(),tasks:new Set};function D8(){const e=vo.now();vo.tasks.forEach(t=>{t.c(e)||(vo.tasks.delete(t),t.f())}),vo.tasks.size!==0&&vo.tick(D8)}function B8(e){let t;return vo.tasks.size===0&&vo.tick(D8),{promise:new Promise(i=>{vo.tasks.add(t={c:e,f:i})}),abort(){vo.tasks.delete(t)}}}function fm(e,t){T8(()=>{e.dispatchEvent(new CustomEvent(t))})}function bT(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(i=>i[0].toUpperCase()+i.slice(1)).join("")}function Cx(e){const t={},i=e.split(";");for(const a of i){const[h,d]=a.split(":");if(!h||d===void 0)break;const p=bT(h.trim());t[p]=d.trim()}return t}const wT=e=>e;function Vn(e,t,i,a){var h=(e&$A)!==0,d=(e&JA)!==0,p=h&&d,s=(e&YA)!==0,w=p?"both":h?"in":"out",A,z=t.inert,B=t.style.overflow,D,V;function W(){return T8(()=>A??(A=i()(t,(a==null?void 0:a())??{},{direction:w})))}var S={is_global:s,in(){var Q;if(t.inert=z,!h){V==null||V.abort(),(Q=V==null?void 0:V.reset)==null||Q.call(V);return}d||D==null||D.abort(),fm(t,"introstart"),D=vv(t,W(),V,1,()=>{fm(t,"introend"),D==null||D.abort(),D=A=void 0,t.style.overflow=B})},out(Q){if(!d){Q==null||Q(),A=void 0;return}t.inert=!0,fm(t,"outrostart"),V=vv(t,W(),D,0,()=>{fm(t,"outroend"),Q==null||Q()})},stop:()=>{D==null||D.abort(),V==null||V.abort()}},j=gy;if((j.transitions??(j.transitions=[])).push(S),h&&HA){var ne=s;if(!ne){for(var te=j.parent;te&&(te.f&WA)!==0;)for(;(te=te.parent)&&(te.f&XA)===0;);ne=!te||(te.f&qA)!==0}ne&&Ng(()=>{Yu(()=>S.in())})}}function vv(e,t,i,a,h){var d=a===1;if(KA(t)){var p,s=!1;return _y(()=>{if(!s){var j=t({direction:d?"in":"out"});p=vv(e,j,i,a,h)}}),{abort:()=>{s=!0,p==null||p.abort()},deactivate:()=>p.deactivate(),reset:()=>p.reset(),t:()=>p.t()}}if(i==null||i.deactivate(),!(t!=null&&t.duration))return h(),{abort:_o,deactivate:_o,reset:_o,t:()=>a};const{delay:w=0,css:A,tick:z,easing:B=wT}=t;var D=[];if(d&&i===void 0&&(z&&z(0,1),A)){var V=Cx(A(0,1));D.push(V,V)}var W=()=>1-a,S=e.animate(D,{duration:w,fill:"forwards"});return S.onfinish=()=>{S.cancel();var j=(i==null?void 0:i.t())??1-a;i==null||i.abort();var ne=a-j,te=t.duration*Math.abs(ne),Q=[];if(te>0){var N=!1;if(A)for(var re=Math.ceil(te/16.666666666666668),oe=0;oe<=re;oe+=1){var ve=j+ne*B(oe/re),Pe=Cx(A(ve,1-ve));Q.push(Pe),N||(N=Pe.overflow==="hidden")}N&&(e.style.overflow="hidden"),W=()=>{var $=S.currentTime;return j+ne*B($/te)},z&&B8(()=>{if(S.playState!=="running")return!1;var $=W();return z($,1-$),!0})}S=e.animate(Q,{duration:te,fill:"forwards"}),S.onfinish=()=>{W=()=>a,z==null||z(a,1-a),h()}},{abort:()=>{S&&(S.cancel(),S.effect=null,S.onfinish=_o)},deactivate:()=>{h=_o},reset:()=>{a===0&&(z==null||z(1,0))},t:()=>W()}}function $m(e,t,i=t){var a=new WeakSet;C8(e,"input",async h=>{var d=h?e.defaultValue:e.value;if(d=I_(e)?A_(d):d,i(d),xu!==null&&a.add(xu),await QA(),d!==(d=t())){var p=e.selectionStart,s=e.selectionEnd,w=e.value.length;if(e.value=d??"",s!==null){var A=e.value.length;p===s&&s===w&&A>w?(e.selectionStart=A,e.selectionEnd=A):(e.selectionStart=p,e.selectionEnd=Math.min(s,A))}}}),(Yn&&e.defaultValue!==e.value||Yu(t)==null&&e.value)&&(i(I_(e)?A_(e.value):e.value),xu!==null&&a.add(xu)),vy(()=>{var h=t();if(e===document.activeElement){var d=eT??xu;if(a.has(d))return}I_(e)&&h===A_(e.value)||e.type==="date"&&!h&&!e.value||h!==e.value&&(e.value=h??"")})}function Sx(e,t,i=t){C8(e,"change",a=>{var h=a?e.defaultChecked:e.checked;i(h)}),(Yn&&e.defaultChecked!==e.checked||Yu(t)==null)&&i(e.checked),vy(()=>{var a=t();e.checked=!!a})}function I_(e){var t=e.type;return t==="number"||t==="range"}function A_(e){return e===""?null:+e}var Ol,Ou,Pp,Dg,G8;const Bg=class Bg{constructor(t){ii(this,Dg);ii(this,Ol,new WeakMap);ii(this,Ou);ii(this,Pp);Zi(this,Pp,t)}observe(t,i){var a=Kt(this,Ol).get(t)||new Set;return a.add(i),Kt(this,Ol).set(t,a),Os(this,Dg,G8).call(this).observe(t,Kt(this,Pp)),()=>{var h=Kt(this,Ol).get(t);h.delete(i),h.size===0&&(Kt(this,Ol).delete(t),Kt(this,Ou).unobserve(t))}}};Ol=new WeakMap,Ou=new WeakMap,Pp=new WeakMap,Dg=new WeakSet,G8=function(){return Kt(this,Ou)??Zi(this,Ou,new ResizeObserver(t=>{for(var i of t){Bg.entries.set(i.target,i);for(var a of Kt(this,Ol).get(i.target)||[])a(i)}}))},Ke(Bg,"entries",new WeakMap);let yv=Bg;var xT=new yv({box:"border-box"});function Jm(e,t,i){var a=xT.observe(e,()=>i(e[t]));Ng(()=>(Yu(()=>i(e[t])),a))}function Hg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function yy(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var i=function a(){return this instanceof a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};i.prototype=t.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var h=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(i,a,h.get?h:{enumerable:!0,get:function(){return e[a]}})}),i}var Dm={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.8.0/LICENSE.txt
 */var MT=Dm.exports,Px;function IT(){return Px||(Px=1,function(e,t){(function(i,a){e.exports=a()})(MT,function(){var i={},a={};function h(p,s,w){if(a[p]=w,p==="index"){var A="var sharedModule = {}; ("+a.shared+")(sharedModule); ("+a.worker+")(sharedModule);",z={};return a.shared(z),a.index(i,z),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([A],{type:"text/javascript"}))),i}}h("shared",["exports"],function(p){function s(l,n,o,u){return new(o||(o=Promise))(function(m,_){function b(G){try{E(u.next(G))}catch(Z){_(Z)}}function I(G){try{E(u.throw(G))}catch(Z){_(Z)}}function E(G){var Z;G.done?m(G.value):(Z=G.value,Z instanceof o?Z:new o(function(K){K(Z)})).then(b,I)}E((u=u.apply(l,n||[])).next())})}function w(l,n){this.x=l,this.y=n}function A(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var z,B;typeof SuppressedError=="function"&&SuppressedError,w.prototype={clone(){return new w(this.x,this.y)},add(l){return this.clone()._add(l)},sub(l){return this.clone()._sub(l)},multByPoint(l){return this.clone()._multByPoint(l)},divByPoint(l){return this.clone()._divByPoint(l)},mult(l){return this.clone()._mult(l)},div(l){return this.clone()._div(l)},rotate(l){return this.clone()._rotate(l)},rotateAround(l,n){return this.clone()._rotateAround(l,n)},matMult(l){return this.clone()._matMult(l)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(l){return this.x===l.x&&this.y===l.y},dist(l){return Math.sqrt(this.distSqr(l))},distSqr(l){const n=l.x-this.x,o=l.y-this.y;return n*n+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith(l){return this.angleWithSep(l.x,l.y)},angleWithSep(l,n){return Math.atan2(this.x*n-this.y*l,this.x*l+this.y*n)},_matMult(l){const n=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=n,this},_add(l){return this.x+=l.x,this.y+=l.y,this},_sub(l){return this.x-=l.x,this.y-=l.y,this},_mult(l){return this.x*=l,this.y*=l,this},_div(l){return this.x/=l,this.y/=l,this},_multByPoint(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint(l){return this.x/=l.x,this.y/=l.y,this},_unit(){return this._div(this.mag()),this},_perp(){const l=this.y;return this.y=this.x,this.x=-l,this},_rotate(l){const n=Math.cos(l),o=Math.sin(l),u=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=u,this},_rotateAround(l,n){const o=Math.cos(l),u=Math.sin(l),m=n.y+u*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-u*(this.y-n.y),this.y=m,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:w},w.convert=function(l){if(l instanceof w)return l;if(Array.isArray(l))return new w(+l[0],+l[1]);if(l.x!==void 0&&l.y!==void 0)return new w(+l.x,+l.y);throw new Error("Expected [x, y] or {x, y} point format")};var D=function(){if(B)return z;function l(n,o,u,m){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(m-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=o,this.p2x=u,this.p2y=m}return B=1,z=l,l.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,o){if(o===void 0&&(o=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,m=0;m<8;m++){var _=this.sampleCurveX(u)-n;if(Math.abs(_)<o)return u;var b=this.sampleCurveDerivativeX(u);if(Math.abs(b)<1e-6)break;u-=_/b}var I=0,E=1;for(u=n,m=0;m<20&&(_=this.sampleCurveX(u),!(Math.abs(_-n)<o));m++)n>_?I=u:E=u,u=.5*(E-I)+I;return u},solve:function(n,o){return this.sampleCurveY(this.solveCurveX(n,o))}},z}(),V=A(D);let W,S;function j(){return W==null&&(W=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),W}function ne(){if(S==null&&(S=!1,j())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let u=0;u<5*5;u++){const m=4*u;n.fillStyle=`rgb(${m},${m+1},${m+2})`,n.fillRect(u%5,Math.floor(u/5),1,1)}const o=n.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&o[u]!==u){S=!0;break}}}return S||!1}var te=1e-6,Q=typeof Float32Array<"u"?Float32Array:Array;function N(){var l=new Q(9);return Q!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function re(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function oe(){var l=new Q(3);return Q!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function ve(l){var n=l[0],o=l[1],u=l[2];return Math.sqrt(n*n+o*o+u*u)}function Pe(l,n,o){var u=new Q(3);return u[0]=l,u[1]=n,u[2]=o,u}function $(l,n,o){return l[0]=n[0]+o[0],l[1]=n[1]+o[1],l[2]=n[2]+o[2],l}function le(l,n,o){return l[0]=n[0]*o,l[1]=n[1]*o,l[2]=n[2]*o,l}function Me(l,n,o){var u=n[0],m=n[1],_=n[2],b=o[0],I=o[1],E=o[2];return l[0]=m*E-_*I,l[1]=_*b-u*E,l[2]=u*I-m*b,l}var Ve,Be=ve;function q(l,n,o){var u=n[0],m=n[1],_=n[2],b=n[3];return l[0]=o[0]*u+o[4]*m+o[8]*_+o[12]*b,l[1]=o[1]*u+o[5]*m+o[9]*_+o[13]*b,l[2]=o[2]*u+o[6]*m+o[10]*_+o[14]*b,l[3]=o[3]*u+o[7]*m+o[11]*_+o[15]*b,l}function me(){var l=new Q(4);return Q!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function Ee(l,n,o,u){var m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",_=Math.PI/360;n*=_,u*=_,o*=_;var b=Math.sin(n),I=Math.cos(n),E=Math.sin(o),G=Math.cos(o),Z=Math.sin(u),K=Math.cos(u);switch(m){case"xyz":l[0]=b*G*K+I*E*Z,l[1]=I*E*K-b*G*Z,l[2]=I*G*Z+b*E*K,l[3]=I*G*K-b*E*Z;break;case"xzy":l[0]=b*G*K-I*E*Z,l[1]=I*E*K-b*G*Z,l[2]=I*G*Z+b*E*K,l[3]=I*G*K+b*E*Z;break;case"yxz":l[0]=b*G*K+I*E*Z,l[1]=I*E*K-b*G*Z,l[2]=I*G*Z-b*E*K,l[3]=I*G*K+b*E*Z;break;case"yzx":l[0]=b*G*K+I*E*Z,l[1]=I*E*K+b*G*Z,l[2]=I*G*Z-b*E*K,l[3]=I*G*K-b*E*Z;break;case"zxy":l[0]=b*G*K-I*E*Z,l[1]=I*E*K+b*G*Z,l[2]=I*G*Z+b*E*K,l[3]=I*G*K-b*E*Z;break;case"zyx":l[0]=b*G*K-I*E*Z,l[1]=I*E*K+b*G*Z,l[2]=I*G*Z-b*E*K,l[3]=I*G*K+b*E*Z;break;default:throw new Error("Unknown angle order "+m)}return l}function Ne(){var l=new Q(2);return Q!=Float32Array&&(l[0]=0,l[1]=0),l}function $e(l,n){var o=new Q(2);return o[0]=l,o[1]=n,o}oe(),Ve=new Q(4),Q!=Float32Array&&(Ve[0]=0,Ve[1]=0,Ve[2]=0,Ve[3]=0),oe(),Pe(1,0,0),Pe(0,1,0),me(),me(),N(),Ne();const ye=8192;function ge(l,n,o){return n*(ye/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}function Ye(l,n){return(l%n+n)%n}function We(l,n,o){return l*(1-o)+n*o}function ot(l){if(l<=0)return 0;if(l>=1)return 1;const n=l*l,o=n*l;return 4*(l<.5?o:3*(l-n)+o-.75)}function Se(l,n,o,u){const m=new V(l,n,o,u);return _=>m.solve(_)}const Ce=Se(.25,.1,.25,1);function It(l,n,o){return Math.min(o,Math.max(n,l))}function Lt(l,n,o){const u=o-n,m=((l-n)%u+u)%u+n;return m===n?o:m}function Xt(l,...n){for(const o of n)for(const u in o)l[u]=o[u];return l}let Jt=1;function dr(l,n,o){const u={};for(const m in l)u[m]=n.call(this,l[m],m,l);return u}function zt(l,n,o){const u={};for(const m in l)n.call(this,l[m],m,l)&&(u[m]=l[m]);return u}function Zt(l){return Array.isArray(l)?l.map(Zt):typeof l=="object"&&l?dr(l,Zt):l}const Ot={};function Yt(l){Ot[l]||(typeof console<"u"&&console.warn(l),Ot[l]=!0)}function Ar(l,n,o){return(o.y-l.y)*(n.x-l.x)>(n.y-l.y)*(o.x-l.x)}function yr(l){return typeof WorkerGlobalScope<"u"&&l!==void 0&&l instanceof WorkerGlobalScope}let kr=null;function Tr(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const Dr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function hi(l,n,o,u,m){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(l,{timestamp:0});try{const b=_==null?void 0:_.format;if(!b||!b.startsWith("BGR")&&!b.startsWith("RGB"))throw new Error(`Unrecognized format ${b}`);const I=b.startsWith("BGR"),E=new Uint8ClampedArray(u*m*4);if(yield _.copyTo(E,function(G,Z,K,ce,fe){const _e=4*Math.max(-Z,0),Ie=(Math.max(0,K)-K)*ce*4+_e,Le=4*ce,Oe=Math.max(0,Z),vt=Math.max(0,K);return{rect:{x:Oe,y:vt,width:Math.min(G.width,Z+ce)-Oe,height:Math.min(G.height,K+fe)-vt},layout:[{offset:Ie,stride:Le}]}}(l,n,o,u,m)),I)for(let G=0;G<E.length;G+=4){const Z=E[G];E[G]=E[G+2],E[G+2]=Z}return E}finally{_.close()}})}let ni,ui;function dn(l,n,o,u){return l.addEventListener(n,o,u),{unsubscribe:()=>{l.removeEventListener(n,o,u)}}}function Xi(l){return l*Math.PI/180}function fn(l){return l/Math.PI*180}const Pr={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},xi={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Fi="AbortError";function ct(){return new Error(Fi)}const be={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function we(l){return be.REGISTERED_PROTOCOLS[l.substring(0,l.indexOf("://"))]}const Te="global-dispatcher";class Ge extends Error{constructor(n,o,u,m){super(`AJAXError: ${o} (${n}): ${u}`),this.status=n,this.statusText=o,this.url=u,this.body=m}}const He=()=>yr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,nt=function(l,n){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){const u=we(l.url);if(u)return u(l,n);if(yr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,targetMapId:Te},n)}if(!(/^file:/.test(o=l.url)||/^file:/.test(He())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,m){return s(this,void 0,void 0,function*(){const _=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:He(),signal:m.signal});let b,I;u.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");try{b=yield fetch(_)}catch(G){throw new Ge(0,G.message,u.url,new Blob)}if(!b.ok){const G=yield b.blob();throw new Ge(b.status,b.statusText,u.url,G)}I=u.type==="arrayBuffer"||u.type==="image"?b.arrayBuffer():u.type==="json"?b.json():b.text();const E=yield I;if(m.signal.aborted)throw ct();return{data:E,cacheControl:b.headers.get("Cache-Control"),expires:b.headers.get("Expires")}})}(l,n);if(yr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,mustQueue:!0,targetMapId:Te},n)}var o;return function(u,m){return new Promise((_,b)=>{var I;const E=new XMLHttpRequest;E.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(E.responseType="arraybuffer");for(const G in u.headers)E.setRequestHeader(G,u.headers[G]);u.type==="json"&&(E.responseType="text",!((I=u.headers)===null||I===void 0)&&I.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=u.credentials==="include",E.onerror=()=>{b(new Error(E.statusText))},E.onload=()=>{if(!m.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let G=E.response;if(u.type==="json")try{G=JSON.parse(E.response)}catch(Z){return void b(Z)}_({data:G,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const G=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});b(new Ge(E.status,E.statusText,u.url,G))}},m.signal.addEventListener("abort",()=>{E.abort(),b(ct())}),E.send(u.body)})}(l,n)};function yt(l){if(!l||l.indexOf("://")<=0||l.indexOf("data:image/")===0||l.indexOf("blob:")===0)return!0;const n=new URL(l),o=window.location;return n.protocol===o.protocol&&n.host===o.host}function ut(l,n,o){o[l]&&o[l].indexOf(n)!==-1||(o[l]=o[l]||[],o[l].push(n))}function St(l,n,o){if(o&&o[l]){const u=o[l].indexOf(n);u!==-1&&o[l].splice(u,1)}}class Vt{constructor(n,o={}){Xt(this,o),this.type=n}}class Ft extends Vt{constructor(n,o={}){super("error",Xt({error:n},o))}}class sr{on(n,o){return this._listeners=this._listeners||{},ut(n,o,this._listeners),{unsubscribe:()=>{this.off(n,o)}}}off(n,o){return St(n,o,this._listeners),St(n,o,this._oneTimeListeners),this}once(n,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},ut(n,o,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,o){typeof n=="string"&&(n=new Vt(n,o||{}));const u=n.type;if(this.listens(u)){n.target=this;const m=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const I of m)I.call(this,n);const _=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const I of _)St(u,I,this._oneTimeListeners),I.call(this,n);const b=this._eventedParent;b&&(Xt(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(n))}else n instanceof Ft&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,o){return this._eventedParent=n,this._eventedParentData=o,this}}var st={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const qe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ct(l,n){const o={};for(const u in l)u!=="ref"&&(o[u]=l[u]);return qe.forEach(u=>{u in n&&(o[u]=n[u])}),o}function wt(l,n){if(Array.isArray(l)){if(!Array.isArray(n)||l.length!==n.length)return!1;for(let o=0;o<l.length;o++)if(!wt(l[o],n[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&n!==null){if(typeof n!="object"||Object.keys(l).length!==Object.keys(n).length)return!1;for(const o in l)if(!wt(l[o],n[o]))return!1;return!0}return l===n}function jt(l,n){l.push(n)}function ie(l,n,o){jt(o,{command:"addSource",args:[l,n[l]]})}function k(l,n,o){jt(n,{command:"removeSource",args:[l]}),o[l]=!0}function C(l,n,o,u){k(l,o,u),ie(l,n,o)}function M(l,n,o){let u;for(u in l[o])if(Object.prototype.hasOwnProperty.call(l[o],u)&&u!=="data"&&!wt(l[o][u],n[o][u]))return!1;for(u in n[o])if(Object.prototype.hasOwnProperty.call(n[o],u)&&u!=="data"&&!wt(l[o][u],n[o][u]))return!1;return!0}function P(l,n,o,u,m,_){l=l||{},n=n||{};for(const b in l)Object.prototype.hasOwnProperty.call(l,b)&&(wt(l[b],n[b])||o.push({command:_,args:[u,b,n[b],m]}));for(const b in n)Object.prototype.hasOwnProperty.call(n,b)&&!Object.prototype.hasOwnProperty.call(l,b)&&(wt(l[b],n[b])||o.push({command:_,args:[u,b,n[b],m]}))}function O(l){return l.id}function xe(l,n){return l[n.id]=n,l}class he{constructor(n,o,u,m){this.message=(n?`${n}: `:"")+u,m&&(this.identifier=m),o!=null&&o.__line__&&(this.line=o.__line__)}}function Y(l,...n){for(const o of n)for(const u in o)l[u]=o[u];return l}class U extends Error{constructor(n,o){super(o),this.message=o,this.key=n}}class J{constructor(n,o=[]){this.parent=n,this.bindings={};for(const[u,m]of o)this.bindings[u]=m}concat(n){return new J(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const ue={kind:"null"},pe={kind:"number"},Ze={kind:"string"},ke={kind:"boolean"},rt={kind:"color"},bt={kind:"projectionDefinition"},ze={kind:"object"},gt={kind:"value"},Ut={kind:"collator"},$t={kind:"formatted"},Mr={kind:"padding"},Wr={kind:"colorArray"},gr={kind:"numberArray"},lr={kind:"resolvedImage"},Xr={kind:"variableAnchorOffsetCollection"};function ft(l,n){return{kind:"array",itemType:l,N:n}}function Bt(l){if(l.kind==="array"){const n=Bt(l.itemType);return typeof l.N=="number"?`array<${n}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${n}>`}return l.kind}const mr=[ue,pe,Ze,ke,rt,bt,$t,ze,ft(gt),Mr,gr,Wr,lr,Xr];function Wt(l,n){if(n.kind==="error")return null;if(l.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Wt(l.itemType,n.itemType))&&(typeof l.N!="number"||l.N===n.N))return null}else{if(l.kind===n.kind)return null;if(l.kind==="value"){for(const o of mr)if(!Wt(o,n))return null}}return`Expected ${Bt(l)} but found ${Bt(n)} instead.`}function vi(l,n){return n.some(o=>o.kind===l.kind)}function Gr(l,n){return n.some(o=>o==="null"?l===null:o==="array"?Array.isArray(l):o==="object"?l&&!Array.isArray(l)&&typeof l=="object":o===typeof l)}function mi(l,n){return l.kind==="array"&&n.kind==="array"?l.itemType.kind===n.itemType.kind&&typeof l.N=="number":l.kind===n.kind}const gi=.96422,Gi=.82521,Ln=4/29,Ei=6/29,on=3*Ei*Ei,zn=Ei*Ei*Ei,ti=Math.PI/180,ln=180/Math.PI;function pn(l){return(l%=360)<0&&(l+=360),l}function Vi([l,n,o,u]){let m,_;const b=fa((.2225045*(l=di(l))+.7168786*(n=di(n))+.0606169*(o=di(o)))/1);l===n&&n===o?m=_=b:(m=fa((.4360747*l+.3850649*n+.1430804*o)/gi),_=fa((.0139322*l+.0971045*n+.7141733*o)/Gi));const I=116*b-16;return[I<0?0:I,500*(m-b),200*(b-_),u]}function di(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function fa(l){return l>zn?Math.pow(l,1/3):l/on+Ln}function Kn([l,n,o,u]){let m=(l+16)/116,_=isNaN(n)?m:m+n/500,b=isNaN(o)?m:m-o/200;return m=1*oc(m),_=gi*oc(_),b=Gi*oc(b),[ac(3.1338561*_-1.6168667*m-.4906146*b),ac(-.9787684*_+1.9161415*m+.033454*b),ac(.0719453*_-.2289914*m+1.4052427*b),u]}function ac(l){return(l=l<=.00304?12.92*l:1.055*Math.pow(l,1/2.4)-.055)<0?0:l>1?1:l}function oc(l){return l>Ei?l*l*l:on*(l-Ln)}const ld=Object.hasOwn||function(l,n){return Object.prototype.hasOwnProperty.call(l,n)};function Ka(l,n){return ld(l,n)?l[n]:void 0}function Ro(l){return parseInt(l.padEnd(2,l),16)/255}function Ms(l,n){return ei(n?l/100:l,0,1)}function ei(l,n,o){return Math.min(Math.max(n,l),o)}function Lo(l){return!l.some(Number.isNaN)}const $a={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ca(l,n,o){return l+o*(n-l)}function zo(l,n,o){return l.map((u,m)=>Ca(u,n[m],o))}class si{constructor(n,o,u,m=1,_=!0){this.r=n,this.g=o,this.b=u,this.a=m,_||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[n,o,u,m]))}static parse(n){if(n instanceof si)return n;if(typeof n!="string")return;const o=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=Ka($a,u);if(m){const[b,I,E]=m;return[b/255,I/255,E/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const b=u.length<6?1:2;let I=1;return[Ro(u.slice(I,I+=b)),Ro(u.slice(I,I+=b)),Ro(u.slice(I,I+=b)),Ro(u.slice(I,I+b)||"ff")]}if(u.startsWith("rgb")){const b=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[I,E,G,Z,K,ce,fe,_e,Ie,Le,Oe,vt]=b,tt=[Z||" ",fe||" ",Le].join("");if(tt==="  "||tt==="  /"||tt===",,"||tt===",,,"){const at=[G,ce,Ie].join(""),Mt=at==="%%%"?100:at===""?255:0;if(Mt){const Dt=[ei(+E/Mt,0,1),ei(+K/Mt,0,1),ei(+_e/Mt,0,1),Oe?Ms(+Oe,vt):1];if(Lo(Dt))return Dt}}return}}const _=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[b,I,E,G,Z,K,ce,fe,_e]=_,Ie=[E||" ",Z||" ",ce].join("");if(Ie==="  "||Ie==="  /"||Ie===",,"||Ie===",,,"){const Le=[+I,ei(+G,0,100),ei(+K,0,100),fe?Ms(+fe,_e):1];if(Lo(Le))return function([Oe,vt,tt,at]){function Mt(Dt){const qt=(Dt+Oe/30)%12,ur=vt*Math.min(tt,1-tt);return tt-ur*Math.max(-1,Math.min(qt-3,9-qt,1))}return Oe=pn(Oe),vt/=100,tt/=100,[Mt(0),Mt(8),Mt(4),at]}(Le)}}}(n);return o?new si(...o,!1):void 0}get rgb(){const{r:n,g:o,b:u,a:m}=this,_=m||1/0;return this.overwriteGetter("rgb",[n/_,o/_,u/_,m])}get hcl(){return this.overwriteGetter("hcl",function(n){const[o,u,m,_]=Vi(n),b=Math.sqrt(u*u+m*m);return[Math.round(1e4*b)?pn(Math.atan2(m,u)*ln):NaN,b,o,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Vi(this.rgb))}overwriteGetter(n,o){return Object.defineProperty(this,n,{value:o}),o}toString(){const[n,o,u,m]=this.rgb;return`rgba(${[n,o,u].map(_=>Math.round(255*_)).join(",")},${m})`}static interpolate(n,o,u,m="rgb"){switch(m){case"rgb":{const[_,b,I,E]=zo(n.rgb,o.rgb,u);return new si(_,b,I,E,!1)}case"hcl":{const[_,b,I,E]=n.hcl,[G,Z,K,ce]=o.hcl;let fe,_e;if(isNaN(_)||isNaN(G))isNaN(_)?isNaN(G)?fe=NaN:(fe=G,I!==1&&I!==0||(_e=Z)):(fe=_,K!==1&&K!==0||(_e=b));else{let tt=G-_;G>_&&tt>180?tt-=360:G<_&&_-G>180&&(tt+=360),fe=_+u*tt}const[Ie,Le,Oe,vt]=function([tt,at,Mt,Dt]){return tt=isNaN(tt)?0:tt*ti,Kn([Mt,Math.cos(tt)*at,Math.sin(tt)*at,Dt])}([fe,_e??Ca(b,Z,u),Ca(I,K,u),Ca(E,ce,u)]);return new si(Ie,Le,Oe,vt,!1)}case"lab":{const[_,b,I,E]=Kn(zo(n.lab,o.lab,u));return new si(_,b,I,E,!1)}}}}si.black=new si(0,0,0,1),si.white=new si(1,1,1,1),si.transparent=new si(0,0,0,0),si.red=new si(1,0,0,1);class Fo{constructor(n,o,u){this.sensitivity=n?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,o){return this.collator.compare(n,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const mh=["bottom","center","top"];class gh{constructor(n,o,u,m,_,b){this.text=n,this.image=o,this.scale=u,this.fontStack=m,this.textColor=_,this.verticalAlign=b}}class cs{constructor(n){this.sections=n}static fromString(n){return new cs([new gh(n,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof cs?n:cs.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class jn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof jn)return n;if(typeof n=="number")return new jn([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const o of n)if(typeof o!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new jn(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,o,u){return new jn(zo(n.values,o.values,u))}}class hs{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof hs)return n;if(typeof n=="number")return new hs([n]);if(Array.isArray(n)){for(const o of n)if(typeof o!="number")return;return new hs(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,o,u){return new hs(zo(n.values,o.values,u))}}class Cn{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Cn)return n;if(typeof n=="string"){const u=si.parse(n);return u?new Cn([u]):void 0}if(!Array.isArray(n))return;const o=[];for(const u of n){if(typeof u!="string")return;const m=si.parse(u);if(!m)return;o.push(m)}return new Cn(o)}toString(){return JSON.stringify(this.values)}static interpolate(n,o,u,m="rgb"){const _=[];if(n.values.length!=o.values.length)throw new Error(`colorArray: Arrays have mismatched length (${n.values.length} vs. ${o.values.length}), cannot interpolate.`);for(let b=0;b<n.values.length;b++)_.push(si.interpolate(n.values[b],o.values[b],u,m));return new Cn(_)}}class ji extends Error{constructor(n){super(n),this.name="RuntimeError"}toJSON(){return this.message}}const n0=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class us{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof us)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let o=0;o<n.length;o+=2){const u=n[o],m=n[o+1];if(typeof u!="string"||!n0.has(u)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new us(n)}}toString(){return JSON.stringify(this.values)}static interpolate(n,o,u){const m=n.values,_=o.values;if(m.length!==_.length)throw new ji(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${o.toString()}`);const b=[];for(let I=0;I<m.length;I+=2){if(m[I]!==_[I])throw new ji(`Cannot interpolate values containing mismatched anchors. from[${I}]: ${m[I]}, to[${I}]: ${_[I]}`);b.push(m[I]);const[E,G]=m[I+1],[Z,K]=_[I+1];b.push([Ca(E,Z,u),Ca(G,K,u)])}return new us(b)}}class Is{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Is({name:n,available:!1}):null}}class rs{constructor(n,o,u){this.from=n,this.to=o,this.transition=u}static interpolate(n,o,u){return new rs(n,o,u)}static parse(n){return n instanceof rs?n:Array.isArray(n)&&n.length===3&&typeof n[0]=="string"&&typeof n[1]=="string"&&typeof n[2]=="number"?new rs(n[0],n[1],n[2]):typeof n=="object"&&typeof n.from=="string"&&typeof n.to=="string"&&typeof n.transition=="number"?new rs(n.from,n.to,n.transition):typeof n=="string"?new rs(n,n,1):void 0}}function Ki(l,n,o,u){return typeof l=="number"&&l>=0&&l<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[l,n,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[l,n,o,u]:[l,n,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Do(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof rs||l instanceof si||l instanceof Fo||l instanceof cs||l instanceof jn||l instanceof hs||l instanceof Cn||l instanceof us||l instanceof Is)return!0;if(Array.isArray(l)){for(const n of l)if(!Do(n))return!1;return!0}if(typeof l=="object"){for(const n in l)if(!Do(l[n]))return!1;return!0}return!1}function jr(l){if(l===null)return ue;if(typeof l=="string")return Ze;if(typeof l=="boolean")return ke;if(typeof l=="number")return pe;if(l instanceof si)return rt;if(l instanceof rs)return bt;if(l instanceof Fo)return Ut;if(l instanceof cs)return $t;if(l instanceof jn)return Mr;if(l instanceof hs)return gr;if(l instanceof Cn)return Wr;if(l instanceof us)return Xr;if(l instanceof Is)return lr;if(Array.isArray(l)){const n=l.length;let o;for(const u of l){const m=jr(u);if(o){if(o===m)continue;o=gt;break}o=m}return ft(o||gt,n)}return ze}function Yr(l){const n=typeof l;return l===null?"":n==="string"||n==="number"||n==="boolean"?String(l):l instanceof si||l instanceof rs||l instanceof cs||l instanceof jn||l instanceof hs||l instanceof Cn||l instanceof us||l instanceof Is?l.toString():JSON.stringify(l)}class Sa{constructor(n,o){this.type=n,this.value=o}static parse(n,o){if(n.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Do(n[1]))return o.error("invalid value");const u=n[1];let m=jr(u);const _=o.expectedType;return m.kind!=="array"||m.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(m=_),new Sa(m,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const yi={string:Ze,number:pe,boolean:ke,object:ze};class As{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let u,m=1;const _=n[0];if(_==="array"){let I,E;if(n.length>2){const G=n[1];if(typeof G!="string"||!(G in yi)||G==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);I=yi[G],m++}else I=gt;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return o.error('The length argument to "array" must be a positive integer literal',2);E=n[2],m++}u=ft(I,E)}else{if(!yi[_])throw new Error(`Types doesn't contain name = ${_}`);u=yi[_]}const b=[];for(;m<n.length;m++){const I=o.parse(n[m],m,gt);if(!I)return null;b.push(I)}return new As(u,b)}evaluate(n){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(n);if(!Wt(this.type,jr(u)))return u;if(o===this.args.length-1)throw new ji(`Expected value to be of type ${Bt(this.type)}, but found ${Bt(jr(u))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const pa={"to-boolean":ke,"to-color":rt,"to-number":pe,"to-string":Ze};class ma{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const u=n[0];if(!pa[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&n.length!==2)return o.error("Expected one argument.");const m=pa[u],_=[];for(let b=1;b<n.length;b++){const I=o.parse(n[b],b,gt);if(!I)return null;_.push(I)}return new ma(m,_)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let o,u;for(const m of this.args){if(o=m.evaluate(n),u=null,o instanceof si)return o;if(typeof o=="string"){const _=n.parseColor(o);if(_)return _}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rgba value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Ki(o[0],o[1],o[2],o[3]),!u))return new si(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new ji(u||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const u of this.args){o=u.evaluate(n);const m=jn.parse(o);if(m)return m}throw new ji(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"numberArray":{let o;for(const u of this.args){o=u.evaluate(n);const m=hs.parse(o);if(m)return m}throw new ji(`Could not parse numberArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"colorArray":{let o;for(const u of this.args){o=u.evaluate(n);const m=Cn.parse(o);if(m)return m}throw new ji(`Could not parse colorArray from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const u of this.args){o=u.evaluate(n);const m=us.parse(o);if(m)return m}throw new ji(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const u of this.args){if(o=u.evaluate(n),o===null)return 0;const m=Number(o);if(!isNaN(m))return m}throw new ji(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return cs.fromString(Yr(this.args[0].evaluate(n)));case"resolvedImage":return Is.fromString(Yr(this.args[0].evaluate(n)));case"projectionDefinition":return this.args[0].evaluate(n);default:return Yr(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const _h=["Unknown","Point","LineString","Polygon"];class cd{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?_h[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let o=this._parseColorCache.get(n);return o||(o=si.parse(n),this._parseColorCache.set(n,o)),o}}class xl{constructor(n,o,u=[],m,_=new J,b=[]){this.registry=n,this.path=u,this.key=u.map(I=>`[${I}]`).join(""),this.scope=_,this.errors=b,this.expectedType=m,this._isConstant=o}parse(n,o,u,m,_={}){return o?this.concat(o,u,m)._parse(n,_):this._parse(n,_)}_parse(n,o){function u(m,_,b){return b==="assert"?new As(_,[m]):b==="coerce"?new ma(_,[m]):m}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=n[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[m];if(_){let b=_.parse(n,this);if(!b)return null;if(this.expectedType){const I=this.expectedType,E=b.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||E.kind!=="value"){if(I.kind==="projectionDefinition"&&["string","array"].includes(E.kind)||["color","formatted","resolvedImage"].includes(I.kind)&&["value","string"].includes(E.kind)||["padding","numberArray"].includes(I.kind)&&["value","number","array"].includes(E.kind)||I.kind==="colorArray"&&["value","string","array"].includes(E.kind)||I.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(E.kind))b=u(b,I,o.typeAnnotation||"coerce");else if(this.checkSubtype(I,E))return null}else b=u(b,I,o.typeAnnotation||"assert")}if(!(b instanceof Sa)&&b.type.kind!=="resolvedImage"&&this._isConstant(b)){const I=new cd;try{b=new Sa(b.type,b.evaluate(I))}catch(E){return this.error(E.message),null}}return b}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,o,u){const m=typeof n=="number"?this.path.concat(n):this.path,_=u?this.scope.concat(u):this.scope;return new xl(this.registry,this._isConstant,m,o||null,_,this.errors)}error(n,...o){const u=`${this.key}${o.map(m=>`[${m}]`).join("")}`;this.errors.push(new U(u,n))}checkSubtype(n,o){const u=Wt(n,o);return u&&this.error(u),u}}class lc{constructor(n,o){this.type=o.type,this.bindings=[].concat(n),this.result=o}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const o of this.bindings)n(o[1]);n(this.result)}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let _=1;_<n.length-1;_+=2){const b=n[_];if(typeof b!="string")return o.error(`Expected string, but found ${typeof b} instead.`,_);if(/[^a-zA-Z0-9_]/.test(b))return o.error("Variable names must contain only alphanumeric characters or '_'.",_);const I=o.parse(n[_+1],_+1);if(!I)return null;u.push([b,I])}const m=o.parse(n[n.length-1],n.length-1,o.expectedType,u);return m?new lc(u,m):null}outputDefined(){return this.result.outputDefined()}}class vh{constructor(n,o){this.type=o.type,this.name=n,this.boundExpression=o}static parse(n,o){if(n.length!==2||typeof n[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=n[1];return o.scope.has(u)?new vh(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class yh{constructor(n,o,u){this.type=n,this.index=o,this.input=u}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,pe),m=o.parse(n[2],2,ft(o.expectedType||gt));return u&&m?new yh(m.type.itemType,u,m):null}evaluate(n){const o=this.index.evaluate(n),u=this.input.evaluate(n);if(o<0)throw new ji(`Array index out of bounds: ${o} < 0.`);if(o>=u.length)throw new ji(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o!==Math.floor(o))throw new ji(`Array index must be an integer, but found ${o} instead.`);return u[o]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class bh{constructor(n,o){this.type=ke,this.needle=n,this.haystack=o}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,gt),m=o.parse(n[2],2,gt);return u&&m?vi(u.type,[ke,Ze,pe,ue,gt])?new bh(u,m):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(u.type)} instead`):null}evaluate(n){const o=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!u)return!1;if(!Gr(o,["boolean","string","number","null"]))throw new ji(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(jr(o))} instead.`);if(!Gr(u,["string","array"]))throw new ji(`Expected second argument to be of type array or string, but found ${Bt(jr(u))} instead.`);return u.indexOf(o)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class $s{constructor(n,o,u){this.type=pe,this.needle=n,this.haystack=o,this.fromIndex=u}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 2 or 3 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,gt),m=o.parse(n[2],2,gt);if(!u||!m)return null;if(!vi(u.type,[ke,Ze,pe,ue,gt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(u.type)} instead`);if(n.length===4){const _=o.parse(n[3],3,pe);return _?new $s(u,m,_):null}return new $s(u,m)}evaluate(n){const o=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!Gr(o,["boolean","string","number","null"]))throw new ji(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(jr(o))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(n)),Gr(u,["string"])){const _=u.indexOf(o,m);return _===-1?-1:[...u.slice(0,_)].length}if(Gr(u,["array"]))return u.indexOf(o,m);throw new ji(`Expected second argument to be of type array or string, but found ${Bt(jr(u))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class Zn{constructor(n,o,u,m,_,b){this.inputType=n,this.type=o,this.input=u,this.cases=m,this.outputs=_,this.otherwise=b}static parse(n,o){if(n.length<5)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return o.error("Expected an even number of arguments.");let u,m;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);const _={},b=[];for(let G=2;G<n.length-1;G+=2){let Z=n[G];const K=n[G+1];Array.isArray(Z)||(Z=[Z]);const ce=o.concat(G);if(Z.length===0)return ce.error("Expected at least one branch label.");for(const _e of Z){if(typeof _e!="number"&&typeof _e!="string")return ce.error("Branch labels must be numbers or strings.");if(typeof _e=="number"&&Math.abs(_e)>Number.MAX_SAFE_INTEGER)return ce.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof _e=="number"&&Math.floor(_e)!==_e)return ce.error("Numeric branch labels must be integer values.");if(u){if(ce.checkSubtype(u,jr(_e)))return null}else u=jr(_e);if(_[String(_e)]!==void 0)return ce.error("Branch labels must be unique.");_[String(_e)]=b.length}const fe=o.parse(K,G,m);if(!fe)return null;m=m||fe.type,b.push(fe)}const I=o.parse(n[1],1,gt);if(!I)return null;const E=o.parse(n[n.length-1],n.length-1,m);return E?I.type.kind!=="value"&&o.concat(1).checkSubtype(u,I.type)?null:new Zn(u,m,I,_,b,E):null}evaluate(n){const o=this.input.evaluate(n);return(jr(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class Ml{constructor(n,o,u){this.type=n,this.branches=o,this.otherwise=u}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const m=[];for(let b=1;b<n.length-1;b+=2){const I=o.parse(n[b],b,ke);if(!I)return null;const E=o.parse(n[b+1],b+1,u);if(!E)return null;m.push([I,E]),u=u||E.type}const _=o.parse(n[n.length-1],n.length-1,u);if(!_)return null;if(!u)throw new Error("Can't infer output type");return new Ml(u,m,_)}evaluate(n){for(const[o,u]of this.branches)if(o.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[o,u]of this.branches)n(o),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class cc{constructor(n,o,u,m){this.type=n,this.input=o,this.beginIndex=u,this.endIndex=m}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 2 or 3 arguments, but found ${n.length-1} instead.`);const u=o.parse(n[1],1,gt),m=o.parse(n[2],2,pe);if(!u||!m)return null;if(!vi(u.type,[ft(gt),Ze,gt]))return o.error(`Expected first argument to be of type array or string, but found ${Bt(u.type)} instead`);if(n.length===4){const _=o.parse(n[3],3,pe);return _?new cc(u.type,u,m,_):null}return new cc(u.type,u,m)}evaluate(n){const o=this.input.evaluate(n),u=this.beginIndex.evaluate(n);let m;if(this.endIndex&&(m=this.endIndex.evaluate(n)),Gr(o,["string"]))return[...o].slice(u,m).join("");if(Gr(o,["array"]))return o.slice(u,m);throw new ji(`Expected first argument to be of type array or string, but found ${Bt(jr(o))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function Bo(l,n){const o=l.length-1;let u,m,_=0,b=o,I=0;for(;_<=b;)if(I=Math.floor((_+b)/2),u=l[I],m=l[I+1],u<=n){if(I===o||n<m)return I;_=I+1}else{if(!(u>n))throw new ji("Input is not a number.");b=I-1}return 0}class yn{constructor(n,o,u){this.type=n,this.input=o,this.labels=[],this.outputs=[];for(const[m,_]of u)this.labels.push(m),this.outputs.push(_)}static parse(n,o){if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(n[1],1,pe);if(!u)return null;const m=[];let _=null;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);for(let b=1;b<n.length;b+=2){const I=b===1?-1/0:n[b],E=n[b+1],G=b,Z=b+1;if(typeof I!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(m.length&&m[m.length-1][0]>=I)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',G);const K=o.parse(E,Z,_);if(!K)return null;_=_||K.type,m.push([I,K])}return new yn(_,u,m)}evaluate(n){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(n);const m=this.input.evaluate(n);if(m<=o[0])return u[0].evaluate(n);const _=o.length;return m>=o[_-1]?u[_-1].evaluate(n):u[Bo(o,m)].evaluate(n)}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function s0(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var hc,hd,h1=function(){if(hd)return hc;function l(n,o,u,m){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(m-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=o,this.p2x=u,this.p2y=m}return hd=1,hc=l,l.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,o){if(o===void 0&&(o=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,m=0;m<8;m++){var _=this.sampleCurveX(u)-n;if(Math.abs(_)<o)return u;var b=this.sampleCurveDerivativeX(u);if(Math.abs(b)<1e-6)break;u-=_/b}var I=0,E=1;for(u=n,m=0;m<20&&(_=this.sampleCurveX(u),!(Math.abs(_-n)<o));m++)n>_?I=u:E=u,u=.5*(E-I)+I;return u},solve:function(n,o){return this.sampleCurveY(this.solveCurveX(n,o))}},hc}(),Il=s0(h1);class $n{constructor(n,o,u,m,_){this.type=n,this.operator=o,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(const[b,I]of _)this.labels.push(b),this.outputs.push(I)}static interpolationFactor(n,o,u,m){let _=0;if(n.name==="exponential")_=uc(o,n.base,u,m);else if(n.name==="linear")_=uc(o,1,u,m);else if(n.name==="cubic-bezier"){const b=n.controlPoints;_=new Il(b[0],b[1],b[2],b[3]).solve(uc(o,1,u,m))}return _}static parse(n,o){let[u,m,_,...b]=n;if(!Array.isArray(m)||m.length===0)return o.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const G=m[1];if(typeof G!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:G}}else{if(m[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const G=m.slice(1);if(G.length!==4||G.some(Z=>typeof Z!="number"||Z<0||Z>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:G}}}if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(_=o.parse(_,2,pe),!_)return null;const I=[];let E=null;u!=="interpolate-hcl"&&u!=="interpolate-lab"||o.expectedType==Wr?o.expectedType&&o.expectedType.kind!=="value"&&(E=o.expectedType):E=rt;for(let G=0;G<b.length;G+=2){const Z=b[G],K=b[G+1],ce=G+3,fe=G+4;if(typeof Z!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ce);if(I.length&&I[I.length-1][0]>=Z)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ce);const _e=o.parse(K,fe,E);if(!_e)return null;E=E||_e.type,I.push([Z,_e])}return mi(E,pe)||mi(E,bt)||mi(E,rt)||mi(E,Mr)||mi(E,gr)||mi(E,Wr)||mi(E,Xr)||mi(E,ft(pe))?new $n(E,u,m,_,I):o.error(`Type ${Bt(E)} is not interpolatable.`)}evaluate(n){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(n);const m=this.input.evaluate(n);if(m<=o[0])return u[0].evaluate(n);const _=o.length;if(m>=o[_-1])return u[_-1].evaluate(n);const b=Bo(o,m),I=$n.interpolationFactor(this.interpolation,m,o[b],o[b+1]),E=u[b].evaluate(n),G=u[b+1].evaluate(n);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ca(E,G,I);case"color":return si.interpolate(E,G,I);case"padding":return jn.interpolate(E,G,I);case"colorArray":return Cn.interpolate(E,G,I);case"numberArray":return hs.interpolate(E,G,I);case"variableAnchorOffsetCollection":return us.interpolate(E,G,I);case"array":return zo(E,G,I);case"projectionDefinition":return rs.interpolate(E,G,I)}case"interpolate-hcl":switch(this.type.kind){case"color":return si.interpolate(E,G,I,"hcl");case"colorArray":return Cn.interpolate(E,G,I,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return si.interpolate(E,G,I,"lab");case"colorArray":return Cn.interpolate(E,G,I,"lab")}}}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function uc(l,n,o,u){const m=u-o,_=l-o;return m===0?0:n===1?_/m:(Math.pow(n,_)-1)/(Math.pow(n,m)-1)}const ga={color:si.interpolate,number:Ca,padding:jn.interpolate,numberArray:hs.interpolate,colorArray:Cn.interpolate,variableAnchorOffsetCollection:us.interpolate,array:zo};class dc{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let u=null;const m=o.expectedType;m&&m.kind!=="value"&&(u=m);const _=[];for(const I of n.slice(1)){const E=o.parse(I,1+_.length,u,void 0,{typeAnnotation:"omit"});if(!E)return null;u=u||E.type,_.push(E)}if(!u)throw new Error("No output type");const b=m&&_.some(I=>Wt(m,I.type));return new dc(b?gt:u,_)}evaluate(n){let o,u=null,m=0;for(const _ of this.args)if(m++,u=_.evaluate(n),u&&u instanceof Is&&!u.available&&(o||(o=u.name),u=null,m===this.args.length&&(u=o)),u!==null)break;return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function fc(l,n){return l==="=="||l==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function pc(l,n,o,u){return u.compare(n,o)===0}function is(l,n,o){const u=l!=="=="&&l!=="!=";return class V8{constructor(_,b,I){this.type=ke,this.lhs=_,this.rhs=b,this.collator=I,this.hasUntypedArgument=_.type.kind==="value"||b.type.kind==="value"}static parse(_,b){if(_.length!==3&&_.length!==4)return b.error("Expected two or three arguments.");const I=_[0];let E=b.parse(_[1],1,gt);if(!E)return null;if(!fc(I,E.type))return b.concat(1).error(`"${I}" comparisons are not supported for type '${Bt(E.type)}'.`);let G=b.parse(_[2],2,gt);if(!G)return null;if(!fc(I,G.type))return b.concat(2).error(`"${I}" comparisons are not supported for type '${Bt(G.type)}'.`);if(E.type.kind!==G.type.kind&&E.type.kind!=="value"&&G.type.kind!=="value")return b.error(`Cannot compare types '${Bt(E.type)}' and '${Bt(G.type)}'.`);u&&(E.type.kind==="value"&&G.type.kind!=="value"?E=new As(G.type,[E]):E.type.kind!=="value"&&G.type.kind==="value"&&(G=new As(E.type,[G])));let Z=null;if(_.length===4){if(E.type.kind!=="string"&&G.type.kind!=="string"&&E.type.kind!=="value"&&G.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(Z=b.parse(_[3],3,Ut),!Z)return null}return new V8(E,G,Z)}evaluate(_){const b=this.lhs.evaluate(_),I=this.rhs.evaluate(_);if(u&&this.hasUntypedArgument){const E=jr(b),G=jr(I);if(E.kind!==G.kind||E.kind!=="string"&&E.kind!=="number")throw new ji(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${E.kind}, ${G.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const E=jr(b),G=jr(I);if(E.kind!=="string"||G.kind!=="string")return n(_,b,I)}return this.collator?o(_,b,I,this.collator.evaluate(_)):n(_,b,I)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const a0=is("==",function(l,n,o){return n===o},pc),wh=is("!=",function(l,n,o){return n!==o},function(l,n,o,u){return!pc(0,n,o,u)}),u1=is("<",function(l,n,o){return n<o},function(l,n,o,u){return u.compare(n,o)<0}),ud=is(">",function(l,n,o){return n>o},function(l,n,o,u){return u.compare(n,o)>0}),d1=is("<=",function(l,n,o){return n<=o},function(l,n,o,u){return u.compare(n,o)<=0}),f1=is(">=",function(l,n,o){return n>=o},function(l,n,o,u){return u.compare(n,o)>=0});class xh{constructor(n,o,u){this.type=Ut,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=o}static parse(n,o){if(n.length!==2)return o.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const m=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,ke);if(!m)return null;const _=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,ke);if(!_)return null;let b=null;return u.locale&&(b=o.parse(u.locale,1,Ze),!b)?null:new xh(m,_,b)}evaluate(n){return new Fo(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class dd{constructor(n,o,u,m,_){this.type=Ze,this.number=n,this.locale=o,this.currency=u,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(n,o){if(n.length!==3)return o.error("Expected two arguments.");const u=o.parse(n[1],1,pe);if(!u)return null;const m=n[2];if(typeof m!="object"||Array.isArray(m))return o.error("NumberFormat options argument must be an object.");let _=null;if(m.locale&&(_=o.parse(m.locale,1,Ze),!_))return null;let b=null;if(m.currency&&(b=o.parse(m.currency,1,Ze),!b))return null;let I=null;if(m["min-fraction-digits"]&&(I=o.parse(m["min-fraction-digits"],1,pe),!I))return null;let E=null;return m["max-fraction-digits"]&&(E=o.parse(m["max-fraction-digits"],1,pe),!E)?null:new dd(u,_,b,I,E)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class Go{constructor(n){this.type=$t,this.sections=n}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const m=[];let _=!1;for(let b=1;b<=n.length-1;++b){const I=n[b];if(_&&typeof I=="object"&&!Array.isArray(I)){_=!1;let E=null;if(I["font-scale"]&&(E=o.parse(I["font-scale"],1,pe),!E))return null;let G=null;if(I["text-font"]&&(G=o.parse(I["text-font"],1,ft(Ze)),!G))return null;let Z=null;if(I["text-color"]&&(Z=o.parse(I["text-color"],1,rt),!Z))return null;let K=null;if(I["vertical-align"]){if(typeof I["vertical-align"]=="string"&&!mh.includes(I["vertical-align"]))return o.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${I["vertical-align"]}' instead.`);if(K=o.parse(I["vertical-align"],1,Ze),!K)return null}const ce=m[m.length-1];ce.scale=E,ce.font=G,ce.textColor=Z,ce.verticalAlign=K}else{const E=o.parse(n[b],1,gt);if(!E)return null;const G=E.type.kind;if(G!=="string"&&G!=="value"&&G!=="null"&&G!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,m.push({content:E,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Go(m)}evaluate(n){return new cs(this.sections.map(o=>{const u=o.content.evaluate(n);return jr(u)===lr?new gh("",u,null,null,null,o.verticalAlign?o.verticalAlign.evaluate(n):null):new gh(Yr(u),null,o.scale?o.scale.evaluate(n):null,o.font?o.font.evaluate(n).join(","):null,o.textColor?o.textColor.evaluate(n):null,o.verticalAlign?o.verticalAlign.evaluate(n):null)}))}eachChild(n){for(const o of this.sections)n(o.content),o.scale&&n(o.scale),o.font&&n(o.font),o.textColor&&n(o.textColor),o.verticalAlign&&n(o.verticalAlign)}outputDefined(){return!1}}class fd{constructor(n){this.type=lr,this.input=n}static parse(n,o){if(n.length!==2)return o.error("Expected two arguments.");const u=o.parse(n[1],1,Ze);return u?new fd(u):o.error("No image name provided.")}evaluate(n){const o=this.input.evaluate(n),u=Is.fromString(o);return u&&n.availableImages&&(u.available=n.availableImages.indexOf(o)>-1),u}eachChild(n){n(this.input)}outputDefined(){return!1}}class Mh{constructor(n){this.type=pe,this.input=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=o.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${Bt(u.type)} instead.`):new Mh(u):null}evaluate(n){const o=this.input.evaluate(n);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new ji(`Expected value to be of type string or array, but found ${Bt(jr(o))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Js=8192;function p1(l,n){const o=(180+l[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,m=Math.pow(2,n.z);return[Math.round(o*m*Js),Math.round(u*m*Js)]}function Ih(l,n){const o=Math.pow(2,n.z);return[(m=(l[0]/Js+n.x)/o,360*m-180),(u=(l[1]/Js+n.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,m}function mc(l,n){l[0]=Math.min(l[0],n[0]),l[1]=Math.min(l[1],n[1]),l[2]=Math.max(l[2],n[0]),l[3]=Math.max(l[3],n[1])}function gc(l,n){return!(l[0]<=n[0]||l[2]>=n[2]||l[1]<=n[1]||l[3]>=n[3])}function m1(l,n,o){const u=l[0]-n[0],m=l[1]-n[1],_=l[0]-o[0],b=l[1]-o[1];return u*b-_*m==0&&u*_<=0&&m*b<=0}function Ah(l,n,o,u){return(m=[u[0]-o[0],u[1]-o[1]])[0]*(_=[n[0]-l[0],n[1]-l[1]])[1]-m[1]*_[0]!=0&&!(!l0(l,n,o,u)||!l0(o,u,l,n));var m,_}function g1(l,n,o){for(const u of o)for(let m=0;m<u.length-1;++m)if(Ah(l,n,u[m],u[m+1]))return!0;return!1}function Vo(l,n,o=!1){let u=!1;for(const I of n)for(let E=0;E<I.length-1;E++){if(m1(l,I[E],I[E+1]))return o;(_=I[E])[1]>(m=l)[1]!=(b=I[E+1])[1]>m[1]&&m[0]<(b[0]-_[0])*(m[1]-_[1])/(b[1]-_[1])+_[0]&&(u=!u)}var m,_,b;return u}function o0(l,n){for(const o of n)if(Vo(l,o))return!0;return!1}function pd(l,n){for(const o of l)if(!Vo(o,n))return!1;for(let o=0;o<l.length-1;++o)if(g1(l[o],l[o+1],n))return!1;return!0}function _1(l,n){for(const o of n)if(pd(l,o))return!0;return!1}function l0(l,n,o,u){const m=u[0]-o[0],_=u[1]-o[1],b=(l[0]-o[0])*_-m*(l[1]-o[1]),I=(n[0]-o[0])*_-m*(n[1]-o[1]);return b>0&&I<0||b<0&&I>0}function md(l,n,o){const u=[];for(let m=0;m<l.length;m++){const _=[];for(let b=0;b<l[m].length;b++){const I=p1(l[m][b],o);mc(n,I),_.push(I)}u.push(_)}return u}function c0(l,n,o){const u=[];for(let m=0;m<l.length;m++){const _=md(l[m],n,o);u.push(_)}return u}function Th(l,n,o,u){if(l[0]<o[0]||l[0]>o[2]){const m=.5*u;let _=l[0]-o[0]>m?-u:o[0]-l[0]>m?u:0;_===0&&(_=l[0]-o[2]>m?-u:o[2]-l[0]>m?u:0),l[0]+=_}mc(n,l)}function h0(l,n,o,u){const m=Math.pow(2,u.z)*Js,_=[u.x*Js,u.y*Js],b=[];for(const I of l)for(const E of I){const G=[E.x+_[0],E.y+_[1]];Th(G,n,o,m),b.push(G)}return b}function u0(l,n,o,u){const m=Math.pow(2,u.z)*Js,_=[u.x*Js,u.y*Js],b=[];for(const E of l){const G=[];for(const Z of E){const K=[Z.x+_[0],Z.y+_[1]];mc(n,K),G.push(K)}b.push(G)}if(n[2]-n[0]<=m/2){(I=n)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const E of b)for(const G of E)Th(G,n,o,m)}var I;return b}class jo{constructor(n,o){this.type=ke,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Do(n[1])){const u=n[1];if(u.type==="FeatureCollection"){const m=[];for(const _ of u.features){const{type:b,coordinates:I}=_.geometry;b==="Polygon"&&m.push(I),b==="MultiPolygon"&&m.push(...I)}if(m.length)return new jo(u,{type:"MultiPolygon",coordinates:m})}else if(u.type==="Feature"){const m=u.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new jo(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new jo(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,u){const m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],b=o.canonicalID();if(u.type==="Polygon"){const I=md(u.coordinates,_,b),E=h0(o.geometry(),m,_,b);if(!gc(m,_))return!1;for(const G of E)if(!Vo(G,I))return!1}if(u.type==="MultiPolygon"){const I=c0(u.coordinates,_,b),E=h0(o.geometry(),m,_,b);if(!gc(m,_))return!1;for(const G of E)if(!o0(G,I))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,u){const m=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],b=o.canonicalID();if(u.type==="Polygon"){const I=md(u.coordinates,_,b),E=u0(o.geometry(),m,_,b);if(!gc(m,_))return!1;for(const G of E)if(!pd(G,I))return!1}if(u.type==="MultiPolygon"){const I=c0(u.coordinates,_,b),E=u0(o.geometry(),m,_,b);if(!gc(m,_))return!1;for(const G of E)if(!_1(G,I))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let gd=class{constructor(l=[],n=(o,u)=>o<u?-1:o>u?1:0){if(this.data=l,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:n,compare:o}=this,u=n[l];for(;l>0;){const m=l-1>>1,_=n[m];if(o(u,_)>=0)break;n[l]=_,l=m}n[l]=u}_down(l){const{data:n,compare:o}=this,u=this.length>>1,m=n[l];for(;l<u;){let _=1+(l<<1);const b=_+1;if(b<this.length&&o(n[b],n[_])<0&&(_=b),o(n[_],m)>=0)break;n[l]=n[_],l=_}n[l]=m}};function _d(l,n,o=0,u=l.length-1,m=v1){for(;u>o;){if(u-o>600){const E=u-o+1,G=n-o+1,Z=Math.log(E),K=.5*Math.exp(2*Z/3),ce=.5*Math.sqrt(Z*K*(E-K)/E)*(G-E/2<0?-1:1);_d(l,n,Math.max(o,Math.floor(n-G*K/E+ce)),Math.min(u,Math.floor(n+(E-G)*K/E+ce)),m)}const _=l[n];let b=o,I=u;for(_c(l,o,n),m(l[u],_)>0&&_c(l,o,u);b<I;){for(_c(l,b,I),b++,I--;m(l[b],_)<0;)b++;for(;m(l[I],_)>0;)I--}m(l[o],_)===0?_c(l,o,I):(I++,_c(l,I,u)),I<=n&&(o=I+1),n<=I&&(u=I-1)}}function _c(l,n,o){const u=l[n];l[n]=l[o],l[o]=u}function v1(l,n){return l<n?-1:l>n?1:0}function vc(l,n){if(l.length<=1)return[l];const o=[];let u,m;for(const _ of l){const b=y1(_);b!==0&&(_.area=Math.abs(b),m===void 0&&(m=b<0),m===b<0?(u&&o.push(u),u=[_]):u.push(_))}if(u&&o.push(u),n>1)for(let _=0;_<o.length;_++)o[_].length<=n||(_d(o[_],n,1,o[_].length-1,d0),o[_]=o[_].slice(0,n));return o}function d0(l,n){return n.area-l.area}function y1(l){let n=0;for(let o,u,m=0,_=l.length,b=_-1;m<_;b=m++)o=l[m],u=l[b],n+=(u.x-o.x)*(o.y+u.y);return n}const f0=1/298.257223563,p0=f0*(2-f0),vd=Math.PI/180;class yd{constructor(n){const o=6378.137*vd*1e3,u=Math.cos(n*vd),m=1/(1-p0*(1-u*u)),_=Math.sqrt(m);this.kx=o*_*u,this.ky=o*_*m*(1-p0)}distance(n,o){const u=this.wrap(n[0]-o[0])*this.kx,m=(n[1]-o[1])*this.ky;return Math.sqrt(u*u+m*m)}pointOnLine(n,o){let u,m,_,b,I=1/0;for(let E=0;E<n.length-1;E++){let G=n[E][0],Z=n[E][1],K=this.wrap(n[E+1][0]-G)*this.kx,ce=(n[E+1][1]-Z)*this.ky,fe=0;K===0&&ce===0||(fe=(this.wrap(o[0]-G)*this.kx*K+(o[1]-Z)*this.ky*ce)/(K*K+ce*ce),fe>1?(G=n[E+1][0],Z=n[E+1][1]):fe>0&&(G+=K/this.kx*fe,Z+=ce/this.ky*fe)),K=this.wrap(o[0]-G)*this.kx,ce=(o[1]-Z)*this.ky;const _e=K*K+ce*ce;_e<I&&(I=_e,u=G,m=Z,_=E,b=fe)}return{point:[u,m],index:_,t:Math.max(0,Math.min(1,b))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function m0(l,n){return n[0]-l[0]}function Ch(l){return l[1]-l[0]+1}function Pa(l,n){return l[1]>=l[0]&&l[1]<n}function Mi(l,n){if(l[0]>l[1])return[null,null];const o=Ch(l);if(n){if(o===2)return[l,null];const m=Math.floor(o/2);return[[l[0],l[0]+m],[l[0]+m,l[1]]]}if(o===1)return[l,null];const u=Math.floor(o/2)-1;return[[l[0],l[0]+u],[l[0]+u+1,l[1]]]}function bd(l,n){if(!Pa(n,l.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let u=n[0];u<=n[1];++u)mc(o,l[u]);return o}function wd(l){const n=[1/0,1/0,-1/0,-1/0];for(const o of l)for(const u of o)mc(n,u);return n}function g0(l){return l[0]!==-1/0&&l[1]!==-1/0&&l[2]!==1/0&&l[3]!==1/0}function xd(l,n,o){if(!g0(l)||!g0(n))return NaN;let u=0,m=0;return l[2]<n[0]&&(u=n[0]-l[2]),l[0]>n[2]&&(u=l[0]-n[2]),l[1]>n[3]&&(m=l[1]-n[3]),l[3]<n[1]&&(m=n[1]-l[3]),o.distance([0,0],[u,m])}function Zo(l,n,o){const u=o.pointOnLine(n,l);return o.distance(l,u.point)}function Md(l,n,o,u,m){const _=Math.min(Zo(l,[o,u],m),Zo(n,[o,u],m)),b=Math.min(Zo(o,[l,n],m),Zo(u,[l,n],m));return Math.min(_,b)}function b1(l,n,o,u,m){if(!Pa(n,l.length)||!Pa(u,o.length))return 1/0;let _=1/0;for(let b=n[0];b<n[1];++b){const I=l[b],E=l[b+1];for(let G=u[0];G<u[1];++G){const Z=o[G],K=o[G+1];if(Ah(I,E,Z,K))return 0;_=Math.min(_,Md(I,E,Z,K,m))}}return _}function w1(l,n,o,u,m){if(!Pa(n,l.length)||!Pa(u,o.length))return NaN;let _=1/0;for(let b=n[0];b<=n[1];++b)for(let I=u[0];I<=u[1];++I)if(_=Math.min(_,m.distance(l[b],o[I])),_===0)return _;return _}function x1(l,n,o){if(Vo(l,n,!0))return 0;let u=1/0;for(const m of n){const _=m[0],b=m[m.length-1];if(_!==b&&(u=Math.min(u,Zo(l,[b,_],o)),u===0))return u;const I=o.pointOnLine(m,l);if(u=Math.min(u,o.distance(l,I.point)),u===0)return u}return u}function M1(l,n,o,u){if(!Pa(n,l.length))return NaN;for(let _=n[0];_<=n[1];++_)if(Vo(l[_],o,!0))return 0;let m=1/0;for(let _=n[0];_<n[1];++_){const b=l[_],I=l[_+1];for(const E of o)for(let G=0,Z=E.length,K=Z-1;G<Z;K=G++){const ce=E[K],fe=E[G];if(Ah(b,I,ce,fe))return 0;m=Math.min(m,Md(b,I,ce,fe,u))}}return m}function _0(l,n){for(const o of l)for(const u of o)if(Vo(u,n,!0))return!0;return!1}function I1(l,n,o,u=1/0){const m=wd(l),_=wd(n);if(u!==1/0&&xd(m,_,o)>=u)return u;if(gc(m,_)){if(_0(l,n))return 0}else if(_0(n,l))return 0;let b=1/0;for(const I of l)for(let E=0,G=I.length,Z=G-1;E<G;Z=E++){const K=I[Z],ce=I[E];for(const fe of n)for(let _e=0,Ie=fe.length,Le=Ie-1;_e<Ie;Le=_e++){const Oe=fe[Le],vt=fe[_e];if(Ah(K,ce,Oe,vt))return 0;b=Math.min(b,Md(K,ce,Oe,vt,o))}}return b}function v0(l,n,o,u,m,_){if(!_)return;const b=xd(bd(u,_),m,o);b<n&&l.push([b,_,[0,0]])}function Sh(l,n,o,u,m,_,b){if(!_||!b)return;const I=xd(bd(u,_),bd(m,b),o);I<n&&l.push([I,_,b])}function Ph(l,n,o,u,m=1/0){let _=Math.min(u.distance(l[0],o[0][0]),m);if(_===0)return _;const b=new gd([[0,[0,l.length-1],[0,0]]],m0),I=wd(o);for(;b.length>0;){const E=b.pop();if(E[0]>=_)continue;const G=E[1],Z=n?50:100;if(Ch(G)<=Z){if(!Pa(G,l.length))return NaN;if(n){const K=M1(l,G,o,u);if(isNaN(K)||K===0)return K;_=Math.min(_,K)}else for(let K=G[0];K<=G[1];++K){const ce=x1(l[K],o,u);if(_=Math.min(_,ce),_===0)return 0}}else{const K=Mi(G,n);v0(b,_,u,l,I,K[0]),v0(b,_,u,l,I,K[1])}}return _}function Eh(l,n,o,u,m,_=1/0){let b=Math.min(_,m.distance(l[0],o[0]));if(b===0)return b;const I=new gd([[0,[0,l.length-1],[0,o.length-1]]],m0);for(;I.length>0;){const E=I.pop();if(E[0]>=b)continue;const G=E[1],Z=E[2],K=n?50:100,ce=u?50:100;if(Ch(G)<=K&&Ch(Z)<=ce){if(!Pa(G,l.length)&&Pa(Z,o.length))return NaN;let fe;if(n&&u)fe=b1(l,G,o,Z,m),b=Math.min(b,fe);else if(n&&!u){const _e=l.slice(G[0],G[1]+1);for(let Ie=Z[0];Ie<=Z[1];++Ie)if(fe=Zo(o[Ie],_e,m),b=Math.min(b,fe),b===0)return b}else if(!n&&u){const _e=o.slice(Z[0],Z[1]+1);for(let Ie=G[0];Ie<=G[1];++Ie)if(fe=Zo(l[Ie],_e,m),b=Math.min(b,fe),b===0)return b}else fe=w1(l,G,o,Z,m),b=Math.min(b,fe)}else{const fe=Mi(G,n),_e=Mi(Z,u);Sh(I,b,m,l,o,fe[0],_e[0]),Sh(I,b,m,l,o,fe[0],_e[1]),Sh(I,b,m,l,o,fe[1],_e[0]),Sh(I,b,m,l,o,fe[1],_e[1])}}return b}function Id(l){return l.type==="MultiPolygon"?l.coordinates.map(n=>({type:"Polygon",coordinates:n})):l.type==="MultiLineString"?l.coordinates.map(n=>({type:"LineString",coordinates:n})):l.type==="MultiPoint"?l.coordinates.map(n=>({type:"Point",coordinates:n})):[l]}class Oo{constructor(n,o){this.type=pe,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Do(n[1])){const u=n[1];if(u.type==="FeatureCollection")return new Oo(u,u.features.map(m=>Id(m.geometry)).flat());if(u.type==="Feature")return new Oo(u,Id(u.geometry));if("type"in u&&"coordinates"in u)return new Oo(u,Id(u))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,u){const m=o.geometry(),_=m.flat().map(E=>Ih([E.x,E.y],o.canonical));if(m.length===0)return NaN;const b=new yd(_[0][1]);let I=1/0;for(const E of u){switch(E.type){case"Point":I=Math.min(I,Eh(_,!1,[E.coordinates],!1,b,I));break;case"LineString":I=Math.min(I,Eh(_,!1,E.coordinates,!0,b,I));break;case"Polygon":I=Math.min(I,Ph(_,!1,E.coordinates,b,I))}if(I===0)return I}return I}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,u){const m=o.geometry(),_=m.flat().map(E=>Ih([E.x,E.y],o.canonical));if(m.length===0)return NaN;const b=new yd(_[0][1]);let I=1/0;for(const E of u){switch(E.type){case"Point":I=Math.min(I,Eh(_,!0,[E.coordinates],!1,b,I));break;case"LineString":I=Math.min(I,Eh(_,!0,E.coordinates,!0,b,I));break;case"Polygon":I=Math.min(I,Ph(_,!0,E.coordinates,b,I))}if(I===0)return I}return I}(n,this.geometries);if(n.geometryType()==="Polygon")return function(o,u){const m=o.geometry();if(m.length===0||m[0].length===0)return NaN;const _=vc(m,0).map(E=>E.map(G=>G.map(Z=>Ih([Z.x,Z.y],o.canonical)))),b=new yd(_[0][0][0][1]);let I=1/0;for(const E of u)for(const G of _){switch(E.type){case"Point":I=Math.min(I,Ph([E.coordinates],!1,G,b,I));break;case"LineString":I=Math.min(I,Ph(E.coordinates,!0,G,b,I));break;case"Polygon":I=Math.min(I,I1(G,E.coordinates,b,I))}if(I===0)return I}return I}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class yc{constructor(n){this.type=gt,this.key=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=n[1];return u==null?o.error("Global state property must be defined."):typeof u!="string"?o.error(`Global state property must be string, but found ${typeof n[1]} instead.`):new yc(u)}evaluate(n){var o;const u=(o=n.globals)===null||o===void 0?void 0:o.globalState;return u&&Object.keys(u).length!==0?Ka(u,this.key):null}eachChild(){}outputDefined(){return!1}}const Al={"==":a0,"!=":wh,">":ud,"<":u1,">=":f1,"<=":d1,array:As,at:yh,boolean:As,case:Ml,coalesce:dc,collator:xh,format:Go,image:fd,in:bh,"index-of":$s,interpolate:$n,"interpolate-hcl":$n,"interpolate-lab":$n,length:Mh,let:lc,literal:Sa,match:Zn,number:As,"number-format":dd,object:As,slice:cc,step:yn,string:As,"to-boolean":ma,"to-color":ma,"to-number":ma,"to-string":ma,var:vh,within:jo,distance:Oo,"global-state":yc};class Gs{constructor(n,o,u,m){this.name=n,this.type=o,this._evaluate=u,this.args=m}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,o){const u=n[0],m=Gs.definitions[u];if(!m)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(m)?m[0]:m.type,b=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,I=b.filter(([G])=>!Array.isArray(G)||G.length===n.length-1);let E=null;for(const[G,Z]of I){E=new xl(o.registry,kh,o.path,null,o.scope);const K=[];let ce=!1;for(let fe=1;fe<n.length;fe++){const _e=n[fe],Ie=Array.isArray(G)?G[fe-1]:G.type,Le=E.parse(_e,1+K.length,Ie);if(!Le){ce=!0;break}K.push(Le)}if(!ce)if(Array.isArray(G)&&G.length!==K.length)E.error(`Expected ${G.length} arguments, but found ${K.length} instead.`);else{for(let fe=0;fe<K.length;fe++){const _e=Array.isArray(G)?G[fe]:G.type,Ie=K[fe];E.concat(fe+1).checkSubtype(_e,Ie.type)}if(E.errors.length===0)return new Gs(u,_,Z,K)}}if(I.length===1)o.errors.push(...E.errors);else{const G=(I.length?I:b).map(([K])=>{return ce=K,Array.isArray(ce)?`(${ce.map(Bt).join(", ")})`:`(${Bt(ce.type)}...)`;var ce}).join(" | "),Z=[];for(let K=1;K<n.length;K++){const ce=o.parse(n[K],1+Z.length);if(!ce)return null;Z.push(Bt(ce.type))}o.error(`Expected arguments of type ${G}, but found (${Z.join(", ")}) instead.`)}return null}static register(n,o){Gs.definitions=o;for(const u in o)n[u]=Gs}}function y0(l,[n,o,u,m]){n=n.evaluate(l),o=o.evaluate(l),u=u.evaluate(l);const _=m?m.evaluate(l):1,b=Ki(n,o,u,_);if(b)throw new ji(b);return new si(n/255,o/255,u/255,_,!1)}function b0(l,n){return l in n}function Ad(l,n){const o=n[l];return o===void 0?null:o}function No(l){return{type:l}}function kh(l){if(l instanceof vh)return kh(l.boundExpression);if(l instanceof Gs&&l.name==="error"||l instanceof xh||l instanceof jo||l instanceof Oo||l instanceof yc)return!1;const n=l instanceof ma||l instanceof As;let o=!0;return l.eachChild(u=>{o=n?o&&kh(u):o&&u instanceof Sa}),!!o&&Rh(l)&&Lh(l,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Rh(l){if(l instanceof Gs&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof jo||l instanceof Oo)return!1;let n=!0;return l.eachChild(o=>{n&&!Rh(o)&&(n=!1)}),n}function bc(l){if(l instanceof Gs&&l.name==="feature-state")return!1;let n=!0;return l.eachChild(o=>{n&&!bc(o)&&(n=!1)}),n}function Lh(l,n){if(l instanceof Gs&&n.indexOf(l.name)>=0)return!1;let o=!0;return l.eachChild(u=>{o&&!Lh(u,n)&&(o=!1)}),o}function w0(l){return{result:"success",value:l}}function Tl(l){return{result:"error",value:l}}function Ja(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function x0(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function Td(l){return!!l.expression&&l.expression.interpolated}function oi(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function wc(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)&&jr(l)===ze}function A1(l){return l}function M0(l,n){const o=l.stops&&typeof l.stops[0][0]=="object",u=o||!(o||l.property!==void 0),m=l.type||(Td(n)?"exponential":"interval"),_=function(Z){switch(Z.type){case"color":return si.parse;case"padding":return jn.parse;case"numberArray":return hs.parse;case"colorArray":return Cn.parse;default:return null}}(n);if(_&&((l=Y({},l)).stops&&(l.stops=l.stops.map(Z=>[Z[0],_(Z[1])])),l.default=_(l.default?l.default:n.default)),l.colorSpace&&(b=l.colorSpace)!=="rgb"&&b!=="hcl"&&b!=="lab")throw new Error(`Unknown color space: "${l.colorSpace}"`);var b;const I=function(Z){switch(Z){case"exponential":return A0;case"interval":return T1;case"categorical":return I0;case"identity":return C1;default:throw new Error(`Unknown function type "${Z}"`)}}(m);let E,G;if(m==="categorical"){E=Object.create(null);for(const Z of l.stops)E[Z[0]]=Z[1];G=typeof l.stops[0][0]}if(o){const Z={},K=[];for(let _e=0;_e<l.stops.length;_e++){const Ie=l.stops[_e],Le=Ie[0].zoom;Z[Le]===void 0&&(Z[Le]={zoom:Le,type:l.type,property:l.property,default:l.default,stops:[]},K.push(Le)),Z[Le].stops.push([Ie[0].value,Ie[1]])}const ce=[];for(const _e of K)ce.push([Z[_e].zoom,M0(Z[_e],n)]);const fe={name:"linear"};return{kind:"composite",interpolationType:fe,interpolationFactor:$n.interpolationFactor.bind(void 0,fe),zoomStops:ce.map(_e=>_e[0]),evaluate:({zoom:_e},Ie)=>A0({stops:ce,base:l.base},n,_e).evaluate(_e,Ie)}}if(u){const Z=m==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:Z,interpolationFactor:$n.interpolationFactor.bind(void 0,Z),zoomStops:l.stops.map(K=>K[0]),evaluate:({zoom:K})=>I(l,n,K,E,G)}}return{kind:"source",evaluate(Z,K){const ce=K&&K.properties?K.properties[l.property]:void 0;return ce===void 0?Qa(l.default,n.default):I(l,n,ce,E,G)}}}function Qa(l,n,o){return l!==void 0?l:n!==void 0?n:o!==void 0?o:void 0}function I0(l,n,o,u,m){return Qa(typeof o===m?u[o]:void 0,l.default,n.default)}function T1(l,n,o){if(oi(o)!=="number")return Qa(l.default,n.default);const u=l.stops.length;if(u===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[u-1][0])return l.stops[u-1][1];const m=Bo(l.stops.map(_=>_[0]),o);return l.stops[m][1]}function A0(l,n,o){const u=l.base!==void 0?l.base:1;if(oi(o)!=="number")return Qa(l.default,n.default);const m=l.stops.length;if(m===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[m-1][0])return l.stops[m-1][1];const _=Bo(l.stops.map(Z=>Z[0]),o),b=function(Z,K,ce,fe){const _e=fe-ce,Ie=Z-ce;return _e===0?0:K===1?Ie/_e:(Math.pow(K,Ie)-1)/(Math.pow(K,_e)-1)}(o,u,l.stops[_][0],l.stops[_+1][0]),I=l.stops[_][1],E=l.stops[_+1][1],G=ga[n.type]||A1;return typeof I.evaluate=="function"?{evaluate(...Z){const K=I.evaluate.apply(void 0,Z),ce=E.evaluate.apply(void 0,Z);if(K!==void 0&&ce!==void 0)return G(K,ce,b,l.colorSpace)}}:G(I,E,b,l.colorSpace)}function C1(l,n,o){switch(n.type){case"color":o=si.parse(o);break;case"formatted":o=cs.fromString(o.toString());break;case"resolvedImage":o=Is.fromString(o.toString());break;case"padding":o=jn.parse(o);break;case"colorArray":o=Cn.parse(o);break;case"numberArray":o=hs.parse(o);break;default:oi(o)===n.type||n.type==="enum"&&n.values[o]||(o=void 0)}return Qa(o,l.default,n.default)}Gs.register(Al,{error:[{kind:"error"},[Ze],(l,[n])=>{throw new ji(n.evaluate(l))}],typeof:[Ze,[gt],(l,[n])=>Bt(jr(n.evaluate(l)))],"to-rgba":[ft(pe,4),[rt],(l,[n])=>{const[o,u,m,_]=n.evaluate(l).rgb;return[255*o,255*u,255*m,_]}],rgb:[rt,[pe,pe,pe],y0],rgba:[rt,[pe,pe,pe,pe],y0],has:{type:ke,overloads:[[[Ze],(l,[n])=>b0(n.evaluate(l),l.properties())],[[Ze,ze],(l,[n,o])=>b0(n.evaluate(l),o.evaluate(l))]]},get:{type:gt,overloads:[[[Ze],(l,[n])=>Ad(n.evaluate(l),l.properties())],[[Ze,ze],(l,[n,o])=>Ad(n.evaluate(l),o.evaluate(l))]]},"feature-state":[gt,[Ze],(l,[n])=>Ad(n.evaluate(l),l.featureState||{})],properties:[ze,[],l=>l.properties()],"geometry-type":[Ze,[],l=>l.geometryType()],id:[gt,[],l=>l.id()],zoom:[pe,[],l=>l.globals.zoom],"heatmap-density":[pe,[],l=>l.globals.heatmapDensity||0],elevation:[pe,[],l=>l.globals.elevation||0],"line-progress":[pe,[],l=>l.globals.lineProgress||0],accumulated:[gt,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[pe,No(pe),(l,n)=>{let o=0;for(const u of n)o+=u.evaluate(l);return o}],"*":[pe,No(pe),(l,n)=>{let o=1;for(const u of n)o*=u.evaluate(l);return o}],"-":{type:pe,overloads:[[[pe,pe],(l,[n,o])=>n.evaluate(l)-o.evaluate(l)],[[pe],(l,[n])=>-n.evaluate(l)]]},"/":[pe,[pe,pe],(l,[n,o])=>n.evaluate(l)/o.evaluate(l)],"%":[pe,[pe,pe],(l,[n,o])=>n.evaluate(l)%o.evaluate(l)],ln2:[pe,[],()=>Math.LN2],pi:[pe,[],()=>Math.PI],e:[pe,[],()=>Math.E],"^":[pe,[pe,pe],(l,[n,o])=>Math.pow(n.evaluate(l),o.evaluate(l))],sqrt:[pe,[pe],(l,[n])=>Math.sqrt(n.evaluate(l))],log10:[pe,[pe],(l,[n])=>Math.log(n.evaluate(l))/Math.LN10],ln:[pe,[pe],(l,[n])=>Math.log(n.evaluate(l))],log2:[pe,[pe],(l,[n])=>Math.log(n.evaluate(l))/Math.LN2],sin:[pe,[pe],(l,[n])=>Math.sin(n.evaluate(l))],cos:[pe,[pe],(l,[n])=>Math.cos(n.evaluate(l))],tan:[pe,[pe],(l,[n])=>Math.tan(n.evaluate(l))],asin:[pe,[pe],(l,[n])=>Math.asin(n.evaluate(l))],acos:[pe,[pe],(l,[n])=>Math.acos(n.evaluate(l))],atan:[pe,[pe],(l,[n])=>Math.atan(n.evaluate(l))],min:[pe,No(pe),(l,n)=>Math.min(...n.map(o=>o.evaluate(l)))],max:[pe,No(pe),(l,n)=>Math.max(...n.map(o=>o.evaluate(l)))],abs:[pe,[pe],(l,[n])=>Math.abs(n.evaluate(l))],round:[pe,[pe],(l,[n])=>{const o=n.evaluate(l);return o<0?-Math.round(-o):Math.round(o)}],floor:[pe,[pe],(l,[n])=>Math.floor(n.evaluate(l))],ceil:[pe,[pe],(l,[n])=>Math.ceil(n.evaluate(l))],"filter-==":[ke,[Ze,gt],(l,[n,o])=>l.properties()[n.value]===o.value],"filter-id-==":[ke,[gt],(l,[n])=>l.id()===n.value],"filter-type-==":[ke,[Ze],(l,[n])=>l.geometryType()===n.value],"filter-<":[ke,[Ze,gt],(l,[n,o])=>{const u=l.properties()[n.value],m=o.value;return typeof u==typeof m&&u<m}],"filter-id-<":[ke,[gt],(l,[n])=>{const o=l.id(),u=n.value;return typeof o==typeof u&&o<u}],"filter->":[ke,[Ze,gt],(l,[n,o])=>{const u=l.properties()[n.value],m=o.value;return typeof u==typeof m&&u>m}],"filter-id->":[ke,[gt],(l,[n])=>{const o=l.id(),u=n.value;return typeof o==typeof u&&o>u}],"filter-<=":[ke,[Ze,gt],(l,[n,o])=>{const u=l.properties()[n.value],m=o.value;return typeof u==typeof m&&u<=m}],"filter-id-<=":[ke,[gt],(l,[n])=>{const o=l.id(),u=n.value;return typeof o==typeof u&&o<=u}],"filter->=":[ke,[Ze,gt],(l,[n,o])=>{const u=l.properties()[n.value],m=o.value;return typeof u==typeof m&&u>=m}],"filter-id->=":[ke,[gt],(l,[n])=>{const o=l.id(),u=n.value;return typeof o==typeof u&&o>=u}],"filter-has":[ke,[gt],(l,[n])=>n.value in l.properties()],"filter-has-id":[ke,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[ke,[ft(Ze)],(l,[n])=>n.value.indexOf(l.geometryType())>=0],"filter-id-in":[ke,[ft(gt)],(l,[n])=>n.value.indexOf(l.id())>=0],"filter-in-small":[ke,[Ze,ft(gt)],(l,[n,o])=>o.value.indexOf(l.properties()[n.value])>=0],"filter-in-large":[ke,[Ze,ft(gt)],(l,[n,o])=>function(u,m,_,b){for(;_<=b;){const I=_+b>>1;if(m[I]===u)return!0;m[I]>u?b=I-1:_=I+1}return!1}(l.properties()[n.value],o.value,0,o.value.length-1)],all:{type:ke,overloads:[[[ke,ke],(l,[n,o])=>n.evaluate(l)&&o.evaluate(l)],[No(ke),(l,n)=>{for(const o of n)if(!o.evaluate(l))return!1;return!0}]]},any:{type:ke,overloads:[[[ke,ke],(l,[n,o])=>n.evaluate(l)||o.evaluate(l)],[No(ke),(l,n)=>{for(const o of n)if(o.evaluate(l))return!0;return!1}]]},"!":[ke,[ke],(l,[n])=>!n.evaluate(l)],"is-supported-script":[ke,[Ze],(l,[n])=>{const o=l.globals&&l.globals.isSupportedScript;return!o||o(n.evaluate(l))}],upcase:[Ze,[Ze],(l,[n])=>n.evaluate(l).toUpperCase()],downcase:[Ze,[Ze],(l,[n])=>n.evaluate(l).toLowerCase()],concat:[Ze,No(gt),(l,n)=>n.map(o=>Yr(o.evaluate(l))).join("")],"resolved-locale":[Ze,[Ut],(l,[n])=>n.evaluate(l).resolvedLocale()]});class Cd{constructor(n,o,u){this.expression=n,this._warningHistory={},this._evaluator=new cd,this._defaultValue=o?function(m){if(m.type==="color"&&wc(m.default))return new si(0,0,0,0);switch(m.type){case"color":return si.parse(m.default)||null;case"padding":return jn.parse(m.default)||null;case"numberArray":return hs.parse(m.default)||null;case"colorArray":return Cn.parse(m.default)||null;case"variableAnchorOffsetCollection":return us.parse(m.default)||null;case"projectionDefinition":return rs.parse(m.default)||null;default:return m.default===void 0?null:m.default}}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this._globalState=u}evaluateWithoutErrorHandling(n,o,u,m,_,b){return this._globalState&&(n=Uo(n,this._globalState)),this._evaluator.globals=n,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=m,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=b,this.expression.evaluate(this._evaluator)}evaluate(n,o,u,m,_,b){this._globalState&&(n=Uo(n,this._globalState)),this._evaluator.globals=n,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=b||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new ji(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function zh(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in Al}function xc(l,n,o){const u=new xl(Al,kh,[],n?function(_){const b={color:rt,string:Ze,number:pe,enum:Ze,boolean:ke,formatted:$t,padding:Mr,numberArray:gr,colorArray:Wr,projectionDefinition:bt,resolvedImage:lr,variableAnchorOffsetCollection:Xr};return _.type==="array"?ft(b[_.value]||gt,_.length):b[_.type]}(n):void 0),m=u.parse(l,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?w0(new Cd(m,n,o)):Tl(u.errors)}class Mc{constructor(n,o,u){this.kind=n,this._styleExpression=o,this.isStateDependent=n!=="constant"&&!bc(o.expression),this.globalStateRefs=Tc(o.expression),this._globalState=u}evaluateWithoutErrorHandling(n,o,u,m,_,b){return this._globalState&&(n=Uo(n,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(n,o,u,m,_,b)}evaluate(n,o,u,m,_,b){return this._globalState&&(n=Uo(n,this._globalState)),this._styleExpression.evaluate(n,o,u,m,_,b)}}class Sd{constructor(n,o,u,m,_){this.kind=n,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=n!=="camera"&&!bc(o.expression),this.globalStateRefs=Tc(o.expression),this.interpolationType=m,this._globalState=_}evaluateWithoutErrorHandling(n,o,u,m,_,b){return this._globalState&&(n=Uo(n,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(n,o,u,m,_,b)}evaluate(n,o,u,m,_,b){return this._globalState&&(n=Uo(n,this._globalState)),this._styleExpression.evaluate(n,o,u,m,_,b)}interpolationFactor(n,o,u){return this.interpolationType?$n.interpolationFactor(this.interpolationType,n,o,u):0}}function T0(l,n,o){const u=xc(l,n,o);if(u.result==="error")return u;const m=u.value.expression,_=Rh(m);if(!_&&!Ja(n))return Tl([new U("","data expressions not supported")]);const b=Lh(m,["zoom"]);if(!b&&!x0(n))return Tl([new U("","zoom expressions not supported")]);const I=Ac(m);return I||b?I instanceof U?Tl([I]):I instanceof $n&&!Td(n)?Tl([new U("",'"interpolate" expressions cannot be used with this property')]):w0(I?new Sd(_?"camera":"composite",u.value,I.labels,I instanceof $n?I.interpolation:void 0,o):new Mc(_?"constant":"source",u.value,o)):Tl([new U("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ic{constructor(n,o){this._parameters=n,this._specification=o,Y(this,M0(this._parameters,this._specification))}static deserialize(n){return new Ic(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Ac(l){let n=null;if(l instanceof lc)n=Ac(l.result);else if(l instanceof dc){for(const o of l.args)if(n=Ac(o),n)break}else(l instanceof yn||l instanceof $n)&&l.input instanceof Gs&&l.input.name==="zoom"&&(n=l);return n instanceof U||l.eachChild(o=>{const u=Ac(o);u instanceof U?n=u:!n&&u?n=new U("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&u&&n!==u&&(n=new U("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function Tc(l,n=new Set){return l instanceof yc&&n.add(l.key),l.eachChild(o=>{Tc(o,n)}),n}function Uo(l,n){const{zoom:o,heatmapDensity:u,elevation:m,lineProgress:_,isSupportedScript:b,accumulated:I}=l??{};return{zoom:o,heatmapDensity:u,elevation:m,lineProgress:_,isSupportedScript:b,accumulated:I,globalState:n}}function Cc(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const n of l.slice(1))if(!Cc(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const Pd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ho(l,n){if(l==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Cc(l)||(l=Fh(l));const o=xc(l,Pd,n);if(o.result==="error")throw new Error(o.value.map(u=>`${u.key}: ${u.message}`).join(", "));return{filter:(u,m,_)=>o.value.evaluate(u,m,{},_),needGeometry:Sc(l),getGlobalStateRefs:()=>Tc(o.value.expression)}}function Ed(l,n){return l<n?-1:l>n?1:0}function Sc(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let n=1;n<l.length;n++)if(Sc(l[n]))return!0;return!1}function Fh(l){if(!l)return!0;const n=l[0];return l.length<=1?n!=="any":n==="=="?kd(l[1],l[2],"=="):n==="!="?Dh(kd(l[1],l[2],"==")):n==="<"||n===">"||n==="<="||n===">="?kd(l[1],l[2],n):n==="any"?(o=l.slice(1),["any"].concat(o.map(Fh))):n==="all"?["all"].concat(l.slice(1).map(Fh)):n==="none"?["all"].concat(l.slice(1).map(Fh).map(Dh)):n==="in"?C0(l[1],l.slice(2)):n==="!in"?Dh(C0(l[1],l.slice(2))):n==="has"?S0(l[1]):n!=="!has"||Dh(S0(l[1]));var o}function kd(l,n,o){switch(l){case"$type":return[`filter-type-${o}`,n];case"$id":return[`filter-id-${o}`,n];default:return[`filter-${o}`,l,n]}}function C0(l,n){if(n.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(o=>typeof o!=typeof n[0])?["filter-in-large",l,["literal",n.sort(Ed)]]:["filter-in-small",l,["literal",n]]}}function S0(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Dh(l){return["!",l]}function Rd(l){const n=typeof l;if(n==="number"||n==="boolean"||n==="string"||l==null)return JSON.stringify(l);if(Array.isArray(l)){let m="[";for(const _ of l)m+=`${Rd(_)},`;return`${m}]`}const o=Object.keys(l).sort();let u="{";for(let m=0;m<o.length;m++)u+=`${JSON.stringify(o[m])}:${Rd(l[o[m]])},`;return`${u}}`}function P0(l){let n="";for(const o of qe)n+=`/${Rd(l[o])}`;return n}function Ld(l){const n=l.value;return n?[new he(l.key,n,"constants have been deprecated as of v8")]:[]}function sn(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Wo(l){if(Array.isArray(l))return l.map(Wo);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const n={};for(const o in l)n[o]=Wo(l[o]);return n}return sn(l)}function Ts(l){const n=l.key,o=l.value,u=l.valueSpec||{},m=l.objectElementValidators||{},_=l.style,b=l.styleSpec,I=l.validateSpec;let E=[];const G=oi(o);if(G!=="object")return[new he(n,o,`object expected, ${G} found`)];for(const Z in o){const K=Z.split(".")[0],ce=Ka(u,K)||u["*"];let fe;if(Ka(m,K))fe=m[K];else if(Ka(u,K))fe=I;else if(m["*"])fe=m["*"];else{if(!u["*"]){E.push(new he(n,o[Z],`unknown property "${Z}"`));continue}fe=I}E=E.concat(fe({key:(n&&`${n}.`)+Z,value:o[Z],valueSpec:ce,style:_,styleSpec:b,object:o,objectKey:Z,validateSpec:I},o))}for(const Z in u)m[Z]||u[Z].required&&u[Z].default===void 0&&o[Z]===void 0&&E.push(new he(n,o,`missing required property "${Z}"`));return E}function Bh(l){const n=l.value,o=l.valueSpec,u=l.style,m=l.styleSpec,_=l.key,b=l.arrayElementValidator||l.validateSpec;if(oi(n)!=="array")return[new he(_,n,`array expected, ${oi(n)} found`)];if(o.length&&n.length!==o.length)return[new he(_,n,`array length ${o.length} expected, length ${n.length} found`)];if(o["min-length"]&&n.length<o["min-length"])return[new he(_,n,`array length at least ${o["min-length"]} expected, length ${n.length} found`)];let I={type:o.value,values:o.values};m.$version<7&&(I.function=o.function),oi(o.value)==="object"&&(I=o.value);let E=[];for(let G=0;G<n.length;G++)E=E.concat(b({array:n,arrayIndex:G,value:n[G],valueSpec:I,validateSpec:l.validateSpec,style:u,styleSpec:m,key:`${_}[${G}]`}));return E}function Gh(l){const n=l.key,o=l.value,u=l.valueSpec;let m=oi(o);return m==="number"&&o!=o&&(m="NaN"),m!=="number"?[new he(n,o,`number expected, ${m} found`)]:"minimum"in u&&o<u.minimum?[new he(n,o,`${o} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&o>u.maximum?[new he(n,o,`${o} is greater than the maximum value ${u.maximum}`)]:[]}function zd(l){const n=l.valueSpec,o=sn(l.value.type);let u,m,_,b={};const I=o!=="categorical"&&l.value.property===void 0,E=!I,G=oi(l.value.stops)==="array"&&oi(l.value.stops[0])==="array"&&oi(l.value.stops[0][0])==="object",Z=Ts({key:l.key,value:l.value,valueSpec:l.styleSpec.function,validateSpec:l.validateSpec,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(fe){if(o==="identity")return[new he(fe.key,fe.value,'identity function may not have a "stops" property')];let _e=[];const Ie=fe.value;return _e=_e.concat(Bh({key:fe.key,value:Ie,valueSpec:fe.valueSpec,validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec,arrayElementValidator:K})),oi(Ie)==="array"&&Ie.length===0&&_e.push(new he(fe.key,Ie,"array must have at least one stop")),_e},default:function(fe){return fe.validateSpec({key:fe.key,value:fe.value,valueSpec:n,validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec})}}});return o==="identity"&&I&&Z.push(new he(l.key,l.value,'missing required property "property"')),o==="identity"||l.value.stops||Z.push(new he(l.key,l.value,'missing required property "stops"')),o==="exponential"&&l.valueSpec.expression&&!Td(l.valueSpec)&&Z.push(new he(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(E&&!Ja(l.valueSpec)?Z.push(new he(l.key,l.value,"property functions not supported")):I&&!x0(l.valueSpec)&&Z.push(new he(l.key,l.value,"zoom functions not supported"))),o!=="categorical"&&!G||l.value.property!==void 0||Z.push(new he(l.key,l.value,'"property" property is required')),Z;function K(fe){let _e=[];const Ie=fe.value,Le=fe.key;if(oi(Ie)!=="array")return[new he(Le,Ie,`array expected, ${oi(Ie)} found`)];if(Ie.length!==2)return[new he(Le,Ie,`array length 2 expected, length ${Ie.length} found`)];if(G){if(oi(Ie[0])!=="object")return[new he(Le,Ie,`object expected, ${oi(Ie[0])} found`)];if(Ie[0].zoom===void 0)return[new he(Le,Ie,"object stop key must have zoom")];if(Ie[0].value===void 0)return[new he(Le,Ie,"object stop key must have value")];if(_&&_>sn(Ie[0].zoom))return[new he(Le,Ie[0].zoom,"stop zoom values must appear in ascending order")];sn(Ie[0].zoom)!==_&&(_=sn(Ie[0].zoom),m=void 0,b={}),_e=_e.concat(Ts({key:`${Le}[0]`,value:Ie[0],valueSpec:{zoom:{}},validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec,objectElementValidators:{zoom:Gh,value:ce}}))}else _e=_e.concat(ce({key:`${Le}[0]`,value:Ie[0],validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec},Ie));return zh(Wo(Ie[1]))?_e.concat([new he(`${Le}[1]`,Ie[1],"expressions are not allowed in function stops.")]):_e.concat(fe.validateSpec({key:`${Le}[1]`,value:Ie[1],valueSpec:n,validateSpec:fe.validateSpec,style:fe.style,styleSpec:fe.styleSpec}))}function ce(fe,_e){const Ie=oi(fe.value),Le=sn(fe.value),Oe=fe.value!==null?fe.value:_e;if(u){if(Ie!==u)return[new he(fe.key,Oe,`${Ie} stop domain type must match previous stop domain type ${u}`)]}else u=Ie;if(Ie!=="number"&&Ie!=="string"&&Ie!=="boolean")return[new he(fe.key,Oe,"stop domain value must be a number, string, or boolean")];if(Ie!=="number"&&o!=="categorical"){let vt=`number expected, ${Ie} found`;return Ja(n)&&o===void 0&&(vt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new he(fe.key,Oe,vt)]}return o!=="categorical"||Ie!=="number"||isFinite(Le)&&Math.floor(Le)===Le?o!=="categorical"&&Ie==="number"&&m!==void 0&&Le<m?[new he(fe.key,Oe,"stop domain values must appear in ascending order")]:(m=Le,o==="categorical"&&Le in b?[new he(fe.key,Oe,"stop domain values must be unique")]:(b[Le]=!0,[])):[new he(fe.key,Oe,`integer expected, found ${Le}`)]}}function Xo(l){const n=(l.expressionContext==="property"?T0:xc)(Wo(l.value),l.valueSpec);if(n.result==="error")return n.value.map(u=>new he(`${l.key}${u.key}`,l.value,u.message));const o=n.value.expression||n.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!o.outputDefined())return[new he(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!bc(o))return[new he(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!bc(o))return[new he(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!Lh(o,["zoom","feature-state"]))return[new he(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!Rh(o))return[new he(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qo(l){const n=l.key,o=l.value,u=oi(o);return u!=="string"?[new he(n,o,`color expected, ${u} found`)]:si.parse(String(o))?[]:[new he(n,o,`color expected, "${o}" found`)]}function Pc(l){const n=l.key,o=l.value,u=l.valueSpec,m=[];return Array.isArray(u.values)?u.values.indexOf(sn(o))===-1&&m.push(new he(n,o,`expected one of [${u.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(u.values).indexOf(sn(o))===-1&&m.push(new he(n,o,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(o)} found`)),m}function Fd(l){return Cc(Wo(l.value))?Xo(Y({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):E0(l)}function E0(l){const n=l.value,o=l.key;if(oi(n)!=="array")return[new he(o,n,`array expected, ${oi(n)} found`)];const u=l.styleSpec;let m,_=[];if(n.length<1)return[new he(o,n,"filter array must have at least 1 element")];switch(_=_.concat(Pc({key:`${o}[0]`,value:n[0],valueSpec:u.filter_operator,style:l.style,styleSpec:l.styleSpec})),sn(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&sn(n[1])==="$type"&&_.push(new he(o,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&_.push(new he(o,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(m=oi(n[1]),m!=="string"&&_.push(new he(`${o}[1]`,n[1],`string expected, ${m} found`)));for(let b=2;b<n.length;b++)m=oi(n[b]),sn(n[1])==="$type"?_=_.concat(Pc({key:`${o}[${b}]`,value:n[b],valueSpec:u.geometry_type,style:l.style,styleSpec:l.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&_.push(new he(`${o}[${b}]`,n[b],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let b=1;b<n.length;b++)_=_.concat(E0({key:`${o}[${b}]`,value:n[b],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":m=oi(n[1]),n.length!==2?_.push(new he(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):m!=="string"&&_.push(new he(`${o}[1]`,n[1],`string expected, ${m} found`))}return _}function k0(l,n){const o=l.key,u=l.validateSpec,m=l.style,_=l.styleSpec,b=l.value,I=l.objectKey,E=_[`${n}_${l.layerType}`];if(!E)return[];const G=I.match(/^(.*)-transition$/);if(n==="paint"&&G&&E[G[1]]&&E[G[1]].transition)return u({key:o,value:b,valueSpec:_.transition,style:m,styleSpec:_});const Z=l.valueSpec||E[I];if(!Z)return[new he(o,b,`unknown property "${I}"`)];let K;if(oi(b)==="string"&&Ja(Z)&&!Z.tokens&&(K=/^{([^}]+)}$/.exec(b)))return[new he(o,b,`"${I}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(K[1])} }\`.`)];const ce=[];return l.layerType==="symbol"&&(I==="text-field"&&m&&!m.glyphs&&ce.push(new he(o,b,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&wc(Wo(b))&&sn(b.type)==="identity"&&ce.push(new he(o,b,'"text-font" does not support identity functions'))),ce.concat(u({key:l.key,value:b,valueSpec:Z,style:m,styleSpec:_,expressionContext:"property",propertyType:n,propertyKey:I}))}function R0(l){return k0(l,"paint")}function L0(l){return k0(l,"layout")}function Cl(l){let n=[];const o=l.value,u=l.key,m=l.style,_=l.styleSpec;if(oi(o)!=="object")return[new he(u,o,`object expected, ${oi(o)} found`)];o.type||o.ref||n.push(new he(u,o,'either "type" or "ref" is required'));let b=sn(o.type);const I=sn(o.ref);if(o.id){const E=sn(o.id);for(let G=0;G<l.arrayIndex;G++){const Z=m.layers[G];sn(Z.id)===E&&n.push(new he(u,o.id,`duplicate layer id "${o.id}", previously used at line ${Z.id.__line__}`))}}if("ref"in o){let E;["type","source","source-layer","filter","layout"].forEach(G=>{G in o&&n.push(new he(u,o[G],`"${G}" is prohibited for ref layers`))}),m.layers.forEach(G=>{sn(G.id)===I&&(E=G)}),E?E.ref?n.push(new he(u,o.ref,"ref cannot reference another ref layer")):b=sn(E.type):n.push(new he(u,o.ref,`ref layer "${I}" not found`))}else if(b!=="background")if(o.source){const E=m.sources&&m.sources[o.source],G=E&&sn(E.type);E?G==="vector"&&b==="raster"?n.push(new he(u,o.source,`layer "${o.id}" requires a raster source`)):G!=="raster-dem"&&b==="hillshade"||G!=="raster-dem"&&b==="color-relief"?n.push(new he(u,o.source,`layer "${o.id}" requires a raster-dem source`)):G==="raster"&&b!=="raster"?n.push(new he(u,o.source,`layer "${o.id}" requires a vector source`)):G!=="vector"||o["source-layer"]?G==="raster-dem"&&b!=="hillshade"&&b!=="color-relief"?n.push(new he(u,o.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):b!=="line"||!o.paint||!o.paint["line-gradient"]||G==="geojson"&&E.lineMetrics||n.push(new he(u,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new he(u,o,`layer "${o.id}" must specify a "source-layer"`)):n.push(new he(u,o.source,`source "${o.source}" not found`))}else n.push(new he(u,o,'missing required property "source"'));return n=n.concat(Ts({key:u,value:o,valueSpec:_.layer,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*":()=>[],type:()=>l.validateSpec({key:`${u}.type`,value:o.type,valueSpec:_.layer.type,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,object:o,objectKey:"type"}),filter:Fd,layout:E=>Ts({layer:o,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":G=>L0(Y({layerType:b},G))}}),paint:E=>Ts({layer:o,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":G=>R0(Y({layerType:b},G))}})}})),n}function Qs(l){const n=l.value,o=l.key,u=oi(n);return u!=="string"?[new he(o,n,`string expected, ${u} found`)]:[]}const vs={promoteId:function({key:l,value:n}){if(oi(n)==="string")return Qs({key:l,value:n});{const o=[];for(const u in n)o.push(...Qs({key:`${l}.${u}`,value:n[u]}));return o}}};function Sl(l){const n=l.value,o=l.key,u=l.styleSpec,m=l.style,_=l.validateSpec;if(!n.type)return[new he(o,n,'"type" is required')];const b=sn(n.type);let I;switch(b){case"vector":case"raster":return I=Ts({key:o,value:n,valueSpec:u[`source_${b.replace("-","_")}`],style:l.style,styleSpec:u,objectElementValidators:vs,validateSpec:_}),I;case"raster-dem":return I=function(E){var G;const Z=(G=E.sourceName)!==null&&G!==void 0?G:"",K=E.value,ce=E.styleSpec,fe=ce.source_raster_dem,_e=E.style;let Ie=[];const Le=oi(K);if(K===void 0)return Ie;if(Le!=="object")return Ie.push(new he("source_raster_dem",K,`object expected, ${Le} found`)),Ie;const Oe=sn(K.encoding)==="custom",vt=["redFactor","greenFactor","blueFactor","baseShift"],tt=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const at in K)!Oe&&vt.includes(at)?Ie.push(new he(at,K[at],`In "${Z}": "${at}" is only valid when "encoding" is set to "custom". ${tt} encoding found`)):fe[at]?Ie=Ie.concat(E.validateSpec({key:at,value:K[at],valueSpec:fe[at],validateSpec:E.validateSpec,style:_e,styleSpec:ce})):Ie.push(new he(at,K[at],`unknown property "${at}"`));return Ie}({sourceName:o,value:n,style:l.style,styleSpec:u,validateSpec:_}),I;case"geojson":if(I=Ts({key:o,value:n,valueSpec:u.source_geojson,style:m,styleSpec:u,validateSpec:_,objectElementValidators:vs}),n.cluster)for(const E in n.clusterProperties){const[G,Z]=n.clusterProperties[E],K=typeof G=="string"?[G,["accumulated"],["get",E]]:G;I.push(...Xo({key:`${o}.${E}.map`,value:Z,expressionContext:"cluster-map"})),I.push(...Xo({key:`${o}.${E}.reduce`,value:K,expressionContext:"cluster-reduce"}))}return I;case"video":return Ts({key:o,value:n,valueSpec:u.source_video,style:m,validateSpec:_,styleSpec:u});case"image":return Ts({key:o,value:n,valueSpec:u.source_image,style:m,validateSpec:_,styleSpec:u});case"canvas":return[new he(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Pc({key:`${o}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Dd(l){const n=l.value,o=l.styleSpec,u=o.light,m=l.style;let _=[];const b=oi(n);if(n===void 0)return _;if(b!=="object")return _=_.concat([new he("light",n,`object expected, ${b} found`)]),_;for(const I in n){const E=I.match(/^(.*)-transition$/);_=_.concat(E&&u[E[1]]&&u[E[1]].transition?l.validateSpec({key:I,value:n[I],valueSpec:o.transition,validateSpec:l.validateSpec,style:m,styleSpec:o}):u[I]?l.validateSpec({key:I,value:n[I],valueSpec:u[I],validateSpec:l.validateSpec,style:m,styleSpec:o}):[new he(I,n[I],`unknown property "${I}"`)])}return _}function z0(l){const n=l.value,o=l.styleSpec,u=o.sky,m=l.style,_=oi(n);if(n===void 0)return[];if(_!=="object")return[new he("sky",n,`object expected, ${_} found`)];let b=[];for(const I in n)b=b.concat(u[I]?l.validateSpec({key:I,value:n[I],valueSpec:u[I],style:m,styleSpec:o}):[new he(I,n[I],`unknown property "${I}"`)]);return b}function F0(l){const n=l.value,o=l.styleSpec,u=o.terrain,m=l.style;let _=[];const b=oi(n);if(n===void 0)return _;if(b!=="object")return _=_.concat([new he("terrain",n,`object expected, ${b} found`)]),_;for(const I in n)_=_.concat(u[I]?l.validateSpec({key:I,value:n[I],valueSpec:u[I],validateSpec:l.validateSpec,style:m,styleSpec:o}):[new he(I,n[I],`unknown property "${I}"`)]);return _}function Pl(l){let n=[];const o=l.value,u=l.key;if(Array.isArray(o)){const m=[],_=[];for(const b in o)o[b].id&&m.includes(o[b].id)&&n.push(new he(u,o,`all the sprites' ids must be unique, but ${o[b].id} is duplicated`)),m.push(o[b].id),o[b].url&&_.includes(o[b].url)&&n.push(new he(u,o,`all the sprites' URLs must be unique, but ${o[b].url} is duplicated`)),_.push(o[b].url),n=n.concat(Ts({key:`${u}[${b}]`,value:o[b],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:l.validateSpec}));return n}return Qs({key:u,value:o})}function Bd(l){return n=l.value,n&&n.constructor===Object?[]:[new he(l.key,l.value,`object expected, ${oi(l.value)} found`)];var n}const Vh={"*":()=>[],array:Bh,boolean:function(l){const n=l.value,o=l.key,u=oi(n);return u!=="boolean"?[new he(o,n,`boolean expected, ${u} found`)]:[]},number:Gh,color:qo,constants:Ld,enum:Pc,filter:Fd,function:zd,layer:Cl,object:Ts,source:Sl,light:Dd,sky:z0,terrain:F0,projection:function(l){const n=l.value,o=l.styleSpec,u=o.projection,m=l.style,_=oi(n);if(n===void 0)return[];if(_!=="object")return[new he("projection",n,`object expected, ${_} found`)];let b=[];for(const I in n)b=b.concat(u[I]?l.validateSpec({key:I,value:n[I],valueSpec:u[I],style:m,styleSpec:o}):[new he(I,n[I],`unknown property "${I}"`)]);return b},projectionDefinition:function(l){const n=l.key;let o=l.value;o=o instanceof String?o.valueOf():o;const u=oi(o);return u!=="array"||function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"}(o)||function(m){return!!["interpolate","step","literal"].includes(m[0])}(o)?["array","string"].includes(u)?[]:[new he(n,o,`projection expected, invalid type "${u}" found`)]:[new he(n,o,`projection expected, invalid array ${JSON.stringify(o)} found`)]},string:Qs,formatted:function(l){return Qs(l).length===0?[]:Xo(l)},resolvedImage:function(l){return Qs(l).length===0?[]:Xo(l)},padding:function(l){const n=l.key,o=l.value;if(oi(o)==="array"){if(o.length<1||o.length>4)return[new he(n,o,`padding requires 1 to 4 values; ${o.length} values found`)];const u={type:"number"};let m=[];for(let _=0;_<o.length;_++)m=m.concat(l.validateSpec({key:`${n}[${_}]`,value:o[_],validateSpec:l.validateSpec,valueSpec:u}));return m}return Gh({key:n,value:o,valueSpec:{}})},numberArray:function(l){const n=l.key,o=l.value;if(oi(o)==="array"){const u={type:"number"};if(o.length<1)return[new he(n,o,"array length at least 1 expected, length 0 found")];let m=[];for(let _=0;_<o.length;_++)m=m.concat(l.validateSpec({key:`${n}[${_}]`,value:o[_],validateSpec:l.validateSpec,valueSpec:u}));return m}return Gh({key:n,value:o,valueSpec:{}})},colorArray:function(l){const n=l.key,o=l.value;if(oi(o)==="array"){if(o.length<1)return[new he(n,o,"array length at least 1 expected, length 0 found")];let u=[];for(let m=0;m<o.length;m++)u=u.concat(qo({key:`${n}[${m}]`,value:o[m]}));return u}return qo({key:n,value:o})},variableAnchorOffsetCollection:function(l){const n=l.key,o=l.value,u=oi(o),m=l.styleSpec;if(u!=="array"||o.length<1||o.length%2!=0)return[new he(n,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let b=0;b<o.length;b+=2)_=_.concat(Pc({key:`${n}[${b}]`,value:o[b],valueSpec:m.layout_symbol["text-anchor"]})),_=_.concat(Bh({key:`${n}[${b+1}]`,value:o[b+1],valueSpec:{length:2,value:"number"},validateSpec:l.validateSpec,style:l.style,styleSpec:m}));return _},sprite:Pl,state:Bd};function jh(l){const n=l.value,o=l.valueSpec,u=l.styleSpec;return l.validateSpec=jh,o.expression&&wc(sn(n))?zd(l):o.expression&&zh(Wo(n))?Xo(l):o.type&&Vh[o.type]?Vh[o.type](l):Ts(Y({},l,{valueSpec:o.type?u[o.type]:o}))}function Zh(l){const n=l.value,o=l.key,u=Qs(l);return u.length||(n.indexOf("{fontstack}")===-1&&u.push(new he(o,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&u.push(new he(o,n,'"glyphs" url must include a "{range}" token'))),u}function Vs(l,n=st){let o=[];return o=o.concat(jh({key:"",value:l,valueSpec:n.$root,styleSpec:n,style:l,validateSpec:jh,objectElementValidators:{glyphs:Zh,"*":()=>[]}})),l.constants&&(o=o.concat(Ld({key:"constants",value:l.constants}))),D0(o)}function ds(l){return function(n){return l(Object.assign({},n,{validateSpec:jh}))}}function D0(l){return[].concat(l).sort((n,o)=>n.line-o.line)}function ea(l){return function(...n){return D0(l.apply(this,n))}}Vs.source=ea(ds(Sl)),Vs.sprite=ea(ds(Pl)),Vs.glyphs=ea(ds(Zh)),Vs.light=ea(ds(Dd)),Vs.sky=ea(ds(z0)),Vs.terrain=ea(ds(F0)),Vs.state=ea(ds(Bd)),Vs.layer=ea(ds(Cl)),Vs.filter=ea(ds(Fd)),Vs.paintProperty=ea(ds(R0)),Vs.layoutProperty=ea(ds(L0));const El=Vs,Ec=El.light,S1=El.sky,P1=El.paintProperty,Oh=El.layoutProperty;function B0(l,n){let o=!1;if(n&&n.length)for(const u of n)l.fire(new Ft(new Error(u.message))),o=!0;return o}class Yo{constructor(n,o,u){const m=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const b=new Int32Array(this.arrayBuffer);n=b[0],this.d=(o=b[1])+2*(u=b[2]);for(let E=0;E<this.d*this.d;E++){const G=b[3+E],Z=b[3+E+1];m.push(G===Z?null:b.subarray(G,Z))}const I=b[3+m.length+1];this.keys=b.subarray(b[3+m.length],I),this.bboxes=b.subarray(I),this.insert=this._insertReadonly}else{this.d=o+2*u;for(let b=0;b<this.d*this.d;b++)m.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=n,this.padding=u,this.scale=o/n,this.uid=0;const _=u/o*n;this.min=-_,this.max=n+_}insert(n,o,u,m,_){this._forEachCell(o,u,m,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,o,u,m,_,b){this.cells[_].push(b)}query(n,o,u,m,_){const b=this.min,I=this.max;if(n<=b&&o<=b&&I<=u&&I<=m&&!_)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(n,o,u,m,this._queryCell,E,{},_),E}}_queryCell(n,o,u,m,_,b,I,E){const G=this.cells[_];if(G!==null){const Z=this.keys,K=this.bboxes;for(let ce=0;ce<G.length;ce++){const fe=G[ce];if(I[fe]===void 0){const _e=4*fe;(E?E(K[_e+0],K[_e+1],K[_e+2],K[_e+3]):n<=K[_e+2]&&o<=K[_e+3]&&u>=K[_e+0]&&m>=K[_e+1])?(I[fe]=!0,b.push(Z[fe])):I[fe]=!1}}}}_forEachCell(n,o,u,m,_,b,I,E){const G=this._convertToCellCoord(n),Z=this._convertToCellCoord(o),K=this._convertToCellCoord(u),ce=this._convertToCellCoord(m);for(let fe=G;fe<=K;fe++)for(let _e=Z;_e<=ce;_e++){const Ie=this.d*_e+fe;if((!E||E(this._convertFromCellCoord(fe),this._convertFromCellCoord(_e),this._convertFromCellCoord(fe+1),this._convertFromCellCoord(_e+1)))&&_.call(this,n,o,u,m,Ie,b,I,E))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,o=3+this.cells.length+1+1;let u=0;for(let b=0;b<this.cells.length;b++)u+=this.cells[b].length;const m=new Int32Array(o+u+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let _=o;for(let b=0;b<n.length;b++){const I=n[b];m[3+b]=_,m.set(I,_),_+=I.length}return m[3+n.length]=_,m.set(this.keys,_),_+=this.keys.length,m[3+n.length+1]=_,m.set(this.bboxes,_),_+=this.bboxes.length,m.buffer}static serialize(n,o){const u=n.toArrayBuffer();return o&&o.push(u),{buffer:u}}static deserialize(n){return new Yo(n.buffer)}}const js={};function _r(l,n,o={}){if(js[l])throw new Error(`${l} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:l,writeable:!1}),js[l]={klass:n,omit:o.omit||[],shallow:o.shallow||[]}}_r("Object",Object),_r("Set",Set),_r("TransferableGridIndex",Yo),_r("Color",si),_r("Error",Error),_r("AJAXError",Ge),_r("ResolvedImage",Is),_r("StylePropertyFunction",Ic),_r("StyleExpression",Cd,{omit:["_evaluator"]}),_r("ZoomDependentExpression",Sd),_r("ZoomConstantExpression",Mc),_r("CompoundExpression",Gs,{omit:["_evaluate"]});for(const l in Al)Al[l]._classRegistryKey||_r(`Expression_${l}`,Al[l]);function Gd(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Nh(l){return l.$name||l.constructor._classRegistryKey}function Vd(l){return!function(n){if(n===null||typeof n!="object")return!1;const o=Nh(n);return!(!o||o==="Object")}(l)&&(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||l instanceof Error||Gd(l)||Tr(l)||ArrayBuffer.isView(l)||l instanceof ImageData)}function Ko(l,n){if(Vd(l))return(Gd(l)||Tr(l))&&n&&n.push(l),ArrayBuffer.isView(l)&&n&&n.push(l.buffer),l instanceof ImageData&&n&&n.push(l.data.buffer),l;if(Array.isArray(l)){const _=[];for(const b of l)_.push(Ko(b,n));return _}if(typeof l!="object")throw new Error("can't serialize object of type "+typeof l);const o=Nh(l);if(!o)throw new Error(`can't serialize object of unregistered class ${l.constructor.name}`);if(!js[o])throw new Error(`${o} is not registered.`);const{klass:u}=js[o],m=u.serialize?u.serialize(l,n):{};if(u.serialize){if(n&&m===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in l){if(!l.hasOwnProperty(_)||js[o].omit.indexOf(_)>=0)continue;const b=l[_];m[_]=js[o].shallow.indexOf(_)>=0?b:Ko(b,n)}l instanceof Error&&(m.message=l.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(m.$name=o),m}function kl(l){if(Vd(l))return l;if(Array.isArray(l))return l.map(kl);if(typeof l!="object")throw new Error("can't deserialize object of type "+typeof l);const n=Nh(l)||"Object";if(!js[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:o}=js[n];if(!o)throw new Error(`can't deserialize unregistered class ${n}`);if(o.deserialize)return o.deserialize(l);const u=Object.create(o.prototype);for(const m of Object.keys(l)){if(m==="$name")continue;const _=l[m];u[m]=js[n].shallow.indexOf(m)>=0?_:kl(_)}return u}class jd{constructor(){this.first=!0}update(n,o){const u=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=u,!0))}}const li={"Latin-1 Supplement":l=>l>=128&&l<=255,"Hangul Jamo":l=>l>=4352&&l<=4607,Khmer:l=>l>=6016&&l<=6143,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Kanbun:l=>l>=12688&&l<=12703,"CJK Strokes":l=>l>=12736&&l<=12783,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Hangul Syllables":l=>l>=44032&&l<=55215,"Private Use Area":l=>l>=57344&&l<=63743,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function Zd(l){for(const n of l)if(Nd(n.charCodeAt(0)))return!0;return!1}function G0(l){for(const n of l)if(!j0(n.charCodeAt(0)))return!1;return!0}function Od(l){const n=l.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(n.join("|"),"u")}const V0=Od(["Arab","Dupl","Mong","Ougr","Syrc"]);function j0(l){return!V0.test(String.fromCodePoint(l))}const Z0=Od(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Nd(l){return!(l!==746&&l!==747&&(l<4352||!(li["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||li["CJK Compatibility"](l)||li["CJK Strokes"](l)||!(!li["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||li["Enclosed CJK Letters and Months"](l)||li["Ideographic Description Characters"](l)||li.Kanbun(l)||li.Katakana(l)&&l!==12540||!(!li["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!li["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||li["Vertical Forms"](l)||li["Yijing Hexagram Symbols"](l)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(l))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(l))||Z0.test(String.fromCodePoint(l)))))}function Ud(l){return!(Nd(l)||function(n){return!!(li["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||li["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||li["Letterlike Symbols"](n)||li["Number Forms"](n)||li["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||li["Control Pictures"](n)&&n!==9251||li["Optical Character Recognition"](n)||li["Enclosed Alphanumerics"](n)||li["Geometric Shapes"](n)||li["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||li["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||li["CJK Symbols and Punctuation"](n)||li.Katakana(n)||li["Private Use Area"](n)||li["CJK Compatibility Forms"](n)||li["Small Form Variants"](n)||li["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(l))}const O0=Od(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Hd(l){return O0.test(String.fromCodePoint(l))}function N0(l,n){return!(!n&&Hd(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||li.Khmer(l))}function Uh(l){for(const n of l)if(Hd(n.charCodeAt(0)))return!0;return!1}const eo=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(l){this.pluginStatus=l.pluginStatus,this.pluginURL=l.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(l){if(eo.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=l.applyArabicShaping,this.processBidirectionalText=l.processBidirectionalText,this.processStyledBidirectionalText=l.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(l,n){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(l.pluginStatus!=="loading")return this.setState(l),l;const o=l.pluginURL,u=new Promise(_=>{this.loadScriptResolve=_});n(o);const m=new Promise(_=>setTimeout(()=>_(),this.TIMEOUT));if(yield Promise.race([u,m]),this.isParsed()){const _={pluginStatus:"loaded",pluginURL:o};return this.setState(_),_}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${o}`)})}};class Li{constructor(n,o){this.isSupportedScript=E1,this.zoom=n,o?(this.now=o.now||0,this.fadeDuration=o.fadeDuration||0,this.zoomHistory=o.zoomHistory||new jd,this.transition=o.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new jd,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,o=n-Math.floor(n),u=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}}}function E1(l){return function(n,o){for(const u of n)if(!N0(u.charCodeAt(0),o))return!1;return!0}(l,eo.getRTLTextPluginStatus()==="loaded")}class Hh{constructor(n,o,u){this.property=n,this.value=o,this.expression=function(m,_,b){if(wc(m))return new Ic(m,_);if(zh(m)){const I=T0(m,_,b);if(I.result==="error")throw new Error(I.value.map(E=>`${E.key}: ${E.message}`).join(", "));return I.value}{let I=m;return _.type==="color"&&typeof m=="string"?I=si.parse(m):_.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?_.type!=="numberArray"||typeof m!="number"&&!Array.isArray(m)?_.type!=="colorArray"||typeof m!="string"&&!Array.isArray(m)?_.type==="variableAnchorOffsetCollection"&&Array.isArray(m)?I=us.parse(m):_.type==="projectionDefinition"&&typeof m=="string"&&(I=rs.parse(m)):I=Cn.parse(m):I=hs.parse(m):I=jn.parse(m),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>I}}}(o===void 0?n.specification.default:o,n.specification,u)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(n,o,u){return this.property.possiblyEvaluate(this,n,o,u)}}class Wh{constructor(n,o){this.property=n,this.value=new Hh(n,void 0,o)}transitioned(n,o){return new Xd(this.property,this.value,o,Xt({},n.transition,this.transition),n.now)}untransitioned(){return new Xd(this.property,this.value,null,{},0)}}class Wd{constructor(n,o){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._globalState=o}getValue(n){return Zt(this._values[n].value.value)}setValue(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Wh(this._values[n].property,this._globalState)),this._values[n].value=new Hh(this._values[n].property,o===null?void 0:Zt(o),this._globalState)}getTransition(n){return Zt(this._values[n].transition)}setTransition(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new Wh(this._values[n].property,this._globalState)),this._values[n].transition=Zt(o)||void 0}serialize(){const n={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(n[o]=u);const m=this.getTransition(o);m!==void 0&&(n[`${o}-transition`]=m)}return n}transitioned(n,o){const u=new U0(this._properties);for(const m of Object.keys(this._values))u._values[m]=this._values[m].transitioned(n,o._values[m]);return u}untransitioned(){const n=new U0(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].untransitioned();return n}}class Xd{constructor(n,o,u,m,_){this.property=n,this.value=o,this.begin=_+m.delay||0,this.end=this.begin+m.duration||0,n.specification.transition&&(m.delay||m.duration)&&(this.prior=u)}possiblyEvaluate(n,o,u){const m=n.now||0,_=this.value.possiblyEvaluate(n,o,u),b=this.prior;if(b){if(m>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(m<this.begin)return b.possiblyEvaluate(n,o,u);{const I=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(n,o,u),_,ot(I))}}return _}}class U0{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,o,u){const m=new Xh(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(n,o,u);return m}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class k1{constructor(n,o){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._globalState=o}hasValue(n){return this._values[n].value!==void 0}getValue(n){return Zt(this._values[n].value)}setValue(n,o){this._values[n]=new Hh(this._values[n].property,o===null?void 0:Zt(o),this._globalState)}serialize(){const n={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(n[o]=u)}return n}possiblyEvaluate(n,o,u){const m=new Xh(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].possiblyEvaluate(n,o,u);return m}}class _a{constructor(n,o,u){this.property=n,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,o,u,m){return this.property.evaluate(this.value,this.parameters,n,o,u,m)}}class Xh{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Sr{constructor(n){this.specification=n}possiblyEvaluate(n,o){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(o)}interpolate(n,o,u){const m=ga[this.specification.type];return m?m(n,o,u):n}}class Fr{constructor(n,o){this.specification=n,this.overrides=o}possiblyEvaluate(n,o,u,m){return new _a(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(o,null,{},u,m)}:n.expression,o)}interpolate(n,o,u){if(n.value.kind!=="constant"||o.value.kind!=="constant")return n;if(n.value.value===void 0||o.value.value===void 0)return new _a(this,{kind:"constant",value:void 0},n.parameters);const m=ga[this.specification.type];if(m){const _=m(n.value.value,o.value.value,u);return new _a(this,{kind:"constant",value:_},n.parameters)}return n}evaluate(n,o,u,m,_,b){return n.kind==="constant"?n.value:n.evaluate(o,u,m,_,b)}}class kc extends Fr{possiblyEvaluate(n,o,u,m){if(n.value===void 0)return new _a(this,{kind:"constant",value:void 0},o);if(n.expression.kind==="constant"){const _=n.expression.evaluate(o,null,{},u,m),b=n.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,I=this._calculate(b,b,b,o);return new _a(this,{kind:"constant",value:I},o)}if(n.expression.kind==="camera"){const _=this._calculate(n.expression.evaluate({zoom:o.zoom-1}),n.expression.evaluate({zoom:o.zoom}),n.expression.evaluate({zoom:o.zoom+1}),o);return new _a(this,{kind:"constant",value:_},o)}return new _a(this,n.expression,o)}evaluate(n,o,u,m,_,b){if(n.kind==="source"){const I=n.evaluate(o,u,m,_,b);return this._calculate(I,I,I,o)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(o.zoom)-1},u,m),n.evaluate({zoom:Math.floor(o.zoom)},u,m),n.evaluate({zoom:Math.floor(o.zoom)+1},u,m),o):n.value}_calculate(n,o,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:u,to:o}}interpolate(n){return n}}class H0{constructor(n){this.specification=n}possiblyEvaluate(n,o,u,m){if(n.value!==void 0){if(n.expression.kind==="constant"){const _=n.expression.evaluate(o,null,{},u,m);return this._calculate(_,_,_,o)}return this._calculate(n.expression.evaluate(new Li(Math.floor(o.zoom-1),o)),n.expression.evaluate(new Li(Math.floor(o.zoom),o)),n.expression.evaluate(new Li(Math.floor(o.zoom+1),o)),o)}}_calculate(n,o,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:u,to:o}}interpolate(n){return n}}class qh{constructor(n){this.specification=n}possiblyEvaluate(n,o,u,m){return!!n.expression.evaluate(o,null,{},u,m)}interpolate(){return!1}}class ns{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in n){const u=n[o];u.specification.overridable&&this.overridableProperties.push(o);const m=this.defaultPropertyValues[o]=new Hh(u,void 0,void 0),_=this.defaultTransitionablePropertyValues[o]=new Wh(u,void 0);this.defaultTransitioningPropertyValues[o]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=m.possiblyEvaluate({})}}}_r("DataDrivenProperty",Fr),_r("DataConstantProperty",Sr),_r("CrossFadedDataDrivenProperty",kc),_r("CrossFadedProperty",H0),_r("ColorRampProperty",qh);const W0="-transition";class ta extends sr{constructor(n,o,u){if(super(),this.id=n.id,this.type=n.type,this._globalState=u,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter,this._featureFilter=Ho(n.filter,u)),o.layout&&(this._unevaluatedLayout=new k1(o.layout,u)),o.paint)){this._transitionablePaint=new Wd(o.paint,u);for(const m in n.paint)this.setPaintProperty(m,n.paint[m],{validate:!1});for(const m in n.layout)this.setLayoutProperty(m,n.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Xh(o.paint)}}setFilter(n){this.filter=n,this._featureFilter=Ho(n,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}getLayoutAffectingGlobalStateRefs(){const n=new Set;if(this._unevaluatedLayout)for(const o in this._unevaluatedLayout._values){const u=this._unevaluatedLayout._values[o];for(const m of u.getGlobalStateRefs())n.add(m)}for(const o of this._featureFilter.getGlobalStateRefs())n.add(o);return n}getPaintAffectingGlobalStateRefs(){var n;const o=new globalThis.Map;if(this._transitionablePaint)for(const u in this._transitionablePaint._values){const m=this._transitionablePaint._values[u].value;for(const _ of m.getGlobalStateRefs()){const b=(n=o.get(_))!==null&&n!==void 0?n:[];b.push({name:u,value:m.value}),o.set(_,b)}}return o}setLayoutProperty(n,o,u={}){o!=null&&this._validate(Oh,`layers.${this.id}.layout.${n}`,n,o,u)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,o):this.visibility=o)}getPaintProperty(n){return n.endsWith(W0)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,o,u={}){if(o!=null&&this._validate(P1,`layers.${this.id}.paint.${n}`,n,o,u))return!1;if(n.endsWith(W0))return this._transitionablePaint.setTransition(n.slice(0,-11),o||void 0),!1;{const m=this._transitionablePaint._values[n],_=m.property.specification["property-type"]==="cross-faded-data-driven",b=m.value.isDataDriven(),I=m.value;this._transitionablePaint.setValue(n,o),this._handleSpecialPaintPropertyUpdate(n);const E=this._transitionablePaint._values[n].value;return E.isDataDriven()||b||_||this._handleOverridablePaintPropertyUpdate(n,I,E)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,o,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,o){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,o)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),zt(n,(o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length))}_validate(n,o,u,m,_={}){return(!_||_.validate!==!1)&&B0(this,n.call(El,{key:o,layerType:this.type,objectKey:u,value:m,styleSpec:st,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const o=this.paint.get(n);if(o instanceof _a&&Ja(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const $o={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Rl{constructor(n,o){this._structArray=n,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class $i{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,o){return n._trim(),o&&(n.isTransferred=!0,o.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const o=Object.create(this.prototype);return o.arrayBuffer=n.arrayBuffer,o.length=n.length,o.capacity=n.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function mn(l,n=1){let o=0,u=0;return{members:l.map(m=>{const _=$o[m.type].BYTES_PER_ELEMENT,b=o=Yh(o,Math.max(n,_)),I=m.components||1;return u=Math.max(u,_),o+=_*I,{name:m.name,type:m.type,components:I,offset:b}}),size:Yh(o,Math.max(u,n)),alignment:n}}function Yh(l,n){return Math.ceil(l/n)*n}class Rc extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const m=2*n;return this.int16[m+0]=o,this.int16[m+1]=u,n}}Rc.prototype.bytesPerElement=4,_r("StructArrayLayout2i4",Rc);class Jo extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,o,u)}emplace(n,o,u,m){const _=3*n;return this.int16[_+0]=o,this.int16[_+1]=u,this.int16[_+2]=m,n}}Jo.prototype.bytesPerElement=6,_r("StructArrayLayout3i6",Jo);class Qo extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,m){const _=this.length;return this.resize(_+1),this.emplace(_,n,o,u,m)}emplace(n,o,u,m,_){const b=4*n;return this.int16[b+0]=o,this.int16[b+1]=u,this.int16[b+2]=m,this.int16[b+3]=_,n}}Qo.prototype.bytesPerElement=8,_r("StructArrayLayout4i8",Qo);class qd extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b){const I=this.length;return this.resize(I+1),this.emplace(I,n,o,u,m,_,b)}emplace(n,o,u,m,_,b,I){const E=6*n;return this.int16[E+0]=o,this.int16[E+1]=u,this.int16[E+2]=m,this.int16[E+3]=_,this.int16[E+4]=b,this.int16[E+5]=I,n}}qd.prototype.bytesPerElement=12,_r("StructArrayLayout2i4i12",qd);class Kh extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b){const I=this.length;return this.resize(I+1),this.emplace(I,n,o,u,m,_,b)}emplace(n,o,u,m,_,b,I){const E=4*n,G=8*n;return this.int16[E+0]=o,this.int16[E+1]=u,this.uint8[G+4]=m,this.uint8[G+5]=_,this.uint8[G+6]=b,this.uint8[G+7]=I,n}}Kh.prototype.bytesPerElement=8,_r("StructArrayLayout2i4ub8",Kh);class Ea extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const m=2*n;return this.float32[m+0]=o,this.float32[m+1]=u,n}}Ea.prototype.bytesPerElement=8,_r("StructArrayLayout2f8",Ea);class Yd extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b,I,E,G,Z){const K=this.length;return this.resize(K+1),this.emplace(K,n,o,u,m,_,b,I,E,G,Z)}emplace(n,o,u,m,_,b,I,E,G,Z,K){const ce=10*n;return this.uint16[ce+0]=o,this.uint16[ce+1]=u,this.uint16[ce+2]=m,this.uint16[ce+3]=_,this.uint16[ce+4]=b,this.uint16[ce+5]=I,this.uint16[ce+6]=E,this.uint16[ce+7]=G,this.uint16[ce+8]=Z,this.uint16[ce+9]=K,n}}Yd.prototype.bytesPerElement=20,_r("StructArrayLayout10ui20",Yd);class Kd extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b,I,E){const G=this.length;return this.resize(G+1),this.emplace(G,n,o,u,m,_,b,I,E)}emplace(n,o,u,m,_,b,I,E,G){const Z=8*n;return this.uint16[Z+0]=o,this.uint16[Z+1]=u,this.uint16[Z+2]=m,this.uint16[Z+3]=_,this.uint16[Z+4]=b,this.uint16[Z+5]=I,this.uint16[Z+6]=E,this.uint16[Z+7]=G,n}}Kd.prototype.bytesPerElement=16,_r("StructArrayLayout8ui16",Kd);class $h extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b,I,E,G,Z,K,ce){const fe=this.length;return this.resize(fe+1),this.emplace(fe,n,o,u,m,_,b,I,E,G,Z,K,ce)}emplace(n,o,u,m,_,b,I,E,G,Z,K,ce,fe){const _e=12*n;return this.int16[_e+0]=o,this.int16[_e+1]=u,this.int16[_e+2]=m,this.int16[_e+3]=_,this.uint16[_e+4]=b,this.uint16[_e+5]=I,this.uint16[_e+6]=E,this.uint16[_e+7]=G,this.int16[_e+8]=Z,this.int16[_e+9]=K,this.int16[_e+10]=ce,this.int16[_e+11]=fe,n}}$h.prototype.bytesPerElement=24,_r("StructArrayLayout4i4ui4i24",$h);class $d extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,o,u)}emplace(n,o,u,m){const _=3*n;return this.float32[_+0]=o,this.float32[_+1]=u,this.float32[_+2]=m,n}}$d.prototype.bytesPerElement=12,_r("StructArrayLayout3f12",$d);class v extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint32[1*n+0]=o,n}}v.prototype.bytesPerElement=4,_r("StructArrayLayout1ul4",v);class r extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b,I,E,G){const Z=this.length;return this.resize(Z+1),this.emplace(Z,n,o,u,m,_,b,I,E,G)}emplace(n,o,u,m,_,b,I,E,G,Z){const K=10*n,ce=5*n;return this.int16[K+0]=o,this.int16[K+1]=u,this.int16[K+2]=m,this.int16[K+3]=_,this.int16[K+4]=b,this.int16[K+5]=I,this.uint32[ce+3]=E,this.uint16[K+8]=G,this.uint16[K+9]=Z,n}}r.prototype.bytesPerElement=20,_r("StructArrayLayout6i1ul2ui20",r);class c extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b){const I=this.length;return this.resize(I+1),this.emplace(I,n,o,u,m,_,b)}emplace(n,o,u,m,_,b,I){const E=6*n;return this.int16[E+0]=o,this.int16[E+1]=u,this.int16[E+2]=m,this.int16[E+3]=_,this.int16[E+4]=b,this.int16[E+5]=I,n}}c.prototype.bytesPerElement=12,_r("StructArrayLayout2i2i2i12",c);class f extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,n,o,u,m,_)}emplace(n,o,u,m,_,b){const I=4*n,E=8*n;return this.float32[I+0]=o,this.float32[I+1]=u,this.float32[I+2]=m,this.int16[E+6]=_,this.int16[E+7]=b,n}}f.prototype.bytesPerElement=16,_r("StructArrayLayout2f1f2i16",f);class g extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b){const I=this.length;return this.resize(I+1),this.emplace(I,n,o,u,m,_,b)}emplace(n,o,u,m,_,b,I){const E=16*n,G=4*n,Z=8*n;return this.uint8[E+0]=o,this.uint8[E+1]=u,this.float32[G+1]=m,this.float32[G+2]=_,this.int16[Z+6]=b,this.int16[Z+7]=I,n}}g.prototype.bytesPerElement=16,_r("StructArrayLayout2ub2f2i16",g);class y extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,o,u)}emplace(n,o,u,m){const _=3*n;return this.uint16[_+0]=o,this.uint16[_+1]=u,this.uint16[_+2]=m,n}}y.prototype.bytesPerElement=6,_r("StructArrayLayout3ui6",y);class x extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b,I,E,G,Z,K,ce,fe,_e,Ie,Le,Oe){const vt=this.length;return this.resize(vt+1),this.emplace(vt,n,o,u,m,_,b,I,E,G,Z,K,ce,fe,_e,Ie,Le,Oe)}emplace(n,o,u,m,_,b,I,E,G,Z,K,ce,fe,_e,Ie,Le,Oe,vt){const tt=24*n,at=12*n,Mt=48*n;return this.int16[tt+0]=o,this.int16[tt+1]=u,this.uint16[tt+2]=m,this.uint16[tt+3]=_,this.uint32[at+2]=b,this.uint32[at+3]=I,this.uint32[at+4]=E,this.uint16[tt+10]=G,this.uint16[tt+11]=Z,this.uint16[tt+12]=K,this.float32[at+7]=ce,this.float32[at+8]=fe,this.uint8[Mt+36]=_e,this.uint8[Mt+37]=Ie,this.uint8[Mt+38]=Le,this.uint32[at+10]=Oe,this.int16[tt+22]=vt,n}}x.prototype.bytesPerElement=48,_r("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",x);class R extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,m,_,b,I,E,G,Z,K,ce,fe,_e,Ie,Le,Oe,vt,tt,at,Mt,Dt,qt,ur,ir,cr,Rr,or){const hr=this.length;return this.resize(hr+1),this.emplace(hr,n,o,u,m,_,b,I,E,G,Z,K,ce,fe,_e,Ie,Le,Oe,vt,tt,at,Mt,Dt,qt,ur,ir,cr,Rr,or)}emplace(n,o,u,m,_,b,I,E,G,Z,K,ce,fe,_e,Ie,Le,Oe,vt,tt,at,Mt,Dt,qt,ur,ir,cr,Rr,or,hr){const Nt=32*n,Zr=16*n;return this.int16[Nt+0]=o,this.int16[Nt+1]=u,this.int16[Nt+2]=m,this.int16[Nt+3]=_,this.int16[Nt+4]=b,this.int16[Nt+5]=I,this.int16[Nt+6]=E,this.int16[Nt+7]=G,this.uint16[Nt+8]=Z,this.uint16[Nt+9]=K,this.uint16[Nt+10]=ce,this.uint16[Nt+11]=fe,this.uint16[Nt+12]=_e,this.uint16[Nt+13]=Ie,this.uint16[Nt+14]=Le,this.uint16[Nt+15]=Oe,this.uint16[Nt+16]=vt,this.uint16[Nt+17]=tt,this.uint16[Nt+18]=at,this.uint16[Nt+19]=Mt,this.uint16[Nt+20]=Dt,this.uint16[Nt+21]=qt,this.uint16[Nt+22]=ur,this.uint32[Zr+12]=ir,this.float32[Zr+13]=cr,this.float32[Zr+14]=Rr,this.uint16[Nt+30]=or,this.uint16[Nt+31]=hr,n}}R.prototype.bytesPerElement=64,_r("StructArrayLayout8i15ui1ul2f2ui64",R);class F extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.float32[1*n+0]=o,n}}F.prototype.bytesPerElement=4,_r("StructArrayLayout1f4",F);class H extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,o,u)}emplace(n,o,u,m){const _=3*n;return this.uint16[6*n+0]=o,this.float32[_+1]=u,this.float32[_+2]=m,n}}H.prototype.bytesPerElement=12,_r("StructArrayLayout1ui2f12",H);class X extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,n,o,u)}emplace(n,o,u,m){const _=4*n;return this.uint32[2*n+0]=o,this.uint16[_+2]=u,this.uint16[_+3]=m,n}}X.prototype.bytesPerElement=8,_r("StructArrayLayout1ul2ui8",X);class ae extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o){const u=this.length;return this.resize(u+1),this.emplace(u,n,o)}emplace(n,o,u){const m=2*n;return this.uint16[m+0]=o,this.uint16[m+1]=u,n}}ae.prototype.bytesPerElement=4,_r("StructArrayLayout2ui4",ae);class ee extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint16[1*n+0]=o,n}}ee.prototype.bytesPerElement=2,_r("StructArrayLayout1ui2",ee);class de extends $i{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,u,m){const _=this.length;return this.resize(_+1),this.emplace(_,n,o,u,m)}emplace(n,o,u,m,_){const b=4*n;return this.float32[b+0]=o,this.float32[b+1]=u,this.float32[b+2]=m,this.float32[b+3]=_,n}}de.prototype.bytesPerElement=16,_r("StructArrayLayout4f16",de);class Ae extends Rl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new w(this.anchorPointX,this.anchorPointY)}}Ae.prototype.size=20;class Fe extends r{get(n){return new Ae(this,n)}}_r("CollisionBoxArray",Fe);class De extends Rl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}De.prototype.size=48;class je extends x{get(n){return new De(this,n)}}_r("PlacedSymbolArray",je);class Ue extends Rl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ue.prototype.size=64;class et extends R{get(n){return new Ue(this,n)}}_r("SymbolInstanceArray",et);class Xe extends F{getoffsetX(n){return this.float32[1*n+0]}}_r("GlyphOffsetArray",Xe);class it extends Jo{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}_r("SymbolLineVertexArray",it);class dt extends Rl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}dt.prototype.size=12;class Je extends H{get(n){return new dt(this,n)}}_r("TextAnchorOffsetArray",Je);class mt extends Rl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}mt.prototype.size=8;class Et extends X{get(n){return new mt(this,n)}}_r("FeatureIndexArray",Et);class xt extends Rc{}class At extends Rc{}class kt extends Rc{}class er extends qd{}class Qt extends Kh{}class Ht extends Ea{}class br extends Yd{}class Qr extends Kd{}class ki extends $h{}class Ji extends $d{}class qi extends v{}class an extends c{}class Qi extends g{}class Fn extends y{}class en extends ae{}const Di=mn([{name:"a_pos",components:2,type:"Int16"}],4),{members:cn}=Di;class ri{constructor(n=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=n}prepareSegment(n,o,u,m){const _=this.segments[this.segments.length-1];return n>ri.MAX_VERTEX_ARRAY_LENGTH&&Yt(`Max vertices per segment is ${ri.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ri.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!_||_.vertexLength+n>ri.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==m?this.createNewSegment(o,u,m):_}createNewSegment(n,o,u){const m={vertexOffset:n.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0,vaos:{}};return u!==void 0&&(m.sortKey=u),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(n,o,u){return this.prepareSegment(0,n,o,u)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const n of this.segments)for(const o in n.vaos)n.vaos[o].destroy()}static simpleSegment(n,o,u,m){return new ri([{vertexOffset:n,primitiveOffset:o,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])}}function Jn(l,n){return 256*(l=It(Math.floor(l),0,255))+It(Math.floor(n),0,255)}ri.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_r("SegmentVector",ri);const ka=mn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),el=mn([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var to,tl,Lc,ro={exports:{}},rl={exports:{}},Cs={exports:{}},io=function(){if(Lc)return ro.exports;Lc=1;var l=(to||(to=1,rl.exports=function(o,u){var m,_,b,I,E,G,Z,K;for(_=o.length-(m=3&o.length),b=u,E=3432918353,G=461845907,K=0;K<_;)Z=255&o.charCodeAt(K)|(255&o.charCodeAt(++K))<<8|(255&o.charCodeAt(++K))<<16|(255&o.charCodeAt(++K))<<24,++K,b=27492+(65535&(I=5*(65535&(b=(b^=Z=(65535&(Z=(Z=(65535&Z)*E+(((Z>>>16)*E&65535)<<16)&4294967295)<<15|Z>>>17))*G+(((Z>>>16)*G&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(I>>>16)&65535)<<16);switch(Z=0,m){case 3:Z^=(255&o.charCodeAt(K+2))<<16;case 2:Z^=(255&o.charCodeAt(K+1))<<8;case 1:b^=Z=(65535&(Z=(Z=(65535&(Z^=255&o.charCodeAt(K)))*E+(((Z>>>16)*E&65535)<<16)&4294967295)<<15|Z>>>17))*G+(((Z>>>16)*G&65535)<<16)&4294967295}return b^=o.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),rl.exports),n=(tl||(tl=1,Cs.exports=function(o,u){for(var m,_=o.length,b=u^_,I=0;_>=4;)m=1540483477*(65535&(m=255&o.charCodeAt(I)|(255&o.charCodeAt(++I))<<8|(255&o.charCodeAt(++I))<<16|(255&o.charCodeAt(++I))<<24))+((1540483477*(m>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),_-=4,++I;switch(_){case 3:b^=(255&o.charCodeAt(I+2))<<16;case 2:b^=(255&o.charCodeAt(I+1))<<8;case 1:b=1540483477*(65535&(b^=255&o.charCodeAt(I)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),Cs.exports);return ro.exports=l,ro.exports.murmur3=l,ro.exports.murmur2=n,ro.exports}(),Ra=A(io);class no{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,o,u,m){this.ids.push(Sn(n)),this.positions.push(o,u,m)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=Sn(n);let u=0,m=this.ids.length-1;for(;u<m;){const b=u+m>>1;this.ids[b]>=o?m=b:u=b+1}const _=[];for(;this.ids[u]===o;)_.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return _}static serialize(n,o){const u=new Float64Array(n.ids),m=new Uint32Array(n.positions);return Pn(u,m,0,u.length-1),o&&o.push(u.buffer,m.buffer),{ids:u,positions:m}}static deserialize(n){const o=new no;return o.ids=n.ids,o.positions=n.positions,o.indexed=!0,o}}function Sn(l){const n=+l;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:Ra(String(l))}function Pn(l,n,o,u){for(;o<u;){const m=l[o+u>>1];let _=o-1,b=u+1;for(;;){do _++;while(l[_]<m);do b--;while(l[b]>m);if(_>=b)break;fs(l,_,b),fs(n,3*_,3*b),fs(n,3*_+1,3*b+1),fs(n,3*_+2,3*b+2)}b-o<u-b?(Pn(l,n,o,b),o=b+1):(Pn(l,n,b+1,u),u=b)}}function fs(l,n,o){const u=l[n];l[n]=l[o],l[o]=u}_r("FeaturePositionMap",no);class tn{constructor(n,o){this.gl=n.gl,this.location=o}}class Jh extends tn{constructor(n,o){super(n,o),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class X0 extends tn{constructor(n,o){super(n,o),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class q0 extends tn{constructor(n,o){super(n,o),this.current=si.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const R1=new Float32Array(16);function Jd(l){return[Jn(255*l.r,255*l.g),Jn(255*l.b,255*l.a)]}class zc{constructor(n,o,u){this.value=n,this.uniformNames=o.map(m=>`u_${m}`),this.type=u}setUniform(n,o,u){n.set(u.constantOr(this.value))}getBinding(n,o,u){return this.type==="color"?new q0(n,o):new Jh(n,o)}}class Ss{constructor(n,o){this.uniformNames=o.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=n.tlbr}setConstantDashPositions(n,o){this.dashTo=[0,n.y,n.height,n.width],this.dashFrom=[0,o.y,o.height,o.width]}setUniform(n,o,u,m){let _=null;m==="u_pattern_to"?_=this.patternTo:m==="u_pattern_from"?_=this.patternFrom:m==="u_dasharray_to"?_=this.dashTo:m==="u_dasharray_from"?_=this.dashFrom:m==="u_pixel_ratio_to"?_=this.pixelRatioTo:m==="u_pixel_ratio_from"&&(_=this.pixelRatioFrom),_!==null&&n.set(_)}getBinding(n,o,u){return u.substr(0,9)==="u_pattern"||u.substr(0,12)==="u_dasharray_"?new X0(n,o):new Jh(n,o)}}class va{constructor(n,o,u,m){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(_=>({name:`a_${_}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(n,o,u){const m=this.paintVertexArray.length,_=this.expression.evaluate(new Li(0,u),o,{},u.canonical,[],u.formattedSection);this.paintVertexArray.resize(n),this._setPaintValue(m,n,_)}updatePaintArray(n,o,u,m,_){const b=this.expression.evaluate(new Li(0,_),u,m);this._setPaintValue(n,o,b)}_setPaintValue(n,o,u){if(this.type==="color"){const m=Jd(u);for(let _=n;_<o;_++)this.paintVertexArray.emplace(_,m[0],m[1])}else{for(let m=n;m<o;m++)this.paintVertexArray.emplace(m,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zs{constructor(n,o,u,m,_,b){this.expression=n,this.uniformNames=o.map(I=>`u_${I}_t`),this.type=u,this.useIntegerZoom=m,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=o.map(I=>({name:`a_${I}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(n,o,u){const m=this.expression.evaluate(new Li(this.zoom,u),o,{},u.canonical,[],u.formattedSection),_=this.expression.evaluate(new Li(this.zoom+1,u),o,{},u.canonical,[],u.formattedSection),b=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(b,n,m,_)}updatePaintArray(n,o,u,m,_){const b=this.expression.evaluate(new Li(this.zoom,_),u,m),I=this.expression.evaluate(new Li(this.zoom+1,_),u,m);this._setPaintValue(n,o,b,I)}_setPaintValue(n,o,u,m){if(this.type==="color"){const _=Jd(u),b=Jd(m);for(let I=n;I<o;I++)this.paintVertexArray.emplace(I,_[0],_[1],b[0],b[1])}else{for(let _=n;_<o;_++)this.paintVertexArray.emplace(_,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,o){const u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,m=It(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);n.set(m)}getBinding(n,o,u){return new Jh(n,o)}}class La{constructor(n,o,u,m,_,b){this.expression=n,this.type=o,this.useIntegerZoom=u,this.zoom=m,this.layerId=b,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(n,o,u){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(m,n,this.getPositionIds(o),u)}updatePaintArray(n,o,u,m,_){this._setPaintValues(n,o,this.getPositionIds(u),_)}_setPaintValues(n,o,u,m){const _=this.getPositions(m);if(!_||!u)return;const b=_[u.min],I=_[u.mid],E=_[u.max];if(b&&I&&E)for(let G=n;G<o;G++)this.emplace(this.zoomInPaintVertexArray,G,I,b),this.emplace(this.zoomOutPaintVertexArray,G,I,E)}upload(n){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const o=this.getVertexAttributes();this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,o,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,o,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Qh extends La{getPositions(n){return n.imagePositions}getPositionIds(n){return n.patterns&&n.patterns[this.layerId]}getVertexAttributes(){return ka.members}emplace(n,o,u,m){n.emplace(o,u.tlbr[0],u.tlbr[1],u.tlbr[2],u.tlbr[3],m.tlbr[0],m.tlbr[1],m.tlbr[2],m.tlbr[3],u.pixelRatio,m.pixelRatio)}}class Qd extends La{getPositions(n){return n.dashPositions}getPositionIds(n){return n.dashes&&n.dashes[this.layerId]}getVertexAttributes(){return el.members}emplace(n,o,u,m){n.emplace(o,0,u.y,u.height,u.width,0,m.y,m.height,m.width)}}class eu{constructor(n,o,u){this.binders={},this._buffers=[];const m=[];for(const _ in n.paint._values){if(!u(_))continue;const b=n.paint.get(_);if(!(b instanceof _a&&Ja(b.property.specification)))continue;const I=cM(_,n.type),E=b.value,G=b.property.specification.type,Z=b.property.useIntegerZoom,K=b.property.specification["property-type"],ce=K==="cross-faded"||K==="cross-faded-data-driven";if(E.kind==="constant")this.binders[_]=ce?new Ss(E.value,I):new zc(E.value,I,G),m.push(`/u_${_}`);else if(E.kind==="source"||ce){const fe=zb(_,G,"source");this.binders[_]=ce?_==="line-dasharray"?new Qd(E,G,Z,o,fe,n.id):new Qh(E,G,Z,o,fe,n.id):new va(E,I,G,fe),m.push(`/a_${_}`)}else{const fe=zb(_,G,"composite");this.binders[_]=new Zs(E,I,G,Z,o,fe),m.push(`/z_${_}`)}}this.cacheKey=m.sort().join("")}getMaxValue(n){const o=this.binders[n];return o instanceof va||o instanceof Zs?o.maxValue:0}populatePaintArrays(n,o,u){for(const m in this.binders){const _=this.binders[m];(_ instanceof va||_ instanceof Zs||_ instanceof La)&&_.populatePaintArray(n,o,u)}}setConstantPatternPositions(n,o){for(const u in this.binders){const m=this.binders[u];m instanceof Ss&&m.setConstantPatternPositions(n,o)}}setConstantDashPositions(n,o){for(const u in this.binders){const m=this.binders[u];m instanceof Ss&&m.setConstantDashPositions(n,o)}}updatePaintArrays(n,o,u,m,_){let b=!1;for(const I in n){const E=o.getPositions(I);for(const G of E){const Z=u.feature(G.index);for(const K in this.binders){const ce=this.binders[K];if((ce instanceof va||ce instanceof Zs||ce instanceof La)&&ce.expression.isStateDependent===!0){const fe=m.paint.get(K);ce.expression=fe.value,ce.updatePaintArray(G.start,G.end,Z,n[I],_),b=!0}}}}return b}defines(){const n=[];for(const o in this.binders){const u=this.binders[o];(u instanceof zc||u instanceof Ss)&&n.push(...u.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return n}getBinderAttributes(){const n=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof va||u instanceof Zs)for(let m=0;m<u.paintVertexAttributes.length;m++)n.push(u.paintVertexAttributes[m].name);else if(u instanceof La){const m=u.getVertexAttributes();for(const _ of m)n.push(_.name)}}return n}getBinderUniforms(){const n=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof zc||u instanceof Ss||u instanceof Zs)for(const m of u.uniformNames)n.push(m)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,o){const u=[];for(const m in this.binders){const _=this.binders[m];if(_ instanceof zc||_ instanceof Ss||_ instanceof Zs){for(const b of _.uniformNames)if(o[b]){const I=_.getBinding(n,o[b],b);u.push({name:b,property:m,binding:I})}}}return u}setUniforms(n,o,u,m){for(const{name:_,property:b,binding:I}of o)this.binders[b].setUniform(I,m,u.get(b),_)}updatePaintBuffers(n){this._buffers=[];for(const o in this.binders){const u=this.binders[o];if(n&&u instanceof La){const m=n.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(u instanceof va||u instanceof Zs)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(n){for(const o in this.binders){const u=this.binders[o];(u instanceof va||u instanceof Zs||u instanceof La)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const o=this.binders[n];(o instanceof va||o instanceof Zs||o instanceof La)&&o.destroy()}}}class Fc{constructor(n,o,u=()=>!0){this.programConfigurations={};for(const m of n)this.programConfigurations[m.id]=new eu(m,o,u);this.needsUpload=!1,this._featureMap=new no,this._bufferOffset=0}populatePaintArrays(n,o,u,m){for(const _ in this.programConfigurations)this.programConfigurations[_].populatePaintArrays(n,o,m);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,o,u,m){for(const _ of u)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(n,this._featureMap,o,_,m)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function cM(l,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${n}-`,"").replace(/-/g,"_")]}function zb(l,n,o){const u={color:{source:Ea,composite:de},number:{source:F,composite:Ea}},m=function(_){return{"line-pattern":{source:br,composite:br},"fill-pattern":{source:br,composite:br},"fill-extrusion-pattern":{source:br,composite:br},"line-dasharray":{source:Qr,composite:Qr}}[_]}(l);return m&&m[o]||u[n][o]}_r("ConstantBinder",zc),_r("CrossFadedConstantBinder",Ss),_r("SourceExpressionBinder",va),_r("CrossFadedPatternBinder",Qh),_r("CrossFadedDasharrayBinder",Qd),_r("CompositeExpressionBinder",Zs),_r("ProgramConfiguration",eu,{omit:["_buffers"]}),_r("ProgramConfigurationSet",Fc);const L1=Math.pow(2,14)-1,Fb=-L1-1;function Dc(l){const n=ye/l.extent,o=l.loadGeometry();for(let u=0;u<o.length;u++){const m=o[u];for(let _=0;_<m.length;_++){const b=m[_],I=Math.round(b.x*n),E=Math.round(b.y*n);b.x=It(I,Fb,L1),b.y=It(E,Fb,L1),(I<b.x||I>b.x+1||E<b.y||E>b.y+1)&&Yt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Bc(l,n){return{type:l.type,id:l.id,properties:l.properties,geometry:n?Dc(l):[]}}const Db=-32768;function hM(l,n,o,u,m){l.emplaceBack(Db+8*n+u,Db+8*o+m)}class z1{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasDependencies=!1,this.layoutVertexArray=new At,this.indexArray=new Fn,this.segments=new ri,this.programConfigurations=new Fc(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,u){const m=this.layers[0],_=[];let b=null,I=!1,E=m.type==="heatmap";if(m.type==="circle"){const Z=m;b=Z.layout.get("circle-sort-key"),I=!b.isConstant(),E=E||Z.paint.get("circle-pitch-alignment")==="map"}const G=E?o.subdivisionGranularity.circle:1;for(const{feature:Z,id:K,index:ce,sourceLayerIndex:fe}of n){const _e=this.layers[0]._featureFilter.needGeometry,Ie=Bc(Z,_e);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),Ie,u))continue;const Le=I?b.evaluate(Ie,{},u):void 0,Oe={id:K,properties:Z.properties,type:Z.type,sourceLayerIndex:fe,index:ce,geometry:_e?Ie.geometry:Dc(Z),patterns:{},sortKey:Le};_.push(Oe)}I&&_.sort((Z,K)=>Z.sortKey-K.sortKey);for(const Z of _){const{geometry:K,index:ce,sourceLayerIndex:fe}=Z,_e=n[ce].feature;this.addFeature(Z,K,ce,u,G),o.featureIndex.insert(_e,K,ce,fe,this.index)}}update(n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,{imagePositions:u})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,cn),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,o,u,m,_=1){let b;switch(_){case 1:b=[0,7];break;case 3:b=[0,2,5,7];break;case 5:b=[0,1,3,4,6,7];break;case 7:b=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${_}; valid values are 1, 3, 5, 7.`)}const I=b.length;for(const E of o)for(const G of E){const Z=G.x,K=G.y;if(Z<0||Z>=ye||K<0||K>=ye)continue;const ce=this.segments.prepareSegment(I*I,this.layoutVertexArray,this.indexArray,n.sortKey),fe=ce.vertexLength;for(let _e=0;_e<I;_e++)for(let Ie=0;Ie<I;Ie++)hM(this.layoutVertexArray,Z,K,b[Ie],b[_e]);for(let _e=0;_e<I-1;_e++)for(let Ie=0;Ie<I-1;Ie++){const Le=fe+_e*I+Ie,Oe=fe+(_e+1)*I+Ie;this.indexArray.emplaceBack(Le,Oe+1,Le+1),this.indexArray.emplaceBack(Le,Oe,Oe+1)}ce.vertexLength+=I*I,ce.primitiveLength+=(I-1)*(I-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{imagePositions:{},canonical:m})}}function Bb(l,n){for(let o=0;o<l.length;o++)if(tu(n,l[o]))return!0;for(let o=0;o<n.length;o++)if(tu(l,n[o]))return!0;return!!F1(l,n)}function Y0(l,n,o){return!!tu(l,n)||!!D1(n,l,o)}function Gb(l,n){if(l.length===1)return jb(n,l[0]);for(let o=0;o<n.length;o++){const u=n[o];for(let m=0;m<u.length;m++)if(tu(l,u[m]))return!0}for(let o=0;o<l.length;o++)if(jb(n,l[o]))return!0;for(let o=0;o<n.length;o++)if(F1(l,n[o]))return!0;return!1}function uM(l,n,o){if(l.length>1){if(F1(l,n))return!0;for(let u=0;u<n.length;u++)if(D1(n[u],l,o))return!0}for(let u=0;u<l.length;u++)if(D1(l[u],n,o))return!0;return!1}function F1(l,n){if(l.length===0||n.length===0)return!1;for(let o=0;o<l.length-1;o++){const u=l[o],m=l[o+1];for(let _=0;_<n.length-1;_++)if(dM(u,m,n[_],n[_+1]))return!0}return!1}function dM(l,n,o,u){return Ar(l,o,u)!==Ar(n,o,u)&&Ar(l,n,o)!==Ar(l,n,u)}function D1(l,n,o){const u=o*o;if(n.length===1)return l.distSqr(n[0])<u;for(let m=1;m<n.length;m++)if(Vb(l,n[m-1],n[m])<u)return!0;return!1}function Vb(l,n,o){const u=n.distSqr(o);if(u===0)return l.distSqr(n);const m=((l.x-n.x)*(o.x-n.x)+(l.y-n.y)*(o.y-n.y))/u;return l.distSqr(m<0?n:m>1?o:o.sub(n)._mult(m)._add(n))}function jb(l,n){let o,u,m,_=!1;for(let b=0;b<l.length;b++){o=l[b];for(let I=0,E=o.length-1;I<o.length;E=I++)u=o[I],m=o[E],u.y>n.y!=m.y>n.y&&n.x<(m.x-u.x)*(n.y-u.y)/(m.y-u.y)+u.x&&(_=!_)}return _}function tu(l,n){let o=!1;for(let u=0,m=l.length-1;u<l.length;m=u++){const _=l[u],b=l[m];_.y>n.y!=b.y>n.y&&n.x<(b.x-_.x)*(n.y-_.y)/(b.y-_.y)+_.x&&(o=!o)}return o}function fM(l,n,o){const u=o[0],m=o[2];if(l.x<u.x&&n.x<u.x||l.x>m.x&&n.x>m.x||l.y<u.y&&n.y<u.y||l.y>m.y&&n.y>m.y)return!1;const _=Ar(l,n,o[0]);return _!==Ar(l,n,o[1])||_!==Ar(l,n,o[2])||_!==Ar(l,n,o[3])}function ru(l,n,o){const u=n.paint.get(l).value;return u.kind==="constant"?u.value:o.programConfigurations.get(n.id).getMaxValue(l)}function K0(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function $0(l,n,o,u,m){if(!n[0]&&!n[1])return l;const _=w.convert(n)._mult(m);o==="viewport"&&_._rotate(-u);const b=[];for(let I=0;I<l.length;I++)b.push(l[I].sub(_));return b}function pM({queryGeometry:l,size:n},o){return Y0(l,o,n)}function mM({queryGeometry:l,size:n,transform:o,unwrappedTileID:u,getElevation:m},_){return Y0(l,_,n*(o.projectTileCoordinates(_.x,_.y,u,m).signedDistanceFromCamera/o.cameraToCenterDistance))}function gM({queryGeometry:l,size:n,transform:o,unwrappedTileID:u,getElevation:m},_){const b=o.projectTileCoordinates(_.x,_.y,u,m).signedDistanceFromCamera,I=n*(o.cameraToCenterDistance/b);return Y0(l,B1(_,o,u,m),I)}function _M({queryGeometry:l,size:n,transform:o,unwrappedTileID:u,getElevation:m},_){return Y0(l,B1(_,o,u,m),n)}function Zb({queryGeometry:l,size:n,transform:o,unwrappedTileID:u,getElevation:m,pitchAlignment:_="map",pitchScale:b="map"},I){const E=_==="map"?b==="map"?pM:mM:b==="map"?gM:_M,G={queryGeometry:l,size:n,transform:o,unwrappedTileID:u,getElevation:m};for(const Z of I)for(const K of Z)if(E(G,K))return!0;return!1}function B1(l,n,o,u){const m=n.projectTileCoordinates(l.x,l.y,o,u).point;return new w((.5*m.x+.5)*n.width,(.5*-m.y+.5)*n.height)}let Ob,Nb;_r("CircleBucket",z1,{omit:["layers"]});var vM={get paint(){return Nb=Nb||new ns({"circle-radius":new Fr(st.paint_circle["circle-radius"]),"circle-color":new Fr(st.paint_circle["circle-color"]),"circle-blur":new Fr(st.paint_circle["circle-blur"]),"circle-opacity":new Fr(st.paint_circle["circle-opacity"]),"circle-translate":new Sr(st.paint_circle["circle-translate"]),"circle-translate-anchor":new Sr(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Sr(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Sr(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Fr(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Fr(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Fr(st.paint_circle["circle-stroke-opacity"])})},get layout(){return Ob=Ob||new ns({"circle-sort-key":new Fr(st.layout_circle["circle-sort-key"])})}};class yM extends ta{constructor(n,o){super(n,vM,o)}createBucket(n){return new z1(n)}queryRadius(n){const o=n;return ru("circle-radius",this,o)+ru("circle-stroke-width",this,o)+K0(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:n,feature:o,featureState:u,geometry:m,transform:_,pixelsToTileUnits:b,unwrappedTileID:I,getElevation:E}){const G=$0(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-_.bearingInRadians,b),Z=this.paint.get("circle-radius").evaluate(o,u)+this.paint.get("circle-stroke-width").evaluate(o,u),K=this.paint.get("circle-pitch-scale"),ce=this.paint.get("circle-pitch-alignment");let fe,_e;return ce==="map"?(fe=G,_e=Z*b):(fe=function(Ie,Le,Oe,vt){return Ie.map(tt=>B1(tt,Le,Oe,vt))}(G,_,I,E),_e=Z),Zb({queryGeometry:fe,size:_e,transform:_,unwrappedTileID:I,getElevation:E,pitchAlignment:ce,pitchScale:K},m)}}class Ub extends z1{}let Hb;_r("HeatmapBucket",Ub,{omit:["layers"]});var bM={get paint(){return Hb=Hb||new ns({"heatmap-radius":new Fr(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Fr(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Sr(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qh(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Sr(st.paint_heatmap["heatmap-opacity"])})}};function G1(l,{width:n,height:o},u,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==n*o*u)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${n*o*u}`)}else m=new Uint8Array(n*o*u);return l.width=n,l.height=o,l.data=m,l}function Wb(l,{width:n,height:o},u){if(n===l.width&&o===l.height)return;const m=G1({},{width:n,height:o},u);V1(l,m,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,n),height:Math.min(l.height,o)},u),l.width=n,l.height=o,l.data=m.data}function V1(l,n,o,u,m,_){if(m.width===0||m.height===0)return n;if(m.width>l.width||m.height>l.height||o.x>l.width-m.width||o.y>l.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>n.width||m.height>n.height||u.x>n.width-m.width||u.y>n.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const b=l.data,I=n.data;if(b===I)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<m.height;E++){const G=((o.y+E)*l.width+o.x)*_,Z=((u.y+E)*n.width+u.x)*_;for(let K=0;K<m.width*_;K++)I[Z+K]=b[G+K]}return n}class ef{constructor(n,o){G1(this,n,1,o)}resize(n){Wb(this,n,1)}clone(){return new ef({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,u,m,_){V1(n,o,u,m,_,1)}}class Ps{constructor(n,o){G1(this,n,4,o)}resize(n){Wb(this,n,4)}replace(n,o){o?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ps({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,u,m,_){V1(n,o,u,m,_,4)}setPixel(n,o,u){const m=4*(n*this.width+o);this.data[m+0]=Math.round(255*u.r/u.a),this.data[m+1]=Math.round(255*u.g/u.a),this.data[m+2]=Math.round(255*u.b/u.a),this.data[m+3]=Math.round(255*u.a)}}function Xb(l){const n={},o=l.resolution||256,u=l.clips?l.clips.length:1,m=l.image||new Ps({width:o,height:u});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const _=(b,I,E)=>{n[l.evaluationKey]=E;const G=l.expression.evaluate(n);m.setPixel(b/4/o,I/4,G)};if(l.clips)for(let b=0,I=0;b<u;++b,I+=4*o)for(let E=0,G=0;E<o;E++,G+=4){const Z=E/(o-1),{start:K,end:ce}=l.clips[b];_(I,G,K*(1-Z)+ce*Z)}else for(let b=0,I=0;b<o;b++,I+=4)_(0,I,b/(o-1));return m}_r("AlphaImage",ef),_r("RGBAImage",Ps);const j1="big-fb";class wM extends ta{createBucket(n){return new Ub(n)}constructor(n,o){super(n,bM,o),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Xb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(j1)&&this.heatmapFbos.delete(j1)}queryRadius(n){return ru("heatmap-radius",this,n)}queryIntersectsFeature({queryGeometry:n,feature:o,featureState:u,geometry:m,transform:_,pixelsToTileUnits:b,unwrappedTileID:I,getElevation:E}){return Zb({queryGeometry:n,size:this.paint.get("heatmap-radius").evaluate(o,u)*b,transform:_,unwrappedTileID:I,getElevation:E},m)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let qb;var xM={get paint(){return qb=qb||new ns({"hillshade-illumination-direction":new Sr(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Sr(st.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Sr(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Sr(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Sr(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Sr(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Sr(st.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Sr(st.paint_hillshade["hillshade-method"])})}};class MM extends ta{constructor(n,o){super(n,xM,o),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let n=this.paint.get("hillshade-illumination-direction").values,o=this.paint.get("hillshade-illumination-altitude").values,u=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values;const _=Math.max(n.length,o.length,u.length,m.length);n=n.concat(Array(_-n.length).fill(n.at(-1))),o=o.concat(Array(_-o.length).fill(o.at(-1))),u=u.concat(Array(_-u.length).fill(u.at(-1))),m=m.concat(Array(_-m.length).fill(m.at(-1)));const b=o.map(Xi);return{directionRadians:n.map(Xi),altitudeRadians:b,shadowColor:m,highlightColor:u}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Yb;var IM={get paint(){return Yb=Yb||new ns({"color-relief-opacity":new Sr(st["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new qh(st["paint_color-relief"]["color-relief-color"])})}};class Z1{constructor(n,o,u,m){this.context=n,this.format=u,this.texture=n.gl.createTexture(),this.update(o,m)}update(n,o,u){const{width:m,height:_}=n,b=!(this.size&&this.size[0]===m&&this.size[1]===_||u),{context:I}=this,{gl:E}=I;if(this.useMipmap=!!(o&&o.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!o||o.premultiply!==!1)),b)this.size=[m,_],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||Tr(n)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,n):E.texImage2D(E.TEXTURE_2D,0,this.format,m,_,0,this.format,E.UNSIGNED_BYTE,n.data);else{const{x:G,y:Z}=u||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||Tr(n)?E.texSubImage2D(E.TEXTURE_2D,0,G,Z,E.RGBA,E.UNSIGNED_BYTE,n):E.texSubImage2D(E.TEXTURE_2D,0,G,Z,m,_,E.RGBA,E.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D),I.pixelStoreUnpackFlipY.setDefault(),I.pixelStoreUnpack.setDefault(),I.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(n,o,u){const{context:m}=this,{gl:_}=m;_.bindTexture(_.TEXTURE_2D,this.texture),u!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=_.LINEAR),n!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,n),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,u||n),this.filter=n),o!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class Kb{constructor(n,o,u,m=1,_=1,b=1,I=0){if(this.uid=n,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void Yt(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const E=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=_,this.blueFactor=b,this.baseShift=I;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let G=0;G<E;G++)this.data[this._idx(-1,G)]=this.data[this._idx(0,G)],this.data[this._idx(E,G)]=this.data[this._idx(E-1,G)],this.data[this._idx(G,-1)]=this.data[this._idx(G,0)],this.data[this._idx(G,E)]=this.data[this._idx(G,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let G=0;G<E;G++)for(let Z=0;Z<E;Z++){const K=this.get(G,Z);K>this.max&&(this.max=K),K<this.min&&(this.min=K)}}get(n,o){const u=new Uint8Array(this.data.buffer),m=4*this._idx(n,o);return this.unpack(u[m],u[m+1],u[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,o){if(n<-1||n>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(n+1)}unpack(n,o,u){return n*this.redFactor+o*this.greenFactor+u*this.blueFactor-this.baseShift}pack(n){return $b(n,this.getUnpackVector())}getPixels(){return new Ps({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,o,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let m=o*this.dim,_=o*this.dim+this.dim,b=u*this.dim,I=u*this.dim+this.dim;switch(o){case-1:m=_-1;break;case 1:_=m+1}switch(u){case-1:b=I-1;break;case 1:I=b+1}const E=-o*this.dim,G=-u*this.dim;for(let Z=b;Z<I;Z++)for(let K=m;K<_;K++)this.data[this._idx(K,Z)]=n.data[this._idx(K+E,Z+G)]}}function $b(l,n){const o=n[0],u=n[1],m=n[2],_=n[3],b=Math.min(o,u,m),I=Math.round((l+_)/b);return{r:Math.floor(I*b/o)%256,g:Math.floor(I*b/u)%256,b:Math.floor(I*b/m)%256}}_r("DEMData",Kb);class AM extends ta{constructor(n,o){super(n,IM,o)}_createColorRamp(n){const o={elevationStops:[],colorStops:[]},u=this._transitionablePaint._values["color-relief-color"].value.expression;if(u instanceof Mc&&u._styleExpression.expression instanceof $n){this.colorRampExpression=u;const b=u._styleExpression.expression;o.elevationStops=b.labels,o.colorStops=[];for(const I of o.elevationStops)o.colorStops.push(b.evaluate({globals:{elevation:I}}))}if(o.elevationStops.length<1&&(o.elevationStops=[0],o.colorStops=[si.transparent]),o.elevationStops.length<2&&(o.elevationStops.push(o.elevationStops[0]+1),o.colorStops.push(o.colorStops[0])),o.elevationStops.length<=n)return o;const m={elevationStops:[],colorStops:[]},_=(o.elevationStops.length-1)/(n-1);for(let b=0;b<o.elevationStops.length-.5;b+=_)m.elevationStops.push(o.elevationStops[Math.round(b)]),m.colorStops.push(o.colorStops[Math.round(b)]);return Yt(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(n,o,u){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const m=this._createColorRamp(o),_=new Ps({width:m.colorStops.length,height:1}),b=new Ps({width:m.colorStops.length,height:1});for(let I=0;I<m.elevationStops.length;I++){const E=$b(m.elevationStops[I],u);b.setPixel(0,I,new si(E.r/255,E.g/255,E.b/255,1)),_.setPixel(0,I,m.colorStops[I])}return this.colorRampTextures={elevationTexture:new Z1(n,b,n.gl.RGBA),colorTexture:new Z1(n,_,n.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const TM=mn([{name:"a_pos",components:2,type:"Int16"}],4),{members:CM}=TM;function J0(l,n,o){const u=o.patternDependencies;let m=!1;for(const _ of n){const b=_.paint.get(`${l}-pattern`);b.isConstant()||(m=!0);const I=b.constantOr(null);I&&(m=!0,u[I.to]=!0,u[I.from]=!0)}return m}function O1(l,n,o,u,m){const{zoom:_}=u,b=m.patternDependencies;for(const I of n){const E=I.paint.get(`${l}-pattern`).value;if(E.kind!=="constant"){let G=E.evaluate({zoom:_-1},o,{},m.availableImages),Z=E.evaluate({zoom:_},o,{},m.availableImages),K=E.evaluate({zoom:_+1},o,{},m.availableImages);G=G&&G.name?G.name:G,Z=Z&&Z.name?Z.name:Z,K=K&&K.name?K.name:K,b[G]=!0,b[Z]=!0,b[K]=!0,o.patterns[I.id]={min:G,mid:Z,max:K}}}return o}function Jb(l,n,o,u,m){let _;if(m===function(b,I,E,G){let Z=0;for(let K=I,ce=E-G;K<E;K+=G)Z+=(b[ce]-b[K])*(b[K+1]+b[ce+1]),ce=K;return Z}(l,n,o,u)>0)for(let b=n;b<o;b+=u)_=rw(b/u|0,l[b],l[b+1],_);else for(let b=o-u;b>=n;b-=u)_=rw(b/u|0,l[b],l[b+1],_);return _&&iu(_,_.next)&&(sf(_),_=_.next),_}function Gc(l,n){if(!l)return l;n||(n=l);let o,u=l;do if(o=!1,u.steiner||!iu(u,u.next)&&Mn(u.prev,u,u.next)!==0)u=u.next;else{if(sf(u),u=n=u.prev,u===u.next)break;o=!0}while(o||u!==n);return n}function tf(l,n,o,u,m,_,b){if(!l)return;!b&&_&&function(E,G,Z,K){let ce=E;do ce.z===0&&(ce.z=N1(ce.x,ce.y,G,Z,K)),ce.prevZ=ce.prev,ce.nextZ=ce.next,ce=ce.next;while(ce!==E);ce.prevZ.nextZ=null,ce.prevZ=null,function(fe){let _e,Ie=1;do{let Le,Oe=fe;fe=null;let vt=null;for(_e=0;Oe;){_e++;let tt=Oe,at=0;for(let Dt=0;Dt<Ie&&(at++,tt=tt.nextZ,tt);Dt++);let Mt=Ie;for(;at>0||Mt>0&&tt;)at!==0&&(Mt===0||!tt||Oe.z<=tt.z)?(Le=Oe,Oe=Oe.nextZ,at--):(Le=tt,tt=tt.nextZ,Mt--),vt?vt.nextZ=Le:fe=Le,Le.prevZ=vt,vt=Le;Oe=tt}vt.nextZ=null,Ie*=2}while(_e>1)}(ce)}(l,u,m,_);let I=l;for(;l.prev!==l.next;){const E=l.prev,G=l.next;if(_?PM(l,u,m,_):SM(l))n.push(E.i,l.i,G.i),sf(l),l=G.next,I=G.next;else if((l=G)===I){b?b===1?tf(l=EM(Gc(l),n),n,o,u,m,_,2):b===2&&kM(l,n,o,u,m,_):tf(Gc(l),n,o,u,m,_,1);break}}}function SM(l){const n=l.prev,o=l,u=l.next;if(Mn(n,o,u)>=0)return!1;const m=n.x,_=o.x,b=u.x,I=n.y,E=o.y,G=u.y,Z=Math.min(m,_,b),K=Math.min(I,E,G),ce=Math.max(m,_,b),fe=Math.max(I,E,G);let _e=u.next;for(;_e!==n;){if(_e.x>=Z&&_e.x<=ce&&_e.y>=K&&_e.y<=fe&&rf(m,I,_,E,b,G,_e.x,_e.y)&&Mn(_e.prev,_e,_e.next)>=0)return!1;_e=_e.next}return!0}function PM(l,n,o,u){const m=l.prev,_=l,b=l.next;if(Mn(m,_,b)>=0)return!1;const I=m.x,E=_.x,G=b.x,Z=m.y,K=_.y,ce=b.y,fe=Math.min(I,E,G),_e=Math.min(Z,K,ce),Ie=Math.max(I,E,G),Le=Math.max(Z,K,ce),Oe=N1(fe,_e,n,o,u),vt=N1(Ie,Le,n,o,u);let tt=l.prevZ,at=l.nextZ;for(;tt&&tt.z>=Oe&&at&&at.z<=vt;){if(tt.x>=fe&&tt.x<=Ie&&tt.y>=_e&&tt.y<=Le&&tt!==m&&tt!==b&&rf(I,Z,E,K,G,ce,tt.x,tt.y)&&Mn(tt.prev,tt,tt.next)>=0||(tt=tt.prevZ,at.x>=fe&&at.x<=Ie&&at.y>=_e&&at.y<=Le&&at!==m&&at!==b&&rf(I,Z,E,K,G,ce,at.x,at.y)&&Mn(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;tt&&tt.z>=Oe;){if(tt.x>=fe&&tt.x<=Ie&&tt.y>=_e&&tt.y<=Le&&tt!==m&&tt!==b&&rf(I,Z,E,K,G,ce,tt.x,tt.y)&&Mn(tt.prev,tt,tt.next)>=0)return!1;tt=tt.prevZ}for(;at&&at.z<=vt;){if(at.x>=fe&&at.x<=Ie&&at.y>=_e&&at.y<=Le&&at!==m&&at!==b&&rf(I,Z,E,K,G,ce,at.x,at.y)&&Mn(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}function EM(l,n){let o=l;do{const u=o.prev,m=o.next.next;!iu(u,m)&&ew(u,o,o.next,m)&&nf(u,m)&&nf(m,u)&&(n.push(u.i,o.i,m.i),sf(o),sf(o.next),o=l=m),o=o.next}while(o!==l);return Gc(o)}function kM(l,n,o,u,m,_){let b=l;do{let I=b.next.next;for(;I!==b.prev;){if(b.i!==I.i&&DM(b,I)){let E=tw(b,I);return b=Gc(b,b.next),E=Gc(E,E.next),tf(b,n,o,u,m,_,0),void tf(E,n,o,u,m,_,0)}I=I.next}b=b.next}while(b!==l)}function RM(l,n){let o=l.x-n.x;return o===0&&(o=l.y-n.y,o===0)&&(o=(l.next.y-l.y)/(l.next.x-l.x)-(n.next.y-n.y)/(n.next.x-n.x)),o}function LM(l,n){const o=function(m,_){let b=_;const I=m.x,E=m.y;let G,Z=-1/0;if(iu(m,b))return b;do{if(iu(m,b.next))return b.next;if(E<=b.y&&E>=b.next.y&&b.next.y!==b.y){const Ie=b.x+(E-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(Ie<=I&&Ie>Z&&(Z=Ie,G=b.x<b.next.x?b:b.next,Ie===I))return G}b=b.next}while(b!==_);if(!G)return null;const K=G,ce=G.x,fe=G.y;let _e=1/0;b=G;do{if(I>=b.x&&b.x>=ce&&I!==b.x&&Qb(E<fe?I:Z,E,ce,fe,E<fe?Z:I,E,b.x,b.y)){const Ie=Math.abs(E-b.y)/(I-b.x);nf(b,m)&&(Ie<_e||Ie===_e&&(b.x>G.x||b.x===G.x&&zM(G,b)))&&(G=b,_e=Ie)}b=b.next}while(b!==K);return G}(l,n);if(!o)return n;const u=tw(o,l);return Gc(u,u.next),Gc(o,o.next)}function zM(l,n){return Mn(l.prev,l,n.prev)<0&&Mn(n.next,l,l.next)<0}function N1(l,n,o,u,m){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-o)*m|0)|l<<8))|l<<4))|l<<2))|l<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*m|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function FM(l){let n=l,o=l;do(n.x<o.x||n.x===o.x&&n.y<o.y)&&(o=n),n=n.next;while(n!==l);return o}function Qb(l,n,o,u,m,_,b,I){return(m-b)*(n-I)>=(l-b)*(_-I)&&(l-b)*(u-I)>=(o-b)*(n-I)&&(o-b)*(_-I)>=(m-b)*(u-I)}function rf(l,n,o,u,m,_,b,I){return!(l===b&&n===I)&&Qb(l,n,o,u,m,_,b,I)}function DM(l,n){return l.next.i!==n.i&&l.prev.i!==n.i&&!function(o,u){let m=o;do{if(m.i!==o.i&&m.next.i!==o.i&&m.i!==u.i&&m.next.i!==u.i&&ew(m,m.next,o,u))return!0;m=m.next}while(m!==o);return!1}(l,n)&&(nf(l,n)&&nf(n,l)&&function(o,u){let m=o,_=!1;const b=(o.x+u.x)/2,I=(o.y+u.y)/2;do m.y>I!=m.next.y>I&&m.next.y!==m.y&&b<(m.next.x-m.x)*(I-m.y)/(m.next.y-m.y)+m.x&&(_=!_),m=m.next;while(m!==o);return _}(l,n)&&(Mn(l.prev,l,n.prev)||Mn(l,n.prev,n))||iu(l,n)&&Mn(l.prev,l,l.next)>0&&Mn(n.prev,n,n.next)>0)}function Mn(l,n,o){return(n.y-l.y)*(o.x-n.x)-(n.x-l.x)*(o.y-n.y)}function iu(l,n){return l.x===n.x&&l.y===n.y}function ew(l,n,o,u){const m=em(Mn(l,n,o)),_=em(Mn(l,n,u)),b=em(Mn(o,u,l)),I=em(Mn(o,u,n));return m!==_&&b!==I||!(m!==0||!Q0(l,o,n))||!(_!==0||!Q0(l,u,n))||!(b!==0||!Q0(o,l,u))||!(I!==0||!Q0(o,n,u))}function Q0(l,n,o){return n.x<=Math.max(l.x,o.x)&&n.x>=Math.min(l.x,o.x)&&n.y<=Math.max(l.y,o.y)&&n.y>=Math.min(l.y,o.y)}function em(l){return l>0?1:l<0?-1:0}function nf(l,n){return Mn(l.prev,l,l.next)<0?Mn(l,n,l.next)>=0&&Mn(l,l.prev,n)>=0:Mn(l,n,l.prev)<0||Mn(l,l.next,n)<0}function tw(l,n){const o=U1(l.i,l.x,l.y),u=U1(n.i,n.x,n.y),m=l.next,_=n.prev;return l.next=n,n.prev=l,o.next=m,m.prev=o,u.next=o,o.prev=u,_.next=u,u.prev=_,u}function rw(l,n,o,u){const m=U1(l,n,o);return u?(m.next=u.next,m.prev=u,u.next.prev=m,u.next=m):(m.prev=m,m.next=m),m}function sf(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function U1(l,n,o){return{i:l,x:n,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class nu{constructor(n,o){if(o>n)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=n,this._minGranularity=o}getGranularityForZoomLevel(n){return Math.max(Math.floor(this._baseZoomGranularity/(1<<n)),this._minGranularity,1)}}class tm{constructor(n){this.fill=n.fill,this.line=n.line,this.tile=n.tile,this.stencil=n.stencil,this.circle=n.circle}}tm.noSubdivision=new tm({fill:new nu(0,0),line:new nu(0,0),tile:new nu(0,0),stencil:new nu(0,0),circle:1}),_r("SubdivisionGranularityExpression",nu),_r("SubdivisionGranularitySetting",tm);const su=-32768,af=32767;class BM{constructor(n,o){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=n,this._granularityCellSize=ye/n,this._canonical=o}_getKey(n,o){return(n+=32768)<<16|o+32768}_vertexToIndex(n,o){if(n<-32768||o<-32768||n>32767||o>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const u=0|Math.round(n),m=0|Math.round(o),_=this._getKey(u,m);if(this._vertexDictionary.has(_))return this._vertexDictionary.get(_);const b=this._vertexBuffer.length/2;return this._vertexDictionary.set(_,b),this._vertexBuffer.push(u,m),b}_subdivideTrianglesScanline(n){if(this._granularity<2)return function(m,_){const b=[];for(let I=0;I<_.length;I+=3){const E=_[I],G=_[I+1],Z=_[I+2],K=m[2*E],ce=m[2*E+1];(m[2*G]-K)*(m[2*Z+1]-ce)-(m[2*G+1]-ce)*(m[2*Z]-K)>0?(b.push(E),b.push(Z),b.push(G)):(b.push(E),b.push(G),b.push(Z))}return b}(this._vertexBuffer,n);const o=[],u=n.length;for(let m=0;m<u;m+=3){const _=[n[m+0],n[m+1],n[m+2]],b=[this._vertexBuffer[2*n[m+0]+0],this._vertexBuffer[2*n[m+0]+1],this._vertexBuffer[2*n[m+1]+0],this._vertexBuffer[2*n[m+1]+1],this._vertexBuffer[2*n[m+2]+0],this._vertexBuffer[2*n[m+2]+1]];let I=1/0,E=1/0,G=-1/0,Z=-1/0;for(let Ie=0;Ie<3;Ie++){const Le=b[2*Ie],Oe=b[2*Ie+1];I=Math.min(I,Le),G=Math.max(G,Le),E=Math.min(E,Oe),Z=Math.max(Z,Oe)}if(I===G||E===Z)continue;const K=Math.floor(I/this._granularityCellSize),ce=Math.ceil(G/this._granularityCellSize),fe=Math.floor(E/this._granularityCellSize),_e=Math.ceil(Z/this._granularityCellSize);if(K!==ce||fe!==_e)for(let Ie=fe;Ie<_e;Ie++){const Le=this._scanlineGenerateVertexRingForCellRow(Ie,b,_);GM(this._vertexBuffer,Le,o)}else o.push(..._)}return o}_scanlineGenerateVertexRingForCellRow(n,o,u){const m=n*this._granularityCellSize,_=m+this._granularityCellSize,b=[];for(let I=0;I<3;I++){const E=o[2*I],G=o[2*I+1],Z=o[2*(I+1)%6],K=o[(2*(I+1)+1)%6],ce=o[2*(I+2)%6],fe=o[(2*(I+2)+1)%6],_e=Z-E,Ie=K-G,Le=_e===0,Oe=Ie===0,vt=(m-G)/Ie,tt=(_-G)/Ie,at=Math.min(vt,tt),Mt=Math.max(vt,tt);if(!Oe&&(at>=1||Mt<=0)||Oe&&(G<m||G>_)){K>=m&&K<=_&&b.push(u[(I+1)%3]);continue}!Oe&&at>0&&b.push(this._vertexToIndex(E+_e*at,G+Ie*at));const Dt=E+_e*Math.max(at,0),qt=E+_e*Math.min(Mt,1);Le||this._generateIntraEdgeVertices(b,E,G,Z,K,Dt,qt),!Oe&&Mt<1&&b.push(this._vertexToIndex(E+_e*Mt,G+Ie*Mt)),(Oe||K>=m&&K<=_)&&b.push(u[(I+1)%3]),!Oe&&(K<=m||K>=_)&&this._generateInterEdgeVertices(b,E,G,Z,K,ce,fe,qt,m,_)}return b}_generateIntraEdgeVertices(n,o,u,m,_,b,I){const E=m-o,G=_-u,Z=G===0,K=Z?Math.min(o,m):Math.min(b,I),ce=Z?Math.max(o,m):Math.max(b,I),fe=Math.floor(K/this._granularityCellSize)+1,_e=Math.ceil(ce/this._granularityCellSize)-1;if(Z?o<m:b<I)for(let Ie=fe;Ie<=_e;Ie++){const Le=Ie*this._granularityCellSize;n.push(this._vertexToIndex(Le,u+G*(Le-o)/E))}else for(let Ie=_e;Ie>=fe;Ie--){const Le=Ie*this._granularityCellSize;n.push(this._vertexToIndex(Le,u+G*(Le-o)/E))}}_generateInterEdgeVertices(n,o,u,m,_,b,I,E,G,Z){const K=_-u,ce=b-m,fe=I-_,_e=(G-_)/fe,Ie=(Z-_)/fe,Le=Math.min(_e,Ie),Oe=Math.max(_e,Ie),vt=m+ce*Le;let tt=Math.floor(Math.min(vt,E)/this._granularityCellSize)+1,at=Math.ceil(Math.max(vt,E)/this._granularityCellSize)-1,Mt=E<vt;const Dt=fe===0;if(Dt&&(I===G||I===Z))return;if(Dt||Le>=1||Oe<=0){const ur=u-I,ir=b+(o-b)*Math.min((G-I)/ur,(Z-I)/ur);tt=Math.floor(Math.min(ir,E)/this._granularityCellSize)+1,at=Math.ceil(Math.max(ir,E)/this._granularityCellSize)-1,Mt=E<ir}const qt=K>0?Z:G;if(Mt)for(let ur=tt;ur<=at;ur++)n.push(this._vertexToIndex(ur*this._granularityCellSize,qt));else for(let ur=at;ur>=tt;ur--)n.push(this._vertexToIndex(ur*this._granularityCellSize,qt))}_generateOutline(n){const o=[];for(const u of n){const m=Vc(u,this._granularity,!0),_=this._pointArrayToIndices(m),b=[];for(let I=1;I<_.length;I++)b.push(_[I-1]),b.push(_[I]);o.push(b)}return o}_handlePoles(n){let o=!1,u=!1;this._canonical&&(this._canonical.y===0&&(o=!0),this._canonical.y===(1<<this._canonical.z)-1&&(u=!0)),(o||u)&&this._fillPoles(n,o,u)}_ensureNoPoleVertices(){const n=this._vertexBuffer;for(let o=0;o<n.length;o+=2){const u=n[o+1];u===su&&(n[o+1]=-32767),u===af&&(n[o+1]=32766)}}_generatePoleQuad(n,o,u,m,_,b){m>_!=(b===su)?(n.push(o),n.push(u),n.push(this._vertexToIndex(m,b)),n.push(u),n.push(this._vertexToIndex(_,b)),n.push(this._vertexToIndex(m,b))):(n.push(u),n.push(o),n.push(this._vertexToIndex(m,b)),n.push(this._vertexToIndex(_,b)),n.push(u),n.push(this._vertexToIndex(m,b)))}_fillPoles(n,o,u){const m=this._vertexBuffer,_=ye,b=n.length;for(let I=2;I<b;I+=3){const E=n[I-2],G=n[I-1],Z=n[I],K=m[2*E],ce=m[2*E+1],fe=m[2*G],_e=m[2*G+1],Ie=m[2*Z],Le=m[2*Z+1];o&&(ce===0&&_e===0&&this._generatePoleQuad(n,E,G,K,fe,su),_e===0&&Le===0&&this._generatePoleQuad(n,G,Z,fe,Ie,su),Le===0&&ce===0&&this._generatePoleQuad(n,Z,E,Ie,K,su)),u&&(ce===_&&_e===_&&this._generatePoleQuad(n,E,G,K,fe,af),_e===_&&Le===_&&this._generatePoleQuad(n,G,Z,fe,Ie,af),Le===_&&ce===_&&this._generatePoleQuad(n,Z,E,Ie,K,af))}}_initializeVertices(n){for(let o=0;o<n.length;o+=2)this._vertexToIndex(n[o],n[o+1])}subdividePolygonInternal(n,o){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:u,holeIndices:m}=function(I){const E=[],G=[];for(const Z of I)if(Z.length!==0){Z!==I[0]&&E.push(G.length/2);for(let K=0;K<Z.length;K++)G.push(Z[K].x),G.push(Z[K].y)}return{flattened:G,holeIndices:E}}(n);let _;this._initializeVertices(u);try{const I=function(G,Z,K=2){const ce=Z&&Z.length,fe=ce?Z[0]*K:G.length;let _e=Jb(G,0,fe,K,!0);const Ie=[];if(!_e||_e.next===_e.prev)return Ie;let Le,Oe,vt;if(ce&&(_e=function(tt,at,Mt,Dt){const qt=[];for(let ur=0,ir=at.length;ur<ir;ur++){const cr=Jb(tt,at[ur]*Dt,ur<ir-1?at[ur+1]*Dt:tt.length,Dt,!1);cr===cr.next&&(cr.steiner=!0),qt.push(FM(cr))}qt.sort(RM);for(let ur=0;ur<qt.length;ur++)Mt=LM(qt[ur],Mt);return Mt}(G,Z,_e,K)),G.length>80*K){Le=G[0],Oe=G[1];let tt=Le,at=Oe;for(let Mt=K;Mt<fe;Mt+=K){const Dt=G[Mt],qt=G[Mt+1];Dt<Le&&(Le=Dt),qt<Oe&&(Oe=qt),Dt>tt&&(tt=Dt),qt>at&&(at=qt)}vt=Math.max(tt-Le,at-Oe),vt=vt!==0?32767/vt:0}return tf(_e,Ie,K,Le,Oe,vt,0),Ie}(u,m),E=this._convertIndices(u,I);_=this._subdivideTrianglesScanline(E)}catch(I){console.error(I)}let b=[];return o&&(b=this._generateOutline(n)),this._ensureNoPoleVertices(),this._handlePoles(_),{verticesFlattened:this._vertexBuffer,indicesTriangles:_,indicesLineList:b}}_convertIndices(n,o){const u=[];for(let m=0;m<o.length;m++)u.push(this._vertexToIndex(n[2*o[m]],n[2*o[m]+1]));return u}_pointArrayToIndices(n){const o=[];for(let u=0;u<n.length;u++){const m=n[u];o.push(this._vertexToIndex(m.x,m.y))}return o}}function iw(l,n,o,u=!0){return new BM(o,n).subdividePolygonInternal(l,u)}function Vc(l,n,o=!1){if(!l||l.length<1)return[];if(l.length<2)return[];const u=l[0],m=l[l.length-1],_=o&&(u.x!==m.x||u.y!==m.y);if(n<2)return _?[...l,l[0]]:[...l];const b=Math.floor(ye/n),I=[];I.push(new w(l[0].x,l[0].y));const E=l.length,G=_?E:E-1;for(let Z=0;Z<G;Z++){const K=l[Z],ce=Z<E-1?l[Z+1]:l[0],fe=K.x,_e=K.y,Ie=ce.x,Le=ce.y,Oe=fe!==Ie,vt=_e!==Le;if(!Oe&&!vt)continue;const tt=Ie-fe,at=Le-_e,Mt=Math.abs(tt),Dt=Math.abs(at);let qt=fe,ur=_e;for(;;){const cr=tt>0?(Math.floor(qt/b)+1)*b:(Math.ceil(qt/b)-1)*b,Rr=at>0?(Math.floor(ur/b)+1)*b:(Math.ceil(ur/b)-1)*b,or=Math.abs(qt-cr),hr=Math.abs(ur-Rr),Nt=Math.abs(qt-Ie),Zr=Math.abs(ur-Le),Nr=Oe?or/Mt:Number.POSITIVE_INFINITY,Br=vt?hr/Dt:Number.POSITIVE_INFINITY;if((Nt<=or||!Oe)&&(Zr<=hr||!vt))break;if(Nr<Br&&Oe||!vt){qt=cr,ur+=at*Nr;const Cr=new w(qt,Math.round(ur));I[I.length-1].x===Cr.x&&I[I.length-1].y===Cr.y||I.push(Cr)}else{qt+=tt*Br,ur=Rr;const Cr=new w(Math.round(qt),ur);I[I.length-1].x===Cr.x&&I[I.length-1].y===Cr.y||I.push(Cr)}}const ir=new w(Ie,Le);I[I.length-1].x===ir.x&&I[I.length-1].y===ir.y||I.push(ir)}return I}function GM(l,n,o){if(n.length===0)throw new Error("Subdivision vertex ring is empty.");let u=0,m=l[2*n[0]];for(let E=1;E<n.length;E++){const G=l[2*n[E]];G<m&&(m=G,u=E)}const _=n.length;let b=u,I=(b+1)%_;for(;;){const E=b-1>=0?b-1:_-1,G=(I+1)%_,Z=l[2*n[E]],K=l[2*n[G]],ce=l[2*n[b]],fe=l[2*n[b]+1],_e=l[2*n[I]+1];let Ie=!1;if(Z<K)Ie=!0;else if(Z>K)Ie=!1;else{const Le=_e-fe,Oe=-(l[2*n[I]]-ce),vt=fe<_e?1:-1;((Z-ce)*Le+(l[2*n[E]+1]-fe)*Oe)*vt>((K-ce)*Le+(l[2*n[G]+1]-fe)*Oe)*vt&&(Ie=!0)}if(Ie){const Le=n[E],Oe=n[b],vt=n[I];Le!==Oe&&Le!==vt&&Oe!==vt&&o.push(vt,Oe,Le),b--,b<0&&(b=_-1)}else{const Le=n[G],Oe=n[b],vt=n[I];Le!==Oe&&Le!==vt&&Oe!==vt&&o.push(vt,Oe,Le),I++,I>=_&&(I=0)}if(E===G)break}}function nw(l,n,o,u,m,_,b,I,E){const G=m.length/2,Z=b&&I&&E;if(G<ri.MAX_VERTEX_ARRAY_LENGTH){const K=n.prepareSegment(G,o,u),ce=K.vertexLength;for(let Ie=0;Ie<_.length;Ie+=3)u.emplaceBack(ce+_[Ie],ce+_[Ie+1],ce+_[Ie+2]);let fe,_e;K.vertexLength+=G,K.primitiveLength+=_.length/3,Z&&(_e=b.prepareSegment(G,o,I),fe=_e.vertexLength,_e.vertexLength+=G);for(let Ie=0;Ie<m.length;Ie+=2)l(m[Ie],m[Ie+1]);if(Z)for(let Ie=0;Ie<E.length;Ie++){const Le=E[Ie];for(let Oe=1;Oe<Le.length;Oe+=2)I.emplaceBack(fe+Le[Oe-1],fe+Le[Oe]);_e.primitiveLength+=Le.length/2}}else(function(K,ce,fe,_e,Ie,Le){const Oe=[];for(let Dt=0;Dt<_e.length/2;Dt++)Oe.push(-1);const vt={count:0};let tt=0,at=K.getOrCreateLatestSegment(ce,fe),Mt=at.vertexLength;for(let Dt=2;Dt<Ie.length;Dt+=3){const qt=Ie[Dt-2],ur=Ie[Dt-1],ir=Ie[Dt];let cr=Oe[qt]<tt,Rr=Oe[ur]<tt,or=Oe[ir]<tt;at.vertexLength+((cr?1:0)+(Rr?1:0)+(or?1:0))>ri.MAX_VERTEX_ARRAY_LENGTH&&(at=K.createNewSegment(ce,fe),tt=vt.count,cr=!0,Rr=!0,or=!0,Mt=0);const hr=of(Oe,_e,Le,vt,qt,cr,at),Nt=of(Oe,_e,Le,vt,ur,Rr,at),Zr=of(Oe,_e,Le,vt,ir,or,at);fe.emplaceBack(Mt+hr-tt,Mt+Nt-tt,Mt+Zr-tt),at.primitiveLength++}})(n,o,u,m,_,l),Z&&function(K,ce,fe,_e,Ie,Le){const Oe=[];for(let Dt=0;Dt<_e.length/2;Dt++)Oe.push(-1);const vt={count:0};let tt=0,at=K.getOrCreateLatestSegment(ce,fe),Mt=at.vertexLength;for(let Dt=0;Dt<Ie.length;Dt++){const qt=Ie[Dt];for(let ur=1;ur<Ie[Dt].length;ur+=2){const ir=qt[ur-1],cr=qt[ur];let Rr=Oe[ir]<tt,or=Oe[cr]<tt;at.vertexLength+((Rr?1:0)+(or?1:0))>ri.MAX_VERTEX_ARRAY_LENGTH&&(at=K.createNewSegment(ce,fe),tt=vt.count,Rr=!0,or=!0,Mt=0);const hr=of(Oe,_e,Le,vt,ir,Rr,at),Nt=of(Oe,_e,Le,vt,cr,or,at);fe.emplaceBack(Mt+hr-tt,Mt+Nt-tt),at.primitiveLength++}}}(b,o,I,m,E,l),n.forceNewSegmentOnNextPrepare(),b==null||b.forceNewSegmentOnNextPrepare()}function of(l,n,o,u,m,_,b){if(_){const I=u.count;return o(n[2*m],n[2*m+1]),l[m]=u.count,u.count++,b.vertexLength++,I}return l[m]}class H1{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new kt,this.indexArray=new Fn,this.indexArray2=new en,this.programConfigurations=new Fc(n.layers,n.zoom),this.segments=new ri,this.segments2=new ri,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,u){this.hasDependencies=J0("fill",this.layers,o);const m=this.layers[0].layout.get("fill-sort-key"),_=!m.isConstant(),b=[];for(const{feature:I,id:E,index:G,sourceLayerIndex:Z}of n){const K=this.layers[0]._featureFilter.needGeometry,ce=Bc(I,K);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),ce,u))continue;const fe=_?m.evaluate(ce,{},u,o.availableImages):void 0,_e={id:E,properties:I.properties,type:I.type,sourceLayerIndex:Z,index:G,geometry:K?ce.geometry:Dc(I),patterns:{},sortKey:fe};b.push(_e)}_&&b.sort((I,E)=>I.sortKey-E.sortKey);for(const I of b){const{geometry:E,index:G,sourceLayerIndex:Z}=I;if(this.hasDependencies){const K=O1("fill",this.layers,I,{zoom:this.zoom},o);this.patternFeatures.push(K)}else this.addFeature(I,E,G,u,{},o.subdivisionGranularity);o.featureIndex.insert(n[G].feature,E,G,Z,this.index)}}update(n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,{imagePositions:u})}addFeatures(n,o,u){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,o,u,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,CM),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,o,u,m,_,b){for(const I of vc(o,500)){const E=iw(I,m,b.fill.getGranularityForZoomLevel(m.z)),G=this.layoutVertexArray;nw((Z,K)=>{G.emplaceBack(Z,K)},this.segments,this.layoutVertexArray,this.indexArray,E.verticesFlattened,E.indicesTriangles,this.segments2,this.indexArray2,E.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{imagePositions:_,canonical:m})}}let sw,aw;_r("FillBucket",H1,{omit:["layers","patternFeatures"]});var VM={get paint(){return aw=aw||new ns({"fill-antialias":new Sr(st.paint_fill["fill-antialias"]),"fill-opacity":new Fr(st.paint_fill["fill-opacity"]),"fill-color":new Fr(st.paint_fill["fill-color"]),"fill-outline-color":new Fr(st.paint_fill["fill-outline-color"]),"fill-translate":new Sr(st.paint_fill["fill-translate"]),"fill-translate-anchor":new Sr(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new kc(st.paint_fill["fill-pattern"])})},get layout(){return sw=sw||new ns({"fill-sort-key":new Fr(st.layout_fill["fill-sort-key"])})}};class jM extends ta{constructor(n,o){super(n,VM,o)}recalculate(n,o){super.recalculate(n,o);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new H1(n)}queryRadius(){return K0(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:n,geometry:o,transform:u,pixelsToTileUnits:m}){return Gb($0(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-u.bearingInRadians,m),o)}isTileClipped(){return!0}}const ZM=mn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),OM=mn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:NM}=ZM;class au{constructor(n,o,u,m,_){this.properties={},this.extent=u,this.type=0,this.id=void 0,this._pbf=n,this._geometry=-1,this._keys=m,this._values=_,n.readFields(UM,this,o)}loadGeometry(){const n=this._pbf;n.pos=this._geometry;const o=n.readVarint()+n.pos,u=[];let m,_=1,b=0,I=0,E=0;for(;n.pos<o;){if(b<=0){const G=n.readVarint();_=7&G,b=G>>3}if(b--,_===1||_===2)I+=n.readSVarint(),E+=n.readSVarint(),_===1&&(m&&u.push(m),m=[]),m&&m.push(new w(I,E));else{if(_!==7)throw new Error(`unknown command ${_}`);m&&m.push(m[0].clone())}}return m&&u.push(m),u}bbox(){const n=this._pbf;n.pos=this._geometry;const o=n.readVarint()+n.pos;let u=1,m=0,_=0,b=0,I=1/0,E=-1/0,G=1/0,Z=-1/0;for(;n.pos<o;){if(m<=0){const K=n.readVarint();u=7&K,m=K>>3}if(m--,u===1||u===2)_+=n.readSVarint(),b+=n.readSVarint(),_<I&&(I=_),_>E&&(E=_),b<G&&(G=b),b>Z&&(Z=b);else if(u!==7)throw new Error(`unknown command ${u}`)}return[I,G,E,Z]}toGeoJSON(n,o,u){const m=this.extent*Math.pow(2,u),_=this.extent*n,b=this.extent*o,I=this.loadGeometry();function E(ce){return[360*(ce.x+_)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(ce.y+b)/m)*Math.PI))-90]}function G(ce){return ce.map(E)}let Z;if(this.type===1){const ce=[];for(const _e of I)ce.push(_e[0]);const fe=G(ce);Z=ce.length===1?{type:"Point",coordinates:fe[0]}:{type:"MultiPoint",coordinates:fe}}else if(this.type===2){const ce=I.map(G);Z=ce.length===1?{type:"LineString",coordinates:ce[0]}:{type:"MultiLineString",coordinates:ce}}else{if(this.type!==3)throw new Error("unknown feature type");{const ce=function(_e){const Ie=_e.length;if(Ie<=1)return[_e];const Le=[];let Oe,vt;for(let tt=0;tt<Ie;tt++){const at=HM(_e[tt]);at!==0&&(vt===void 0&&(vt=at<0),vt===at<0?(Oe&&Le.push(Oe),Oe=[_e[tt]]):Oe&&Oe.push(_e[tt]))}return Oe&&Le.push(Oe),Le}(I),fe=[];for(const _e of ce)fe.push(_e.map(G));Z=fe.length===1?{type:"Polygon",coordinates:fe[0]}:{type:"MultiPolygon",coordinates:fe}}}const K={type:"Feature",geometry:Z,properties:this.properties};return this.id!=null&&(K.id=this.id),K}}function UM(l,n,o){l===1?n.id=o.readVarint():l===2?function(u,m){const _=u.readVarint()+u.pos;for(;u.pos<_;){const b=m._keys[u.readVarint()],I=m._values[u.readVarint()];m.properties[b]=I}}(o,n):l===3?n.type=o.readVarint():l===4&&(n._geometry=o.pos)}function HM(l){let n=0;for(let o,u,m=0,_=l.length,b=_-1;m<_;b=m++)o=l[m],u=l[b],n+=(u.x-o.x)*(o.y+u.y);return n}au.types=["Unknown","Point","LineString","Polygon"];class ow{constructor(n,o){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(WM,this,o),this.length=this._features.length}feature(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];const o=this._pbf.readVarint()+this._pbf.pos;return new au(this._pbf,o,this.extent,this._keys,this._values)}}function WM(l,n,o){l===15?n.version=o.readVarint():l===1?n.name=o.readString():l===5?n.extent=o.readVarint():l===2?n._features.push(o.pos):l===3?n._keys.push(o.readString()):l===4&&n._values.push(function(u){let m=null;const _=u.readVarint()+u.pos;for(;u.pos<_;){const b=u.readVarint()>>3;m=b===1?u.readString():b===2?u.readFloat():b===3?u.readDouble():b===4?u.readVarint64():b===5?u.readVarint():b===6?u.readSVarint():b===7?u.readBoolean():null}if(m==null)throw new Error("unknown feature value");return m}(o))}class lw{constructor(n,o){this.layers=n.readFields(XM,{},o)}}function XM(l,n,o){if(l===3){const u=new ow(o,o.readVarint()+o.pos);u.length&&(n[u.name]=u)}}const W1=Math.pow(2,13);function lf(l,n,o,u,m,_,b,I){l.emplaceBack(n,o,2*Math.floor(u*W1)+b,m*W1*2,_*W1*2,Math.round(I))}class X1{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasDependencies=!1,this.layoutVertexArray=new er,this.centroidVertexArray=new xt,this.indexArray=new Fn,this.programConfigurations=new Fc(n.layers,n.zoom),this.segments=new ri,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,u){this.features=[],this.hasDependencies=J0("fill-extrusion",this.layers,o);for(const{feature:m,id:_,index:b,sourceLayerIndex:I}of n){const E=this.layers[0]._featureFilter.needGeometry,G=Bc(m,E);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),G,u))continue;const Z={id:_,sourceLayerIndex:I,index:b,geometry:E?G.geometry:Dc(m),properties:m.properties,type:m.type,patterns:{}};this.hasDependencies?this.features.push(O1("fill-extrusion",this.layers,Z,{zoom:this.zoom},o)):this.addFeature(Z,Z.geometry,b,u,{},o.subdivisionGranularity),o.featureIndex.insert(m,Z.geometry,b,I,this.index,!0)}}addFeatures(n,o,u){for(const m of this.features){const{geometry:_}=m;this.addFeature(m,_,m.index,o,u,n.subdivisionGranularity)}}update(n,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,{imagePositions:u})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,NM),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,OM.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,o,u,m,_,b){for(const I of vc(o,500)){const E={x:0,y:0,sampleCount:0},G=this.layoutVertexArray.length;this.processPolygon(E,m,n,I,b);const Z=this.layoutVertexArray.length-G,K=Math.floor(E.x/E.sampleCount),ce=Math.floor(E.y/E.sampleCount);for(let fe=0;fe<Z;fe++)this.centroidVertexArray.emplaceBack(K,ce)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{imagePositions:_,canonical:m})}processPolygon(n,o,u,m,_){if(m.length<1||cw(m[0]))return;for(const K of m)K.length!==0&&qM(n,K);const b={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},I=_.fill.getGranularityForZoomLevel(o.z),E=au.types[u.type]==="Polygon";for(const K of m){if(K.length===0||cw(K))continue;const ce=Vc(K,I,E);this._generateSideFaces(ce,b)}if(!E)return;const G=iw(m,o,I,!1),Z=this.layoutVertexArray;nw((K,ce)=>{lf(Z,K,ce,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,G.verticesFlattened,G.indicesTriangles)}_generateSideFaces(n,o){let u=0;for(let m=1;m<n.length;m++){const _=n[m],b=n[m-1];if(YM(_,b))continue;o.segment.vertexLength+4>ri.MAX_VERTEX_ARRAY_LENGTH&&(o.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const I=_.sub(b)._perp()._unit(),E=b.dist(_);u+E>32768&&(u=0),lf(this.layoutVertexArray,_.x,_.y,I.x,I.y,0,0,u),lf(this.layoutVertexArray,_.x,_.y,I.x,I.y,0,1,u),u+=E,lf(this.layoutVertexArray,b.x,b.y,I.x,I.y,0,0,u),lf(this.layoutVertexArray,b.x,b.y,I.x,I.y,0,1,u);const G=o.segment.vertexLength;this.indexArray.emplaceBack(G,G+2,G+1),this.indexArray.emplaceBack(G+1,G+2,G+3),o.segment.vertexLength+=4,o.segment.primitiveLength+=2}}}function qM(l,n){for(let o=0;o<n.length;o++){const u=n[o];o===n.length-1&&n[0].x===u.x&&n[0].y===u.y||(l.x+=u.x,l.y+=u.y,l.sampleCount++)}}function YM(l,n){return l.x===n.x&&(l.x<0||l.x>ye)||l.y===n.y&&(l.y<0||l.y>ye)}function cw(l){return l.every(n=>n.x<0)||l.every(n=>n.x>ye)||l.every(n=>n.y<0)||l.every(n=>n.y>ye)}let hw;_r("FillExtrusionBucket",X1,{omit:["layers","features"]});var KM={get paint(){return hw=hw||new ns({"fill-extrusion-opacity":new Sr(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Fr(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Sr(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Sr(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new kc(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Fr(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Fr(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Sr(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class $M extends ta{constructor(n,o){super(n,KM,o)}createBucket(n){return new X1(n)}queryRadius(){return K0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:n,feature:o,featureState:u,geometry:m,transform:_,pixelsToTileUnits:b,pixelPosMatrix:I}){const E=$0(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-_.bearingInRadians,b),G=this.paint.get("fill-extrusion-height").evaluate(o,u),Z=this.paint.get("fill-extrusion-base").evaluate(o,u),K=function(fe,_e){const Ie=[];for(const Le of fe){const Oe=[Le.x,Le.y,0,1];q(Oe,Oe,_e),Ie.push(new w(Oe[0]/Oe[3],Oe[1]/Oe[3]))}return Ie}(E,I),ce=function(fe,_e,Ie,Le){const Oe=[],vt=[],tt=Le[8]*_e,at=Le[9]*_e,Mt=Le[10]*_e,Dt=Le[11]*_e,qt=Le[8]*Ie,ur=Le[9]*Ie,ir=Le[10]*Ie,cr=Le[11]*Ie;for(const Rr of fe){const or=[],hr=[];for(const Nt of Rr){const Zr=Nt.x,Nr=Nt.y,Br=Le[0]*Zr+Le[4]*Nr+Le[12],Cr=Le[1]*Zr+Le[5]*Nr+Le[13],fi=Le[2]*Zr+Le[6]*Nr+Le[14],gn=Le[3]*Zr+Le[7]*Nr+Le[15],Dn=fi+Mt,as=gn+Dt,ia=Br+qt,Es=Cr+ur,Qn=fi+ir,hn=gn+cr,Nn=new w((Br+tt)/as,(Cr+at)/as);Nn.z=Dn/as,or.push(Nn);const es=new w(ia/hn,Es/hn);es.z=Qn/hn,hr.push(es)}Oe.push(or),vt.push(hr)}return[Oe,vt]}(m,Z,G,I);return function(fe,_e,Ie){let Le=1/0;Gb(Ie,_e)&&(Le=uw(Ie,_e[0]));for(let Oe=0;Oe<_e.length;Oe++){const vt=_e[Oe],tt=fe[Oe];for(let at=0;at<vt.length-1;at++){const Mt=vt[at],Dt=[Mt,vt[at+1],tt[at+1],tt[at],Mt];Bb(Ie,Dt)&&(Le=Math.min(Le,uw(Ie,Dt)))}}return Le!==1/0&&Le}(ce[0],ce[1],K)}}function cf(l,n){return l.x*n.x+l.y*n.y}function uw(l,n){if(l.length===1){let o=0;const u=n[o++];let m;for(;!m||u.equals(m);)if(m=n[o++],!m)return 1/0;for(;o<n.length;o++){const _=n[o],b=l[0],I=m.sub(u),E=_.sub(u),G=b.sub(u),Z=cf(I,I),K=cf(I,E),ce=cf(E,E),fe=cf(G,I),_e=cf(G,E),Ie=Z*ce-K*K,Le=(ce*fe-K*_e)/Ie,Oe=(Z*_e-K*fe)/Ie,vt=u.z*(1-Le-Oe)+m.z*Le+_.z*Oe;if(isFinite(vt))return vt}return 1/0}{let o=1/0;for(const u of n)o=Math.min(o,u.z);return o}}const JM=mn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:QM}=JM,eI=mn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:tI}=eI,rI=Math.cos(Math.PI/180*37.5),dw=Math.pow(2,14)/.5;class q1{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Qt,this.layoutVertexArray2=new Ht,this.indexArray=new Fn,this.programConfigurations=new Fc(n.layers,n.zoom),this.segments=new ri,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,u){this.hasDependencies=J0("line",this.layers,o)||this.hasLineDasharray(this.layers);const m=this.layers[0].layout.get("line-sort-key"),_=!m.isConstant(),b=[];for(const{feature:I,id:E,index:G,sourceLayerIndex:Z}of n){const K=this.layers[0]._featureFilter.needGeometry,ce=Bc(I,K);if(!this.layers[0]._featureFilter.filter(new Li(this.zoom),ce,u))continue;const fe=_?m.evaluate(ce,{},u):void 0,_e={id:E,properties:I.properties,type:I.type,sourceLayerIndex:Z,index:G,geometry:K?ce.geometry:Dc(I),patterns:{},dashes:{},sortKey:fe};b.push(_e)}_&&b.sort((I,E)=>I.sortKey-E.sortKey);for(const I of b){const{geometry:E,index:G,sourceLayerIndex:Z}=I;this.hasDependencies?(J0("line",this.layers,o)?O1("line",this.layers,I,{zoom:this.zoom},o):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,I,this.zoom,o),this.patternFeatures.push(I)):this.addFeature(I,E,G,u,{},{},o.subdivisionGranularity),o.featureIndex.insert(n[G].feature,E,G,Z,this.index)}}update(n,o,u,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,{imagePositions:u,dashPositions:m})}addFeatures(n,o,u,m){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,o,u,m,n.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,tI)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,QM),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,o,u,m,_,b,I){const E=this.layers[0].layout,G=E.get("line-join").evaluate(n,{}),Z=E.get("line-cap"),K=E.get("line-miter-limit"),ce=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const fe of o)this.addLine(fe,n,G,Z,K,ce,m,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{imagePositions:_,dashPositions:b,canonical:m})}addLine(n,o,u,m,_,b,I,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,n=Vc(n,I?E.line.getGranularityForZoomLevel(I.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let tt=0;tt<n.length-1;tt++)this.totalDistance+=n[tt].dist(n[tt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const G=au.types[o.type]==="Polygon";let Z=n.length;for(;Z>=2&&n[Z-1].equals(n[Z-2]);)Z--;let K=0;for(;K<Z-1&&n[K].equals(n[K+1]);)K++;if(Z<(G?3:2))return;u==="bevel"&&(_=1.05);const ce=this.overscaling<=16?122880/(512*this.overscaling):0,fe=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray);let _e,Ie,Le,Oe,vt;this.e1=this.e2=-1,G&&(_e=n[Z-2],vt=n[K].sub(_e)._unit()._perp());for(let tt=K;tt<Z;tt++){if(Le=tt===Z-1?G?n[K+1]:void 0:n[tt+1],Le&&n[tt].equals(Le))continue;vt&&(Oe=vt),_e&&(Ie=_e),_e=n[tt],vt=Le?Le.sub(_e)._unit()._perp():Oe,Oe=Oe||vt;let at=Oe.add(vt);at.x===0&&at.y===0||at._unit();const Mt=Oe.x*vt.x+Oe.y*vt.y,Dt=at.x*vt.x+at.y*vt.y,qt=Dt!==0?1/Dt:1/0,ur=2*Math.sqrt(2-2*Dt),ir=Dt<rI&&Ie&&Le,cr=Oe.x*vt.y-Oe.y*vt.x>0;if(ir&&tt>K){const hr=_e.dist(Ie);if(hr>2*ce){const Nt=_e.sub(_e.sub(Ie)._mult(ce/hr)._round());this.updateDistance(Ie,Nt),this.addCurrentVertex(Nt,Oe,0,0,fe),Ie=Nt}}const Rr=Ie&&Le;let or=Rr?u:G?"butt":m;if(Rr&&or==="round"&&(qt<b?or="miter":qt<=2&&(or="fakeround")),or==="miter"&&qt>_&&(or="bevel"),or==="bevel"&&(qt>2&&(or="flipbevel"),qt<_&&(or="miter")),Ie&&this.updateDistance(Ie,_e),or==="miter")at._mult(qt),this.addCurrentVertex(_e,at,0,0,fe);else if(or==="flipbevel"){if(qt>100)at=vt.mult(-1);else{const hr=qt*Oe.add(vt).mag()/Oe.sub(vt).mag();at._perp()._mult(hr*(cr?-1:1))}this.addCurrentVertex(_e,at,0,0,fe),this.addCurrentVertex(_e,at.mult(-1),0,0,fe)}else if(or==="bevel"||or==="fakeround"){const hr=-Math.sqrt(qt*qt-1),Nt=cr?hr:0,Zr=cr?0:hr;if(Ie&&this.addCurrentVertex(_e,Oe,Nt,Zr,fe),or==="fakeround"){const Nr=Math.round(180*ur/Math.PI/20);for(let Br=1;Br<Nr;Br++){let Cr=Br/Nr;if(Cr!==.5){const gn=Cr-.5;Cr+=Cr*gn*(Cr-1)*((1.0904+Mt*(Mt*(3.55645-1.43519*Mt)-3.2452))*gn*gn+(.848013+Mt*(.215638*Mt-1.06021)))}const fi=vt.sub(Oe)._mult(Cr)._add(Oe)._unit()._mult(cr?-1:1);this.addHalfVertex(_e,fi.x,fi.y,!1,cr,0,fe)}}Le&&this.addCurrentVertex(_e,vt,-Nt,-Zr,fe)}else if(or==="butt")this.addCurrentVertex(_e,at,0,0,fe);else if(or==="square"){const hr=Ie?1:-1;this.addCurrentVertex(_e,at,hr,hr,fe)}else or==="round"&&(Ie&&(this.addCurrentVertex(_e,Oe,0,0,fe),this.addCurrentVertex(_e,Oe,1,1,fe,!0)),Le&&(this.addCurrentVertex(_e,vt,-1,-1,fe,!0),this.addCurrentVertex(_e,vt,0,0,fe)));if(ir&&tt<Z-1){const hr=_e.dist(Le);if(hr>2*ce){const Nt=_e.add(Le.sub(_e)._mult(ce/hr)._round());this.updateDistance(_e,Nt),this.addCurrentVertex(Nt,vt,0,0,fe),_e=Nt}}}}addCurrentVertex(n,o,u,m,_,b=!1){const I=o.y*m-o.x,E=-o.y-o.x*m;this.addHalfVertex(n,o.x+o.y*u,o.y-o.x*u,b,!1,u,_),this.addHalfVertex(n,I,E,b,!0,-m,_),this.distance>dw/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,o,u,m,_,b))}addHalfVertex({x:n,y:o},u,m,_,b,I,E){const G=.5*(this.lineClips?this.scaledDistance*(dw-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(_?1:0),(o<<1)+(b?1:0),Math.round(63*u)+128,Math.round(63*m)+128,1+(I===0?0:I<0?-1:1)|(63&G)<<2,G>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Z=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,Z,this.e2),E.primitiveLength++),b?this.e2=Z:this.e1=Z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,o){this.distance+=n.dist(o),this.updateScaledDistance()}hasLineDasharray(n){for(const o of n){const u=o.paint.get("line-dasharray");if(u&&!u.isConstant())return!0}return!1}addLineDashDependencies(n,o,u,m){for(const _ of n){const b=_.paint.get("line-dasharray");if(!b||b.value.kind==="constant")continue;const I=_.layout.get("line-cap")==="round",E={dasharray:b.value.evaluate({zoom:u-1},o,{}),round:I},G={dasharray:b.value.evaluate({zoom:u},o,{}),round:I},Z={dasharray:b.value.evaluate({zoom:u+1},o,{}),round:I},K=`${E.dasharray.join(",")},${E.round}`,ce=`${G.dasharray.join(",")},${G.round}`,fe=`${Z.dasharray.join(",")},${Z.round}`;m.dashDependencies[K]=E,m.dashDependencies[ce]=G,m.dashDependencies[fe]=Z,o.dashes[_.id]={min:K,mid:ce,max:fe}}}}let fw,pw;_r("LineBucket",q1,{omit:["layers","patternFeatures"]});var mw={get paint(){return pw=pw||new ns({"line-opacity":new Fr(st.paint_line["line-opacity"]),"line-color":new Fr(st.paint_line["line-color"]),"line-translate":new Sr(st.paint_line["line-translate"]),"line-translate-anchor":new Sr(st.paint_line["line-translate-anchor"]),"line-width":new Fr(st.paint_line["line-width"]),"line-gap-width":new Fr(st.paint_line["line-gap-width"]),"line-offset":new Fr(st.paint_line["line-offset"]),"line-blur":new Fr(st.paint_line["line-blur"]),"line-dasharray":new kc(st.paint_line["line-dasharray"]),"line-pattern":new kc(st.paint_line["line-pattern"]),"line-gradient":new qh(st.paint_line["line-gradient"])})},get layout(){return fw=fw||new ns({"line-cap":new Sr(st.layout_line["line-cap"]),"line-join":new Fr(st.layout_line["line-join"]),"line-miter-limit":new Sr(st.layout_line["line-miter-limit"]),"line-round-limit":new Sr(st.layout_line["line-round-limit"]),"line-sort-key":new Fr(st.layout_line["line-sort-key"])})}};class iI extends Fr{possiblyEvaluate(n,o){return o=new Li(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(n,o)}evaluate(n,o,u,m){return o=Xt({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(n,o,u,m)}}let rm;class nI extends ta{constructor(n,o){super(n,mw,o),this.gradientVersion=0,rm||(rm=new iI(mw.paint.properties["line-width"].specification),rm.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof yn,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,o){super.recalculate(n,o),this.paint._values["line-floorwidth"]=rm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new q1(n)}queryRadius(n){const o=n,u=gw(ru("line-width",this,o),ru("line-gap-width",this,o)),m=ru("line-offset",this,o);return u/2+Math.abs(m)+K0(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:n,feature:o,featureState:u,geometry:m,transform:_,pixelsToTileUnits:b}){const I=$0(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-_.bearingInRadians,b),E=b/2*gw(this.paint.get("line-width").evaluate(o,u),this.paint.get("line-gap-width").evaluate(o,u)),G=this.paint.get("line-offset").evaluate(o,u);return G&&(m=function(Z,K){const ce=[];for(let fe=0;fe<Z.length;fe++){const _e=Z[fe],Ie=[];for(let Le=0;Le<_e.length;Le++){const Oe=_e[Le-1],vt=_e[Le],tt=_e[Le+1],at=Le===0?new w(0,0):vt.sub(Oe)._unit()._perp(),Mt=Le===_e.length-1?new w(0,0):tt.sub(vt)._unit()._perp(),Dt=at._add(Mt)._unit(),qt=Dt.x*Mt.x+Dt.y*Mt.y;qt!==0&&Dt._mult(1/qt),Ie.push(Dt._mult(K)._add(vt))}ce.push(Ie)}return ce}(m,G*b)),function(Z,K,ce){for(let fe=0;fe<K.length;fe++){const _e=K[fe];if(Z.length>=3){for(let Ie=0;Ie<_e.length;Ie++)if(tu(Z,_e[Ie]))return!0}if(uM(Z,_e,ce))return!0}return!1}(I,m,E)}isTileClipped(){return!0}}function gw(l,n){return n>0?n+2*l:l}const sI=mn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),aI=mn([{name:"a_projected_pos",components:3,type:"Float32"}],4);mn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const oI=mn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);mn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const _w=mn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),lI=mn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function cI(l,n,o){return l.sections.forEach(u=>{u.text=function(m,_,b){const I=_.layout.get("text-transform").evaluate(b,{});return I==="uppercase"?m=m.toLocaleUpperCase():I==="lowercase"&&(m=m.toLocaleLowerCase()),eo.applyArabicShaping&&(m=eo.applyArabicShaping(m)),m}(u.text,n,o)}),l}mn([{name:"triangle",components:3,type:"Uint16"}]),mn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),mn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),mn([{type:"Float32",name:"offsetX"}]),mn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),mn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const hf={"!":"ï¸","#":"ï¼",$:"ï¼","%":"ï¼","&":"ï¼","(":"ï¸µ",")":"ï¸¶","*":"ï¼","+":"ï¼",",":"ï¸","-":"ï¸²",".":"ã»","/":"ï¼",":":"ï¸",";":"ï¸","<":"ï¸¿","=":"ï¼",">":"ï¹","?":"ï¸","@":"ï¼ ","[":"ï¹","\\":"ï¼¼","]":"ï¹","^":"ï¼¾",_:"ï¸³","`":"ï½","{":"ï¸·","|":"â","}":"ï¸¸","~":"ï½","Â¢":"ï¿ ","Â£":"ï¿¡","Â¥":"ï¿¥","Â¦":"ï¿¤","Â¬":"ï¿¢","Â¯":"ï¿£","â":"ï¸²","â":"ï¸±","â":"ï¹","â":"ï¹","â":"ï¹","â":"ï¹","â¦":"ï¸","â§":"ã»","â©":"ï¿¦","ã":"ï¸","ã":"ï¸","ã":"ï¸¿","ã":"ï¹","ã":"ï¸½","ã":"ï¸¾","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¸»","ã":"ï¸¼","ã":"ï¸¹","ã":"ï¸º","ã":"ï¸","ã":"ï¸","ï¼":"ï¸","ï¼":"ï¸µ","ï¼":"ï¸¶","ï¼":"ï¸","ï¼":"ï¸²","ï¼":"ã»","ï¼":"ï¸","ï¼":"ï¸","ï¼":"ï¸¿","ï¼":"ï¹","ï¼":"ï¸","ï¼»":"ï¹","ï¼½":"ï¹","ï¼¿":"ï¸³","ï½":"ï¸·","ï½":"â","ï½":"ï¸¸","ï½":"ï¸µ","ï½ ":"ï¸¶","ï½¡":"ï¸","ï½¢":"ï¹","ï½£":"ï¹"};var On=24;const Y1=4294967296,vw=1/Y1,yw=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class K1{constructor(n=new Uint8Array(16)){this.buf=ArrayBuffer.isView(n)?n:new Uint8Array(n),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(n,o,u=this.length){for(;this.pos<u;){const m=this.readVarint(),_=m>>3,b=this.pos;this.type=7&m,n(_,o,this),this.pos===b&&this.skip(m)}return o}readMessage(n,o){return this.readFields(n,o,this.readVarint()+this.pos)}readFixed32(){const n=this.dataView.getUint32(this.pos,!0);return this.pos+=4,n}readSFixed32(){const n=this.dataView.getInt32(this.pos,!0);return this.pos+=4,n}readFixed64(){const n=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Y1;return this.pos+=8,n}readSFixed64(){const n=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Y1;return this.pos+=8,n}readFloat(){const n=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,n}readDouble(){const n=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,n}readVarint(n){const o=this.buf;let u,m;return m=o[this.pos++],u=127&m,m<128?u:(m=o[this.pos++],u|=(127&m)<<7,m<128?u:(m=o[this.pos++],u|=(127&m)<<14,m<128?u:(m=o[this.pos++],u|=(127&m)<<21,m<128?u:(m=o[this.pos],u|=(15&m)<<28,function(_,b,I){const E=I.buf;let G,Z;if(Z=E[I.pos++],G=(112&Z)>>4,Z<128||(Z=E[I.pos++],G|=(127&Z)<<3,Z<128)||(Z=E[I.pos++],G|=(127&Z)<<10,Z<128)||(Z=E[I.pos++],G|=(127&Z)<<17,Z<128)||(Z=E[I.pos++],G|=(127&Z)<<24,Z<128)||(Z=E[I.pos++],G|=(1&Z)<<31,Z<128))return ou(_,G,b);throw new Error("Expected varint not more than 10 bytes")}(u,n,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const n=this.readVarint();return n%2==1?(n+1)/-2:n/2}readBoolean(){return!!this.readVarint()}readString(){const n=this.readVarint()+this.pos,o=this.pos;return this.pos=n,n-o>=12&&yw?yw.decode(this.buf.subarray(o,n)):function(u,m,_){let b="",I=m;for(;I<_;){const E=u[I];let G,Z,K,ce=null,fe=E>239?4:E>223?3:E>191?2:1;if(I+fe>_)break;fe===1?E<128&&(ce=E):fe===2?(G=u[I+1],(192&G)==128&&(ce=(31&E)<<6|63&G,ce<=127&&(ce=null))):fe===3?(G=u[I+1],Z=u[I+2],(192&G)==128&&(192&Z)==128&&(ce=(15&E)<<12|(63&G)<<6|63&Z,(ce<=2047||ce>=55296&&ce<=57343)&&(ce=null))):fe===4&&(G=u[I+1],Z=u[I+2],K=u[I+3],(192&G)==128&&(192&Z)==128&&(192&K)==128&&(ce=(15&E)<<18|(63&G)<<12|(63&Z)<<6|63&K,(ce<=65535||ce>=1114112)&&(ce=null))),ce===null?(ce=65533,fe=1):ce>65535&&(ce-=65536,b+=String.fromCharCode(ce>>>10&1023|55296),ce=56320|1023&ce),b+=String.fromCharCode(ce),I+=fe}return b}(this.buf,o,n)}readBytes(){const n=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,n);return this.pos=n,o}readPackedVarint(n=[],o){const u=this.readPackedEnd();for(;this.pos<u;)n.push(this.readVarint(o));return n}readPackedSVarint(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readSVarint());return n}readPackedBoolean(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readBoolean());return n}readPackedFloat(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readFloat());return n}readPackedDouble(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readDouble());return n}readPackedFixed32(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readFixed32());return n}readPackedSFixed32(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readSFixed32());return n}readPackedFixed64(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readFixed64());return n}readPackedSFixed64(n=[]){const o=this.readPackedEnd();for(;this.pos<o;)n.push(this.readSFixed64());return n}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(n){const o=7&n;if(o===0)for(;this.buf[this.pos++]>127;);else if(o===2)this.pos=this.readVarint()+this.pos;else if(o===5)this.pos+=4;else{if(o!==1)throw new Error(`Unimplemented type: ${o}`);this.pos+=8}}writeTag(n,o){this.writeVarint(n<<3|o)}realloc(n){let o=this.length||16;for(;o<this.pos+n;)o*=2;if(o!==this.length){const u=new Uint8Array(o);u.set(this.buf),this.buf=u,this.dataView=new DataView(u.buffer),this.length=o}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(n){this.realloc(4),this.dataView.setInt32(this.pos,n,!0),this.pos+=4}writeSFixed32(n){this.realloc(4),this.dataView.setInt32(this.pos,n,!0),this.pos+=4}writeFixed64(n){this.realloc(8),this.dataView.setInt32(this.pos,-1&n,!0),this.dataView.setInt32(this.pos+4,Math.floor(n*vw),!0),this.pos+=8}writeSFixed64(n){this.realloc(8),this.dataView.setInt32(this.pos,-1&n,!0),this.dataView.setInt32(this.pos+4,Math.floor(n*vw),!0),this.pos+=8}writeVarint(n){(n=+n||0)>268435455||n<0?function(o,u){let m,_;if(o>=0?(m=o%4294967296|0,_=o/4294967296|0):(m=~(-o%4294967296),_=~(-o/4294967296),4294967295^m?m=m+1|0:(m=0,_=_+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(b,I,E){E.buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,b>>>=7,E.buf[E.pos++]=127&b|128,E.buf[E.pos]=127&(b>>>=7)}(m,0,u),function(b,I){const E=(7&b)<<4;I.buf[I.pos++]|=E|((b>>>=3)?128:0),b&&(I.buf[I.pos++]=127&b|((b>>>=7)?128:0),b&&(I.buf[I.pos++]=127&b|((b>>>=7)?128:0),b&&(I.buf[I.pos++]=127&b|((b>>>=7)?128:0),b&&(I.buf[I.pos++]=127&b|((b>>>=7)?128:0),b&&(I.buf[I.pos++]=127&b)))))}(_,u)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))}writeSVarint(n){this.writeVarint(n<0?2*-n-1:2*n)}writeBoolean(n){this.writeVarint(+n)}writeString(n){n=String(n),this.realloc(4*n.length),this.pos++;const o=this.pos;this.pos=function(m,_,b){for(let I,E,G=0;G<_.length;G++){if(I=_.charCodeAt(G),I>55295&&I<57344){if(!E){I>56319||G+1===_.length?(m[b++]=239,m[b++]=191,m[b++]=189):E=I;continue}if(I<56320){m[b++]=239,m[b++]=191,m[b++]=189,E=I;continue}I=E-55296<<10|I-56320|65536,E=null}else E&&(m[b++]=239,m[b++]=191,m[b++]=189,E=null);I<128?m[b++]=I:(I<2048?m[b++]=I>>6|192:(I<65536?m[b++]=I>>12|224:(m[b++]=I>>18|240,m[b++]=I>>12&63|128),m[b++]=I>>6&63|128),m[b++]=63&I|128)}return b}(this.buf,n,this.pos);const u=this.pos-o;u>=128&&bw(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u}writeFloat(n){this.realloc(4),this.dataView.setFloat32(this.pos,n,!0),this.pos+=4}writeDouble(n){this.realloc(8),this.dataView.setFloat64(this.pos,n,!0),this.pos+=8}writeBytes(n){const o=n.length;this.writeVarint(o),this.realloc(o);for(let u=0;u<o;u++)this.buf[this.pos++]=n[u]}writeRawMessage(n,o){this.pos++;const u=this.pos;n(o,this);const m=this.pos-u;m>=128&&bw(u,m,this),this.pos=u-1,this.writeVarint(m),this.pos+=m}writeMessage(n,o,u){this.writeTag(n,2),this.writeRawMessage(o,u)}writePackedVarint(n,o){o.length&&this.writeMessage(n,hI,o)}writePackedSVarint(n,o){o.length&&this.writeMessage(n,uI,o)}writePackedBoolean(n,o){o.length&&this.writeMessage(n,pI,o)}writePackedFloat(n,o){o.length&&this.writeMessage(n,dI,o)}writePackedDouble(n,o){o.length&&this.writeMessage(n,fI,o)}writePackedFixed32(n,o){o.length&&this.writeMessage(n,mI,o)}writePackedSFixed32(n,o){o.length&&this.writeMessage(n,gI,o)}writePackedFixed64(n,o){o.length&&this.writeMessage(n,_I,o)}writePackedSFixed64(n,o){o.length&&this.writeMessage(n,vI,o)}writeBytesField(n,o){this.writeTag(n,2),this.writeBytes(o)}writeFixed32Field(n,o){this.writeTag(n,5),this.writeFixed32(o)}writeSFixed32Field(n,o){this.writeTag(n,5),this.writeSFixed32(o)}writeFixed64Field(n,o){this.writeTag(n,1),this.writeFixed64(o)}writeSFixed64Field(n,o){this.writeTag(n,1),this.writeSFixed64(o)}writeVarintField(n,o){this.writeTag(n,0),this.writeVarint(o)}writeSVarintField(n,o){this.writeTag(n,0),this.writeSVarint(o)}writeStringField(n,o){this.writeTag(n,2),this.writeString(o)}writeFloatField(n,o){this.writeTag(n,5),this.writeFloat(o)}writeDoubleField(n,o){this.writeTag(n,1),this.writeDouble(o)}writeBooleanField(n,o){this.writeVarintField(n,+o)}}function ou(l,n,o){return o?4294967296*n+(l>>>0):4294967296*(n>>>0)+(l>>>0)}function bw(l,n,o){const u=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));o.realloc(u);for(let m=o.pos-1;m>=l;m--)o.buf[m+u]=o.buf[m]}function hI(l,n){for(let o=0;o<l.length;o++)n.writeVarint(l[o])}function uI(l,n){for(let o=0;o<l.length;o++)n.writeSVarint(l[o])}function dI(l,n){for(let o=0;o<l.length;o++)n.writeFloat(l[o])}function fI(l,n){for(let o=0;o<l.length;o++)n.writeDouble(l[o])}function pI(l,n){for(let o=0;o<l.length;o++)n.writeBoolean(l[o])}function mI(l,n){for(let o=0;o<l.length;o++)n.writeFixed32(l[o])}function gI(l,n){for(let o=0;o<l.length;o++)n.writeSFixed32(l[o])}function _I(l,n){for(let o=0;o<l.length;o++)n.writeFixed64(l[o])}function vI(l,n){for(let o=0;o<l.length;o++)n.writeSFixed64(l[o])}function yI(l,n,o){l===1&&o.readMessage(bI,n)}function bI(l,n,o){if(l===3){const{id:u,bitmap:m,width:_,height:b,left:I,top:E,advance:G}=o.readMessage(wI,{});n.push({id:u,bitmap:new ef({width:_+6,height:b+6},m),metrics:{width:_,height:b,left:I,top:E,advance:G}})}}function wI(l,n,o){l===1?n.id=o.readVarint():l===2?n.bitmap=o.readBytes():l===3?n.width=o.readVarint():l===4?n.height=o.readVarint():l===5?n.left=o.readSVarint():l===6?n.top=o.readSVarint():l===7&&(n.advance=o.readVarint())}function ww(l){let n=0,o=0;for(const b of l)n+=b.w*b.h,o=Math.max(o,b.w);l.sort((b,I)=>I.h-b.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),o),h:1/0}];let m=0,_=0;for(const b of l)for(let I=u.length-1;I>=0;I--){const E=u[I];if(!(b.w>E.w||b.h>E.h)){if(b.x=E.x,b.y=E.y,_=Math.max(_,b.y+b.h),m=Math.max(m,b.x+b.w),b.w===E.w&&b.h===E.h){const G=u.pop();G&&I<u.length&&(u[I]=G)}else b.h===E.h?(E.x+=b.w,E.w-=b.w):b.w===E.w?(E.y+=b.h,E.h-=b.h):(u.push({x:E.x+b.w,y:E.y,w:E.w-b.w,h:b.h}),E.y+=b.h,E.h-=b.h);break}}return{w:m,h:_,fill:n/(m*_)||0}}class $1{constructor(n,{pixelRatio:o,version:u,stretchX:m,stretchY:_,content:b,textFitWidth:I,textFitHeight:E}){this.paddedRect=n,this.pixelRatio=o,this.stretchX=m,this.stretchY=_,this.content=b,this.version=u,this.textFitWidth=I,this.textFitHeight=E}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class xw{constructor(n,o){const u={},m={};this.haveRenderCallbacks=[];const _=[];this.addImages(n,u,_),this.addImages(o,m,_);const{w:b,h:I}=ww(_),E=new Ps({width:b||1,height:I||1});for(const G in n){const Z=n[G],K=u[G].paddedRect;Ps.copy(Z.data,E,{x:0,y:0},{x:K.x+1,y:K.y+1},Z.data)}for(const G in o){const Z=o[G],K=m[G].paddedRect,ce=K.x+1,fe=K.y+1,_e=Z.data.width,Ie=Z.data.height;Ps.copy(Z.data,E,{x:0,y:0},{x:ce,y:fe},Z.data),Ps.copy(Z.data,E,{x:0,y:Ie-1},{x:ce,y:fe-1},{width:_e,height:1}),Ps.copy(Z.data,E,{x:0,y:0},{x:ce,y:fe+Ie},{width:_e,height:1}),Ps.copy(Z.data,E,{x:_e-1,y:0},{x:ce-1,y:fe},{width:1,height:Ie}),Ps.copy(Z.data,E,{x:0,y:0},{x:ce+_e,y:fe},{width:1,height:Ie})}this.image=E,this.iconPositions=u,this.patternPositions=m}addImages(n,o,u){for(const m in n){const _=n[m],b={x:0,y:0,w:_.data.width+2,h:_.data.height+2};u.push(b),o[m]=new $1(b,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(n,o){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in n.updatedImages)this.patchUpdatedImage(this.iconPositions[u],n.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],n.getImage(u),o)}patchUpdatedImage(n,o,u){if(!n||!o||n.version===o.version)return;n.version=o.version;const[m,_]=n.tl;u.update(o.data,void 0,{x:m,y:_})}}var Ll;_r("ImagePosition",$1),_r("ImageAtlas",xw),p.ao=void 0,(Ll=p.ao||(p.ao={}))[Ll.none=0]="none",Ll[Ll.horizontal=1]="horizontal",Ll[Ll.vertical=2]="vertical",Ll[Ll.horizontalOnly=3]="horizontalOnly";class uf{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(n,o,u){const m=new uf;return m.scale=n||1,m.fontStack=o,m.verticalAlign=u||"bottom",m}static forImage(n,o){const u=new uf;return u.imageName=n,u.verticalAlign=o||"bottom",u}}class lu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,o){const u=new lu;for(let m=0;m<n.sections.length;m++){const _=n.sections[m];_.image?u.addImageSection(_):u.addTextSection(_,o)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let o="";for(let u=0;u<n.length;u++){const m=n.charCodeAt(u+1)||null,_=n.charCodeAt(u-1)||null;o+=m&&Ud(m)&&!hf[n[u+1]]||_&&Ud(_)&&!hf[n[u-1]]||!hf[n[u]]?n[u]:hf[n[u]]}return o}(this.text)}trim(){let n=0;for(let u=0;u<this.text.length&&nm[this.text.charCodeAt(u)];u++)n++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&nm[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(n,o),this.sectionIndex=this.sectionIndex.slice(n,o)}substring(n,o){const u=new lu;return u.text=this.text.substring(n,o),u.sectionIndex=this.sectionIndex.slice(n,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,o)=>Math.max(n,this.sections[o].scale),0)}getMaxImageSize(n){let o=0,u=0;for(let m=0;m<this.length();m++){const _=this.getSection(m);if(_.imageName){const b=n[_.imageName];if(!b)continue;const I=b.displaySize;o=Math.max(o,I[0]),u=Math.max(u,I[1])}}return{maxImageWidth:o,maxImageHeight:u}}addTextSection(n,o){this.text+=n.text,this.sections.push(uf.forText(n.scale,n.fontStack||o,n.verticalAlign));const u=this.sections.length-1;for(let m=0;m<n.text.length;++m)this.sectionIndex.push(u)}addImageSection(n){const o=n.image?n.image.name:"";if(o.length===0)return void Yt("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(uf.forImage(o,n.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Yt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function im(l,n,o,u,m,_,b,I,E,G,Z,K,ce,fe,_e){const Ie=lu.fromFeature(l,m);let Le;K===p.ao.vertical&&Ie.verticalizePunctuation();const{processBidirectionalText:Oe,processStyledBidirectionalText:vt}=eo;if(Oe&&Ie.sections.length===1){Le=[];const Mt=Oe(Ie.toString(),J1(Ie,G,_,n,u,fe));for(const Dt of Mt){const qt=new lu;qt.text=Dt,qt.sections=Ie.sections;for(let ur=0;ur<Dt.length;ur++)qt.sectionIndex.push(0);Le.push(qt)}}else if(vt){Le=[];const Mt=vt(Ie.text,Ie.sectionIndex,J1(Ie,G,_,n,u,fe));for(const Dt of Mt){const qt=new lu;qt.text=Dt[0],qt.sectionIndex=Dt[1],qt.sections=Ie.sections,Le.push(qt)}}else Le=function(Mt,Dt){const qt=[],ur=Mt.text;let ir=0;for(const cr of Dt)qt.push(Mt.substring(ir,cr)),ir=cr;return ir<ur.length&&qt.push(Mt.substring(ir,ur.length)),qt}(Ie,J1(Ie,G,_,n,u,fe));const tt=[],at={positionedLines:tt,text:Ie.toString(),top:Z[1],bottom:Z[1],left:Z[0],right:Z[0],writingMode:K,iconsInText:!1,verticalizable:!1};return function(Mt,Dt,qt,ur,ir,cr,Rr,or,hr,Nt,Zr,Nr){let Br=0,Cr=0,fi=0,gn=0;const Dn=or==="right"?1:or==="left"?0:.5,as=On/Nr;let ia=0;for(const hn of ir){hn.trim();const Nn=hn.getMaxScale(),es={positionedGlyphs:[],lineOffset:0};Mt.positionedLines[ia]=es;const ts=es.positionedGlyphs;let ys=0;if(!hn.length()){Cr+=cr,++ia;continue}const na=AI(ur,hn,as);for(let ks=0;ks<hn.length();ks++){const Bn=hn.getSection(ks),Hn=hn.getSectionIndex(ks),Wn=hn.getCharCode(ks),En=TI(hr,Zr,Wn);let rn;if(Bn.imageName){if(Mt.iconsInText=!0,Bn.scale=Bn.scale*as,rn=SI(Bn,En,Nn,na,ur),!rn)continue;ys=Math.max(ys,rn.imageOffset)}else if(rn=CI(Bn,Wn,En,na,Dt,qt),!rn)continue;const{rect:za,metrics:du,baselineOffset:Fa}=rn;ts.push({glyph:Wn,imageName:Bn.imageName,x:Br,y:Cr+Fa+-17,vertical:En,scale:Bn.scale,fontStack:Bn.fontStack,sectionIndex:Hn,metrics:du,rect:za}),En?(Mt.verticalizable=!0,Br+=(Bn.imageName?du.advance:On)*Bn.scale+Nt):Br+=du.advance*Bn.scale+Nt}ts.length!==0&&(fi=Math.max(Br-Nt,fi),PI(ts,0,ts.length-1,Dn)),Br=0,es.lineOffset=Math.max(ys,(Nn-1)*On);const Un=cr*Nn+ys;Cr+=Un,gn=Math.max(Un,gn),++ia}const{horizontalAlign:Es,verticalAlign:Qn}=Q1(Rr);(function(hn,Nn,es,ts,ys,na,Un,ks,Bn){const Hn=(Nn-es)*ys;let Wn=0;Wn=na!==Un?-ks*ts- -17:-ts*Bn*Un+.5*Un;for(const En of hn)for(const rn of En.positionedGlyphs)rn.x+=Hn,rn.y+=Wn})(Mt.positionedLines,Dn,Es,Qn,fi,gn,cr,Cr,ir.length),Mt.top+=-Qn*Cr,Mt.bottom=Mt.top+Cr,Mt.left+=-Es*fi,Mt.right=Mt.left+fi}(at,n,o,u,Le,b,I,E,K,G,ce,_e),!function(Mt){for(const Dt of Mt)if(Dt.positionedGlyphs.length!==0)return!1;return!0}(tt)&&at}const nm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},xI={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},MI={40:!0};function Mw(l,n,o,u,m,_){if(n.imageName){const b=u[n.imageName];return b?b.displaySize[0]*n.scale*On/_+m:0}{const b=o[n.fontStack],I=b&&b[l];return I?I.metrics.advance*n.scale+m:0}}function Iw(l,n,o,u){const m=Math.pow(l-n,2);return u?l<n?m/2:2*m:m+Math.abs(o)*o}function II(l,n,o){let u=0;return l===10&&(u-=1e4),o&&(u+=150),l!==40&&l!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function Aw(l,n,o,u,m,_){let b=null,I=Iw(n,o,m,_);for(const E of u){const G=Iw(n-E.x,o,m,_)+E.badness;G<=I&&(b=E,I=G)}return{index:l,x:n,priorBreak:b,badness:I}}function Tw(l){return l?Tw(l.priorBreak).concat(l.index):[]}function J1(l,n,o,u,m,_){if(!l)return[];const b=[],I=function(K,ce,fe,_e,Ie,Le){let Oe=0;for(let vt=0;vt<K.length();vt++){const tt=K.getSection(vt);Oe+=Mw(K.getCharCode(vt),tt,_e,Ie,ce,Le)}return Oe/Math.max(1,Math.ceil(Oe/fe))}(l,n,o,u,m,_),E=l.text.indexOf("â")>=0;let G=0;for(let K=0;K<l.length();K++){const ce=l.getSection(K),fe=l.getCharCode(K);if(nm[fe]||(G+=Mw(fe,ce,u,m,n,_)),K<l.length()-1){const _e=!((Z=fe)<11904)&&(!!li["CJK Compatibility Forms"](Z)||!!li["CJK Compatibility"](Z)||!!li["CJK Strokes"](Z)||!!li["CJK Symbols and Punctuation"](Z)||!!li["Enclosed CJK Letters and Months"](Z)||!!li["Halfwidth and Fullwidth Forms"](Z)||!!li["Ideographic Description Characters"](Z)||!!li["Vertical Forms"](Z)||Z0.test(String.fromCodePoint(Z)));(xI[fe]||_e||ce.imageName||K!==l.length()-2&&MI[l.getCharCode(K+1)])&&b.push(Aw(K+1,G,I,b,II(fe,l.getCharCode(K+1),_e&&E),!1))}}var Z;return Tw(Aw(l.length(),G,I,b,0,!0))}function Q1(l){let n=.5,o=.5;switch(l){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:n,verticalAlign:o}}function AI(l,n,o){const u=n.getMaxScale()*On,{maxImageWidth:m,maxImageHeight:_}=n.getMaxImageSize(l),b=Math.max(u,_*o);return{verticalLineContentWidth:Math.max(u,m*o),horizontalLineContentHeight:b}}function Cw(l){switch(l){case"top":return 0;case"center":return .5;default:return 1}}function TI(l,n,o){return!(l===p.ao.horizontal||!n&&!Nd(o)||n&&(nm[o]||(u=o,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(u)))));var u}function CI(l,n,o,u,m,_){const b=_[l.fontStack],I=function(G,Z,K,ce){if(G&&G.rect)return G;const fe=Z[K.fontStack],_e=fe&&fe[ce];return _e?{rect:null,metrics:_e.metrics}:null}(b&&b[n],m,l,n);if(I===null)return null;let E;if(o)E=u.verticalLineContentWidth-l.scale*On;else{const G=Cw(l.verticalAlign);E=(u.horizontalLineContentHeight-l.scale*On)*G}return{rect:I.rect,metrics:I.metrics,baselineOffset:E}}function SI(l,n,o,u,m){const _=m[l.imageName];if(!_)return null;const b=_.paddedRect,I=_.displaySize,E={width:I[0],height:I[1],left:1,top:-3,advance:n?I[1]:I[0]};let G;if(n)G=u.verticalLineContentWidth-I[1]*l.scale;else{const Z=Cw(l.verticalAlign);G=(u.horizontalLineContentHeight-I[1]*l.scale)*Z}return{rect:b,metrics:E,baselineOffset:G,imageOffset:(n?I[0]:I[1])*l.scale-On*o}}function PI(l,n,o,u){if(u===0)return;const m=l[o],_=(l[o].x+m.metrics.advance*m.scale)*u;for(let b=n;b<=o;b++)l[b].x-=_}function EI(l,n,o){const{horizontalAlign:u,verticalAlign:m}=Q1(o),_=n[0]-l.displaySize[0]*u,b=n[1]-l.displaySize[1]*m;return{image:l,top:b,bottom:b+l.displaySize[1],left:_,right:_+l.displaySize[0]}}function Sw(l){var n,o;let u=l.left,m=l.top,_=l.right-u,b=l.bottom-m;const I=(n=l.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",E=(o=l.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",G=(l.image.content[2]-l.image.content[0])/(l.image.content[3]-l.image.content[1]);if(E==="proportional"){if(I==="stretchOnly"&&_/b<G||I==="proportional"){const Z=Math.ceil(b*G);u*=Z/_,_=Z}}else if(I==="proportional"&&E==="stretchOnly"&&G!==0&&_/b>G){const Z=Math.ceil(_/G);m*=Z/b,b=Z}return{x1:u,y1:m,x2:u+_,y2:m+b}}function Pw(l,n,o,u,m,_){const b=l.image;let I;if(b.content){const Le=b.content,Oe=b.pixelRatio||1;I=[Le[0]/Oe,Le[1]/Oe,b.displaySize[0]-Le[2]/Oe,b.displaySize[1]-Le[3]/Oe]}const E=n.left*_,G=n.right*_;let Z,K,ce,fe;o==="width"||o==="both"?(fe=m[0]+E-u[3],K=m[0]+G+u[1]):(fe=m[0]+(E+G-b.displaySize[0])/2,K=fe+b.displaySize[0]);const _e=n.top*_,Ie=n.bottom*_;return o==="height"||o==="both"?(Z=m[1]+_e-u[0],ce=m[1]+Ie+u[2]):(Z=m[1]+(_e+Ie-b.displaySize[1])/2,ce=Z+b.displaySize[1]),{image:b,top:Z,right:K,bottom:ce,left:fe,collisionPadding:I}}const il=128,zl=32640;function Ew(l,n){const{expression:o}=n;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Li(l+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:m}=o;let _=0;for(;_<u.length&&u[_]<=l;)_++;_=Math.max(0,_-1);let b=_;for(;b<u.length&&u[b]<l+1;)b++;b=Math.min(u.length-1,b);const I=u[_],E=u[b];return o.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:E,interpolationType:m}:{kind:"camera",minZoom:I,maxZoom:E,minSize:o.evaluate(new Li(I)),maxSize:o.evaluate(new Li(E)),interpolationType:m}}}function e_(l,n,o){let u="never";const m=l.get(n);return m?u=m:l.get(o)&&(u="always"),u}const kI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sm(l,n,o,u,m,_,b,I,E,G,Z,K,ce){const fe=I?Math.min(zl,Math.round(I[0])):0,_e=I?Math.min(zl,Math.round(I[1])):0;l.emplaceBack(n,o,Math.round(32*u),Math.round(32*m),_,b,(fe<<1)+(E?1:0),_e,16*G,16*Z,256*K,256*ce)}function t_(l,n,o){l.emplaceBack(n.x,n.y,o),l.emplaceBack(n.x,n.y,o),l.emplaceBack(n.x,n.y,o),l.emplaceBack(n.x,n.y,o)}function RI(l){for(const n of l.sections)if(Uh(n.text))return!0;return!1}class r_{constructor(n){this.layoutVertexArray=new ki,this.indexArray=new Fn,this.programConfigurations=n,this.segments=new ri,this.dynamicLayoutVertexArray=new Ji,this.opacityVertexArray=new qi,this.hasVisibleVertices=!1,this.placedSymbolArray=new je}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,o,u,m){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,sI.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,aI.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,kI,!0),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}_r("SymbolBuffers",r_);class i_{constructor(n,o,u){this.layoutVertexArray=new n,this.layoutAttributes=o,this.indexArray=new u,this.segments=new ri,this.collisionVertexArray=new Qi}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,oI.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}_r("CollisionBuffers",i_);class cu{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(b=>b.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ew(this.zoom,o["text-size"]),this.iconSizeData=Ew(this.zoom,o["icon-size"]);const u=this.layers[0].layout,m=u.get("symbol-sort-key"),_=u.get("symbol-z-order");this.canOverlap=e_(u,"text-overlap","text-allow-overlap")!=="never"||e_(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(b=>p.ao[b])),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=n.sourceID}createArrays(){this.text=new r_(new Fc(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new r_(new Fc(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new Xe,this.lineVertexArray=new it,this.symbolInstances=new et,this.textAnchorOffsets=new Je}calculateGlyphDependencies(n,o,u,m,_){for(let b=0;b<n.length;b++)if(o[n.charCodeAt(b)]=!0,(u||m)&&_){const I=hf[n.charAt(b)];I&&(o[I.charCodeAt(0)]=!0)}}populate(n,o,u){const m=this.layers[0],_=m.layout,b=_.get("text-font"),I=_.get("text-field"),E=_.get("icon-image"),G=(I.value.kind!=="constant"||I.value.value instanceof cs&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(b.value.kind!=="constant"||b.value.value.length>0),Z=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,K=_.get("symbol-sort-key");if(this.features=[],!G&&!Z)return;const ce=o.iconDependencies,fe=o.glyphDependencies,_e=o.availableImages,Ie=new Li(this.zoom);for(const{feature:Le,id:Oe,index:vt,sourceLayerIndex:tt}of n){const at=m._featureFilter.needGeometry,Mt=Bc(Le,at);if(!m._featureFilter.filter(Ie,Mt,u))continue;let Dt,qt;if(at||(Mt.geometry=Dc(Le)),G){const ir=m.getValueAndResolveTokens("text-field",Mt,u,_e),cr=cs.factory(ir),Rr=this.hasRTLText=this.hasRTLText||RI(cr);(!Rr||eo.getRTLTextPluginStatus()==="unavailable"||Rr&&eo.isParsed())&&(Dt=cI(cr,m,Mt))}if(Z){const ir=m.getValueAndResolveTokens("icon-image",Mt,u,_e);qt=ir instanceof Is?ir:Is.fromString(ir)}if(!Dt&&!qt)continue;const ur=this.sortFeaturesByKey?K.evaluate(Mt,{},u):void 0;if(this.features.push({id:Oe,text:Dt,icon:qt,index:vt,sourceLayerIndex:tt,geometry:Mt.geometry,properties:Le.properties,type:au.types[Le.type],sortKey:ur}),qt&&(ce[qt.name]=!0),Dt){const ir=b.evaluate(Mt,{},u).join(","),cr=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(p.ao.vertical)>=0;for(const Rr of Dt.sections)if(Rr.image)ce[Rr.image.name]=!0;else{const or=Zd(Dt.toString()),hr=Rr.fontStack||ir,Nt=fe[hr]=fe[hr]||{};this.calculateGlyphDependencies(Rr.text,Nt,cr,this.allowVerticalPlacement,or)}}}_.get("symbol-placement")==="line"&&(this.features=function(Le){const Oe={},vt={},tt=[];let at=0;function Mt(ir){tt.push(Le[ir]),at++}function Dt(ir,cr,Rr){const or=vt[ir];return delete vt[ir],vt[cr]=or,tt[or].geometry[0].pop(),tt[or].geometry[0]=tt[or].geometry[0].concat(Rr[0]),or}function qt(ir,cr,Rr){const or=Oe[cr];return delete Oe[cr],Oe[ir]=or,tt[or].geometry[0].shift(),tt[or].geometry[0]=Rr[0].concat(tt[or].geometry[0]),or}function ur(ir,cr,Rr){const or=Rr?cr[0][cr[0].length-1]:cr[0][0];return`${ir}:${or.x}:${or.y}`}for(let ir=0;ir<Le.length;ir++){const cr=Le[ir],Rr=cr.geometry,or=cr.text?cr.text.toString():null;if(!or){Mt(ir);continue}const hr=ur(or,Rr),Nt=ur(or,Rr,!0);if(hr in vt&&Nt in Oe&&vt[hr]!==Oe[Nt]){const Zr=qt(hr,Nt,Rr),Nr=Dt(hr,Nt,tt[Zr].geometry);delete Oe[hr],delete vt[Nt],vt[ur(or,tt[Nr].geometry,!0)]=Nr,tt[Zr].geometry=null}else hr in vt?Dt(hr,Nt,Rr):Nt in Oe?qt(hr,Nt,Rr):(Mt(ir),Oe[hr]=at-1,vt[Nt]=at-1)}return tt.filter(ir=>ir.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Le,Oe)=>Le.sortKey-Oe.sortKey)}update(n,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,o,this.layers,{imagePositions:u}),this.icon.programConfigurations.updatePaintArrays(n,o,this.layers,{imagePositions:u}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,o){const u=this.lineVertexArray.length;if(n.segment!==void 0){let m=n.dist(o[n.segment+1]),_=n.dist(o[n.segment]);const b={};for(let I=n.segment+1;I<o.length;I++)b[I]={x:o[I].x,y:o[I].y,tileUnitDistanceFromAnchor:m},I<o.length-1&&(m+=o[I+1].dist(o[I]));for(let I=n.segment||0;I>=0;I--)b[I]={x:o[I].x,y:o[I].y,tileUnitDistanceFromAnchor:_},I>0&&(_+=o[I-1].dist(o[I]));for(let I=0;I<o.length;I++){const E=b[I];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,o,u,m,_,b,I,E,G,Z,K,ce){const fe=n.indexArray,_e=n.layoutVertexArray,Ie=n.segments.prepareSegment(4*o.length,_e,fe,this.canOverlap?b.sortKey:void 0),Le=this.glyphOffsetArray.length,Oe=Ie.vertexLength,vt=this.allowVerticalPlacement&&I===p.ao.vertical?Math.PI/2:0,tt=b.text&&b.text.sections;for(let at=0;at<o.length;at++){const{tl:Mt,tr:Dt,bl:qt,br:ur,tex:ir,pixelOffsetTL:cr,pixelOffsetBR:Rr,minFontScaleX:or,minFontScaleY:hr,glyphOffset:Nt,isSDF:Zr,sectionIndex:Nr}=o[at],Br=Ie.vertexLength,Cr=Nt[1];sm(_e,E.x,E.y,Mt.x,Cr+Mt.y,ir.x,ir.y,u,Zr,cr.x,cr.y,or,hr),sm(_e,E.x,E.y,Dt.x,Cr+Dt.y,ir.x+ir.w,ir.y,u,Zr,Rr.x,cr.y,or,hr),sm(_e,E.x,E.y,qt.x,Cr+qt.y,ir.x,ir.y+ir.h,u,Zr,cr.x,Rr.y,or,hr),sm(_e,E.x,E.y,ur.x,Cr+ur.y,ir.x+ir.w,ir.y+ir.h,u,Zr,Rr.x,Rr.y,or,hr),t_(n.dynamicLayoutVertexArray,E,vt),fe.emplaceBack(Br,Br+2,Br+1),fe.emplaceBack(Br+1,Br+2,Br+3),Ie.vertexLength+=4,Ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Nt[0]),at!==o.length-1&&Nr===o[at+1].sectionIndex||n.programConfigurations.populatePaintArrays(_e.length,b,b.index,{imagePositions:{},canonical:ce,formattedSection:tt&&tt[Nr]})}n.placedSymbolArray.emplaceBack(E.x,E.y,Le,this.glyphOffsetArray.length-Le,Oe,G,Z,E.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],I,0,!1,0,K)}_addCollisionDebugVertex(n,o,u,m,_,b){return o.emplaceBack(0,0),n.emplaceBack(u.x,u.y,m,_,Math.round(b.x),Math.round(b.y))}addCollisionDebugVertices(n,o,u,m,_,b,I){const E=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),G=E.vertexLength,Z=_.layoutVertexArray,K=_.collisionVertexArray,ce=I.anchorX,fe=I.anchorY;this._addCollisionDebugVertex(Z,K,b,ce,fe,new w(n,o)),this._addCollisionDebugVertex(Z,K,b,ce,fe,new w(u,o)),this._addCollisionDebugVertex(Z,K,b,ce,fe,new w(u,m)),this._addCollisionDebugVertex(Z,K,b,ce,fe,new w(n,m)),E.vertexLength+=4;const _e=_.indexArray;_e.emplaceBack(G,G+1),_e.emplaceBack(G+1,G+2),_e.emplaceBack(G+2,G+3),_e.emplaceBack(G+3,G),E.primitiveLength+=4}addDebugCollisionBoxes(n,o,u,m){for(let _=n;_<o;_++){const b=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(b.x1,b.y1,b.x2,b.y2,m?this.textCollisionBox:this.iconCollisionBox,b.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new i_(an,_w.members,en),this.iconCollisionBox=new i_(an,_w.members,en);for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(n,o,u,m,_,b,I,E,G){const Z={};for(let K=o;K<u;K++){const ce=n.get(K);Z.textBox={x1:ce.x1,y1:ce.y1,x2:ce.x2,y2:ce.y2,anchorPointX:ce.anchorPointX,anchorPointY:ce.anchorPointY},Z.textFeatureIndex=ce.featureIndex;break}for(let K=m;K<_;K++){const ce=n.get(K);Z.verticalTextBox={x1:ce.x1,y1:ce.y1,x2:ce.x2,y2:ce.y2,anchorPointX:ce.anchorPointX,anchorPointY:ce.anchorPointY},Z.verticalTextFeatureIndex=ce.featureIndex;break}for(let K=b;K<I;K++){const ce=n.get(K);Z.iconBox={x1:ce.x1,y1:ce.y1,x2:ce.x2,y2:ce.y2,anchorPointX:ce.anchorPointX,anchorPointY:ce.anchorPointY},Z.iconFeatureIndex=ce.featureIndex;break}for(let K=E;K<G;K++){const ce=n.get(K);Z.verticalIconBox={x1:ce.x1,y1:ce.y1,x2:ce.x2,y2:ce.y2,anchorPointX:ce.anchorPointX,anchorPointY:ce.anchorPointY},Z.verticalIconFeatureIndex=ce.featureIndex;break}return Z}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,o){const u=n.placedSymbolArray.get(o),m=u.vertexStartIndex+4*u.numGlyphs;for(let _=u.vertexStartIndex;_<m;_+=4)n.indexArray.emplaceBack(_,_+2,_+1),n.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(n),u=Math.cos(n),m=[],_=[],b=[];for(let I=0;I<this.symbolInstances.length;++I){b.push(I);const E=this.symbolInstances.get(I);m.push(0|Math.round(o*E.anchorX+u*E.anchorY)),_.push(E.featureIndex)}return b.sort((I,E)=>m[I]-m[E]||_[E]-_[I]),b}addToSortKeyRanges(n,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((m,_,b)=>{m>=0&&b.indexOf(m)===_&&this.addIndicesForPlacedSymbol(this.text,m)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let kw,Rw;_r("SymbolBucket",cu,{omit:["layers","collisionBoxArray","features","compareText"]}),cu.MAX_GLYPHS=65535,cu.addDynamicAttributes=t_;var n_={get paint(){return Rw=Rw||new ns({"icon-opacity":new Fr(st.paint_symbol["icon-opacity"]),"icon-color":new Fr(st.paint_symbol["icon-color"]),"icon-halo-color":new Fr(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new Fr(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Fr(st.paint_symbol["icon-halo-blur"]),"icon-translate":new Sr(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new Sr(st.paint_symbol["icon-translate-anchor"]),"text-opacity":new Fr(st.paint_symbol["text-opacity"]),"text-color":new Fr(st.paint_symbol["text-color"],{runtimeType:rt,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Fr(st.paint_symbol["text-halo-color"]),"text-halo-width":new Fr(st.paint_symbol["text-halo-width"]),"text-halo-blur":new Fr(st.paint_symbol["text-halo-blur"]),"text-translate":new Sr(st.paint_symbol["text-translate"]),"text-translate-anchor":new Sr(st.paint_symbol["text-translate-anchor"])})},get layout(){return kw=kw||new ns({"symbol-placement":new Sr(st.layout_symbol["symbol-placement"]),"symbol-spacing":new Sr(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Sr(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Fr(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Sr(st.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Sr(st.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Sr(st.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Sr(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new Sr(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Sr(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new Fr(st.layout_symbol["icon-size"]),"icon-text-fit":new Sr(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Sr(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new Fr(st.layout_symbol["icon-image"]),"icon-rotate":new Fr(st.layout_symbol["icon-rotate"]),"icon-padding":new Fr(st.layout_symbol["icon-padding"]),"icon-keep-upright":new Sr(st.layout_symbol["icon-keep-upright"]),"icon-offset":new Fr(st.layout_symbol["icon-offset"]),"icon-anchor":new Fr(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Sr(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Sr(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Sr(st.layout_symbol["text-rotation-alignment"]),"text-field":new Fr(st.layout_symbol["text-field"]),"text-font":new Fr(st.layout_symbol["text-font"]),"text-size":new Fr(st.layout_symbol["text-size"]),"text-max-width":new Fr(st.layout_symbol["text-max-width"]),"text-line-height":new Sr(st.layout_symbol["text-line-height"]),"text-letter-spacing":new Fr(st.layout_symbol["text-letter-spacing"]),"text-justify":new Fr(st.layout_symbol["text-justify"]),"text-radial-offset":new Fr(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Sr(st.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Fr(st.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Fr(st.layout_symbol["text-anchor"]),"text-max-angle":new Sr(st.layout_symbol["text-max-angle"]),"text-writing-mode":new Sr(st.layout_symbol["text-writing-mode"]),"text-rotate":new Fr(st.layout_symbol["text-rotate"]),"text-padding":new Sr(st.layout_symbol["text-padding"]),"text-keep-upright":new Sr(st.layout_symbol["text-keep-upright"]),"text-transform":new Fr(st.layout_symbol["text-transform"]),"text-offset":new Fr(st.layout_symbol["text-offset"]),"text-allow-overlap":new Sr(st.layout_symbol["text-allow-overlap"]),"text-overlap":new Sr(st.layout_symbol["text-overlap"]),"text-ignore-placement":new Sr(st.layout_symbol["text-ignore-placement"]),"text-optional":new Sr(st.layout_symbol["text-optional"])})}};class Lw{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:ue,this.defaultValue=n}evaluate(n){if(n.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(n.formattedSection))return o.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}_r("FormatSectionOverride",Lw,{omit:["defaultValue"]});class am extends ta{constructor(n,o){super(n,n_,o)}recalculate(n,o){if(super.recalculate(n,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const m=[];for(const _ of u)m.indexOf(_)<0&&m.push(_);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,o,u,m){const _=this.layout.get(n).evaluate(o,{},u,m),b=this._unevaluatedLayout._values[n];return b.isDataDriven()||zh(b.value)||!_?_:function(I,E){return E.replace(/{([^{}]+)}/g,(G,Z)=>I&&Z in I?String(I[Z]):"")}(o.properties,_)}createBucket(n){return new cu(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of n_.paint.overridableProperties){if(!am.hasPaintOverride(this.layout,n))continue;const o=this.paint.get(n),u=new Lw(o),m=new Cd(u,o.property.specification);let _=null;_=o.value.kind==="constant"||o.value.kind==="source"?new Mc("source",m):new Sd("composite",m,o.value.zoomStops),this.paint._values[n]=new _a(o.property,_,o.parameters)}}_handleOverridablePaintPropertyUpdate(n,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&am.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,o){const u=n.get("text-field"),m=n_.paint.properties[o];let _=!1;const b=I=>{for(const E of I)if(m.overrides&&m.overrides.hasOverride(E))return void(_=!0)};if(u.value.kind==="constant"&&u.value.value instanceof cs)b(u.value.value.sections);else if(u.value.kind==="source"||u.value.kind==="composite"){const I=G=>{_||(G instanceof Sa&&jr(G.value)===$t?b(G.value.sections):G instanceof Go?b(G.sections):G.eachChild(I))},E=u.value;E._styleExpression&&I(E._styleExpression.expression)}return _}}let zw;var LI={get paint(){return zw=zw||new ns({"background-color":new Sr(st.paint_background["background-color"]),"background-pattern":new H0(st.paint_background["background-pattern"]),"background-opacity":new Sr(st.paint_background["background-opacity"])})}};class zI extends ta{constructor(n,o){super(n,LI,o)}}let Fw;var FI={get paint(){return Fw=Fw||new ns({"raster-opacity":new Sr(st.paint_raster["raster-opacity"]),"raster-hue-rotate":new Sr(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Sr(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Sr(st.paint_raster["raster-brightness-max"]),"raster-saturation":new Sr(st.paint_raster["raster-saturation"]),"raster-contrast":new Sr(st.paint_raster["raster-contrast"]),"raster-resampling":new Sr(st.paint_raster["raster-resampling"]),"raster-fade-duration":new Sr(st.paint_raster["raster-fade-duration"])})}};class DI extends ta{constructor(n,o){super(n,FI,o)}}class BI extends ta{constructor(n,o){super(n,{},o),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class GI{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const VI={once:!0},s_=63710088e-1;class Fl{constructor(n,o){if(isNaN(n)||isNaN(o))throw new Error(`Invalid LngLat object: (${n}, ${o})`);if(this.lng=+n,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fl(Lt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const o=Math.PI/180,u=this.lat*o,m=n.lat*o,_=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((n.lng-this.lng)*o);return s_*Math.acos(Math.min(_,1))}static convert(n){if(n instanceof Fl)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Fl(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Fl(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Dw=2*Math.PI*s_;function Bw(l){return Dw*Math.cos(l*Math.PI/180)}function Gw(l){return(180+l)/360}function Vw(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function jw(l,n){return l/Bw(n)}function a_(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Zw(l,n){return l*Bw(a_(n))}class df{constructor(n,o,u=0){this.x=+n,this.y=+o,this.z=+u}static fromLngLat(n,o=0){const u=Fl.convert(n);return new df(Gw(u.lng),Vw(u.lat),jw(o,u.lat))}toLngLat(){return new Fl(360*this.x-180,a_(this.y))}toAltitude(){return Zw(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Dw*(n=a_(this.y),1/Math.cos(n*Math.PI/180));var n}}function Ow(l,n,o){var u=2*Math.PI*6378137/256/Math.pow(2,o);return[l*u-2*Math.PI*6378137/2,n*u-2*Math.PI*6378137/2]}class o_{constructor(n,o,u){if(!function(m,_,b){return!(m<0||m>25||b<0||b>=Math.pow(2,m)||_<0||_>=Math.pow(2,m))}(n,o,u))throw new Error(`x=${o}, y=${u}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=o,this.y=u,this.key=hu(0,n,n,o,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,o,u){const m=(b=this.y,I=this.z,E=Ow(256*(_=this.x),256*(b=Math.pow(2,I)-b-1),I),G=Ow(256*(_+1),256*(b+1),I),E[0]+","+E[1]+","+G[0]+","+G[1]);var _,b,I,E,G;const Z=function(K,ce,fe){let _e,Ie="";for(let Le=K;Le>0;Le--)_e=1<<Le-1,Ie+=(ce&_e?1:0)+(fe&_e?2:0);return Ie}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,Z).replace(/{bbox-epsg-3857}/g,m)}isChildOf(n){const o=this.z-n.z;return o>0&&n.x===this.x>>o&&n.y===this.y>>o}getTilePoint(n){const o=Math.pow(2,this.z);return new w((n.x*o-this.x)*ye,(n.y*o-this.y)*ye)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Nw{constructor(n,o){this.wrap=n,this.canonical=o,this.key=hu(n,o.z,o.z,o.x,o.y)}}class ra{constructor(n,o,u,m,_){if(this.terrainRttPosMatrix32f=null,n<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${u}`);this.overscaledZ=n,this.wrap=o,this.canonical=new o_(u,+m,+_),this.key=hu(o,n,u,m,_)}clone(){return new ra(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-n;return n>this.canonical.z?new ra(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ra(n,this.wrap,n,this.canonical.x>>o,this.canonical.y>>o)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(n,o){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-n;return n>this.canonical.z?hu(this.wrap*+o,n,this.canonical.z,this.canonical.x,this.canonical.y):hu(this.wrap*+o,n,n,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(n){if(n.wrap!==this.wrap||this.overscaledZ-n.overscaledZ<=0)return!1;if(n.overscaledZ===0)return this.overscaledZ>0;const o=this.canonical.z-n.canonical.z;return!(o<0)&&n.canonical.x===this.canonical.x>>o&&n.canonical.y===this.canonical.y>>o}children(n){if(this.overscaledZ>=n)return[new ra(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new ra(o,this.wrap,o,u,m),new ra(o,this.wrap,o,u+1,m),new ra(o,this.wrap,o,u,m+1),new ra(o,this.wrap,o,u+1,m+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new ra(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new ra(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Nw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new df(n.x-this.wrap,n.y))}}function hu(l,n,o,u,m){(l*=2)<0&&(l=-1*l-1);const _=1<<o;return(_*_*l+_*m+u).toString(36)+o.toString(36)+n.toString(36)}function ff(l,n){return n?l.properties[n]:l.id}_r("CanonicalTileID",o_),_r("OverscaledTileID",ra,{omit:["terrainRttPosMatrix32f"]});class jc{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(n){return this.minX=Math.min(this.minX,n.x),this.minY=Math.min(this.minY,n.y),this.maxX=Math.max(this.maxX,n.x),this.maxY=Math.max(this.maxY,n.y),this}expandBy(n){return this.minX-=n,this.minY-=n,this.maxX+=n,this.maxY+=n,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(n){return this.expandBy(-n)}map(n){const o=new jc;return o.extend(n(new w(this.minX,this.minY))),o.extend(n(new w(this.maxX,this.minY))),o.extend(n(new w(this.minX,this.maxY))),o.extend(n(new w(this.maxX,this.maxY))),o}static fromPoints(n){const o=new jc;for(const u of n)o.extend(u);return o}contains(n){return n.x>=this.minX&&n.x<=this.maxX&&n.y>=this.minY&&n.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(n){return!this.empty()&&!n.empty()&&n.minX>=this.minX&&n.maxX<=this.maxX&&n.minY>=this.minY&&n.maxY<=this.maxY}intersects(n){return!this.empty()&&!n.empty()&&n.minX<=this.maxX&&n.maxX>=this.minX&&n.minY<=this.maxY&&n.maxY>=this.minY}}class Uw{constructor(n){this._stringToNumber={},this._numberToString=[];for(let o=0;o<n.length;o++){const u=n[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class Hw{constructor(n,o,u,m,_){this.type="Feature",this._vectorTileFeature=n,n._z=o,n._x=u,n._y=m,this.properties=n.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(n[o]=this[o]);return n}}class Ww{constructor(n,o){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Yo(ye,16,0),this.grid3D=new Yo(ye,16,0),this.featureIndexArray=new Et,this.promoteId=o}insert(n,o,u,m,_,b){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,_);const E=b?this.grid3D:this.grid;for(let G=0;G<o.length;G++){const Z=o[G],K=[1/0,1/0,-1/0,-1/0];for(let ce=0;ce<Z.length;ce++){const fe=Z[ce];K[0]=Math.min(K[0],fe.x),K[1]=Math.min(K[1],fe.y),K[2]=Math.max(K[2],fe.x),K[3]=Math.max(K[3],fe.y)}K[0]<ye&&K[1]<ye&&K[2]>=0&&K[3]>=0&&E.insert(I,K[0],K[1],K[2],K[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new lw(new K1(this.rawTileData)).layers,this.sourceLayerCoder=new Uw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,o,u,m){this.loadVTLayers();const _=n.params,b=ye/n.tileSize/n.scale,I=Ho(_.filter,_.globalState),E=n.queryGeometry,G=n.queryPadding*b,Z=jc.fromPoints(E),K=this.grid.query(Z.minX-G,Z.minY-G,Z.maxX+G,Z.maxY+G),ce=jc.fromPoints(n.cameraQueryGeometry).expandBy(G),fe=this.grid3D.query(ce.minX,ce.minY,ce.maxX,ce.maxY,(Le,Oe,vt,tt)=>function(at,Mt,Dt,qt,ur){for(const cr of at)if(Mt<=cr.x&&Dt<=cr.y&&qt>=cr.x&&ur>=cr.y)return!0;const ir=[new w(Mt,Dt),new w(Mt,ur),new w(qt,ur),new w(qt,Dt)];if(at.length>2){for(const cr of ir)if(tu(at,cr))return!0}for(let cr=0;cr<at.length-1;cr++)if(fM(at[cr],at[cr+1],ir))return!0;return!1}(n.cameraQueryGeometry,Le-G,Oe-G,vt+G,tt+G));for(const Le of fe)K.push(Le);K.sort(jI);const _e={};let Ie;for(let Le=0;Le<K.length;Le++){const Oe=K[Le];if(Oe===Ie)continue;Ie=Oe;const vt=this.featureIndexArray.get(Oe);let tt=null;this.loadMatchingFeature(_e,vt.bucketIndex,vt.sourceLayerIndex,vt.featureIndex,I,_.layers,_.availableImages,o,u,m,(at,Mt,Dt)=>(tt||(tt=Dc(at)),Mt.queryIntersectsFeature({queryGeometry:E,feature:at,featureState:Dt,geometry:tt,zoom:this.z,transform:n.transform,pixelsToTileUnits:b,pixelPosMatrix:n.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:n.getElevation})))}return _e}loadMatchingFeature(n,o,u,m,_,b,I,E,G,Z,K){const ce=this.bucketLayerIDs[o];if(b&&!ce.some(Le=>b.has(Le)))return;const fe=this.sourceLayerCoder.decode(u),_e=this.vtLayers[fe].feature(m);if(_.needGeometry){const Le=Bc(_e,!0);if(!_.filter(new Li(this.tileID.overscaledZ),Le,this.tileID.canonical))return}else if(!_.filter(new Li(this.tileID.overscaledZ),_e))return;const Ie=this.getId(_e,fe);for(let Le=0;Le<ce.length;Le++){const Oe=ce[Le];if(b&&!b.has(Oe))continue;const vt=E[Oe];if(!vt)continue;let tt={};Ie&&Z&&(tt=Z.getState(vt.sourceLayer||"_geojsonTileLayer",Ie));const at=Xt({},G[Oe]);at.paint=Xw(at.paint,vt.paint,_e,tt,I),at.layout=Xw(at.layout,vt.layout,_e,tt,I);const Mt=!K||K(_e,vt,tt);if(!Mt)continue;const Dt=new Hw(_e,this.z,this.x,this.y,Ie);Dt.layer=at;let qt=n[Oe];qt===void 0&&(qt=n[Oe]=[]),qt.push({featureIndex:m,feature:Dt,intersectionZ:Mt})}}lookupSymbolFeatures(n,o,u,m,_,b,I,E){const G={};this.loadVTLayers();const Z=Ho(_.filterSpec,_.globalState);for(const K of n)this.loadMatchingFeature(G,u,m,K,Z,b,I,E,o);return G}hasLayer(n){for(const o of this.bucketLayerIDs)for(const u of o)if(n===u)return!0;return!1}getId(n,o){var u;let m=n.id;return this.promoteId&&(m=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((u=n.properties)===null||u===void 0)&&u.cluster)&&this.promoteId&&(m=Number(n.properties.cluster_id))),m}}function Xw(l,n,o,u,m){return dr(l,(_,b)=>{const I=n instanceof Xh?n.get(b):null;return I&&I.evaluate?I.evaluate(o,u,m):I})}function jI(l,n){return n-l}function qw(l,n,o,u,m){const _=[];for(let b=0;b<l.length;b++){const I=l[b];let E;for(let G=0;G<I.length-1;G++){let Z=I[G],K=I[G+1];Z.x<n&&K.x<n||(Z.x<n?Z=new w(n,Z.y+(n-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round():K.x<n&&(K=new w(n,Z.y+(n-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round()),Z.y<o&&K.y<o||(Z.y<o?Z=new w(Z.x+(o-Z.y)/(K.y-Z.y)*(K.x-Z.x),o)._round():K.y<o&&(K=new w(Z.x+(o-Z.y)/(K.y-Z.y)*(K.x-Z.x),o)._round()),Z.x>=u&&K.x>=u||(Z.x>=u?Z=new w(u,Z.y+(u-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round():K.x>=u&&(K=new w(u,Z.y+(u-Z.x)/(K.x-Z.x)*(K.y-Z.y))._round()),Z.y>=m&&K.y>=m||(Z.y>=m?Z=new w(Z.x+(m-Z.y)/(K.y-Z.y)*(K.x-Z.x),m)._round():K.y>=m&&(K=new w(Z.x+(m-Z.y)/(K.y-Z.y)*(K.x-Z.x),m)._round()),E&&Z.equals(E[E.length-1])||(E=[Z],_.push(E)),E.push(K)))))}}return _}_r("FeatureIndex",Ww,{omit:["rawTileData","sourceLayerCoder"]});class Dl extends w{constructor(n,o,u,m){super(n,o),this.angle=u,m!==void 0&&(this.segment=m)}clone(){return new Dl(this.x,this.y,this.angle,this.segment)}}function Yw(l,n,o,u,m){if(n.segment===void 0||o===0)return!0;let _=n,b=n.segment+1,I=0;for(;I>-o/2;){if(b--,b<0)return!1;I-=l[b].dist(_),_=l[b]}I+=l[b].dist(l[b+1]),b++;const E=[];let G=0;for(;I<o/2;){const Z=l[b],K=l[b+1];if(!K)return!1;let ce=l[b-1].angleTo(Z)-Z.angleTo(K);for(ce=Math.abs((ce+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:I,angleDelta:ce}),G+=ce;I-E[0].distance>u;)G-=E.shift().angleDelta;if(G>m)return!1;b++,I+=Z.dist(K)}return!0}function Kw(l){let n=0;for(let o=0;o<l.length-1;o++)n+=l[o].dist(l[o+1]);return n}function $w(l,n,o){return l?.6*n*o:0}function Jw(l,n){return Math.max(l?l.right-l.left:0,n?n.right-n.left:0)}function ZI(l,n,o,u,m,_){const b=$w(o,m,_),I=Jw(o,u)*_;let E=0;const G=Kw(l)/2;for(let Z=0;Z<l.length-1;Z++){const K=l[Z],ce=l[Z+1],fe=K.dist(ce);if(E+fe>G){const _e=(G-E)/fe,Ie=ga.number(K.x,ce.x,_e),Le=ga.number(K.y,ce.y,_e),Oe=new Dl(Ie,Le,ce.angleTo(K),Z);return Oe._round(),!b||Yw(l,Oe,I,b,n)?Oe:void 0}E+=fe}}function OI(l,n,o,u,m,_,b,I,E){const G=$w(u,_,b),Z=Jw(u,m),K=Z*b,ce=l[0].x===0||l[0].x===E||l[0].y===0||l[0].y===E;return n-K<n/4&&(n=K+n/4),Qw(l,ce?n/2*I%n:(Z/2+2*_)*b*I%n,n,G,o,K,ce,!1,E)}function Qw(l,n,o,u,m,_,b,I,E){const G=_/2,Z=Kw(l);let K=0,ce=n-o,fe=[];for(let _e=0;_e<l.length-1;_e++){const Ie=l[_e],Le=l[_e+1],Oe=Ie.dist(Le),vt=Le.angleTo(Ie);for(;ce+o<K+Oe;){ce+=o;const tt=(ce-K)/Oe,at=ga.number(Ie.x,Le.x,tt),Mt=ga.number(Ie.y,Le.y,tt);if(at>=0&&at<E&&Mt>=0&&Mt<E&&ce-G>=0&&ce+G<=Z){const Dt=new Dl(at,Mt,vt,_e);Dt._round(),u&&!Yw(l,Dt,_,u,m)||fe.push(Dt)}}K+=Oe}return I||fe.length||b||(fe=Qw(l,K/2,o,u,m,_,b,!0,E)),fe}function ex(l,n,o,u){const m=[],_=l.image,b=_.pixelRatio,I=_.paddedRect.w-2,E=_.paddedRect.h-2;let G={x1:l.left,y1:l.top,x2:l.right,y2:l.bottom};const Z=_.stretchX||[[0,I]],K=_.stretchY||[[0,E]],ce=(Nt,Zr)=>Nt+Zr[1]-Zr[0],fe=Z.reduce(ce,0),_e=K.reduce(ce,0),Ie=I-fe,Le=E-_e;let Oe=0,vt=fe,tt=0,at=_e,Mt=0,Dt=Ie,qt=0,ur=Le;if(_.content&&u){const Nt=_.content,Zr=Nt[2]-Nt[0],Nr=Nt[3]-Nt[1];(_.textFitWidth||_.textFitHeight)&&(G=Sw(l)),Oe=om(Z,0,Nt[0]),tt=om(K,0,Nt[1]),vt=om(Z,Nt[0],Nt[2]),at=om(K,Nt[1],Nt[3]),Mt=Nt[0]-Oe,qt=Nt[1]-tt,Dt=Zr-vt,ur=Nr-at}const ir=G.x1,cr=G.y1,Rr=G.x2-ir,or=G.y2-cr,hr=(Nt,Zr,Nr,Br)=>{const Cr=lm(Nt.stretch-Oe,vt,Rr,ir),fi=cm(Nt.fixed-Mt,Dt,Nt.stretch,fe),gn=lm(Zr.stretch-tt,at,or,cr),Dn=cm(Zr.fixed-qt,ur,Zr.stretch,_e),as=lm(Nr.stretch-Oe,vt,Rr,ir),ia=cm(Nr.fixed-Mt,Dt,Nr.stretch,fe),Es=lm(Br.stretch-tt,at,or,cr),Qn=cm(Br.fixed-qt,ur,Br.stretch,_e),hn=new w(Cr,gn),Nn=new w(as,gn),es=new w(as,Es),ts=new w(Cr,Es),ys=new w(fi/b,Dn/b),na=new w(ia/b,Qn/b),Un=n*Math.PI/180;if(Un){const Hn=Math.sin(Un),Wn=Math.cos(Un),En=[Wn,-Hn,Hn,Wn];hn._matMult(En),Nn._matMult(En),ts._matMult(En),es._matMult(En)}const ks=Nt.stretch+Nt.fixed,Bn=Zr.stretch+Zr.fixed;return{tl:hn,tr:Nn,bl:ts,br:es,tex:{x:_.paddedRect.x+1+ks,y:_.paddedRect.y+1+Bn,w:Nr.stretch+Nr.fixed-ks,h:Br.stretch+Br.fixed-Bn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ys,pixelOffsetBR:na,minFontScaleX:Dt/b/Rr,minFontScaleY:ur/b/or,isSDF:o}};if(u&&(_.stretchX||_.stretchY)){const Nt=tx(Z,Ie,fe),Zr=tx(K,Le,_e);for(let Nr=0;Nr<Nt.length-1;Nr++){const Br=Nt[Nr],Cr=Nt[Nr+1];for(let fi=0;fi<Zr.length-1;fi++)m.push(hr(Br,Zr[fi],Cr,Zr[fi+1]))}}else m.push(hr({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:E+1}));return m}function om(l,n,o){let u=0;for(const m of l)u+=Math.max(n,Math.min(o,m[1]))-Math.max(n,Math.min(o,m[0]));return u}function tx(l,n,o){const u=[{fixed:-1,stretch:0}];for(const[m,_]of l){const b=u[u.length-1];u.push({fixed:m-b.stretch,stretch:b.stretch}),u.push({fixed:m-b.stretch,stretch:b.stretch+(_-m)})}return u.push({fixed:n+1,stretch:o}),u}function lm(l,n,o,u){return l/n*o+u}function cm(l,n,o,u){return l-n*o/u}_r("Anchor",Dl);class hm{constructor(n,o,u,m,_,b,I,E,G,Z){var K;if(this.boxStartIndex=n.length,G){let ce=b.top,fe=b.bottom;const _e=b.collisionPadding;_e&&(ce-=_e[1],fe+=_e[3]);let Ie=fe-ce;Ie>0&&(Ie=Math.max(10,Ie),this.circleDiameter=Ie)}else{const ce=!((K=b.image)===null||K===void 0)&&K.content&&(b.image.textFitWidth||b.image.textFitHeight)?Sw(b):{x1:b.left,y1:b.top,x2:b.right,y2:b.bottom};ce.y1=ce.y1*I-E[0],ce.y2=ce.y2*I+E[2],ce.x1=ce.x1*I-E[3],ce.x2=ce.x2*I+E[1];const fe=b.collisionPadding;if(fe&&(ce.x1-=fe[0]*I,ce.y1-=fe[1]*I,ce.x2+=fe[2]*I,ce.y2+=fe[3]*I),Z){const _e=new w(ce.x1,ce.y1),Ie=new w(ce.x2,ce.y1),Le=new w(ce.x1,ce.y2),Oe=new w(ce.x2,ce.y2),vt=Z*Math.PI/180;_e._rotate(vt),Ie._rotate(vt),Le._rotate(vt),Oe._rotate(vt),ce.x1=Math.min(_e.x,Ie.x,Le.x,Oe.x),ce.x2=Math.max(_e.x,Ie.x,Le.x,Oe.x),ce.y1=Math.min(_e.y,Ie.y,Le.y,Oe.y),ce.y2=Math.max(_e.y,Ie.y,Le.y,Oe.y)}n.emplaceBack(o.x,o.y,ce.x1,ce.y1,ce.x2,ce.y2,u,m,_)}this.boxEndIndex=n.length}}class NI{constructor(n=[],o=(u,m)=>u<m?-1:u>m?1:0){if(this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:o,compare:u}=this,m=o[n];for(;n>0;){const _=n-1>>1,b=o[_];if(u(m,b)>=0)break;o[n]=b,n=_}o[n]=m}_down(n){const{data:o,compare:u}=this,m=this.length>>1,_=o[n];for(;n<m;){let b=1+(n<<1);const I=b+1;if(I<this.length&&u(o[I],o[b])<0&&(b=I),u(o[b],_)>=0)break;o[n]=o[b],n=b}o[n]=_}}function UI(l,n=1,o=!1){const u=jc.fromPoints(l[0]),m=Math.min(u.width(),u.height());let _=m/2;const b=new NI([],HI),{minX:I,minY:E,maxX:G,maxY:Z}=u;if(m===0)return new w(I,E);for(let fe=I;fe<G;fe+=m)for(let _e=E;_e<Z;_e+=m)b.push(new uu(fe+_,_e+_,_,l));let K=function(fe){let _e=0,Ie=0,Le=0;const Oe=fe[0];for(let vt=0,tt=Oe.length,at=tt-1;vt<tt;at=vt++){const Mt=Oe[vt],Dt=Oe[at],qt=Mt.x*Dt.y-Dt.x*Mt.y;Ie+=(Mt.x+Dt.x)*qt,Le+=(Mt.y+Dt.y)*qt,_e+=3*qt}return new uu(Ie/_e,Le/_e,0,fe)}(l),ce=b.length;for(;b.length;){const fe=b.pop();(fe.d>K.d||!K.d)&&(K=fe,o&&console.log("found best %d after %d probes",Math.round(1e4*fe.d)/1e4,ce)),fe.max-K.d<=n||(_=fe.h/2,b.push(new uu(fe.p.x-_,fe.p.y-_,_,l)),b.push(new uu(fe.p.x+_,fe.p.y-_,_,l)),b.push(new uu(fe.p.x-_,fe.p.y+_,_,l)),b.push(new uu(fe.p.x+_,fe.p.y+_,_,l)),ce+=4)}return o&&(console.log(`num probes: ${ce}`),console.log(`best distance: ${K.d}`)),K.p}function HI(l,n){return n.max-l.max}function uu(l,n,o,u){this.p=new w(l,n),this.h=o,this.d=function(m,_){let b=!1,I=1/0;for(let E=0;E<_.length;E++){const G=_[E];for(let Z=0,K=G.length,ce=K-1;Z<K;ce=Z++){const fe=G[Z],_e=G[ce];fe.y>m.y!=_e.y>m.y&&m.x<(_e.x-fe.x)*(m.y-fe.y)/(_e.y-fe.y)+fe.x&&(b=!b),I=Math.min(I,Vb(m,fe,_e))}}return(b?1:-1)*Math.sqrt(I)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var ss;p.aE=void 0,(ss=p.aE||(p.aE={}))[ss.center=1]="center",ss[ss.left=2]="left",ss[ss.right=3]="right",ss[ss.top=4]="top",ss[ss.bottom=5]="bottom",ss[ss["top-left"]=6]="top-left",ss[ss["top-right"]=7]="top-right",ss[ss["bottom-left"]=8]="bottom-left",ss[ss["bottom-right"]=9]="bottom-right";const l_=Number.POSITIVE_INFINITY;function rx(l,n){return n[1]!==l_?function(o,u,m){let _=0,b=0;switch(u=Math.abs(u),m=Math.abs(m),o){case"top-right":case"top-left":case"top":b=m-7;break;case"bottom-right":case"bottom-left":case"bottom":b=7-m}switch(o){case"top-right":case"bottom-right":case"right":_=-u;break;case"top-left":case"bottom-left":case"left":_=u}return[_,b]}(l,n[0],n[1]):function(o,u){let m=0,_=0;u<0&&(u=0);const b=u/Math.SQRT2;switch(o){case"top-right":case"top-left":_=b-7;break;case"bottom-right":case"bottom-left":_=7-b;break;case"bottom":_=7-u;break;case"top":_=u-7}switch(o){case"top-right":case"bottom-right":m=-b;break;case"top-left":case"bottom-left":m=b;break;case"left":m=u;break;case"right":m=-u}return[m,_]}(l,n[0])}function ix(l,n,o){var u;const m=l.layout,_=(u=m.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(n,{},o);if(_){const I=_.values,E=[];for(let G=0;G<I.length;G+=2){const Z=E[G]=I[G],K=I[G+1].map(ce=>ce*On);Z.startsWith("top")?K[1]-=7:Z.startsWith("bottom")&&(K[1]+=7),E[G+1]=K}return new us(E)}const b=m.get("text-variable-anchor");if(b){let I;I=l._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(n,{},o)*On,l_]:m.get("text-offset").evaluate(n,{},o).map(G=>G*On);const E=[];for(const G of b)E.push(G,rx(G,I));return new us(E)}return null}function c_(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function WI(l,n,o,u,m,_,b,I,E,G,Z,K){let ce=_.textMaxSize.evaluate(n,{});ce===void 0&&(ce=b);const fe=l.layers[0].layout,_e=fe.get("icon-offset").evaluate(n,{},Z),Ie=sx(o.horizontal),Le=b/24,Oe=l.tilePixelRatio*Le,vt=l.tilePixelRatio*ce/24,tt=l.tilePixelRatio*I,at=l.tilePixelRatio*fe.get("symbol-spacing"),Mt=fe.get("text-padding")*l.tilePixelRatio,Dt=function(Nr,Br,Cr,fi=1){const gn=Nr.get("icon-padding").evaluate(Br,{},Cr),Dn=gn&&gn.values;return[Dn[0]*fi,Dn[1]*fi,Dn[2]*fi,Dn[3]*fi]}(fe,n,Z,l.tilePixelRatio),qt=fe.get("text-max-angle")/180*Math.PI,ur=fe.get("text-rotation-alignment")!=="viewport"&&fe.get("symbol-placement")!=="point",ir=fe.get("icon-rotation-alignment")==="map"&&fe.get("symbol-placement")!=="point",cr=fe.get("symbol-placement"),Rr=at/2,or=fe.get("icon-text-fit");let hr;u&&or!=="none"&&(l.allowVerticalPlacement&&o.vertical&&(hr=Pw(u,o.vertical,or,fe.get("icon-text-fit-padding"),_e,Le)),Ie&&(u=Pw(u,Ie,or,fe.get("icon-text-fit-padding"),_e,Le)));const Nt=Z?K.line.getGranularityForZoomLevel(Z.z):1,Zr=(Nr,Br)=>{Br.x<0||Br.x>=ye||Br.y<0||Br.y>=ye||function(Cr,fi,gn,Dn,as,ia,Es,Qn,hn,Nn,es,ts,ys,na,Un,ks,Bn,Hn,Wn,En,rn,za,du,Fa,YI){const fu=Cr.addToLineVertexArray(fi,gn);let Zc,pu,mu,gu,cx=0,hx=0,ux=0,dx=0,__=-1,v_=-1;const nl={};let fx=Ra("");if(Cr.allowVerticalPlacement&&Dn.vertical){const ps=Qn.layout.get("text-rotate").evaluate(rn,{},Fa)+90;mu=new hm(hn,fi,Nn,es,ts,Dn.vertical,ys,na,Un,ps),Es&&(gu=new hm(hn,fi,Nn,es,ts,Es,Bn,Hn,Un,ps))}if(as){const ps=Qn.layout.get("icon-rotate").evaluate(rn,{}),sa=Qn.layout.get("icon-text-fit")!=="none",Oc=ex(as,ps,du,sa),Ba=Es?ex(Es,ps,du,sa):void 0;pu=new hm(hn,fi,Nn,es,ts,as,Bn,Hn,!1,ps),cx=4*Oc.length;const Nc=Cr.iconSizeData;let so=null;Nc.kind==="source"?(so=[il*Qn.layout.get("icon-size").evaluate(rn,{})],so[0]>zl&&Yt(`${Cr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Nc.kind==="composite"&&(so=[il*za.compositeIconSizes[0].evaluate(rn,{},Fa),il*za.compositeIconSizes[1].evaluate(rn,{},Fa)],(so[0]>zl||so[1]>zl)&&Yt(`${Cr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Cr.addSymbols(Cr.icon,Oc,so,En,Wn,rn,p.ao.none,fi,fu.lineStartIndex,fu.lineLength,-1,Fa),__=Cr.icon.placedSymbolArray.length-1,Ba&&(hx=4*Ba.length,Cr.addSymbols(Cr.icon,Ba,so,En,Wn,rn,p.ao.vertical,fi,fu.lineStartIndex,fu.lineLength,-1,Fa),v_=Cr.icon.placedSymbolArray.length-1)}const px=Object.keys(Dn.horizontal);for(const ps of px){const sa=Dn.horizontal[ps];if(!Zc){fx=Ra(sa.text);const Ba=Qn.layout.get("text-rotate").evaluate(rn,{},Fa);Zc=new hm(hn,fi,Nn,es,ts,sa,ys,na,Un,Ba)}const Oc=sa.positionedLines.length===1;if(ux+=nx(Cr,fi,sa,ia,Qn,Un,rn,ks,fu,Dn.vertical?p.ao.horizontal:p.ao.horizontalOnly,Oc?px:[ps],nl,__,za,Fa),Oc)break}Dn.vertical&&(dx+=nx(Cr,fi,Dn.vertical,ia,Qn,Un,rn,ks,fu,p.ao.vertical,["vertical"],nl,v_,za,Fa));const KI=Zc?Zc.boxStartIndex:Cr.collisionBoxArray.length,$I=Zc?Zc.boxEndIndex:Cr.collisionBoxArray.length,JI=mu?mu.boxStartIndex:Cr.collisionBoxArray.length,QI=mu?mu.boxEndIndex:Cr.collisionBoxArray.length,eA=pu?pu.boxStartIndex:Cr.collisionBoxArray.length,tA=pu?pu.boxEndIndex:Cr.collisionBoxArray.length,rA=gu?gu.boxStartIndex:Cr.collisionBoxArray.length,iA=gu?gu.boxEndIndex:Cr.collisionBoxArray.length;let Da=-1;const dm=(ps,sa)=>ps&&ps.circleDiameter?Math.max(ps.circleDiameter,sa):sa;Da=dm(Zc,Da),Da=dm(mu,Da),Da=dm(pu,Da),Da=dm(gu,Da);const mx=Da>-1?1:0;mx&&(Da*=YI/On),Cr.glyphOffsetArray.length>=cu.MAX_GLYPHS&&Yt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),rn.sortKey!==void 0&&Cr.addToSortKeyRanges(Cr.symbolInstances.length,rn.sortKey);const nA=ix(Qn,rn,Fa),[sA,aA]=function(ps,sa){const Oc=ps.length,Ba=sa==null?void 0:sa.values;if((Ba==null?void 0:Ba.length)>0)for(let Nc=0;Nc<Ba.length;Nc+=2){const so=Ba[Nc+1];ps.emplaceBack(p.aE[Ba[Nc]],so[0],so[1])}return[Oc,ps.length]}(Cr.textAnchorOffsets,nA);Cr.symbolInstances.emplaceBack(fi.x,fi.y,nl.right>=0?nl.right:-1,nl.center>=0?nl.center:-1,nl.left>=0?nl.left:-1,nl.vertical||-1,__,v_,fx,KI,$I,JI,QI,eA,tA,rA,iA,Nn,ux,dx,cx,hx,mx,0,ys,Da,sA,aA)}(l,Br,Nr,o,u,m,hr,l.layers[0],l.collisionBoxArray,n.index,n.sourceLayerIndex,l.index,Oe,[Mt,Mt,Mt,Mt],ur,E,tt,Dt,ir,_e,n,_,G,Z,b)};if(cr==="line")for(const Nr of qw(n.geometry,0,0,ye,ye)){const Br=Vc(Nr,Nt),Cr=OI(Br,at,qt,o.vertical||Ie,u,24,vt,l.overscaling,ye);for(const fi of Cr)Ie&&XI(l,Ie.text,Rr,fi)||Zr(Br,fi)}else if(cr==="line-center"){for(const Nr of n.geometry)if(Nr.length>1){const Br=Vc(Nr,Nt),Cr=ZI(Br,qt,o.vertical||Ie,u,24,vt);Cr&&Zr(Br,Cr)}}else if(n.type==="Polygon")for(const Nr of vc(n.geometry,0)){const Br=UI(Nr,16);Zr(Vc(Nr[0],Nt,!0),new Dl(Br.x,Br.y,0))}else if(n.type==="LineString")for(const Nr of n.geometry){const Br=Vc(Nr,Nt);Zr(Br,new Dl(Br[0].x,Br[0].y,0))}else if(n.type==="Point")for(const Nr of n.geometry)for(const Br of Nr)Zr([Br],new Dl(Br.x,Br.y,0))}function nx(l,n,o,u,m,_,b,I,E,G,Z,K,ce,fe,_e){const Ie=function(vt,tt,at,Mt,Dt,qt,ur,ir){const cr=Mt.layout.get("text-rotate").evaluate(qt,{})*Math.PI/180,Rr=[];for(const or of tt.positionedLines)for(const hr of or.positionedGlyphs){if(!hr.rect)continue;const Nt=hr.rect||{};let Zr=4,Nr=!0,Br=1,Cr=0;const fi=(Dt||ir)&&hr.vertical,gn=hr.metrics.advance*hr.scale/2;if(ir&&tt.verticalizable&&(Cr=or.lineOffset/2-(hr.imageName?-(On-hr.metrics.width*hr.scale)/2:(hr.scale-1)*On)),hr.imageName){const Hn=ur[hr.imageName];Nr=Hn.sdf,Br=Hn.pixelRatio,Zr=1/Br}const Dn=Dt?[hr.x+gn,hr.y]:[0,0];let as=Dt?[0,0]:[hr.x+gn+at[0],hr.y+at[1]-Cr],ia=[0,0];fi&&(ia=as,as=[0,0]);const Es=hr.metrics.isDoubleResolution?2:1,Qn=(hr.metrics.left-Zr)*hr.scale-gn+as[0],hn=(-hr.metrics.top-Zr)*hr.scale+as[1],Nn=Qn+Nt.w/Es*hr.scale/Br,es=hn+Nt.h/Es*hr.scale/Br,ts=new w(Qn,hn),ys=new w(Nn,hn),na=new w(Qn,es),Un=new w(Nn,es);if(fi){const Hn=new w(-gn,gn- -17),Wn=-Math.PI/2,En=12-gn,rn=new w(22-En,-(hr.imageName?En:0)),za=new w(...ia);ts._rotateAround(Wn,Hn)._add(rn)._add(za),ys._rotateAround(Wn,Hn)._add(rn)._add(za),na._rotateAround(Wn,Hn)._add(rn)._add(za),Un._rotateAround(Wn,Hn)._add(rn)._add(za)}if(cr){const Hn=Math.sin(cr),Wn=Math.cos(cr),En=[Wn,-Hn,Hn,Wn];ts._matMult(En),ys._matMult(En),na._matMult(En),Un._matMult(En)}const ks=new w(0,0),Bn=new w(0,0);Rr.push({tl:ts,tr:ys,bl:na,br:Un,tex:Nt,writingMode:tt.writingMode,glyphOffset:Dn,sectionIndex:hr.sectionIndex,isSDF:Nr,pixelOffsetTL:ks,pixelOffsetBR:Bn,minFontScaleX:0,minFontScaleY:0})}return Rr}(0,o,I,m,_,b,u,l.allowVerticalPlacement),Le=l.textSizeData;let Oe=null;Le.kind==="source"?(Oe=[il*m.layout.get("text-size").evaluate(b,{})],Oe[0]>zl&&Yt(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Le.kind==="composite"&&(Oe=[il*fe.compositeTextSizes[0].evaluate(b,{},_e),il*fe.compositeTextSizes[1].evaluate(b,{},_e)],(Oe[0]>zl||Oe[1]>zl)&&Yt(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,Ie,Oe,I,_,b,G,n,E.lineStartIndex,E.lineLength,ce,_e);for(const vt of Z)K[vt]=l.text.placedSymbolArray.length-1;return 4*Ie.length}function sx(l){for(const n in l)return l[n];return null}function XI(l,n,o,u){const m=l.compareText;if(n in m){const _=m[n];for(let b=_.length-1;b>=0;b--)if(u.dist(_[b])<o)return!0}else m[n]=[];return m[n].push(u),!1}const ax=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class h_{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(n,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=u>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const _=ax[15&u];if(!_)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(n,2,1),[I]=new Uint32Array(n,4,1);return new h_(I,b,_,n)}constructor(n,o=64,u=Float64Array,m){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const _=ax.indexOf(this.ArrayType),b=2*n*this.ArrayType.BYTES_PER_ELEMENT,I=n*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-I%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${u}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+I+E,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+b+I+E),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+I+E,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=n)}add(n,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=o,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return u_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,o,u,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:b,nodeSize:I}=this,E=[0,_.length-1,0],G=[];for(;E.length;){const Z=E.pop()||0,K=E.pop()||0,ce=E.pop()||0;if(K-ce<=I){for(let Le=ce;Le<=K;Le++){const Oe=b[2*Le],vt=b[2*Le+1];Oe>=n&&Oe<=u&&vt>=o&&vt<=m&&G.push(_[Le])}continue}const fe=ce+K>>1,_e=b[2*fe],Ie=b[2*fe+1];_e>=n&&_e<=u&&Ie>=o&&Ie<=m&&G.push(_[fe]),(Z===0?n<=_e:o<=Ie)&&(E.push(ce),E.push(fe-1),E.push(1-Z)),(Z===0?u>=_e:m>=Ie)&&(E.push(fe+1),E.push(K),E.push(1-Z))}return G}within(n,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:_,nodeSize:b}=this,I=[0,m.length-1,0],E=[],G=u*u;for(;I.length;){const Z=I.pop()||0,K=I.pop()||0,ce=I.pop()||0;if(K-ce<=b){for(let Le=ce;Le<=K;Le++)lx(_[2*Le],_[2*Le+1],n,o)<=G&&E.push(m[Le]);continue}const fe=ce+K>>1,_e=_[2*fe],Ie=_[2*fe+1];lx(_e,Ie,n,o)<=G&&E.push(m[fe]),(Z===0?n-u<=_e:o-u<=Ie)&&(I.push(ce),I.push(fe-1),I.push(1-Z)),(Z===0?n+u>=_e:o+u>=Ie)&&(I.push(fe+1),I.push(K),I.push(1-Z))}return E}}function u_(l,n,o,u,m,_){if(m-u<=o)return;const b=u+m>>1;ox(l,n,b,u,m,_),u_(l,n,o,u,b-1,1-_),u_(l,n,o,b+1,m,1-_)}function ox(l,n,o,u,m,_){for(;m>u;){if(m-u>600){const G=m-u+1,Z=o-u+1,K=Math.log(G),ce=.5*Math.exp(2*K/3),fe=.5*Math.sqrt(K*ce*(G-ce)/G)*(Z-G/2<0?-1:1);ox(l,n,o,Math.max(u,Math.floor(o-Z*ce/G+fe)),Math.min(m,Math.floor(o+(G-Z)*ce/G+fe)),_)}const b=n[2*o+_];let I=u,E=m;for(pf(l,n,u,o),n[2*m+_]>b&&pf(l,n,u,m);I<E;){for(pf(l,n,I,E),I++,E--;n[2*I+_]<b;)I++;for(;n[2*E+_]>b;)E--}n[2*u+_]===b?pf(l,n,u,E):(E++,pf(l,n,E,m)),E<=o&&(u=E+1),o<=E&&(m=E-1)}}function pf(l,n,o,u){d_(l,o,u),d_(n,2*o,2*u),d_(n,2*o+1,2*u+1)}function d_(l,n,o){const u=l[n];l[n]=l[o],l[o]=u}function lx(l,n,o,u){const m=l-o,_=n-u;return m*m+_*_}var f_;p.cx=void 0,(f_=p.cx||(p.cx={})).create="create",f_.load="load",f_.fullLoad="fullLoad";let um=null,mf=[];const p_=1e3/60,m_="loadTime",g_="fullLoadTime",qI={mark(l){performance.mark(l)},frame(l){const n=l;um!=null&&mf.push(n-um),um=n},clearMetrics(){um=null,mf=[],performance.clearMeasures(m_),performance.clearMeasures(g_);for(const l in p.cx)performance.clearMarks(p.cx[l])},getPerformanceMetrics(){performance.measure(m_,p.cx.create,p.cx.load),performance.measure(g_,p.cx.create,p.cx.fullLoad);const l=performance.getEntriesByName(m_)[0].duration,n=performance.getEntriesByName(g_)[0].duration,o=mf.length,u=1/(mf.reduce((_,b)=>_+b,0)/o/1e3),m=mf.filter(_=>_>p_).reduce((_,b)=>_+(b-p_)/p_,0);return{loadTime:l,fullLoadTime:n,fps:u,percentDroppedFrames:m/(o+m)*100,totalFrames:o}}};p.$=ye,p.A=Q,p.B=function([l,n,o]){return n+=90,n*=Math.PI/180,o*=Math.PI/180,{x:l*Math.cos(n)*Math.sin(o),y:l*Math.sin(n)*Math.sin(o),z:l*Math.cos(o)}},p.C=ga,p.D=Sr,p.E=sr,p.F=Li,p.G=S1,p.H=function(l){if(kr==null){const n=l.navigator?l.navigator.userAgent:null;kr=!!l.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return kr},p.I=$1,p.J=class{constructor(l,n){this.target=l,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new GI(()=>this.process()),this.subscription=dn(this.target,"message",o=>this.receive(o),!1),this.globalScope=yr(self)?l:window}registerMessageHandler(l,n){this.messageHandlers[l]=n}sendAsync(l,n){return new Promise((o,u)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10),_=n?dn(n.signal,"abort",()=>{_==null||_.unsubscribe(),delete this.resolveRejects[m];const E={id:m,type:"<cancel>",origin:location.origin,targetMapId:l.targetMapId,sourceMapId:this.mapId};this.target.postMessage(E)},VI):null;this.resolveRejects[m]={resolve:E=>{_==null||_.unsubscribe(),o(E)},reject:E=>{_==null||_.unsubscribe(),u(E)}};const b=[],I=Object.assign(Object.assign({},l),{id:m,sourceMapId:this.mapId,origin:location.origin,data:Ko(l.data,b)});this.target.postMessage(I,{transfer:b})})}receive(l){const n=l.data,o=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[o];const u=this.abortControllers[o];return delete this.abortControllers[o],void(u&&u.abort())}if(yr(self)||n.mustQueue)return this.tasks[o]=n,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,n)}}process(){if(this.taskQueue.length===0)return;const l=this.taskQueue.shift(),n=this.tasks[l];delete this.tasks[l],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(l,n)}processTask(l,n){return s(this,void 0,void 0,function*(){if(n.type==="<response>"){const m=this.resolveRejects[l];return delete this.resolveRejects[l],m?void(n.error?m.reject(kl(n.error)):m.resolve(kl(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(l,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=kl(n.data),u=new AbortController;this.abortControllers[l]=u;try{const m=yield this.messageHandlers[n.type](n.sourceMapId,o,u);this.completeTask(l,null,m)}catch(m){this.completeTask(l,m)}})}completeTask(l,n,o){const u=[];delete this.abortControllers[l];const m={id:l,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?Ko(n):null,data:Ko(o,u)};this.target.postMessage(m,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},p.K=Te,p.L=function(){var l=new Q(16);return Q!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},p.M=function(l,n,o){var u,m,_,b,I,E,G,Z,K,ce,fe,_e,Ie=o[0],Le=o[1],Oe=o[2];return n===l?(l[12]=n[0]*Ie+n[4]*Le+n[8]*Oe+n[12],l[13]=n[1]*Ie+n[5]*Le+n[9]*Oe+n[13],l[14]=n[2]*Ie+n[6]*Le+n[10]*Oe+n[14],l[15]=n[3]*Ie+n[7]*Le+n[11]*Oe+n[15]):(m=n[1],_=n[2],b=n[3],I=n[4],E=n[5],G=n[6],Z=n[7],K=n[8],ce=n[9],fe=n[10],_e=n[11],l[0]=u=n[0],l[1]=m,l[2]=_,l[3]=b,l[4]=I,l[5]=E,l[6]=G,l[7]=Z,l[8]=K,l[9]=ce,l[10]=fe,l[11]=_e,l[12]=u*Ie+I*Le+K*Oe+n[12],l[13]=m*Ie+E*Le+ce*Oe+n[13],l[14]=_*Ie+G*Le+fe*Oe+n[14],l[15]=b*Ie+Z*Le+_e*Oe+n[15]),l},p.N=function(l,n,o){var u=o[0],m=o[1],_=o[2];return l[0]=n[0]*u,l[1]=n[1]*u,l[2]=n[2]*u,l[3]=n[3]*u,l[4]=n[4]*m,l[5]=n[5]*m,l[6]=n[6]*m,l[7]=n[7]*m,l[8]=n[8]*_,l[9]=n[9]*_,l[10]=n[10]*_,l[11]=n[11]*_,l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15],l},p.O=function(l,n,o){var u=n[0],m=n[1],_=n[2],b=n[3],I=n[4],E=n[5],G=n[6],Z=n[7],K=n[8],ce=n[9],fe=n[10],_e=n[11],Ie=n[12],Le=n[13],Oe=n[14],vt=n[15],tt=o[0],at=o[1],Mt=o[2],Dt=o[3];return l[0]=tt*u+at*I+Mt*K+Dt*Ie,l[1]=tt*m+at*E+Mt*ce+Dt*Le,l[2]=tt*_+at*G+Mt*fe+Dt*Oe,l[3]=tt*b+at*Z+Mt*_e+Dt*vt,l[4]=(tt=o[4])*u+(at=o[5])*I+(Mt=o[6])*K+(Dt=o[7])*Ie,l[5]=tt*m+at*E+Mt*ce+Dt*Le,l[6]=tt*_+at*G+Mt*fe+Dt*Oe,l[7]=tt*b+at*Z+Mt*_e+Dt*vt,l[8]=(tt=o[8])*u+(at=o[9])*I+(Mt=o[10])*K+(Dt=o[11])*Ie,l[9]=tt*m+at*E+Mt*ce+Dt*Le,l[10]=tt*_+at*G+Mt*fe+Dt*Oe,l[11]=tt*b+at*Z+Mt*_e+Dt*vt,l[12]=(tt=o[12])*u+(at=o[13])*I+(Mt=o[14])*K+(Dt=o[15])*Ie,l[13]=tt*m+at*E+Mt*ce+Dt*Le,l[14]=tt*_+at*G+Mt*fe+Dt*Oe,l[15]=tt*b+at*Z+Mt*_e+Dt*vt,l},p.P=w,p.Q=function(l,n){const o={};for(let u=0;u<n.length;u++){const m=n[u];m in l&&(o[m]=l[m])}return o},p.R=Ps,p.S=Fl,p.T=Z1,p.U=Vw,p.V=Gw,p.W=j,p.X=ne,p.Y=hi,p.Z=ra,p._=s,p.a=be,p.a$=Be,p.a0=function(l,n){var o,u,m,_,b;if(!l)return n??{};if(!n)return l;let I=Object.assign({},l);if(n.removeAll&&(I={removeAll:!0}),n.remove){const E=new Set(n.remove);I.add&&(I.add=I.add.filter(Z=>!E.has(Z.id))),I.update&&(I.update=I.update.filter(Z=>!E.has(Z.id)));const G=new Set(((o=l.add)!==null&&o!==void 0?o:[]).map(Z=>Z.id));n.remove=n.remove.filter(Z=>!G.has(Z))}if(n.remove){const E=new Set(I.remove?I.remove.concat(n.remove):n.remove);I.remove=Array.from(E.values())}if(n.add){const E=I.add?I.add.concat(n.add):n.add,G=new Map(E.map(Z=>[Z.id,Z]));I.add=Array.from(G.values())}if(n.update){const E=new Map((u=I.update)===null||u===void 0?void 0:u.map(G=>[G.id,G]));for(const G of n.update){const Z=(m=E.get(G.id))!==null&&m!==void 0?m:{id:G.id};G.newGeometry&&(Z.newGeometry=G.newGeometry),G.addOrUpdateProperties&&(Z.addOrUpdateProperties=((_=Z.addOrUpdateProperties)!==null&&_!==void 0?_:[]).concat(G.addOrUpdateProperties)),G.removeProperties&&(Z.removeProperties=((b=Z.removeProperties)!==null&&b!==void 0?b:[]).concat(G.removeProperties)),G.removeAllProperties&&(Z.removeAllProperties=!0),E.set(G.id,Z)}I.update=Array.from(E.values())}return I.remove&&I.add&&(I.remove=I.remove.filter(E=>I.add.findIndex(G=>G.id===E)===-1)),I},p.a1=df,p.a2=jc,p.a3=25,p.a4=o_,p.a5=l=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(o=>{n.onloadstart=()=>{o(n)};for(const u of l){const m=window.document.createElement("source");yt(u)||(n.crossOrigin="Anonymous"),m.src=u,n.appendChild(m)}})},p.a6=he,p.a7=function(){return Jt++},p.a8=Fe,p.a9=cu,p.aA=function(l){let n=1/0,o=1/0,u=-1/0,m=-1/0;for(const _ of l)n=Math.min(n,_.x),o=Math.min(o,_.y),u=Math.max(u,_.x),m=Math.max(m,_.y);return[n,o,u,m]},p.aB=On,p.aC=ge,p.aD=function(l,n,o,u,m=!1){if(!o[0]&&!o[1])return[0,0];const _=m?u==="map"?-l.bearingInRadians:0:u==="viewport"?l.bearingInRadians:0;if(_){const b=Math.sin(_),I=Math.cos(_);o=[o[0]*I-o[1]*b,o[0]*b+o[1]*I]}return[m?o[0]:ge(n,o[0],l.zoom),m?o[1]:ge(n,o[1],l.zoom)]},p.aF=e_,p.aG=c_,p.aH=Q1,p.aI=h_,p.aJ=mn,p.aK=tm,p.aL=xt,p.aM=ri,p.aN=Fn,p.aO=Lt,p.aP=fn,p.aQ=Zw,p.aR=le,p.aS=$,p.aT=function(l){var n=new Q(3);return n[0]=l[0],n[1]=l[1],n[2]=l[2],n},p.aU=function(l,n,o){return l[0]=n[0]-o[0],l[1]=n[1]-o[1],l[2]=n[2]-o[2],l},p.aV=function(l,n){var o=n[0],u=n[1],m=n[2],_=o*o+u*u+m*m;return _>0&&(_=1/Math.sqrt(_)),l[0]=n[0]*_,l[1]=n[1]*_,l[2]=n[2]*_,l},p.aW=Me,p.aX=function(l,n){return l[0]*n[0]+l[1]*n[1]+l[2]*n[2]},p.aY=function(l,n,o){return l[0]=n[0]*o[0],l[1]=n[1]*o[1],l[2]=n[2]*o[2],l[3]=n[3]*o[3],l},p.aZ=ve,p.a_=function(l,n,o){const u=n[0]*o[0]+n[1]*o[1]+n[2]*o[2];return u===0?null:(-(l[0]*o[0]+l[1]*o[1]+l[2]*o[2])-o[3])/u},p.aa=Ho,p.ab=Bc,p.ac=Hw,p.ad=function(l){const n={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,m,_)=>{const b=m||_;return n[u]=!b||b.toLowerCase(),""}),n["max-age"]){const o=parseInt(n["max-age"],10);isNaN(o)?delete n["max-age"]:n["max-age"]=o}return n},p.ae=Xi,p.af=function(l){return Math.pow(2,l)},p.ag=re,p.ah=It,p.ai=85.051129,p.aj=jw,p.ak=function(l){return Math.log(l)/Math.LN2},p.al=function(l){var n=l[0],o=l[1];return n*n+o*o},p.am=function(l,n){const o=[];for(const u in l)u in n||o.push(u);return o},p.an=function(l,n){let o=0,u=0;if(l.kind==="constant")u=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:m,minZoom:_,maxZoom:b}=l,I=m?It($n.interpolationFactor(m,n,_,b),0,1):0;l.kind==="camera"?u=ga.number(l.minSize,l.maxSize,I):o=I}return{uSizeT:o,uSize:u}},p.ap=function(l,{uSize:n,uSizeT:o},{lowerSize:u,upperSize:m}){return l.kind==="source"?u/il:l.kind==="composite"?ga.number(u/il,m/il,o):n},p.aq=function(l,n){var o=n[0],u=n[1],m=n[2],_=n[3],b=n[4],I=n[5],E=n[6],G=n[7],Z=n[8],K=n[9],ce=n[10],fe=n[11],_e=n[12],Ie=n[13],Le=n[14],Oe=n[15],vt=o*I-u*b,tt=o*E-m*b,at=o*G-_*b,Mt=u*E-m*I,Dt=u*G-_*I,qt=m*G-_*E,ur=Z*Ie-K*_e,ir=Z*Le-ce*_e,cr=Z*Oe-fe*_e,Rr=K*Le-ce*Ie,or=K*Oe-fe*Ie,hr=ce*Oe-fe*Le,Nt=vt*hr-tt*or+at*Rr+Mt*cr-Dt*ir+qt*ur;return Nt?(l[0]=(I*hr-E*or+G*Rr)*(Nt=1/Nt),l[1]=(m*or-u*hr-_*Rr)*Nt,l[2]=(Ie*qt-Le*Dt+Oe*Mt)*Nt,l[3]=(ce*Dt-K*qt-fe*Mt)*Nt,l[4]=(E*cr-b*hr-G*ir)*Nt,l[5]=(o*hr-m*cr+_*ir)*Nt,l[6]=(Le*at-_e*qt-Oe*tt)*Nt,l[7]=(Z*qt-ce*at+fe*tt)*Nt,l[8]=(b*or-I*cr+G*ur)*Nt,l[9]=(u*cr-o*or-_*ur)*Nt,l[10]=(_e*Dt-Ie*at+Oe*vt)*Nt,l[11]=(K*at-Z*Dt-fe*vt)*Nt,l[12]=(I*ir-b*Rr-E*ur)*Nt,l[13]=(o*Rr-u*ir+m*ur)*Nt,l[14]=(Ie*tt-_e*Mt-Le*vt)*Nt,l[15]=(Z*Mt-K*tt+ce*vt)*Nt,l):null},p.ar=Ne,p.as=function(l){var n=l[0],o=l[1];return Math.sqrt(n*n+o*o)},p.at=function(l){return l[0]=0,l[1]=0,l},p.au=function(l,n,o){return l[0]=n[0]*o,l[1]=n[1]*o,l},p.av=t_,p.aw=q,p.ax=function(l,n,o,u){const m=n.y-l.y,_=n.x-l.x,b=u.y-o.y,I=u.x-o.x,E=b*_-I*m;if(E===0)return null;const G=(I*(l.y-o.y)-b*(l.x-o.x))/E;return new w(l.x+G*_,l.y+G*m)},p.ay=qw,p.az=Bb,p.b=Tr,p.b$=class extends f{},p.b0=function(l,n,o){return l[0]=n[0]*o,l[1]=n[1]*o,l[2]=n[2]*o,l[3]=n[3]*o,l},p.b1=function(l,n){return l[0]*n[0]+l[1]*n[1]+l[2]*n[2]+l[3]},p.b2=Nw,p.b3=hu,p.b4=function(l,n,o,u,m){var _=1/Math.tan(n/2);if(l[0]=_/o,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=_,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,m!=null&&m!==1/0){var b=1/(u-m);l[10]=(m+u)*b,l[14]=2*m*u*b}else l[10]=-1,l[14]=-2*u;return l},p.b5=function(l){var n=new Q(16);return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],n},p.b6=function(l,n,o){var u=Math.sin(o),m=Math.cos(o),_=n[0],b=n[1],I=n[2],E=n[3],G=n[4],Z=n[5],K=n[6],ce=n[7];return n!==l&&(l[8]=n[8],l[9]=n[9],l[10]=n[10],l[11]=n[11],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15]),l[0]=_*m+G*u,l[1]=b*m+Z*u,l[2]=I*m+K*u,l[3]=E*m+ce*u,l[4]=G*m-_*u,l[5]=Z*m-b*u,l[6]=K*m-I*u,l[7]=ce*m-E*u,l},p.b7=function(l,n,o){var u=Math.sin(o),m=Math.cos(o),_=n[4],b=n[5],I=n[6],E=n[7],G=n[8],Z=n[9],K=n[10],ce=n[11];return n!==l&&(l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15]),l[4]=_*m+G*u,l[5]=b*m+Z*u,l[6]=I*m+K*u,l[7]=E*m+ce*u,l[8]=G*m-_*u,l[9]=Z*m-b*u,l[10]=K*m-I*u,l[11]=ce*m-E*u,l},p.b8=function(){const l=new Float32Array(16);return re(l),l},p.b9=function(){const l=new Float64Array(16);return re(l),l},p.bA=function(l,n){const o=Ye(l,360),u=Ye(n,360),m=u-o,_=u>o?m-360:m+360;return Math.abs(m)<Math.abs(_)?m:_},p.bB=function(l){return l[0]=0,l[1]=0,l[2]=0,l},p.bC=function(l,n,o,u){const m=Math.sqrt(l*l+n*n),_=Math.sqrt(o*o+u*u);l/=m,n/=m,o/=_,u/=_;const b=Math.acos(l*o+n*u);return-n*o+l*u>0?b:-b},p.bD=function(l,n){const o=Ye(l,2*Math.PI),u=Ye(n,2*Math.PI);return Math.min(Math.abs(o-u),Math.abs(o-u+2*Math.PI),Math.abs(o-u-2*Math.PI))},p.bE=function(){const l={},n=st.$version;for(const o in st.$root){const u=st.$root[o];if(u.required){let m=null;m=o==="version"?n:u.type==="array"?[]:{},m!=null&&(l[o]=m)}}return l},p.bF=jd,p.bG=He,p.bH=function l(n,o){if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let u=0;u<n.length;u++)if(!l(n[u],o[u]))return!1;return!0}if(typeof n=="object"&&n!==null&&o!==null){if(typeof o!="object"||Object.keys(n).length!==Object.keys(o).length)return!1;for(const u in n)if(!l(n[u],o[u]))return!1;return!0}return n===o},p.bI=function(l){l=l.slice();const n=Object.create(null);for(let o=0;o<l.length;o++)n[l[o].id]=l[o];for(let o=0;o<l.length;o++)"ref"in l[o]&&(l[o]=Ct(l[o],n[l[o].ref]));return l},p.bJ=function(l,n){if(l.type==="custom")return new BI(l,n);switch(l.type){case"background":return new zI(l,n);case"circle":return new yM(l,n);case"color-relief":return new AM(l,n);case"fill":return new jM(l,n);case"fill-extrusion":return new $M(l,n);case"heatmap":return new wM(l,n);case"hillshade":return new MM(l,n);case"line":return new nI(l,n);case"raster":return new DI(l,n);case"symbol":return new am(l,n)}},p.bK=Zt,p.bL=function(l,n){if(!l)return[{command:"setStyle",args:[n]}];let o=[];try{if(!wt(l.version,n.version))return[{command:"setStyle",args:[n]}];wt(l.center,n.center)||o.push({command:"setCenter",args:[n.center]}),wt(l.state,n.state)||o.push({command:"setGlobalState",args:[n.state]}),wt(l.centerAltitude,n.centerAltitude)||o.push({command:"setCenterAltitude",args:[n.centerAltitude]}),wt(l.zoom,n.zoom)||o.push({command:"setZoom",args:[n.zoom]}),wt(l.bearing,n.bearing)||o.push({command:"setBearing",args:[n.bearing]}),wt(l.pitch,n.pitch)||o.push({command:"setPitch",args:[n.pitch]}),wt(l.roll,n.roll)||o.push({command:"setRoll",args:[n.roll]}),wt(l.sprite,n.sprite)||o.push({command:"setSprite",args:[n.sprite]}),wt(l.glyphs,n.glyphs)||o.push({command:"setGlyphs",args:[n.glyphs]}),wt(l.transition,n.transition)||o.push({command:"setTransition",args:[n.transition]}),wt(l.light,n.light)||o.push({command:"setLight",args:[n.light]}),wt(l.terrain,n.terrain)||o.push({command:"setTerrain",args:[n.terrain]}),wt(l.sky,n.sky)||o.push({command:"setSky",args:[n.sky]}),wt(l.projection,n.projection)||o.push({command:"setProjection",args:[n.projection]});const u={},m=[];(function(b,I,E,G){let Z;for(Z in I=I||{},b=b||{})Object.prototype.hasOwnProperty.call(b,Z)&&(Object.prototype.hasOwnProperty.call(I,Z)||k(Z,E,G));for(Z in I)Object.prototype.hasOwnProperty.call(I,Z)&&(Object.prototype.hasOwnProperty.call(b,Z)?wt(b[Z],I[Z])||(b[Z].type==="geojson"&&I[Z].type==="geojson"&&M(b,I,Z)?jt(E,{command:"setGeoJSONSourceData",args:[Z,I[Z].data]}):C(Z,I,E,G)):ie(Z,I,E))})(l.sources,n.sources,m,u);const _=[];l.layers&&l.layers.forEach(b=>{"source"in b&&u[b.source]?o.push({command:"removeLayer",args:[b.id]}):_.push(b)}),o=o.concat(m),function(b,I,E){I=I||[];const G=(b=b||[]).map(O),Z=I.map(O),K=b.reduce(xe,{}),ce=I.reduce(xe,{}),fe=G.slice(),_e=Object.create(null);let Ie,Le,Oe,vt,tt;for(let at=0,Mt=0;at<G.length;at++)Ie=G[at],Object.prototype.hasOwnProperty.call(ce,Ie)?Mt++:(jt(E,{command:"removeLayer",args:[Ie]}),fe.splice(fe.indexOf(Ie,Mt),1));for(let at=0,Mt=0;at<Z.length;at++)Ie=Z[Z.length-1-at],fe[fe.length-1-at]!==Ie&&(Object.prototype.hasOwnProperty.call(K,Ie)?(jt(E,{command:"removeLayer",args:[Ie]}),fe.splice(fe.lastIndexOf(Ie,fe.length-Mt),1)):Mt++,vt=fe[fe.length-at],jt(E,{command:"addLayer",args:[ce[Ie],vt]}),fe.splice(fe.length-at,0,Ie),_e[Ie]=!0);for(let at=0;at<Z.length;at++)if(Ie=Z[at],Le=K[Ie],Oe=ce[Ie],!_e[Ie]&&!wt(Le,Oe))if(wt(Le.source,Oe.source)&&wt(Le["source-layer"],Oe["source-layer"])&&wt(Le.type,Oe.type)){for(tt in P(Le.layout,Oe.layout,E,Ie,null,"setLayoutProperty"),P(Le.paint,Oe.paint,E,Ie,null,"setPaintProperty"),wt(Le.filter,Oe.filter)||jt(E,{command:"setFilter",args:[Ie,Oe.filter]}),wt(Le.minzoom,Oe.minzoom)&&wt(Le.maxzoom,Oe.maxzoom)||jt(E,{command:"setLayerZoomRange",args:[Ie,Oe.minzoom,Oe.maxzoom]}),Le)Object.prototype.hasOwnProperty.call(Le,tt)&&tt!=="layout"&&tt!=="paint"&&tt!=="filter"&&tt!=="metadata"&&tt!=="minzoom"&&tt!=="maxzoom"&&(tt.indexOf("paint.")===0?P(Le[tt],Oe[tt],E,Ie,tt.slice(6),"setPaintProperty"):wt(Le[tt],Oe[tt])||jt(E,{command:"setLayerProperty",args:[Ie,tt,Oe[tt]]}));for(tt in Oe)Object.prototype.hasOwnProperty.call(Oe,tt)&&!Object.prototype.hasOwnProperty.call(Le,tt)&&tt!=="layout"&&tt!=="paint"&&tt!=="filter"&&tt!=="metadata"&&tt!=="minzoom"&&tt!=="maxzoom"&&(tt.indexOf("paint.")===0?P(Le[tt],Oe[tt],E,Ie,tt.slice(6),"setPaintProperty"):wt(Le[tt],Oe[tt])||jt(E,{command:"setLayerProperty",args:[Ie,tt,Oe[tt]]}))}else jt(E,{command:"removeLayer",args:[Ie]}),vt=fe[fe.lastIndexOf(Ie)+1],jt(E,{command:"addLayer",args:[Oe,vt]})}(_,n.layers,o)}catch(u){console.warn("Unable to compute style diff:",u),o=[{command:"setStyle",args:[n]}]}return o},p.bM=function(l){const n=[],o=l.id;return o===void 0&&n.push({message:`layers.${o}: missing required property "id"`}),l.render===void 0&&n.push({message:`layers.${o}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&n.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),n},p.bN=dr,p.bO=zt,p.bP=class extends tn{constructor(l,n){super(l,n),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},p.bQ=q0,p.bR=class extends tn{constructor(l,n){super(l,n),this.current=R1}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let n=1;n<16;n++)if(l[n]!==this.current[n]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},p.bS=X0,p.bT=class extends tn{constructor(l,n){super(l,n),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},p.bU=class extends tn{constructor(l,n){super(l,n),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},p.bV=N,p.bW=function(l,n){var o=Math.sin(n),u=Math.cos(n);return l[0]=u,l[1]=o,l[2]=0,l[3]=-o,l[4]=u,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},p.bX=function(l,n,o){var u=n[0],m=n[1],_=n[2];return l[0]=u*o[0]+m*o[3]+_*o[6],l[1]=u*o[1]+m*o[4]+_*o[7],l[2]=u*o[2]+m*o[5]+_*o[8],l},p.bY=function(l,n,o,u,m,_,b){var I=1/(n-o),E=1/(u-m),G=1/(_-b);return l[0]=-2*I,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*E,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*G,l[11]=0,l[12]=(n+o)*I,l[13]=(m+u)*E,l[14]=(b+_)*G,l[15]=1,l},p.bZ=class extends tn{constructor(l,n){super(l,n),this.current=new Array}set(l){if(l!=this.current){this.current=l;const n=new Float32Array(4*l.length);for(let o=0;o<l.length;o++)n[4*o]=l[o].r,n[4*o+1]=l[o].g,n[4*o+2]=l[o].b,n[4*o+3]=l[o].a;this.gl.uniform4fv(this.location,n)}}},p.b_=class extends tn{constructor(l,n){super(l,n),this.current=new Array}set(l){if(l!=this.current){this.current=l;const n=new Float32Array(l);this.gl.uniform1fv(this.location,n)}}},p.ba=function(){return new Float64Array(16)},p.bb=function(l,n,o){const u=new Float64Array(4);return Ee(u,l,n-90,o),u},p.bc=function(l,n,o,u){var m,_,b,I,E,G=n[0],Z=n[1],K=n[2],ce=n[3],fe=o[0],_e=o[1],Ie=o[2],Le=o[3];return(_=G*fe+Z*_e+K*Ie+ce*Le)<0&&(_=-_,fe=-fe,_e=-_e,Ie=-Ie,Le=-Le),1-_>te?(m=Math.acos(_),b=Math.sin(m),I=Math.sin((1-u)*m)/b,E=Math.sin(u*m)/b):(I=1-u,E=u),l[0]=I*G+E*fe,l[1]=I*Z+E*_e,l[2]=I*K+E*Ie,l[3]=I*ce+E*Le,l},p.bd=function(l){const n=new Float64Array(9);var o,u,m,_,b,I,E,G,Z,K,ce,fe,_e,Ie,Le,Oe,vt,tt;K=(m=(u=l)[0])*(E=m+m),ce=(_=u[1])*E,_e=(b=u[2])*E,Ie=b*(G=_+_),Oe=(I=u[3])*E,vt=I*G,tt=I*(Z=b+b),(o=n)[0]=1-(fe=_*G)-(Le=b*Z),o[3]=ce-tt,o[6]=_e+vt,o[1]=ce+tt,o[4]=1-K-Le,o[7]=Ie-Oe,o[2]=_e-vt,o[5]=Ie+Oe,o[8]=1-K-fe;const at=fn(-Math.asin(It(n[2],-1,1)));let Mt,Dt;return Math.hypot(n[5],n[8])<.001?(Mt=0,Dt=-fn(Math.atan2(n[3],n[4]))):(Mt=fn(n[5]===0&&n[8]===0?0:Math.atan2(n[5],n[8])),Dt=fn(n[1]===0&&n[0]===0?0:Math.atan2(n[1],n[0]))),{roll:Mt,pitch:at+90,bearing:Dt}},p.be=function(l,n){return l.roll==n.roll&&l.pitch==n.pitch&&l.bearing==n.bearing},p.bf=si,p.bg=Jh,p.bh=su,p.bi=af,p.bj=nu,p.bk=We,p.bl=ot,p.bm=rs,p.bn=function(l,n,o,u,m){return We(u,m,It((l-n)/(o-n),0,1))},p.bo=Ye,p.bp=function(){return new Float64Array(3)},p.bq=function(l,n,o,u){return l[0]=n[0]+o[0]*u,l[1]=n[1]+o[1]*u,l[2]=n[2]+o[2]*u,l},p.br=Ee,p.bs=function(l,n,o){var u=o[0],m=o[1],_=o[2],b=o[3],I=n[0],E=n[1],G=n[2],Z=m*G-_*E,K=_*I-u*G,ce=u*E-m*I;return l[0]=I+b*(Z+=Z)+m*(ce+=ce)-_*(K+=K),l[1]=E+b*K+_*Z-u*ce,l[2]=G+b*ce+u*K-m*Z,l},p.bt=function(l,n,o){const u=(m=[l[0],l[1],l[2],n[0],n[1],n[2],o[0],o[1],o[2]])[0]*((Z=m[8])*(b=m[4])-(I=m[5])*(G=m[7]))+m[1]*(-Z*(_=m[3])+I*(E=m[6]))+m[2]*(G*_-b*E);var m,_,b,I,E,G,Z;if(u===0)return null;const K=Me([],[n[0],n[1],n[2]],[o[0],o[1],o[2]]),ce=Me([],[o[0],o[1],o[2]],[l[0],l[1],l[2]]),fe=Me([],[l[0],l[1],l[2]],[n[0],n[1],n[2]]),_e=le([],K,-l[3]);return $(_e,_e,le([],ce,-n[3])),$(_e,_e,le([],fe,-o[3])),le(_e,_e,1/u),_e},p.bu=s_,p.bv=function(){return new Float64Array(4)},p.bw=function(l,n,o,u){var m=[],_=[];return m[0]=n[0]-o[0],m[1]=n[1]-o[1],m[2]=n[2]-o[2],_[0]=m[0]*Math.cos(u)-m[1]*Math.sin(u),_[1]=m[0]*Math.sin(u)+m[1]*Math.cos(u),_[2]=m[2],l[0]=_[0]+o[0],l[1]=_[1]+o[1],l[2]=_[2]+o[2],l},p.bx=function(l,n,o,u){var m=[],_=[];return m[0]=n[0]-o[0],m[1]=n[1]-o[1],m[2]=n[2]-o[2],_[0]=m[0],_[1]=m[1]*Math.cos(u)-m[2]*Math.sin(u),_[2]=m[1]*Math.sin(u)+m[2]*Math.cos(u),l[0]=_[0]+o[0],l[1]=_[1]+o[1],l[2]=_[2]+o[2],l},p.by=function(l,n,o,u){var m=[],_=[];return m[0]=n[0]-o[0],m[1]=n[1]-o[1],m[2]=n[2]-o[2],_[0]=m[2]*Math.sin(u)+m[0]*Math.cos(u),_[1]=m[1],_[2]=m[2]*Math.cos(u)-m[0]*Math.sin(u),l[0]=_[0]+o[0],l[1]=_[1]+o[1],l[2]=_[2]+o[2],l},p.bz=function(l,n,o){var u=Math.sin(o),m=Math.cos(o),_=n[0],b=n[1],I=n[2],E=n[3],G=n[8],Z=n[9],K=n[10],ce=n[11];return n!==l&&(l[4]=n[4],l[5]=n[5],l[6]=n[6],l[7]=n[7],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15]),l[0]=_*m-G*u,l[1]=b*m-Z*u,l[2]=I*m-K*u,l[3]=E*m-ce*u,l[8]=_*u+G*m,l[9]=b*u+Z*m,l[10]=I*u+K*m,l[11]=E*u+ce*m,l},p.c=ct,p.c0=lI,p.c1=class extends y{},p.c2=j1,p.c3=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},p.c4=Xb,p.c5=function(l,n,o){var u=n[0],m=n[1],_=n[2],b=o[3]*u+o[7]*m+o[11]*_+o[15];return l[0]=(o[0]*u+o[4]*m+o[8]*_+o[12])/(b=b||1),l[1]=(o[1]*u+o[5]*m+o[9]*_+o[13])/b,l[2]=(o[2]*u+o[6]*m+o[10]*_+o[14])/b,l},p.c6=class extends Qo{},p.c7=class extends ee{},p.c8=function(l,n){return l[0]===n[0]&&l[1]===n[1]&&l[2]===n[2]&&l[3]===n[3]&&l[4]===n[4]&&l[5]===n[5]&&l[6]===n[6]&&l[7]===n[7]&&l[8]===n[8]&&l[9]===n[9]&&l[10]===n[10]&&l[11]===n[11]&&l[12]===n[12]&&l[13]===n[13]&&l[14]===n[14]&&l[15]===n[15]},p.c9=function(l,n){var o=l[0],u=l[1],m=l[2],_=l[3],b=l[4],I=l[5],E=l[6],G=l[7],Z=l[8],K=l[9],ce=l[10],fe=l[11],_e=l[12],Ie=l[13],Le=l[14],Oe=l[15],vt=n[0],tt=n[1],at=n[2],Mt=n[3],Dt=n[4],qt=n[5],ur=n[6],ir=n[7],cr=n[8],Rr=n[9],or=n[10],hr=n[11],Nt=n[12],Zr=n[13],Nr=n[14],Br=n[15];return Math.abs(o-vt)<=te*Math.max(1,Math.abs(o),Math.abs(vt))&&Math.abs(u-tt)<=te*Math.max(1,Math.abs(u),Math.abs(tt))&&Math.abs(m-at)<=te*Math.max(1,Math.abs(m),Math.abs(at))&&Math.abs(_-Mt)<=te*Math.max(1,Math.abs(_),Math.abs(Mt))&&Math.abs(b-Dt)<=te*Math.max(1,Math.abs(b),Math.abs(Dt))&&Math.abs(I-qt)<=te*Math.max(1,Math.abs(I),Math.abs(qt))&&Math.abs(E-ur)<=te*Math.max(1,Math.abs(E),Math.abs(ur))&&Math.abs(G-ir)<=te*Math.max(1,Math.abs(G),Math.abs(ir))&&Math.abs(Z-cr)<=te*Math.max(1,Math.abs(Z),Math.abs(cr))&&Math.abs(K-Rr)<=te*Math.max(1,Math.abs(K),Math.abs(Rr))&&Math.abs(ce-or)<=te*Math.max(1,Math.abs(ce),Math.abs(or))&&Math.abs(fe-hr)<=te*Math.max(1,Math.abs(fe),Math.abs(hr))&&Math.abs(_e-Nt)<=te*Math.max(1,Math.abs(_e),Math.abs(Nt))&&Math.abs(Ie-Zr)<=te*Math.max(1,Math.abs(Ie),Math.abs(Zr))&&Math.abs(Le-Nr)<=te*Math.max(1,Math.abs(Le),Math.abs(Nr))&&Math.abs(Oe-Br)<=te*Math.max(1,Math.abs(Oe),Math.abs(Br))},p.cA=function(l,n){be.REGISTERED_PROTOCOLS[l]=n},p.cB=function(l){delete be.REGISTERED_PROTOCOLS[l]},p.cC=function(l,n){const o={};for(let m=0;m<l.length;m++){const _=n&&n[l[m].id]||P0(l[m]);n&&(n[l[m].id]=_);let b=o[_];b||(b=o[_]=[]),b.push(l[m])}const u=[];for(const m in o)u.push(o[m]);return u},p.cD=_r,p.cE=Uw,p.cF=Ww,p.cG=xw,p.cH=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=ye/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const n=l.bucket.layers[0],o=n.layout,u=n._unevaluatedLayout._values,m={layoutIconSize:u["icon-size"].possiblyEvaluate(new Li(l.bucket.zoom+1),l.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Li(l.bucket.zoom+1),l.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Li(18))};if(l.bucket.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:Z}=l.bucket.textSizeData;m.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Li(G),l.canonical),u["text-size"].possiblyEvaluate(new Li(Z),l.canonical)]}if(l.bucket.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:Z}=l.bucket.iconSizeData;m.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Li(G),l.canonical),u["icon-size"].possiblyEvaluate(new Li(Z),l.canonical)]}const _=o.get("text-line-height")*On,b=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",I=o.get("text-keep-upright"),E=o.get("text-size");for(const G of l.bucket.features){const Z=o.get("text-font").evaluate(G,{},l.canonical).join(","),K=E.evaluate(G,{},l.canonical),ce=m.layoutTextSize.evaluate(G,{},l.canonical),fe=m.layoutIconSize.evaluate(G,{},l.canonical),_e={horizontal:{},vertical:void 0},Ie=G.text;let Le,Oe=[0,0];if(Ie){const at=Ie.toString(),Mt=o.get("text-letter-spacing").evaluate(G,{},l.canonical)*On,Dt=G0(at)?Mt:0,qt=o.get("text-anchor").evaluate(G,{},l.canonical),ur=ix(n,G,l.canonical);if(!ur){const or=o.get("text-radial-offset").evaluate(G,{},l.canonical);Oe=or?rx(qt,[or*On,l_]):o.get("text-offset").evaluate(G,{},l.canonical).map(hr=>hr*On)}let ir=b?"center":o.get("text-justify").evaluate(G,{},l.canonical);const cr=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(G,{},l.canonical)*On:1/0,Rr=()=>{l.bucket.allowVerticalPlacement&&Zd(at)&&(_e.vertical=im(Ie,l.glyphMap,l.glyphPositions,l.imagePositions,Z,cr,_,qt,"left",Dt,Oe,p.ao.vertical,!0,ce,K))};if(!b&&ur){const or=new Set;if(ir==="auto")for(let Nt=0;Nt<ur.values.length;Nt+=2)or.add(c_(ur.values[Nt]));else or.add(ir);let hr=!1;for(const Nt of or)if(!_e.horizontal[Nt])if(hr)_e.horizontal[Nt]=_e.horizontal[0];else{const Zr=im(Ie,l.glyphMap,l.glyphPositions,l.imagePositions,Z,cr,_,"center",Nt,Dt,Oe,p.ao.horizontal,!1,ce,K);Zr&&(_e.horizontal[Nt]=Zr,hr=Zr.positionedLines.length===1)}Rr()}else{ir==="auto"&&(ir=c_(qt));const or=im(Ie,l.glyphMap,l.glyphPositions,l.imagePositions,Z,cr,_,qt,ir,Dt,Oe,p.ao.horizontal,!1,ce,K);or&&(_e.horizontal[ir]=or),Rr(),Zd(at)&&b&&I&&(_e.vertical=im(Ie,l.glyphMap,l.glyphPositions,l.imagePositions,Z,cr,_,qt,ir,Dt,Oe,p.ao.vertical,!1,ce,K))}}let vt=!1;if(G.icon&&G.icon.name){const at=l.imageMap[G.icon.name];at&&(Le=EI(l.imagePositions[G.icon.name],o.get("icon-offset").evaluate(G,{},l.canonical),o.get("icon-anchor").evaluate(G,{},l.canonical)),vt=!!at.sdf,l.bucket.sdfIcons===void 0?l.bucket.sdfIcons=vt:l.bucket.sdfIcons!==vt&&Yt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(at.pixelRatio!==l.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(l.bucket.iconsNeedLinear=!0))}const tt=sx(_e.horizontal)||_e.vertical;l.bucket.iconsInText=!!tt&&tt.iconsInText,(tt||Le)&&WI(l.bucket,G,_e,Le,l.imageMap,m,ce,fe,Oe,vt,l.canonical,l.subdivisionGranularity)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},p.cI=H1,p.cJ=X1,p.cK=q1,p.cL=lw,p.cM=K1,p.cN=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return l.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},p.cO=function(l,n,o,u,m){return s(this,void 0,void 0,function*(){if(ne())try{return yield hi(l,n,o,u,m)}catch{}return function(_,b,I,E,G){const Z=_.width,K=_.height;ni&&ui||(ni=new OffscreenCanvas(Z,K),ui=ni.getContext("2d",{willReadFrequently:!0})),ni.width=Z,ni.height=K,ui.drawImage(_,0,0,Z,K);const ce=ui.getImageData(b,I,E,G);return ui.clearRect(0,0,Z,K),ce.data}(l,n,o,u,m)})},p.cP=Kb,p.cQ=A,p.cR=ow,p.cS=au,p.cT=xc,p.cU=function(l,n){const o=new Map;if(l!=null)if(l.type==="Feature")o.set(ff(l,n),l);else for(const u of l.features)o.set(ff(u,n),u);return o},p.cV=function(l,n){if(l==null)return!0;if(l.type==="Feature")return ff(l,n)!=null;if(l.type==="FeatureCollection"){const o=new Set;for(const u of l.features){const m=ff(u,n);if(m==null||o.has(m))return!1;o.add(m)}return!0}return!1},p.cW=function(l,n,o){var u,m,_,b;if(n.removeAll&&l.clear(),n.remove)for(const I of n.remove)l.delete(I);if(n.add)for(const I of n.add){const E=ff(I,o);E!=null&&l.set(E,I)}if(n.update)for(const I of n.update){let E=l.get(I.id);if(E==null)continue;const G=!I.removeAllProperties&&(((u=I.removeProperties)===null||u===void 0?void 0:u.length)>0||((m=I.addOrUpdateProperties)===null||m===void 0?void 0:m.length)>0);if((I.newGeometry||I.removeAllProperties||G)&&(E=Object.assign({},E),l.set(I.id,E),G&&(E.properties=Object.assign({},E.properties))),I.newGeometry&&(E.geometry=I.newGeometry),I.removeAllProperties)E.properties={};else if(((_=I.removeProperties)===null||_===void 0?void 0:_.length)>0)for(const Z of I.removeProperties)Object.prototype.hasOwnProperty.call(E.properties,Z)&&delete E.properties[Z];if(((b=I.addOrUpdateProperties)===null||b===void 0?void 0:b.length)>0)for(const{key:Z,value:K}of I.addOrUpdateProperties)E.properties[Z]=K}},p.cX=eo,p.ca=function(l,n){return l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l[4]=n[4],l[5]=n[5],l[6]=n[6],l[7]=n[7],l[8]=n[8],l[9]=n[9],l[10]=n[10],l[11]=n[11],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15],l},p.cb=l=>l.type==="symbol",p.cc=l=>l.type==="circle",p.cd=l=>l.type==="heatmap",p.ce=l=>l.type==="line",p.cf=l=>l.type==="fill",p.cg=l=>l.type==="fill-extrusion",p.ch=l=>l.type==="hillshade",p.ci=l=>l.type==="color-relief",p.cj=l=>l.type==="raster",p.ck=l=>l.type==="background",p.cl=l=>l.type==="custom",p.cm=Se,p.cn=function(l,n,o){const u=$e(n.x-o.x,n.y-o.y),m=$e(l.x-o.x,l.y-o.y);var _,b;return fn(Math.atan2(u[0]*m[1]-u[1]*m[0],(_=u)[0]*(b=m)[0]+_[1]*b[1]))},p.co=Ce,p.cp=function(l,n){return xi[n]&&(l instanceof MouseEvent||l instanceof WheelEvent)},p.cq=function(l,n){return Pr[n]&&"touches"in l},p.cr=function(l){return Pr[l]||xi[l]},p.cs=function(l,n,o){var u=n[0],m=n[1];return l[0]=o[0]*u+o[4]*m+o[12],l[1]=o[1]*u+o[5]*m+o[13],l},p.ct=function(l,n){const{x:o,y:u}=df.fromLngLat(n);return!(l<0||l>25||u<0||u>=1||o<0||o>=1)},p.cu=function(l,n){return l[0]=n[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=n[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=n[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},p.cv=class extends Jo{},p.cw=qI,p.cy=function(l){return l.message===Fi},p.cz=Ge,p.d=yt,p.e=Xt,p.f=l=>s(void 0,void 0,void 0,function*(){if(l.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(l)],{type:"image/png"});try{return createImageBitmap(n)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),p.g=we,p.h=l=>new Promise((n,o)=>{const u=new Image;u.onload=()=>{n(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=Dr})},u.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(l)],{type:"image/png"});u.src=l.byteLength?URL.createObjectURL(m):Dr}),p.i=yr,p.j=(l,n)=>nt(Xt(l,{type:"json"}),n),p.k=Ft,p.l=Vt,p.m=nt,p.n=(l,n)=>nt(Xt(l,{type:"arrayBuffer"}),n),p.o=function(l){return new K1(l).readFields(yI,[])},p.p=ww,p.q=ef,p.r=ns,p.s=dn,p.t=Wd,p.u=li,p.v=st,p.w=Yt,p.x=Ec,p.y=B0,p.z=El}),h("worker",["./shared"],function(p){class s{constructor(be,we){this.keyCache={},be&&this.replace(be,we)}replace(be,we){this._layerConfigs={},this._layers={},this.update(be,[],we)}update(be,we,Te){for(const He of be){this._layerConfigs[He.id]=He;const nt=this._layers[He.id]=p.bJ(He,Te);nt._featureFilter=p.aa(nt.filter,Te),this.keyCache[He.id]&&delete this.keyCache[He.id]}for(const He of we)delete this.keyCache[He],delete this._layerConfigs[He],delete this._layers[He];this.familiesBySource={};const Ge=p.cC(Object.values(this._layerConfigs),this.keyCache);for(const He of Ge){const nt=He.map(sr=>this._layers[sr.id]),yt=nt[0];if(yt.visibility==="none")continue;const ut=yt.source||"";let St=this.familiesBySource[ut];St||(St=this.familiesBySource[ut]={});const Vt=yt.sourceLayer||"_geojsonTileLayer";let Ft=St[Vt];Ft||(Ft=St[Vt]=[]),Ft.push(nt)}}}class w{constructor(be){const we={},Te=[];for(const yt in be){const ut=be[yt],St=we[yt]={};for(const Vt in ut){const Ft=ut[+Vt];if(!Ft||Ft.bitmap.width===0||Ft.bitmap.height===0)continue;const sr={x:0,y:0,w:Ft.bitmap.width+2,h:Ft.bitmap.height+2};Te.push(sr),St[Vt]={rect:sr,metrics:Ft.metrics}}}const{w:Ge,h:He}=p.p(Te),nt=new p.q({width:Ge||1,height:He||1});for(const yt in be){const ut=be[yt];for(const St in ut){const Vt=ut[+St];if(!Vt||Vt.bitmap.width===0||Vt.bitmap.height===0)continue;const Ft=we[yt][St].rect;p.q.copy(Vt.bitmap,nt,{x:0,y:0},{x:Ft.x+1,y:Ft.y+1},Vt.bitmap)}}this.image=nt,this.positions=we}}p.cD("GlyphAtlas",w);class A{constructor(be){this.tileID=new p.Z(be.tileID.overscaledZ,be.tileID.wrap,be.tileID.canonical.z,be.tileID.canonical.x,be.tileID.canonical.y),this.uid=be.uid,this.zoom=be.zoom,this.pixelRatio=be.pixelRatio,this.tileSize=be.tileSize,this.source=be.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=be.showCollisionBoxes,this.collectResourceTiming=!!be.collectResourceTiming,this.returnDependencies=!!be.returnDependencies,this.promoteId=be.promoteId,this.inFlightDependencies=[]}parse(be,we,Te,Ge,He){return p._(this,void 0,void 0,function*(){this.status="parsing",this.data=be,this.collisionBoxArray=new p.a8;const nt=new p.cE(Object.keys(be.layers).sort()),yt=new p.cF(this.tileID,this.promoteId);yt.bucketLayerIDs=[];const ut={},St={featureIndex:yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:Te,subdivisionGranularity:He},Vt=we.familiesBySource[this.source];for(const he in Vt){const Y=be.layers[he];if(!Y)continue;Y.version===1&&p.w(`Vector tile source "${this.source}" layer "${he}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const U=nt.encode(he),J=[];for(let ue=0;ue<Y.length;ue++){const pe=Y.feature(ue),Ze=yt.getId(pe,he);J.push({feature:pe,id:Ze,index:ue,sourceLayerIndex:U})}for(const ue of Vt[he]){const pe=ue[0];pe.source!==this.source&&p.w(`layer.source = ${pe.source} does not equal this.source = ${this.source}`),pe.minzoom&&this.zoom<Math.floor(pe.minzoom)||pe.maxzoom&&this.zoom>=pe.maxzoom||pe.visibility!=="none"&&(z(ue,this.zoom,Te),(ut[pe.id]=pe.createBucket({index:yt.bucketLayerIDs.length,layers:ue,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:U,sourceID:this.source})).populate(J,St,this.tileID.canonical),yt.bucketLayerIDs.push(ue.map(Ze=>Ze.id)))}}const Ft=p.bN(St.glyphDependencies,he=>Object.keys(he).map(Number));this.inFlightDependencies.forEach(he=>he==null?void 0:he.abort()),this.inFlightDependencies=[];let sr=Promise.resolve({});if(Object.keys(Ft).length){const he=new AbortController;this.inFlightDependencies.push(he),sr=Ge.sendAsync({type:"GG",data:{stacks:Ft,source:this.source,tileID:this.tileID,type:"glyphs"}},he)}const st=Object.keys(St.iconDependencies);let qe=Promise.resolve({});if(st.length){const he=new AbortController;this.inFlightDependencies.push(he),qe=Ge.sendAsync({type:"GI",data:{icons:st,source:this.source,tileID:this.tileID,type:"icons"}},he)}const Ct=Object.keys(St.patternDependencies);let wt=Promise.resolve({});if(Ct.length){const he=new AbortController;this.inFlightDependencies.push(he),wt=Ge.sendAsync({type:"GI",data:{icons:Ct,source:this.source,tileID:this.tileID,type:"patterns"}},he)}const jt=St.dashDependencies;let ie=Promise.resolve({});if(Object.keys(jt).length){const he=new AbortController;this.inFlightDependencies.push(he),ie=Ge.sendAsync({type:"GDA",data:{dashes:jt}},he)}const[k,C,M,P]=yield Promise.all([sr,qe,wt,ie]),O=new w(k),xe=new p.cG(C,M);for(const he in ut){const Y=ut[he];Y instanceof p.a9?(z(Y.layers,this.zoom,Te),p.cH({bucket:Y,glyphMap:k,glyphPositions:O.positions,imageMap:C,imagePositions:xe.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:St.subdivisionGranularity})):Y.hasDependencies&&(Y instanceof p.cI||Y instanceof p.cJ||Y instanceof p.cK)&&(z(Y.layers,this.zoom,Te),Y.addFeatures(St,this.tileID.canonical,xe.patternPositions,P))}return this.status="done",{buckets:Object.values(ut).filter(he=>!he.isEmpty()),featureIndex:yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:O.image,imageAtlas:xe,dashPositions:P,glyphMap:this.returnDependencies?k:null,iconMap:this.returnDependencies?C:null,glyphPositions:this.returnDependencies?O.positions:null}})}}function z(ct,be,we){const Te=new p.F(be);for(const Ge of ct)Ge.recalculate(Te,we)}class B{constructor(be,we,Te){this.actor=be,this.layerIndex=we,this.availableImages=Te,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(be,we){return p._(this,void 0,void 0,function*(){const Te=yield p.n(be.request,we);try{return{vectorTile:new p.cL(new p.cM(Te.data)),rawData:Te.data,cacheControl:Te.cacheControl,expires:Te.expires}}catch(Ge){const He=new Uint8Array(Te.data);let nt=`Unable to parse the tile at ${be.request.url}, `;throw nt+=He[0]===31&&He[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Ge.message}`,new Error(nt)}})}loadTile(be){return p._(this,void 0,void 0,function*(){const we=be.uid,Te=!!(be&&be.request&&be.request.collectResourceTiming)&&new p.cN(be.request),Ge=new A(be);this.loading[we]=Ge;const He=new AbortController;Ge.abort=He;try{const nt=yield this.loadVectorTile(be,He);if(delete this.loading[we],!nt)return null;const yt=nt.rawData,ut={};nt.expires&&(ut.expires=nt.expires),nt.cacheControl&&(ut.cacheControl=nt.cacheControl);const St={};if(Te){const Ft=Te.finish();Ft&&(St.resourceTiming=JSON.parse(JSON.stringify(Ft)))}Ge.vectorTile=nt.vectorTile;const Vt=Ge.parse(nt.vectorTile,this.layerIndex,this.availableImages,this.actor,be.subdivisionGranularity);this.loaded[we]=Ge,this.fetching[we]={rawTileData:yt,cacheControl:ut,resourceTiming:St};try{const Ft=yield Vt;return p.e({rawTileData:yt.slice(0)},Ft,ut,St)}finally{delete this.fetching[we]}}catch(nt){throw delete this.loading[we],Ge.status="done",this.loaded[we]=Ge,nt}})}reloadTile(be){return p._(this,void 0,void 0,function*(){const we=be.uid;if(!this.loaded||!this.loaded[we])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Te=this.loaded[we];if(Te.showCollisionBoxes=be.showCollisionBoxes,Te.status==="parsing"){const Ge=yield Te.parse(Te.vectorTile,this.layerIndex,this.availableImages,this.actor,be.subdivisionGranularity);let He;if(this.fetching[we]){const{rawTileData:nt,cacheControl:yt,resourceTiming:ut}=this.fetching[we];delete this.fetching[we],He=p.e({rawTileData:nt.slice(0)},Ge,yt,ut)}else He=Ge;return He}if(Te.status==="done"&&Te.vectorTile)return Te.parse(Te.vectorTile,this.layerIndex,this.availableImages,this.actor,be.subdivisionGranularity)})}abortTile(be){return p._(this,void 0,void 0,function*(){const we=this.loading,Te=be.uid;we&&we[Te]&&we[Te].abort&&(we[Te].abort.abort(),delete we[Te])})}removeTile(be){return p._(this,void 0,void 0,function*(){this.loaded&&this.loaded[be.uid]&&delete this.loaded[be.uid]})}}class D{constructor(){this.loaded={}}loadTile(be){return p._(this,void 0,void 0,function*(){const{uid:we,encoding:Te,rawImageData:Ge,redFactor:He,greenFactor:nt,blueFactor:yt,baseShift:ut}=be,St=Ge.width+2,Vt=Ge.height+2,Ft=p.b(Ge)?new p.R({width:St,height:Vt},yield p.cO(Ge,-1,-1,St,Vt)):Ge,sr=new p.cP(we,Ft,Te,He,nt,yt,ut);return this.loaded=this.loaded||{},this.loaded[we]=sr,sr})}removeTile(be){const we=this.loaded,Te=be.uid;we&&we[Te]&&delete we[Te]}}var V,W,S=function(){if(W)return V;function ct(we,Te){if(we.length!==0){be(we[0],Te);for(var Ge=1;Ge<we.length;Ge++)be(we[Ge],!Te)}}function be(we,Te){for(var Ge=0,He=0,nt=0,yt=we.length,ut=yt-1;nt<yt;ut=nt++){var St=(we[nt][0]-we[ut][0])*(we[ut][1]+we[nt][1]),Vt=Ge+St;He+=Math.abs(Ge)>=Math.abs(St)?Ge-Vt+St:St-Vt+Ge,Ge=Vt}Ge+He>=0!=!!Te&&we.reverse()}return W=1,V=function we(Te,Ge){var He,nt=Te&&Te.type;if(nt==="FeatureCollection")for(He=0;He<Te.features.length;He++)we(Te.features[He],Ge);else if(nt==="GeometryCollection")for(He=0;He<Te.geometries.length;He++)we(Te.geometries[He],Ge);else if(nt==="Feature")we(Te.geometry,Ge);else if(nt==="Polygon")ct(Te.coordinates,Ge);else if(nt==="MultiPolygon")for(He=0;He<Te.coordinates.length;He++)ct(Te.coordinates[He],Ge);return Te}}(),j=p.cQ(S);class ne extends p.cS{constructor(be,we){super(new p.cM,0,we,[],[]),this.feature=be,this.type=be.type,this.properties=be.tags?be.tags:{},"id"in be&&(typeof be.id=="string"?this.id=parseInt(be.id,10):typeof be.id!="number"||isNaN(be.id)||(this.id=be.id))}loadGeometry(){const be=[],we=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const Te of we){const Ge=[];for(const He of Te)Ge.push(new p.P(He[0],He[1]));be.push(Ge)}return be}}class te extends p.cR{constructor(be,we){super(new p.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=we?we.version:1,this.extent=we?we.extent:4096,this.length=be.length,this.features=be}feature(be){return new ne(this.features[be],this.extent)}}function Q(ct,be){be.writeVarintField(15,ct.version||1),be.writeStringField(1,ct.name||""),be.writeVarintField(5,ct.extent||4096);const we={keys:[],values:[],keycache:{},valuecache:{}};for(let He=0;He<ct.length;He++)we.feature=ct.feature(He),be.writeMessage(2,N,we);const Te=we.keys;for(const He of Te)be.writeStringField(3,He);const Ge=we.values;for(const He of Ge)be.writeMessage(4,$,He)}function N(ct,be){if(!ct.feature)return;const we=ct.feature;we.id!==void 0&&be.writeVarintField(1,we.id),be.writeMessage(2,re,ct),be.writeVarintField(3,we.type),be.writeMessage(4,Pe,we)}function re(ct,be){var we;for(const Te in(we=ct.feature)==null?void 0:we.properties){let Ge=ct.feature.properties[Te],He=ct.keycache[Te];if(Ge===null)continue;He===void 0&&(ct.keys.push(Te),He=ct.keys.length-1,ct.keycache[Te]=He),be.writeVarint(He),typeof Ge!="string"&&typeof Ge!="boolean"&&typeof Ge!="number"&&(Ge=JSON.stringify(Ge));const nt=typeof Ge+":"+Ge;let yt=ct.valuecache[nt];yt===void 0&&(ct.values.push(Ge),yt=ct.values.length-1,ct.valuecache[nt]=yt),be.writeVarint(yt)}}function oe(ct,be){return(be<<3)+(7&ct)}function ve(ct){return ct<<1^ct>>31}function Pe(ct,be){const we=ct.loadGeometry(),Te=ct.type;let Ge=0,He=0;for(const nt of we){let yt=1;Te===1&&(yt=nt.length),be.writeVarint(oe(1,yt));const ut=Te===3?nt.length-1:nt.length;for(let St=0;St<ut;St++){St===1&&Te!==1&&be.writeVarint(oe(2,ut-1));const Vt=nt[St].x-Ge,Ft=nt[St].y-He;be.writeVarint(ve(Vt)),be.writeVarint(ve(Ft)),Ge+=Vt,He+=Ft}ct.type===3&&be.writeVarint(oe(7,1))}}function $(ct,be){const we=typeof ct;we==="string"?be.writeStringField(1,ct):we==="boolean"?be.writeBooleanField(7,ct):we==="number"&&(ct%1!=0?be.writeDoubleField(3,ct):ct<0?be.writeSVarintField(6,ct):be.writeVarintField(5,ct))}const le={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ct=>ct},Me=Math.fround||(Ve=new Float32Array(1),ct=>(Ve[0]=+ct,Ve[0]));var Ve;class Be{constructor(be){this.options=Object.assign(Object.create(le),be),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(be){const{log:we,minZoom:Te,maxZoom:Ge}=this.options;we&&console.time("total time");const He=`prepare ${be.length} points`;we&&console.time(He),this.points=be;const nt=[];for(let ut=0;ut<be.length;ut++){const St=be[ut];if(!St.geometry)continue;const[Vt,Ft]=St.geometry.coordinates,sr=Me(Ee(Vt)),st=Me(Ne(Ft));nt.push(sr,st,1/0,ut,-1,1),this.options.reduce&&nt.push(0)}let yt=this.trees[Ge+1]=this._createTree(nt);we&&console.timeEnd(He);for(let ut=Ge;ut>=Te;ut--){const St=+Date.now();yt=this.trees[ut]=this._createTree(this._cluster(yt,ut)),we&&console.log("z%d: %d clusters in %dms",ut,yt.numItems,+Date.now()-St)}return we&&console.timeEnd("total time"),this}getClusters(be,we){let Te=((be[0]+180)%360+360)%360-180;const Ge=Math.max(-90,Math.min(90,be[1]));let He=be[2]===180?180:((be[2]+180)%360+360)%360-180;const nt=Math.max(-90,Math.min(90,be[3]));if(be[2]-be[0]>=360)Te=-180,He=180;else if(Te>He){const Ft=this.getClusters([Te,Ge,180,nt],we),sr=this.getClusters([-180,Ge,He,nt],we);return Ft.concat(sr)}const yt=this.trees[this._limitZoom(we)],ut=yt.range(Ee(Te),Ne(nt),Ee(He),Ne(Ge)),St=yt.data,Vt=[];for(const Ft of ut){const sr=this.stride*Ft;Vt.push(St[sr+5]>1?q(St,sr,this.clusterProps):this.points[St[sr+3]])}return Vt}getChildren(be){const we=this._getOriginId(be),Te=this._getOriginZoom(be),Ge="No cluster with the specified id.",He=this.trees[Te];if(!He)throw new Error(Ge);const nt=He.data;if(we*this.stride>=nt.length)throw new Error(Ge);const yt=this.options.radius/(this.options.extent*Math.pow(2,Te-1)),ut=He.within(nt[we*this.stride],nt[we*this.stride+1],yt),St=[];for(const Vt of ut){const Ft=Vt*this.stride;nt[Ft+4]===be&&St.push(nt[Ft+5]>1?q(nt,Ft,this.clusterProps):this.points[nt[Ft+3]])}if(St.length===0)throw new Error(Ge);return St}getLeaves(be,we,Te){const Ge=[];return this._appendLeaves(Ge,be,we=we||10,Te=Te||0,0),Ge}getTile(be,we,Te){const Ge=this.trees[this._limitZoom(be)],He=Math.pow(2,be),{extent:nt,radius:yt}=this.options,ut=yt/nt,St=(Te-ut)/He,Vt=(Te+1+ut)/He,Ft={features:[]};return this._addTileFeatures(Ge.range((we-ut)/He,St,(we+1+ut)/He,Vt),Ge.data,we,Te,He,Ft),we===0&&this._addTileFeatures(Ge.range(1-ut/He,St,1,Vt),Ge.data,He,Te,He,Ft),we===He-1&&this._addTileFeatures(Ge.range(0,St,ut/He,Vt),Ge.data,-1,Te,He,Ft),Ft.features.length?Ft:null}getClusterExpansionZoom(be){let we=this._getOriginZoom(be)-1;for(;we<=this.options.maxZoom;){const Te=this.getChildren(be);if(we++,Te.length!==1)break;be=Te[0].properties.cluster_id}return we}_appendLeaves(be,we,Te,Ge,He){const nt=this.getChildren(we);for(const yt of nt){const ut=yt.properties;if(ut&&ut.cluster?He+ut.point_count<=Ge?He+=ut.point_count:He=this._appendLeaves(be,ut.cluster_id,Te,Ge,He):He<Ge?He++:be.push(yt),be.length===Te)break}return He}_createTree(be){const we=new p.aI(be.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Te=0;Te<be.length;Te+=this.stride)we.add(be[Te],be[Te+1]);return we.finish(),we.data=be,we}_addTileFeatures(be,we,Te,Ge,He,nt){for(const yt of be){const ut=yt*this.stride,St=we[ut+5]>1;let Vt,Ft,sr;if(St)Vt=me(we,ut,this.clusterProps),Ft=we[ut],sr=we[ut+1];else{const Ct=this.points[we[ut+3]];Vt=Ct.properties;const[wt,jt]=Ct.geometry.coordinates;Ft=Ee(wt),sr=Ne(jt)}const st={type:1,geometry:[[Math.round(this.options.extent*(Ft*He-Te)),Math.round(this.options.extent*(sr*He-Ge))]],tags:Vt};let qe;qe=St||this.options.generateId?we[ut+3]:this.points[we[ut+3]].id,qe!==void 0&&(st.id=qe),nt.features.push(st)}}_limitZoom(be){return Math.max(this.options.minZoom,Math.min(Math.floor(+be),this.options.maxZoom+1))}_cluster(be,we){const{radius:Te,extent:Ge,reduce:He,minPoints:nt}=this.options,yt=Te/(Ge*Math.pow(2,we)),ut=be.data,St=[],Vt=this.stride;for(let Ft=0;Ft<ut.length;Ft+=Vt){if(ut[Ft+2]<=we)continue;ut[Ft+2]=we;const sr=ut[Ft],st=ut[Ft+1],qe=be.within(ut[Ft],ut[Ft+1],yt),Ct=ut[Ft+5];let wt=Ct;for(const jt of qe){const ie=jt*Vt;ut[ie+2]>we&&(wt+=ut[ie+5])}if(wt>Ct&&wt>=nt){let jt,ie=sr*Ct,k=st*Ct,C=-1;const M=(Ft/Vt<<5)+(we+1)+this.points.length;for(const P of qe){const O=P*Vt;if(ut[O+2]<=we)continue;ut[O+2]=we;const xe=ut[O+5];ie+=ut[O]*xe,k+=ut[O+1]*xe,ut[O+4]=M,He&&(jt||(jt=this._map(ut,Ft,!0),C=this.clusterProps.length,this.clusterProps.push(jt)),He(jt,this._map(ut,O)))}ut[Ft+4]=M,St.push(ie/wt,k/wt,1/0,M,-1,wt),He&&St.push(C)}else{for(let jt=0;jt<Vt;jt++)St.push(ut[Ft+jt]);if(wt>1)for(const jt of qe){const ie=jt*Vt;if(!(ut[ie+2]<=we)){ut[ie+2]=we;for(let k=0;k<Vt;k++)St.push(ut[ie+k])}}}}return St}_getOriginId(be){return be-this.points.length>>5}_getOriginZoom(be){return(be-this.points.length)%32}_map(be,we,Te){if(be[we+5]>1){const nt=this.clusterProps[be[we+6]];return Te?Object.assign({},nt):nt}const Ge=this.points[be[we+3]].properties,He=this.options.map(Ge);return Te&&He===Ge?Object.assign({},He):He}}function q(ct,be,we){return{type:"Feature",id:ct[be+3],properties:me(ct,be,we),geometry:{type:"Point",coordinates:[(Te=ct[be],360*(Te-.5)),$e(ct[be+1])]}};var Te}function me(ct,be,we){const Te=ct[be+5],Ge=Te>=1e4?`${Math.round(Te/1e3)}k`:Te>=1e3?Math.round(Te/100)/10+"k":Te,He=ct[be+6],nt=He===-1?{}:Object.assign({},we[He]);return Object.assign(nt,{cluster:!0,cluster_id:ct[be+3],point_count:Te,point_count_abbreviated:Ge})}function Ee(ct){return ct/360+.5}function Ne(ct){const be=Math.sin(ct*Math.PI/180),we=.5-.25*Math.log((1+be)/(1-be))/Math.PI;return we<0?0:we>1?1:we}function $e(ct){const be=(180-360*ct)*Math.PI/180;return 360*Math.atan(Math.exp(be))/Math.PI-90}function ye(ct,be,we,Te){let Ge=Te;const He=be+(we-be>>1);let nt,yt=we-be;const ut=ct[be],St=ct[be+1],Vt=ct[we],Ft=ct[we+1];for(let sr=be+3;sr<we;sr+=3){const st=ge(ct[sr],ct[sr+1],ut,St,Vt,Ft);if(st>Ge)nt=sr,Ge=st;else if(st===Ge){const qe=Math.abs(sr-He);qe<yt&&(nt=sr,yt=qe)}}Ge>Te&&(nt-be>3&&ye(ct,be,nt,Te),ct[nt+2]=Ge,we-nt>3&&ye(ct,nt,we,Te))}function ge(ct,be,we,Te,Ge,He){let nt=Ge-we,yt=He-Te;if(nt!==0||yt!==0){const ut=((ct-we)*nt+(be-Te)*yt)/(nt*nt+yt*yt);ut>1?(we=Ge,Te=He):ut>0&&(we+=nt*ut,Te+=yt*ut)}return nt=ct-we,yt=be-Te,nt*nt+yt*yt}function Ye(ct,be,we,Te){const Ge={id:ct??null,type:be,geometry:we,tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(be==="Point"||be==="MultiPoint"||be==="LineString")We(Ge,we);else if(be==="Polygon")We(Ge,we[0]);else if(be==="MultiLineString")for(const He of we)We(Ge,He);else if(be==="MultiPolygon")for(const He of we)We(Ge,He[0]);return Ge}function We(ct,be){for(let we=0;we<be.length;we+=3)ct.minX=Math.min(ct.minX,be[we]),ct.minY=Math.min(ct.minY,be[we+1]),ct.maxX=Math.max(ct.maxX,be[we]),ct.maxY=Math.max(ct.maxY,be[we+1])}function ot(ct,be,we,Te){if(!be.geometry)return;const Ge=be.geometry.coordinates;if(Ge&&Ge.length===0)return;const He=be.geometry.type,nt=Math.pow(we.tolerance/((1<<we.maxZoom)*we.extent),2);let yt=[],ut=be.id;if(we.promoteId?ut=be.properties[we.promoteId]:we.generateId&&(ut=Te||0),He==="Point")Se(Ge,yt);else if(He==="MultiPoint")for(const St of Ge)Se(St,yt);else if(He==="LineString")Ce(Ge,yt,nt,!1);else if(He==="MultiLineString"){if(we.lineMetrics){for(const St of Ge)yt=[],Ce(St,yt,nt,!1),ct.push(Ye(ut,"LineString",yt,be.properties));return}It(Ge,yt,nt,!1)}else if(He==="Polygon")It(Ge,yt,nt,!0);else{if(He!=="MultiPolygon"){if(He==="GeometryCollection"){for(const St of be.geometry.geometries)ot(ct,{id:ut,geometry:St,properties:be.properties},we,Te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const St of Ge){const Vt=[];It(St,Vt,nt,!0),yt.push(Vt)}}ct.push(Ye(ut,He,yt,be.properties))}function Se(ct,be){be.push(Lt(ct[0]),Xt(ct[1]),0)}function Ce(ct,be,we,Te){let Ge,He,nt=0;for(let ut=0;ut<ct.length;ut++){const St=Lt(ct[ut][0]),Vt=Xt(ct[ut][1]);be.push(St,Vt,0),ut>0&&(nt+=Te?(Ge*Vt-St*He)/2:Math.sqrt(Math.pow(St-Ge,2)+Math.pow(Vt-He,2))),Ge=St,He=Vt}const yt=be.length-3;be[2]=1,ye(be,0,yt,we),be[yt+2]=1,be.size=Math.abs(nt),be.start=0,be.end=be.size}function It(ct,be,we,Te){for(let Ge=0;Ge<ct.length;Ge++){const He=[];Ce(ct[Ge],He,we,Te),be.push(He)}}function Lt(ct){return ct/360+.5}function Xt(ct){const be=Math.sin(ct*Math.PI/180),we=.5-.25*Math.log((1+be)/(1-be))/Math.PI;return we<0?0:we>1?1:we}function Jt(ct,be,we,Te,Ge,He,nt,yt){if(Te/=be,He>=(we/=be)&&nt<Te)return ct;if(nt<we||He>=Te)return null;const ut=[];for(const St of ct){const Vt=St.geometry;let Ft=St.type;const sr=Ge===0?St.minX:St.minY,st=Ge===0?St.maxX:St.maxY;if(sr>=we&&st<Te){ut.push(St);continue}if(st<we||sr>=Te)continue;let qe=[];if(Ft==="Point"||Ft==="MultiPoint")dr(Vt,qe,we,Te,Ge);else if(Ft==="LineString")zt(Vt,qe,we,Te,Ge,!1,yt.lineMetrics);else if(Ft==="MultiLineString")Ot(Vt,qe,we,Te,Ge,!1);else if(Ft==="Polygon")Ot(Vt,qe,we,Te,Ge,!0);else if(Ft==="MultiPolygon")for(const Ct of Vt){const wt=[];Ot(Ct,wt,we,Te,Ge,!0),wt.length&&qe.push(wt)}if(qe.length){if(yt.lineMetrics&&Ft==="LineString"){for(const Ct of qe)ut.push(Ye(St.id,Ft,Ct,St.tags));continue}Ft!=="LineString"&&Ft!=="MultiLineString"||(qe.length===1?(Ft="LineString",qe=qe[0]):Ft="MultiLineString"),Ft!=="Point"&&Ft!=="MultiPoint"||(Ft=qe.length===3?"Point":"MultiPoint"),ut.push(Ye(St.id,Ft,qe,St.tags))}}return ut.length?ut:null}function dr(ct,be,we,Te,Ge){for(let He=0;He<ct.length;He+=3){const nt=ct[He+Ge];nt>=we&&nt<=Te&&Yt(be,ct[He],ct[He+1],ct[He+2])}}function zt(ct,be,we,Te,Ge,He,nt){let yt=Zt(ct);const ut=Ge===0?Ar:yr;let St,Vt,Ft=ct.start;for(let wt=0;wt<ct.length-3;wt+=3){const jt=ct[wt],ie=ct[wt+1],k=ct[wt+2],C=ct[wt+3],M=ct[wt+4],P=Ge===0?jt:ie,O=Ge===0?C:M;let xe=!1;nt&&(St=Math.sqrt(Math.pow(jt-C,2)+Math.pow(ie-M,2))),P<we?O>we&&(Vt=ut(yt,jt,ie,C,M,we),nt&&(yt.start=Ft+St*Vt)):P>Te?O<Te&&(Vt=ut(yt,jt,ie,C,M,Te),nt&&(yt.start=Ft+St*Vt)):Yt(yt,jt,ie,k),O<we&&P>=we&&(Vt=ut(yt,jt,ie,C,M,we),xe=!0),O>Te&&P<=Te&&(Vt=ut(yt,jt,ie,C,M,Te),xe=!0),!He&&xe&&(nt&&(yt.end=Ft+St*Vt),be.push(yt),yt=Zt(ct)),nt&&(Ft+=St)}let sr=ct.length-3;const st=ct[sr],qe=ct[sr+1],Ct=Ge===0?st:qe;Ct>=we&&Ct<=Te&&Yt(yt,st,qe,ct[sr+2]),sr=yt.length-3,He&&sr>=3&&(yt[sr]!==yt[0]||yt[sr+1]!==yt[1])&&Yt(yt,yt[0],yt[1],yt[2]),yt.length&&be.push(yt)}function Zt(ct){const be=[];return be.size=ct.size,be.start=ct.start,be.end=ct.end,be}function Ot(ct,be,we,Te,Ge,He){for(const nt of ct)zt(nt,be,we,Te,Ge,He,!1)}function Yt(ct,be,we,Te){ct.push(be,we,Te)}function Ar(ct,be,we,Te,Ge,He){const nt=(He-be)/(Te-be);return Yt(ct,He,we+(Ge-we)*nt,1),nt}function yr(ct,be,we,Te,Ge,He){const nt=(He-we)/(Ge-we);return Yt(ct,be+(Te-be)*nt,He,1),nt}function kr(ct,be){const we=[];for(let Te=0;Te<ct.length;Te++){const Ge=ct[Te],He=Ge.type;let nt;if(He==="Point"||He==="MultiPoint"||He==="LineString")nt=Tr(Ge.geometry,be);else if(He==="MultiLineString"||He==="Polygon"){nt=[];for(const yt of Ge.geometry)nt.push(Tr(yt,be))}else if(He==="MultiPolygon"){nt=[];for(const yt of Ge.geometry){const ut=[];for(const St of yt)ut.push(Tr(St,be));nt.push(ut)}}we.push(Ye(Ge.id,He,nt,Ge.tags))}return we}function Tr(ct,be){const we=[];we.size=ct.size,ct.start!==void 0&&(we.start=ct.start,we.end=ct.end);for(let Te=0;Te<ct.length;Te+=3)we.push(ct[Te]+be,ct[Te+1],ct[Te+2]);return we}function Dr(ct,be){if(ct.transformed)return ct;const we=1<<ct.z,Te=ct.x,Ge=ct.y;for(const He of ct.features){const nt=He.geometry,yt=He.type;if(He.geometry=[],yt===1)for(let ut=0;ut<nt.length;ut+=2)He.geometry.push(hi(nt[ut],nt[ut+1],be,we,Te,Ge));else for(let ut=0;ut<nt.length;ut++){const St=[];for(let Vt=0;Vt<nt[ut].length;Vt+=2)St.push(hi(nt[ut][Vt],nt[ut][Vt+1],be,we,Te,Ge));He.geometry.push(St)}}return ct.transformed=!0,ct}function hi(ct,be,we,Te,Ge,He){return[Math.round(we*(ct*Te-Ge)),Math.round(we*(be*Te-He))]}function ni(ct,be,we,Te,Ge){const He=be===Ge.maxZoom?0:Ge.tolerance/((1<<be)*Ge.extent),nt={features:[],numPoints:0,numSimplified:0,numFeatures:ct.length,source:null,x:we,y:Te,z:be,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const yt of ct)ui(nt,yt,He,Ge);return nt}function ui(ct,be,we,Te){const Ge=be.geometry,He=be.type,nt=[];if(ct.minX=Math.min(ct.minX,be.minX),ct.minY=Math.min(ct.minY,be.minY),ct.maxX=Math.max(ct.maxX,be.maxX),ct.maxY=Math.max(ct.maxY,be.maxY),He==="Point"||He==="MultiPoint")for(let yt=0;yt<Ge.length;yt+=3)nt.push(Ge[yt],Ge[yt+1]),ct.numPoints++,ct.numSimplified++;else if(He==="LineString")dn(nt,Ge,ct,we,!1,!1);else if(He==="MultiLineString"||He==="Polygon")for(let yt=0;yt<Ge.length;yt++)dn(nt,Ge[yt],ct,we,He==="Polygon",yt===0);else if(He==="MultiPolygon")for(let yt=0;yt<Ge.length;yt++){const ut=Ge[yt];for(let St=0;St<ut.length;St++)dn(nt,ut[St],ct,we,!0,St===0)}if(nt.length){let yt=be.tags||null;if(He==="LineString"&&Te.lineMetrics){yt={};for(const St in be.tags)yt[St]=be.tags[St];yt.mapbox_clip_start=Ge.start/Ge.size,yt.mapbox_clip_end=Ge.end/Ge.size}const ut={geometry:nt,type:He==="Polygon"||He==="MultiPolygon"?3:He==="LineString"||He==="MultiLineString"?2:1,tags:yt};be.id!==null&&(ut.id=be.id),ct.features.push(ut)}}function dn(ct,be,we,Te,Ge,He){const nt=Te*Te;if(Te>0&&be.size<(Ge?nt:Te))return void(we.numPoints+=be.length/3);const yt=[];for(let ut=0;ut<be.length;ut+=3)(Te===0||be[ut+2]>nt)&&(we.numSimplified++,yt.push(be[ut],be[ut+1])),we.numPoints++;Ge&&function(ut,St){let Vt=0;for(let Ft=0,sr=ut.length,st=sr-2;Ft<sr;st=Ft,Ft+=2)Vt+=(ut[Ft]-ut[st])*(ut[Ft+1]+ut[st+1]);if(Vt>0===St)for(let Ft=0,sr=ut.length;Ft<sr/2;Ft+=2){const st=ut[Ft],qe=ut[Ft+1];ut[Ft]=ut[sr-2-Ft],ut[Ft+1]=ut[sr-1-Ft],ut[sr-2-Ft]=st,ut[sr-1-Ft]=qe}}(yt,He),ct.push(yt)}const Xi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class fn{constructor(be,we){const Te=(we=this.options=function(He,nt){for(const yt in nt)He[yt]=nt[yt];return He}(Object.create(Xi),we)).debug;if(Te&&console.time("preprocess data"),we.maxZoom<0||we.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(we.promoteId&&we.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ge=function(He,nt){const yt=[];if(He.type==="FeatureCollection")for(let ut=0;ut<He.features.length;ut++)ot(yt,He.features[ut],nt,ut);else ot(yt,He.type==="Feature"?He:{geometry:He},nt);return yt}(be,we);this.tiles={},this.tileCoords=[],Te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",we.indexMaxZoom,we.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ge=function(He,nt){const yt=nt.buffer/nt.extent;let ut=He;const St=Jt(He,1,-1-yt,yt,0,-1,2,nt),Vt=Jt(He,1,1-yt,2+yt,0,-1,2,nt);return(St||Vt)&&(ut=Jt(He,1,-yt,1+yt,0,-1,2,nt)||[],St&&(ut=kr(St,1).concat(ut)),Vt&&(ut=ut.concat(kr(Vt,-1)))),ut}(Ge,we),Ge.length&&this.splitTile(Ge,0,0,0),Te&&(Ge.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(be,we,Te,Ge,He,nt,yt){const ut=[be,we,Te,Ge],St=this.options,Vt=St.debug;for(;ut.length;){Ge=ut.pop(),Te=ut.pop(),we=ut.pop(),be=ut.pop();const Ft=1<<we,sr=Pr(we,Te,Ge);let st=this.tiles[sr];if(!st&&(Vt>1&&console.time("creation"),st=this.tiles[sr]=ni(be,we,Te,Ge,St),this.tileCoords.push({z:we,x:Te,y:Ge}),Vt)){Vt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",we,Te,Ge,st.numFeatures,st.numPoints,st.numSimplified),console.timeEnd("creation"));const xe=`z${we}`;this.stats[xe]=(this.stats[xe]||0)+1,this.total++}if(st.source=be,He==null){if(we===St.indexMaxZoom||st.numPoints<=St.indexMaxPoints)continue}else{if(we===St.maxZoom||we===He)continue;if(He!=null){const xe=He-we;if(Te!==nt>>xe||Ge!==yt>>xe)continue}}if(st.source=null,be.length===0)continue;Vt>1&&console.time("clipping");const qe=.5*St.buffer/St.extent,Ct=.5-qe,wt=.5+qe,jt=1+qe;let ie=null,k=null,C=null,M=null,P=Jt(be,Ft,Te-qe,Te+wt,0,st.minX,st.maxX,St),O=Jt(be,Ft,Te+Ct,Te+jt,0,st.minX,st.maxX,St);be=null,P&&(ie=Jt(P,Ft,Ge-qe,Ge+wt,1,st.minY,st.maxY,St),k=Jt(P,Ft,Ge+Ct,Ge+jt,1,st.minY,st.maxY,St),P=null),O&&(C=Jt(O,Ft,Ge-qe,Ge+wt,1,st.minY,st.maxY,St),M=Jt(O,Ft,Ge+Ct,Ge+jt,1,st.minY,st.maxY,St),O=null),Vt>1&&console.timeEnd("clipping"),ut.push(ie||[],we+1,2*Te,2*Ge),ut.push(k||[],we+1,2*Te,2*Ge+1),ut.push(C||[],we+1,2*Te+1,2*Ge),ut.push(M||[],we+1,2*Te+1,2*Ge+1)}}getTile(be,we,Te){be=+be,we=+we,Te=+Te;const Ge=this.options,{extent:He,debug:nt}=Ge;if(be<0||be>24)return null;const yt=1<<be,ut=Pr(be,we=we+yt&yt-1,Te);if(this.tiles[ut])return Dr(this.tiles[ut],He);nt>1&&console.log("drilling down to z%d-%d-%d",be,we,Te);let St,Vt=be,Ft=we,sr=Te;for(;!St&&Vt>0;)Vt--,Ft>>=1,sr>>=1,St=this.tiles[Pr(Vt,Ft,sr)];return St&&St.source?(nt>1&&(console.log("found parent tile z%d-%d-%d",Vt,Ft,sr),console.time("drilling down")),this.splitTile(St.source,Vt,Ft,sr,be,we,Te),nt>1&&console.timeEnd("drilling down"),this.tiles[ut]?Dr(this.tiles[ut],He):null):null}}function Pr(ct,be,we){return 32*((1<<ct)*we+be)+ct}class xi extends B{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(be,we){return p._(this,void 0,void 0,function*(){const Te=be.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Ge=this._geoJSONIndex.getTile(Te.z,Te.x,Te.y);if(!Ge)return null;const He=new te(Ge.features,{version:2,extent:p.$});let nt=function(yt){const ut=new p.cM;return function(St,Vt){for(const Ft in St.layers)Vt.writeMessage(3,Q,St.layers[Ft])}(yt,ut),ut.finish()}(He);return nt.byteOffset===0&&nt.byteLength===nt.buffer.byteLength||(nt=new Uint8Array(nt)),{vectorTile:He,rawData:nt.buffer}})}loadData(be){return p._(this,void 0,void 0,function*(){var we;(we=this._pendingRequest)===null||we===void 0||we.abort();const Te=!!(be&&be.request&&be.request.collectResourceTiming)&&new p.cN(be.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(be,this._pendingRequest);const Ge=yield this._pendingData;this._geoJSONIndex=be.cluster?new Be(function({superclusterOptions:nt,clusterProperties:yt}){if(!yt||!nt)return nt;const ut={},St={},Vt={accumulated:null,zoom:0},Ft={properties:null},sr=Object.keys(yt);for(const st of sr){const[qe,Ct]=yt[st],wt=p.cT(Ct),jt=p.cT(typeof qe=="string"?[qe,["accumulated"],["get",st]]:qe);ut[st]=wt.value,St[st]=jt.value}return nt.map=st=>{Ft.properties=st;const qe={};for(const Ct of sr)qe[Ct]=ut[Ct].evaluate(Vt,Ft);return qe},nt.reduce=(st,qe)=>{Ft.properties=qe;for(const Ct of sr)Vt.accumulated=st[Ct],st[Ct]=St[Ct].evaluate(Vt,Ft)},nt}(be)).load(Ge.features):function(nt,yt){return new fn(nt,yt)}(Ge,be.geojsonVtOptions),this.loaded={};const He={data:Ge};if(Te){const nt=Te.finish();nt&&(He.resourceTiming={},He.resourceTiming[be.source]=JSON.parse(JSON.stringify(nt)))}return He}catch(Ge){if(delete this._pendingRequest,p.cy(Ge))return{abandoned:!0};throw Ge}})}getData(){return p._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(be){const we=this.loaded;return we&&we[be.uid]?super.reloadTile(be):this.loadTile(be)}loadAndProcessGeoJSON(be,we){return p._(this,void 0,void 0,function*(){let Te=yield this.loadGeoJSON(be,we);if(delete this._pendingRequest,typeof Te!="object")throw new Error(`Input data given to '${be.source}' is not a valid GeoJSON object.`);if(j(Te,!0),be.filter){const Ge=p.cT(be.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ge.result==="error")throw new Error(Ge.value.map(nt=>`${nt.key}: ${nt.message}`).join(", "));Te={type:"FeatureCollection",features:Te.features.filter(nt=>Ge.value.evaluate({zoom:0},nt))}}return Te})}loadGeoJSON(be,we){return p._(this,void 0,void 0,function*(){const{promoteId:Te}=be;if(be.request){const Ge=yield p.j(be.request,we);return this._dataUpdateable=p.cV(Ge.data,Te)?p.cU(Ge.data,Te):void 0,Ge.data}if(typeof be.data=="string")try{const Ge=JSON.parse(be.data);return this._dataUpdateable=p.cV(Ge,Te)?p.cU(Ge,Te):void 0,Ge}catch{throw new Error(`Input data given to '${be.source}' is not a valid GeoJSON object.`)}if(!be.dataDiff)throw new Error(`Input data given to '${be.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${be.source}`);return p.cW(this._dataUpdateable,be.dataDiff,Te),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(be){return p._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(be){return this._geoJSONIndex.getClusterExpansionZoom(be.clusterId)}getClusterChildren(be){return this._geoJSONIndex.getChildren(be.clusterId)}getClusterLeaves(be){return this._geoJSONIndex.getLeaves(be.clusterId,be.limit,be.offset)}}class Fi{constructor(be){this.self=be,this.actor=new p.J(be),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(we,Te)=>{if(this.externalWorkerSourceTypes[we])throw new Error(`Worker source with name "${we}" already registered.`);this.externalWorkerSourceTypes[we]=Te},this.self.addProtocol=p.cA,this.self.removeProtocol=p.cB,this.self.registerRTLTextPlugin=we=>{p.cX.setMethods(we)},this.actor.registerMessageHandler("LDT",(we,Te)=>this._getDEMWorkerSource(we,Te.source).loadTile(Te)),this.actor.registerMessageHandler("RDT",(we,Te)=>p._(this,void 0,void 0,function*(){this._getDEMWorkerSource(we,Te.source).removeTile(Te)})),this.actor.registerMessageHandler("GCEZ",(we,Te)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(we,Te.type,Te.source).getClusterExpansionZoom(Te)})),this.actor.registerMessageHandler("GCC",(we,Te)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(we,Te.type,Te.source).getClusterChildren(Te)})),this.actor.registerMessageHandler("GCL",(we,Te)=>p._(this,void 0,void 0,function*(){return this._getWorkerSource(we,Te.type,Te.source).getClusterLeaves(Te)})),this.actor.registerMessageHandler("LD",(we,Te)=>this._getWorkerSource(we,Te.type,Te.source).loadData(Te)),this.actor.registerMessageHandler("GD",(we,Te)=>this._getWorkerSource(we,Te.type,Te.source).getData()),this.actor.registerMessageHandler("LT",(we,Te)=>this._getWorkerSource(we,Te.type,Te.source).loadTile(Te)),this.actor.registerMessageHandler("RT",(we,Te)=>this._getWorkerSource(we,Te.type,Te.source).reloadTile(Te)),this.actor.registerMessageHandler("AT",(we,Te)=>this._getWorkerSource(we,Te.type,Te.source).abortTile(Te)),this.actor.registerMessageHandler("RMT",(we,Te)=>this._getWorkerSource(we,Te.type,Te.source).removeTile(Te)),this.actor.registerMessageHandler("RS",(we,Te)=>p._(this,void 0,void 0,function*(){if(!this.workerSources[we]||!this.workerSources[we][Te.type]||!this.workerSources[we][Te.type][Te.source])return;const Ge=this.workerSources[we][Te.type][Te.source];delete this.workerSources[we][Te.type][Te.source],Ge.removeSource!==void 0&&Ge.removeSource(Te)})),this.actor.registerMessageHandler("RM",we=>p._(this,void 0,void 0,function*(){delete this.layerIndexes[we],delete this.availableImages[we],delete this.workerSources[we],delete this.demWorkerSources[we],this.globalStates.delete(we)})),this.actor.registerMessageHandler("SR",(we,Te)=>p._(this,void 0,void 0,function*(){this.referrer=Te})),this.actor.registerMessageHandler("SRPS",(we,Te)=>this._syncRTLPluginState(we,Te)),this.actor.registerMessageHandler("IS",(we,Te)=>p._(this,void 0,void 0,function*(){this.self.importScripts(Te)})),this.actor.registerMessageHandler("SI",(we,Te)=>this._setImages(we,Te)),this.actor.registerMessageHandler("UL",(we,Te)=>p._(this,void 0,void 0,function*(){this._getLayerIndex(we).update(Te.layers,Te.removedIds,this._getGlobalState(we))})),this.actor.registerMessageHandler("UGS",(we,Te)=>p._(this,void 0,void 0,function*(){const Ge=this._getGlobalState(we);for(const He in Te)Ge[He]=Te[He]})),this.actor.registerMessageHandler("SL",(we,Te)=>p._(this,void 0,void 0,function*(){this._getLayerIndex(we).replace(Te,this._getGlobalState(we))}))}_getGlobalState(be){let we=this.globalStates.get(be);return we||(we={},this.globalStates.set(be,we)),we}_setImages(be,we){return p._(this,void 0,void 0,function*(){this.availableImages[be]=we;for(const Te in this.workerSources[be]){const Ge=this.workerSources[be][Te];for(const He in Ge)Ge[He].availableImages=we}})}_syncRTLPluginState(be,we){return p._(this,void 0,void 0,function*(){return yield p.cX.syncState(we,this.self.importScripts)})}_getAvailableImages(be){let we=this.availableImages[be];return we||(we=[]),we}_getLayerIndex(be){let we=this.layerIndexes[be];return we||(we=this.layerIndexes[be]=new s),we}_getWorkerSource(be,we,Te){if(this.workerSources[be]||(this.workerSources[be]={}),this.workerSources[be][we]||(this.workerSources[be][we]={}),!this.workerSources[be][we][Te]){const Ge={sendAsync:(He,nt)=>(He.targetMapId=be,this.actor.sendAsync(He,nt))};switch(we){case"vector":this.workerSources[be][we][Te]=new B(Ge,this._getLayerIndex(be),this._getAvailableImages(be));break;case"geojson":this.workerSources[be][we][Te]=new xi(Ge,this._getLayerIndex(be),this._getAvailableImages(be));break;default:this.workerSources[be][we][Te]=new this.externalWorkerSourceTypes[we](Ge,this._getLayerIndex(be),this._getAvailableImages(be))}}return this.workerSources[be][we][Te]}_getDEMWorkerSource(be,we){return this.demWorkerSources[be]||(this.demWorkerSources[be]={}),this.demWorkerSources[be][we]||(this.demWorkerSources[be][we]=new D),this.demWorkerSources[be][we]}}return p.i(self)&&(self.worker=new Fi(self)),Fi}),h("index",["exports","./shared"],function(p,s){var w="5.8.0";function A(){var v=new s.A(4);return s.A!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v}let z,B;const D={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(v,r,c){const f=requestAnimationFrame(y=>{g(),r(y)}),{unsubscribe:g}=s.s(v.signal,"abort",()=>{g(),cancelAnimationFrame(f),c(s.c())},!1)},frameAsync(v){return new Promise((r,c)=>{this.frame(v,r,c)})},getImageData(v,r=0){return this.getImageCanvasContext(v).getImageData(-r,-r,v.width+2*r,v.height+2*r)},getImageCanvasContext(v){const r=window.document.createElement("canvas"),c=r.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return r.width=v.width,r.height=v.height,c.drawImage(v,0,0,v.width,v.height),c},resolveURL:v=>(z||(z=document.createElement("a")),z.href=v,z.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(B==null&&(B=matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};class V{static testProp(r){if(!V.docStyle)return r[0];for(let c=0;c<r.length;c++)if(r[c]in V.docStyle)return r[c];return r[0]}static create(r,c,f){const g=window.document.createElement(r);return c!==void 0&&(g.className=c),f&&f.appendChild(g),g}static createNS(r,c){return window.document.createElementNS(r,c)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]="none")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(r,c){r.style[V.transformProp]=c}static addEventListener(r,c,f,g={}){r.addEventListener(c,f,"passive"in g?g:g.capture)}static removeEventListener(r,c,f,g={}){r.removeEventListener(c,f,"passive"in g?g:g.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",V.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",V.suppressClickInternal,!0)},0)}static getScale(r){const c=r.getBoundingClientRect();return{x:c.width/r.offsetWidth||1,y:c.height/r.offsetHeight||1,boundingClientRect:c}}static getPoint(r,c,f){const g=c.boundingClientRect;return new s.P((f.clientX-g.left)/c.x-r.clientLeft,(f.clientY-g.top)/c.y-r.clientTop)}static mousePos(r,c){const f=V.getScale(r);return V.getPoint(r,f,c)}static touchPos(r,c){const f=[],g=V.getScale(r);for(let y=0;y<c.length;y++)f.push(V.getPoint(r,g,c[y]));return f}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}static sanitize(r){const c=new DOMParser().parseFromString(r,"text/html").body||document.createElement("body"),f=c.querySelectorAll("script");for(const g of f)g.remove();return V.clean(c),c.innerHTML}static isPossiblyDangerous(r,c){const f=c.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(r)||!f.includes("javascript:")&&!f.includes("data:"))||!!r.startsWith("on")||void 0}static clean(r){const c=r.children;for(const f of c)V.removeAttributes(f),V.clean(f)}static removeAttributes(r){for(const{name:c,value:f}of r.attributes)V.isPossiblyDangerous(c,f)&&r.removeAttribute(c)}}V.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V.transformProp=V.testProp(["transform","WebkitTransform"]);const W={supported:!1,testSupport:function(v){!ne&&j&&(te?Q(v):S=v)}};let S,j,ne=!1,te=!1;function Q(v){const r=v.createTexture();v.bindTexture(v.TEXTURE_2D,r);try{if(v.texImage2D(v.TEXTURE_2D,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,j),v.isContextLost())return;W.supported=!0}catch{}v.deleteTexture(r),ne=!0}var N;typeof document<"u"&&(j=document.createElement("img"),j.onload=()=>{S&&Q(S),S=null,te=!0},j.onerror=()=>{ne=!0,S=null},j.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(v){let r,c,f,g;v.resetRequestQueue=()=>{r=[],c=0,f=0,g={}},v.addThrottleControl=F=>{const H=f++;return g[H]=F,H},v.removeThrottleControl=F=>{delete g[F],x()},v.getImage=(F,H,X=!0)=>new Promise((ae,ee)=>{W.supported&&(F.headers||(F.headers={}),F.headers.accept="image/webp,*/*"),s.e(F,{type:"image"}),r.push({abortController:H,requestParameters:F,supportImageRefresh:X,state:"queued",onError:de=>{ee(de)},onSuccess:de=>{ae(de)}}),x()});const y=F=>s._(this,void 0,void 0,function*(){F.state="running";const{requestParameters:H,supportImageRefresh:X,onError:ae,onSuccess:ee,abortController:de}=F,Ae=X===!1&&!s.i(self)&&!s.g(H.url)&&(!H.headers||Object.keys(H.headers).reduce((je,Ue)=>je&&Ue==="accept",!0));c++;const Fe=Ae?R(H,de):s.m(H,de);try{const je=yield Fe;delete F.abortController,F.state="completed",je.data instanceof HTMLImageElement||s.b(je.data)?ee(je):je.data&&ee({data:yield(De=je.data,typeof createImageBitmap=="function"?s.f(De):s.h(De)),cacheControl:je.cacheControl,expires:je.expires})}catch(je){delete F.abortController,ae(je)}finally{c--,x()}var De}),x=()=>{const F=(()=>{for(const H of Object.keys(g))if(g[H]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let H=c;H<F&&r.length>0;H++){const X=r.shift();X.abortController.signal.aborted?H--:y(X)}},R=(F,H)=>new Promise((X,ae)=>{const ee=new Image,de=F.url,Ae=F.credentials;Ae&&Ae==="include"?ee.crossOrigin="use-credentials":(Ae&&Ae==="same-origin"||!s.d(de))&&(ee.crossOrigin="anonymous"),H.signal.addEventListener("abort",()=>{ee.src="",ae(s.c())}),ee.fetchPriority="high",ee.onload=()=>{ee.onerror=ee.onload=null,X({data:ee})},ee.onerror=()=>{ee.onerror=ee.onload=null,H.signal.aborted||ae(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ee.src=de})}(N||(N={})),N.resetRequestQueue();class re{constructor(r){this._transformRequestFn=r??null}transformRequest(r,c){return this._transformRequestFn&&this._transformRequestFn(r,c)||{url:r}}setTransformRequest(r){this._transformRequestFn=r}}function oe(v){const r=[];if(typeof v=="string")r.push({id:"default",url:v});else if(v&&v.length>0){const c=[];for(const{id:f,url:g}of v){const y=`${f}${g}`;c.indexOf(y)===-1&&(c.push(y),r.push({id:f,url:g}))}}return r}function ve(v,r,c){try{const f=new URL(v);return f.pathname+=`${r}${c}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${v}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Pe(v){const{userImage:r}=v;return!!(r&&r.render&&r.render())&&(v.data.replace(new Uint8Array(r.data.buffer)),!0)}class $ extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:c,promiseResolve:f}of this.requestors)f(this._getImagesForIds(c));this.requestors=[]}}getImage(r){const c=this.images[r];if(c&&!c.data&&c.spriteData){const f=c.spriteData;c.data=new s.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),c.spriteData=null}return c}addImage(r,c){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,c)&&(this.images[r]=c)}_validate(r,c){let f=!0;const g=c.data||c.spriteData;return this._validateStretch(c.stretchX,g&&g.width)||(this.fire(new s.k(new Error(`Image "${r}" has invalid "stretchX" value`))),f=!1),this._validateStretch(c.stretchY,g&&g.height)||(this.fire(new s.k(new Error(`Image "${r}" has invalid "stretchY" value`))),f=!1),this._validateContent(c.content,c)||(this.fire(new s.k(new Error(`Image "${r}" has invalid "content" value`))),f=!1),f}_validateStretch(r,c){if(!r)return!0;let f=0;for(const g of r){if(g[0]<f||g[1]<g[0]||c<g[1])return!1;f=g[1]}return!0}_validateContent(r,c){if(!r)return!0;if(r.length!==4)return!1;const f=c.spriteData,g=f&&f.width||c.data.width,y=f&&f.height||c.data.height;return!(r[0]<0||g<r[0]||r[1]<0||y<r[1]||r[2]<0||g<r[2]||r[3]<0||y<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,c,f=!0){const g=this.getImage(r);if(f&&(g.data.width!==c.data.width||g.data.height!==c.data.height))throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${c.data.width}x${c.data.height}).`);c.version=g.version+1,this.images[r]=c,this.updatedImages[r]=!0}removeImage(r){const c=this.images[r];delete this.images[r],delete this.patterns[r],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r){return new Promise((c,f)=>{let g=!0;if(!this.isLoaded())for(const y of r)this.images[y]||(g=!1);this.isLoaded()||g?c(this._getImagesForIds(r)):this.requestors.push({ids:r,promiseResolve:c})})}_getImagesForIds(r){const c={};for(const f of r){let g=this.getImage(f);g||(this.fire(new s.l("styleimagemissing",{id:f})),g=this.getImage(f)),g?c[f]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,textFitWidth:g.textFitWidth,textFitHeight:g.textFitHeight,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:s.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return c}getPixelSize(){const{width:r,height:c}=this.atlasImage;return{width:r,height:c}}getPattern(r){const c=this.patterns[r],f=this.getImage(r);if(!f)return null;if(c&&c.position.version===f.version)return c.position;if(c)c.position.version=f.version;else{const g={w:f.data.width+2,h:f.data.height+2,x:0,y:0},y=new s.I(g,f);this.patterns[r]={bin:g,position:y}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const c=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(r,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const y in this.patterns)r.push(this.patterns[y].bin);const{w:c,h:f}=s.p(r),g=this.atlasImage;g.resize({width:c||1,height:f||1});for(const y in this.patterns){const{bin:x}=this.patterns[y],R=x.x+1,F=x.y+1,H=this.getImage(y).data,X=H.width,ae=H.height;s.R.copy(H,g,{x:0,y:0},{x:R,y:F},{width:X,height:ae}),s.R.copy(H,g,{x:0,y:ae-1},{x:R,y:F-1},{width:X,height:1}),s.R.copy(H,g,{x:0,y:0},{x:R,y:F+ae},{width:X,height:1}),s.R.copy(H,g,{x:X-1,y:0},{x:R-1,y:F},{width:1,height:ae}),s.R.copy(H,g,{x:0,y:0},{x:R+X,y:F},{width:1,height:ae})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const c of r){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const f=this.getImage(c);f||s.w(`Image with ID: "${c}" was not found`),Pe(f)&&this.updateImage(c,f)}}}const le=1e20;function Me(v,r,c,f,g,y,x,R,F){for(let H=r;H<r+f;H++)Ve(v,c*y+H,y,g,x,R,F);for(let H=c;H<c+g;H++)Ve(v,H*y+r,1,f,x,R,F)}function Ve(v,r,c,f,g,y,x){y[0]=0,x[0]=-1e20,x[1]=le,g[0]=v[r];for(let R=1,F=0,H=0;R<f;R++){g[R]=v[r+R*c];const X=R*R;do{const ae=y[F];H=(g[R]-g[ae]+X-ae*ae)/(R-ae)/2}while(H<=x[F]&&--F>-1);F++,y[F]=R,x[F]=H,x[F+1]=le}for(let R=0,F=0;R<f;R++){for(;x[F+1]<R;)F++;const H=y[F],X=R-H;v[r+R*c]=g[H]+X*X}}class Be{constructor(r,c,f){this.requestManager=r,this.localIdeographFontFamily=c,this.entries={},this.lang=f}setURL(r){this.url=r}getGlyphs(r){return s._(this,void 0,void 0,function*(){const c=[];for(const y in r)for(const x of r[y])c.push(this._getAndCacheGlyphsPromise(y,x));const f=yield Promise.all(c),g={};for(const{stack:y,id:x,glyph:R}of f)g[y]||(g[y]={}),g[y][x]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};return g})}_getAndCacheGlyphsPromise(r,c){return s._(this,void 0,void 0,function*(){let f=this.entries[r];f||(f=this.entries[r]={glyphs:{},requests:{},ranges:{}});let g=f.glyphs[c];if(g!==void 0)return{stack:r,id:c,glyph:g};if(g=this._tinySDF(f,r,c),g)return f.glyphs[c]=g,{stack:r,id:c,glyph:g};const y=Math.floor(c/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[y])return{stack:r,id:c,glyph:g};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[y]){const R=Be.loadGlyphRange(r,y,this.url,this.requestManager);f.requests[y]=R}const x=yield f.requests[y];for(const R in x)this._doesCharSupportLocalGlyph(+R)||(f.glyphs[+R]=x[+R]);return f.ranges[y]=!0,{stack:r,id:c,glyph:x[c]||null}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(r))||s.u["CJK Unified Ideographs"](r)||s.u["Hangul Syllables"](r)||s.u.Hiragana(r)||s.u.Katakana(r)||s.u["CJK Symbols and Punctuation"](r)||s.u["Halfwidth and Fullwidth Forms"](r))}_tinySDF(r,c,f){const g=this.localIdeographFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let y=r.tinySDF;if(!y){let R="400";/bold/i.test(c)?R="900":/medium/i.test(c)?R="500":/light/i.test(c)&&(R="200"),y=r.tinySDF=new Be.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:g,fontWeight:R})}const x=y.draw(String.fromCharCode(f));return{id:f,bitmap:new s.q({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}Be.loadGlyphRange=function(v,r,c,f){return s._(this,void 0,void 0,function*(){const g=256*r,y=g+255,x=f.transformRequest(c.replace("{fontstack}",v).replace("{range}",`${g}-${y}`),"Glyphs"),R=yield s.n(x,new AbortController);if(!R||!R.data)throw new Error(`Could not load glyph range. range: ${r}, ${g}-${y}`);const F={};for(const H of s.o(R.data))F[H.id]=H;return F})},Be.TinySDF=class{constructor({fontSize:v=24,buffer:r=3,radius:c=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:y="normal",fontStyle:x="normal",lang:R=null}={}){this.buffer=r,this.cutoff=f,this.radius=c,this.lang=R;const F=this.size=v+4*r,H=this._createCanvas(F),X=this.ctx=H.getContext("2d",{willReadFrequently:!0});X.font=`${x} ${y} ${v}px ${g}`,X.textBaseline="alphabetic",X.textAlign="left",X.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Uint16Array(F)}_createCanvas(v){const r=document.createElement("canvas");return r.width=r.height=v,r}draw(v){const{width:r,actualBoundingBoxAscent:c,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:y}=this.ctx.measureText(v),x=Math.ceil(c),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-g))),F=Math.min(this.size-this.buffer,x+Math.ceil(f)),H=R+2*this.buffer,X=F+2*this.buffer,ae=Math.max(H*X,0),ee=new Uint8ClampedArray(ae),de={data:ee,width:H,height:X,glyphWidth:R,glyphHeight:F,glyphTop:x,glyphLeft:0,glyphAdvance:r};if(R===0||F===0)return de;const{ctx:Ae,buffer:Fe,gridInner:De,gridOuter:je}=this;this.lang&&(Ae.lang=this.lang),Ae.clearRect(Fe,Fe,R,F),Ae.fillText(v,Fe,Fe+x);const Ue=Ae.getImageData(Fe,Fe,R,F);je.fill(le,0,ae),De.fill(0,0,ae);for(let et=0;et<F;et++)for(let Xe=0;Xe<R;Xe++){const it=Ue.data[4*(et*R+Xe)+3]/255;if(it===0)continue;const dt=(et+Fe)*H+Xe+Fe;if(it===1)je[dt]=0,De[dt]=le;else{const Je=.5-it;je[dt]=Je>0?Je*Je:0,De[dt]=Je<0?Je*Je:0}}Me(je,0,0,H,X,H,this.f,this.v,this.z),Me(De,Fe,Fe,R,F,H,this.f,this.v,this.z);for(let et=0;et<ae;et++){const Xe=Math.sqrt(je[et])-Math.sqrt(De[et]);ee[et]=Math.round(255-255*(Xe/this.radius+this.cutoff))}return de}};class q{constructor(){this.specification=s.v.light.position}possiblyEvaluate(r,c){return s.B(r.expression.evaluate(c))}interpolate(r,c,f){return{x:s.C.number(r.x,c.x,f),y:s.C.number(r.y,c.y,f),z:s.C.number(r.z,c.z,f)}}}let me;class Ee extends s.E{constructor(r){super(),me=me||new s.r({anchor:new s.D(s.v.light.anchor),position:new q,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.t(me,void 0),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,c={}){if(!this._validate(s.x,r,c))for(const f in r){const g=r[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,f){return(!f||f.validate!==!1)&&s.y(this,r.call(s.z,{value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}const Ne=new s.r({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class $e extends s.E{constructor(r){super(),this._transitionable=new s.t(Ne,void 0),this.setSky(r),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0))}setSky(r,c={}){if(!this._validate(s.G,r,c)){r||(r={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in r){const g=r[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),g):this._transitionable.setValue(f,g)}}}getSky(){return this._transitionable.serialize()}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,f={}){return(f==null?void 0:f.validate)!==!1&&s.y(this,r.call(s.z,s.e({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(r){return r<60?0:r<70?(r-60)/10:1}}class ye{constructor(r,c){this.width=r,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,c){const f=r.join(",")+String(c);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(r,c)),this.dashEntry[f]}getDashRanges(r,c,f){const g=[];let y=r.length%2==1?-r[r.length-1]*f:0,x=r[0]*f,R=!0;g.push({left:y,right:x,isDash:R,zeroLength:r[0]===0});let F=r[0];for(let H=1;H<r.length;H++){R=!R;const X=r[H];y=F*f,F+=X,x=F*f,g.push({left:y,right:x,isDash:R,zeroLength:X===0})}return g}addRoundDash(r,c,f){const g=c/2;for(let y=-f;y<=f;y++){const x=this.width*(this.nextRow+f+y);let R=0,F=r[R];for(let H=0;H<this.width;H++){H/F.right>1&&(F=r[++R]);const X=Math.abs(H-F.left),ae=Math.abs(H-F.right),ee=Math.min(X,ae);let de;const Ae=y/f*(g+1);if(F.isDash){const Fe=g-Math.abs(Ae);de=Math.sqrt(ee*ee+Fe*Fe)}else de=g-Math.sqrt(ee*ee+Ae*Ae);this.data[x+H]=Math.max(0,Math.min(255,de+128))}}}addRegularDash(r){for(let R=r.length-1;R>=0;--R){const F=r[R],H=r[R+1];F.zeroLength?r.splice(R,1):H&&H.isDash===F.isDash&&(H.left=F.left,r.splice(R,1))}const c=r[0],f=r[r.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const g=this.width*this.nextRow;let y=0,x=r[y];for(let R=0;R<this.width;R++){R/x.right>1&&(x=r[++y]);const F=Math.abs(R-x.left),H=Math.abs(R-x.right),X=Math.min(F,H);this.data[g+R]=Math.max(0,Math.min(255,(x.isDash?X:-X)+128))}}addDash(r,c){const f=c?7:0,g=2*f+1;if(this.nextRow+g>this.height)return s.w("LineAtlas out of space"),null;let y=0;for(let R=0;R<r.length;R++)y+=r[R];if(y!==0){const R=this.width/y,F=this.getDashRanges(r,this.width,R);c?this.addRoundDash(F,R,f):this.addRegularDash(F)}const x={y:this.nextRow+f,height:2*f,width:y};return this.nextRow+=g,this.dirty=!0,x}bind(r){const c=r.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))}}const ge="maplibre_preloaded_worker_pool";class Ye{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Ye.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ge]}numActive(){return Object.keys(this.active).length}}const We=Math.floor(D.hardwareConcurrency/2);let ot,Se;function Ce(){return ot||(ot=new Ye),ot}Ye.workerCount=s.H(globalThis)?Math.max(Math.min(We,3),1):1;class It{constructor(r,c){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=c;const f=this.workerPool.acquire(c);for(let g=0;g<f.length;g++){const y=new s.J(f[g],c);y.name=`Worker ${g}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,c){const f=[];for(const g of this.actors)f.push(g.sendAsync({type:r,data:c}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(c=>{c.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}registerMessageHandler(r,c){for(const f of this.actors)f.registerMessageHandler(r,c)}}function Lt(){return Se||(Se=new It(Ce(),s.K),Se.registerMessageHandler("GR",(v,r,c)=>s.m(r,c))),Se}function Xt(v,r){const c=s.L();return s.M(c,c,[1,1,0]),s.N(c,c,[.5*v.width,.5*v.height,1]),v.calculatePosMatrix?s.O(c,c,v.calculatePosMatrix(r.toUnwrapped())):c}function Jt(v,r,c,f,g,y,x){var R;const F=function(ee,de,Ae){if(ee)for(const Fe of ee){const De=de[Fe];if(De&&De.source===Ae&&De.type==="fill-extrusion")return!0}else for(const Fe in de){const De=de[Fe];if(De.source===Ae&&De.type==="fill-extrusion")return!0}return!1}((R=g==null?void 0:g.layers)!==null&&R!==void 0?R:null,r,v.id),H=y.maxPitchScaleFactor(),X=v.tilesIn(f,H,F);X.sort(dr);const ae=[];for(const ee of X)ae.push({wrappedTileID:ee.tileID.wrapped().key,queryResults:ee.tile.queryRenderedFeatures(r,c,v._state,ee.queryGeometry,ee.cameraQueryGeometry,ee.scale,g,y,H,Xt(v.transform,ee.tileID),x?(de,Ae)=>x(ee.tileID,de,Ae):void 0)});return function(ee,de){for(const Ae in ee)for(const Fe of ee[Ae])zt(Fe,de);return ee}(function(ee){const de={},Ae={};for(const Fe of ee){const De=Fe.queryResults,je=Fe.wrappedTileID,Ue=Ae[je]=Ae[je]||{};for(const et in De){const Xe=De[et],it=Ue[et]=Ue[et]||{},dt=de[et]=de[et]||[];for(const Je of Xe)it[Je.featureIndex]||(it[Je.featureIndex]=!0,dt.push(Je))}}return de}(ae),v)}function dr(v,r){const c=v.tileID,f=r.tileID;return c.overscaledZ-f.overscaledZ||c.canonical.y-f.canonical.y||c.wrap-f.wrap||c.canonical.x-f.canonical.x}function zt(v,r){const c=v.feature,f=r.getFeatureState(c.layer["source-layer"],c.id);c.source=c.layer.source,c.layer["source-layer"]&&(c.sourceLayer=c.layer["source-layer"]),c.state=f}function Zt(v,r,c){return s._(this,void 0,void 0,function*(){let f=v;if(v.url?f=(yield s.j(r.transformRequest(v.url,"Source"),c)).data:yield D.frameAsync(c),!f)return null;const g=s.Q(s.e(f,v),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(g.vectorLayerIds=f.vector_layers.map(y=>y.id)),g})}class Ot{constructor(r,c){r&&(c?this.setSouthWest(r).setNorthEast(c):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof s.S?new s.S(r.lng,r.lat):s.S.convert(r),this}setSouthWest(r){return this._sw=r instanceof s.S?new s.S(r.lng,r.lat):s.S.convert(r),this}extend(r){const c=this._sw,f=this._ne;let g,y;if(r instanceof s.S)g=r,y=r;else{if(!(r instanceof Ot))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Ot.convert(r)):this.extend(s.S.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(s.S.convert(r)):this;if(g=r._sw,y=r._ne,!g||!y)return this}return c||f?(c.lng=Math.min(g.lng,c.lng),c.lat=Math.min(g.lat,c.lat),f.lng=Math.max(y.lng,f.lng),f.lat=Math.max(y.lat,f.lat)):(this._sw=new s.S(g.lng,g.lat),this._ne=new s.S(y.lng,y.lat)),this}getCenter(){return new s.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.S(this.getWest(),this.getNorth())}getSouthEast(){return new s.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:c,lat:f}=s.S.convert(r);let g=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(r){return r instanceof Ot?r:r&&new Ot(r)}static fromLngLat(r,c=0){const f=360*c/40075017,g=f/Math.cos(Math.PI/180*r.lat);return new Ot(new s.S(r.lng-g,r.lat-f),new s.S(r.lng+g,r.lat+f))}adjustAntiMeridian(){const r=new s.S(this._sw.lng,this._sw.lat),c=new s.S(this._ne.lng,this._ne.lat);return new Ot(r,r.lng>c.lng?new s.S(c.lng+360,c.lat):c)}}class Yt{constructor(r,c,f){this.bounds=Ot.convert(this.validateBounds(r)),this.minzoom=c||0,this.maxzoom=f||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const c=Math.pow(2,r.z),f=Math.floor(s.V(this.bounds.getWest())*c),g=Math.floor(s.U(this.bounds.getNorth())*c),y=Math.ceil(s.V(this.bounds.getEast())*c),x=Math.ceil(s.U(this.bounds.getSouth())*c);return r.x>=f&&r.x<y&&r.y>=g&&r.y<x}}class Ar extends s.E{constructor(r,c,f,g){if(super(),this.id=r,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.Q(c,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Zt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r&&(s.e(this,r),r.bounds&&(this.tileBounds=new Yt(r.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this._loaded=!0,this.fire(new s.k(r))}})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.abort(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(r){return s._(this,void 0,void 0,function*(){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(c,"Tile"),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};f.request.collectResourceTiming=this._collectResourceTiming;let g="RT";if(r.actor&&r.state!=="expired"){if(r.state==="loading")return new Promise((y,x)=>{r.reloadPromise={resolve:y,reject:x}})}else r.actor=this.dispatcher.getActor(),g="LT";r.abortController=new AbortController;try{const y=yield r.actor.sendAsync({type:g,data:f},r.abortController);if(delete r.abortController,r.aborted)return;this._afterTileLoadWorkerResponse(r,y)}catch(y){if(delete r.abortController,r.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(r,null)}})}_afterTileLoadWorkerResponse(r,c){if(c&&c.resourceTiming&&(r.resourceTiming=c.resourceTiming),c&&this.map._refreshExpiredTiles&&r.setExpiryData(c),r.loadVectorData(c,this.map.painter),r.reloadPromise){const f=r.reloadPromise;r.reloadPromise=null,this.loadTile(r).then(f.resolve).catch(f.reject)}}abortTile(r){return s._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.actor&&(yield r.actor.sendAsync({type:"AT",data:{uid:r.uid,type:this.type,source:this.id}}))})}unloadTile(r){return s._(this,void 0,void 0,function*(){r.unloadVectorData(),r.actor&&(yield r.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class yr extends s.E{constructor(r,c,f,g){super(),this.id=r,this.dispatcher=f,this.setEventedParent(g),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},c),s.e(this,s.Q(c,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(r=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const c=yield Zt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,c&&(s.e(this,c),c.bounds&&(this.tileBounds=new Yt(c.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:r})))}catch(c){this._tileJSONRequest=null,this._loaded=!0,this.fire(new s.k(c))}})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),r(),this.load(!0)}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}serialize(){return s.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r){return s._(this,void 0,void 0,function*(){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.abortController=new AbortController;try{const f=yield N.getImage(this.map._requestManager.transformRequest(c,"Tile"),r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&r.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const g=this.map.painter.context,y=g.gl,x=f.data;r.texture=this.map.painter.getTileTexture(x.width),r.texture?r.texture.update(x,{useMipmap:!0}):(r.texture=new s.T(g,x,y.RGBA,{useMipmap:!0}),r.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST)),r.state="loaded"}}catch(f){if(delete r.abortController,r.aborted)r.state="unloaded";else if(f)throw r.state="errored",f}})}abortTile(r){return s._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController)})}unloadTile(r){return s._(this,void 0,void 0,function*(){r.texture&&this.map.painter.saveTileTexture(r.texture)})}hasTransition(){return!1}}class kr extends yr{constructor(r,c,f,g){super(r,c,f,g),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox",this.redFactor=c.redFactor,this.greenFactor=c.greenFactor,this.blueFactor=c.blueFactor,this.baseShift=c.baseShift}loadTile(r){return s._(this,void 0,void 0,function*(){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(c,"Tile");r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.abortController=new AbortController;try{const g=yield N.getImage(f,r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(g&&g.data){const y=g.data;this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&r.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const x=s.b(y)&&s.W()?y:yield this.readImageNow(y),R={type:this.type,uid:r.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();const F=yield r.actor.sendAsync({type:"LDT",data:R});r.dem=F,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded"}}}catch(g){if(delete r.abortController,r.aborted)r.state="unloaded";else if(g)throw r.state="errored",g}})}readImageNow(r){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.X()){const c=r.width+2,f=r.height+2;try{return new s.R({width:c,height:f},yield s.Y(r,-1,-1,c,f))}catch{}}return D.getImageData(r,1)})}_getNeighboringTiles(r){const c=r.canonical,f=Math.pow(2,c.z),g=(c.x-1+f)%f,y=c.x===0?r.wrap-1:r.wrap,x=(c.x+1+f)%f,R=c.x+1===f?r.wrap+1:r.wrap,F={};return F[new s.Z(r.overscaledZ,y,c.z,g,c.y).key]={backfilled:!1},F[new s.Z(r.overscaledZ,R,c.z,x,c.y).key]={backfilled:!1},c.y>0&&(F[new s.Z(r.overscaledZ,y,c.z,g,c.y-1).key]={backfilled:!1},F[new s.Z(r.overscaledZ,r.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},F[new s.Z(r.overscaledZ,R,c.z,x,c.y-1).key]={backfilled:!1}),c.y+1<f&&(F[new s.Z(r.overscaledZ,y,c.z,g,c.y+1).key]={backfilled:!1},F[new s.Z(r.overscaledZ,r.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},F[new s.Z(r.overscaledZ,R,c.z,x,c.y+1).key]={backfilled:!1}),F}unloadTile(r){return s._(this,void 0,void 0,function*(){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&(yield r.actor.sendAsync({type:"RDT",data:{type:this.type,uid:r.uid,source:this.id}}))})}}class Tr extends s.E{constructor(r,c,f,g){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:c.data},this.actor=f.getActor(),this.setEventedParent(g),this._data=c.data,this._options=s.e({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId,c.clusterMaxZoom!==void 0&&this.maxzoom<=c.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${c.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(c.buffer!==void 0?c.buffer:128),tolerance:this._pixelsToTileUnits(c.tolerance!==void 0?c.tolerance:.375),extent:s.$,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(c.clusterMaxZoom),minPoints:Math.max(2,c.clusterMinPoints||2),extent:s.$,radius:this._pixelsToTileUnits(c.clusterRadius||50),log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(r){return r*(s.$/this.tileSize)}_getClusterMaxZoom(r){const c=r?Math.round(r):this.maxzoom-1;return Number.isInteger(r)||r===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${r}" rounded to "${c}"`),c}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._pendingWorkerUpdate={data:r},this._updateWorkerData(),this}updateData(r){return this._pendingWorkerUpdate.diff=s.a0(this._pendingWorkerUpdate.diff,r),this._updateWorkerData(),this}getData(){return s._(this,void 0,void 0,function*(){const r=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:r})})}getCoordinatesFromGeometry(r){return r.type==="GeometryCollection"?r.geometries.map(c=>c.coordinates).flat(1/0):r.coordinates.flat(1/0)}getBounds(){return s._(this,void 0,void 0,function*(){const r=new Ot,c=yield this.getData();let f;switch(c.type){case"FeatureCollection":f=c.features.map(g=>this.getCoordinatesFromGeometry(g.geometry)).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(c.geometry);break;default:f=this.getCoordinatesFromGeometry(c)}if(f.length==0)return r;for(let g=0;g<f.length-1;g+=2)r.extend([f[g],f[g+1]]);return r})}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(r.clusterRadius)),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(r.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(r){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:r,source:this.id}})}getClusterChildren(r){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:r,source:this.id}})}getClusterLeaves(r,c,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:r,limit:c,offset:f}})}_updateWorkerData(){return s._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:r,diff:c}=this._pendingWorkerUpdate;if(!r&&!c)return void s.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const f=s.e({type:this.type},this.workerOptions);r?(typeof r=="string"?(f.request=this.map._requestManager.transformRequest(D.resolveURL(r),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(r),this._pendingWorkerUpdate.data=void 0):c&&(f.dataDiff=c,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new s.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||g.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));this._data=g.data;let y=null;g.resourceTiming&&g.resourceTiming[this.id]&&(y=g.resourceTiming[this.id].slice(0));const x={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&s.e(x,{resourceTiming:y}),this.fire(new s.l("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}catch(g){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(g))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(r){return s._(this,void 0,void 0,function*(){const c=r.actor?"RT":"LT";r.actor=this.actor;const f={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};r.abortController=new AbortController;const g=yield this.actor.sendAsync({type:c,data:f},r.abortController);delete r.abortController,r.unloadVectorData(),r.aborted||r.loadVectorData(g,this.map.painter,c==="RT")})}abortTile(r){return s._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.aborted=!0})}unloadTile(r){return s._(this,void 0,void 0,function*(){r.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Dr extends s.E{constructor(r,c,f,g){super(),this.flippedWindingOrder=!1,this.id=r,this.dispatcher=f,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(g),this.options=c}load(r){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const c=yield N.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,c&&c.data&&(this.image=c.data,r&&(this.coordinates=r),this._finishLoading())}catch(c){this._request=null,this._loaded=!0,this.fire(new s.k(c))}})}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=r.url,this.load(r.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(r){this.coordinates=r;const c=r.map(s.a1.fromLngLat);var f;return this.tileID=function(g){const y=s.a2.fromPoints(g),x=y.width(),R=y.height(),F=Math.max(x,R),H=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),X=Math.pow(2,H);return new s.a4(H,Math.floor((y.minX+y.maxX)/2*X),Math.floor((y.minY+y.maxY)/2*X))}(c),this.terrainTileRanges=this._getOverlappingTileRanges(c),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=c.map(g=>this.tileID.getTilePoint(g)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,c=r.gl;this.texture||(this.texture=new s.T(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const y=this.tiles[g];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,f=!0)}f&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(r){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={}):r.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(r){const{minX:c,minY:f,maxX:g,maxY:y}=s.a2.fromPoints(r),x={};for(let R=0;R<=s.a3;R++){const F=Math.pow(2,R),H=Math.floor(c*F),X=Math.floor(f*F),ae=Math.floor(g*F),ee=Math.floor(y*F);x[R]={minTileX:H,minTileY:X,maxTileX:ae,maxTileY:ee}}return x}}class hi extends Dr{constructor(r,c,f,g){super(r,c,f,g),this.roundZoom=!0,this.type="video",this.options=c}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;const r=this.options;this.urls=[];for(const c of r.urls)this.urls.push(this.map._requestManager.transformRequest(c,"Source").url);try{const c=yield s.a5(this.urls);if(this._loaded=!0,!c)return;this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(c){this.fire(new s.k(c))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const c=this.video.seekable;r<c.start(0)||r>c.end(0)?this.fire(new s.k(new s.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,c=r.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(r,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));let f=!1;for(const g in this.tiles){const y=this.tiles[g];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,f=!0)}f&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ni extends Dr{constructor(r,c,f,g){super(r,c,f,g),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(x=>typeof x!="number"))||this.fire(new s.k(new s.a6(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.a6(`sources.${r}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new s.k(new s.a6(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.a6(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.a6(`sources.${r}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context,f=c.gl;this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(c,this.canvas,f.RGBA,{premultiply:!0});let g=!1;for(const y in this.tiles){const x=this.tiles[y];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,g=!0)}g&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const ui={},dn=v=>{switch(v){case"geojson":return Tr;case"image":return Dr;case"raster":return yr;case"raster-dem":return kr;case"vector":return Ar;case"video":return hi;case"canvas":return ni}return ui[v]},Xi="RTLPluginLoaded";class fn extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Lt()}_syncState(r){return this.status=r,this.dispatcher.broadcast("SRPS",{pluginStatus:r,pluginURL:this.url}).catch(c=>{throw this.status="error",c})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(r){return s._(this,arguments,void 0,function*(c,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=D.resolveURL(c),!this.url)throw new Error(`requested url ${c} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(Xi))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Pr=null;function xi(){return Pr||(Pr=new fn),Pr}class Fi{constructor(r,c){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=s.a7(),this.uses=0,this.tileSize=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const c=r+this.timeAdded;c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,c,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(g,y){const x={};if(!y)return x;for(const R of g){const F=R.layerIds.map(H=>y.getLayer(H)).filter(Boolean);if(F.length!==0){R.layers=F,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map(H=>F.filter(X=>X.id===H)[0]));for(const H of F)x[H.id]=R}}return x}(r.buckets,c==null?void 0:c.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const y=this.buckets[g];if(y instanceof s.a9){if(this.hasSymbolBuckets=!0,!f)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const y=this.buckets[g];if(y instanceof s.a9&&y.hasRTLText){this.hasRTLText=!0,xi().lazyLoad();break}}this.queryPadding=0;for(const g in this.buckets){const y=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(g).queryRadius(y))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),this.dashPositions=r.dashPositions}else this.collisionBoxArray=new s.a8}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(r)}const c=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(r,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(r,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,c,f,g,y,x,R,F,H,X,ae){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:g,cameraQueryGeometry:y,scale:x,tileSize:this.tileSize,pixelPosMatrix:X,transform:F,params:R,queryPadding:this.queryPadding*H,getElevation:ae},r,c,f):{}}querySourceFeatures(r,c){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),y=c&&c.sourceLayer?c.sourceLayer:"",x=g._geojsonTileLayer||g[y];if(!x)return;const R=s.aa(c==null?void 0:c.filter,c==null?void 0:c.globalState),{z:F,x:H,y:X}=this.tileID.canonical,ae={z:F,x:H,y:X};for(let ee=0;ee<x.length;ee++){const de=x.feature(ee);if(R.needGeometry){const De=s.ab(de,!0);if(!R.filter(new s.F(this.tileID.overscaledZ),De,this.tileID.canonical))continue}else if(!R.filter(new s.F(this.tileID.overscaledZ),de))continue;const Ae=f.getId(de,y),Fe=new s.ac(de,F,H,X,Ae);Fe.tile=ae,r.push(Fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const c=this.expirationTime;if(r.cacheControl){const f=s.ad(r.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(c)if(this.expirationTime<c)g=!0;else{const y=this.expirationTime-c;y?this.expirationTime=f+Math.max(y,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const g in this.buckets){if(!c.style.hasLayer(g))continue;const y=this.buckets[g],x=y.layers[0].sourceLayer||"_geojsonTileLayer",R=f[x],F=r[x];if(!R||!F||Object.keys(F).length===0)continue;y.update(F,R,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const H=c&&c.style&&c.style.getLayer(g);H&&(this.queryPadding=Math.max(this.queryPadding,H.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<D.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=D.now()+r}setDependencies(r,c){const f={};for(const g of c)f[g]=!0;this.dependencies[r]=f}hasDependency(r,c){for(const f of r){const g=this.dependencies[f];if(g){for(const y of c)if(g[y])return!0}}return!1}}class ct{constructor(r,c){this.max=r,this.onRemove=c,this.reset()}reset(){for(const r in this.data)for(const c of this.data[r])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(r,c,f){const g=r.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const y={value:c,timeout:void 0};if(f!==void 0&&(y.timeout=setTimeout(()=>{this.remove(r,y)},f)),this.data[g].push(y),this.order.push(g),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const c=this.data[r].shift();return c.timeout&&clearTimeout(c.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),c.value}getByKey(r){const c=this.data[r];return c?c[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,c){if(!this.has(r))return this;const f=r.wrapped().key,g=c===void 0?0:this.data[f].indexOf(c),y=this.data[f][g];return this.data[f].splice(g,1),y.timeout&&clearTimeout(y.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(y.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(r){const c=[];for(const f in this.data)for(const g of this.data[f])r(g.value)||c.push(g);for(const f of c)this.remove(f.value.tileID,f)}}class be{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,c,f){const g=String(c);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][g]=this.stateChanges[r][g]||{},s.e(this.stateChanges[r][g],f),this.deletedStates[r]===null){this.deletedStates[r]={};for(const y in this.state[r])y!==g&&(this.deletedStates[r][y]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][g]===null){this.deletedStates[r][g]={};for(const y in this.state[r][g])f[y]||(this.deletedStates[r][g][y]=null)}else for(const y in f)this.deletedStates[r]&&this.deletedStates[r][g]&&this.deletedStates[r][g][y]===null&&delete this.deletedStates[r][g][y]}removeFeatureState(r,c,f){if(this.deletedStates[r]===null)return;const g=String(c);if(this.deletedStates[r]=this.deletedStates[r]||{},f&&c!==void 0)this.deletedStates[r][g]!==null&&(this.deletedStates[r][g]=this.deletedStates[r][g]||{},this.deletedStates[r][g][f]=null);else if(c!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][g])for(f in this.deletedStates[r][g]={},this.stateChanges[r][g])this.deletedStates[r][g][f]=null;else this.deletedStates[r][g]=null;else this.deletedStates[r]=null}getState(r,c){const f=String(c),g=s.e({},(this.state[r]||{})[f],(this.stateChanges[r]||{})[f]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const y=this.deletedStates[r][c];if(y===null)return{};for(const x in y)delete g[x]}return g}initializeTileState(r,c){r.setFeatureState(this.state,c)}coalesceChanges(r,c){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const y={};for(const x in this.stateChanges[g])this.state[g][x]||(this.state[g][x]={}),s.e(this.state[g][x],this.stateChanges[g][x]),y[x]=this.state[g][x];f[g]=y}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const y={};if(this.deletedStates[g]===null)for(const x in this.state[g])y[x]={},this.state[g][x]={};else for(const x in this.deletedStates[g]){if(this.deletedStates[g][x]===null)this.state[g][x]={};else for(const R of Object.keys(this.deletedStates[g][x]))delete this.state[g][x][R];y[x]=this.state[g][x]}f[g]=f[g]||{},s.e(f[g],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in r)r[g].setFeatureState(f,c)}}const we=89.25;function Te(v,r){const c=s.ah(r.lat,-s.ai,s.ai);return new s.P(s.V(r.lng)*v,s.U(c)*v)}function Ge(v,r){return new s.a1(r.x/v,r.y/v).toLngLat()}function He(v){return v.cameraToCenterDistance*Math.min(.85*Math.tan(s.ae(90-v.pitch)),Math.tan(s.ae(we-v.pitch)))}function nt(v,r){const c=v.canonical,f=r/s.af(c.z),g=c.x+Math.pow(2,c.z)*v.wrap,y=s.ag(new Float64Array(16));return s.M(y,y,[g*f,c.y*f,0]),s.N(y,y,[f/s.$,f/s.$,1]),y}function yt(v,r,c,f,g){const y=s.a1.fromLngLat(v,r),x=g*s.aj(1,v.lat),R=x*Math.cos(s.ae(c)),F=Math.sqrt(x*x-R*R),H=F*Math.sin(s.ae(-f)),X=F*Math.cos(s.ae(-f));return new s.a1(y.x+H,y.y+X,y.z+R)}function ut(v,r,c){const f=r.intersectsFrustum(v);if(!c||f===0)return f;const g=r.intersectsPlane(c);return g===0?0:f===2&&g===2?2:1}function St(v,r,c){let f=0;const g=(c-r)/10;for(let y=0;y<10;y++)f+=g*Math.pow(Math.cos(r+(y+.5)/10*(c-r)),v);return f}function Vt(v,r){return function(c,f,g,y,x){const R=2*((v-1)/s.ak(Math.cos(s.ae(we-x))/Math.cos(s.ae(we)))-1),F=Math.acos(g/y),H=2*St(R-1,0,s.ae(x/2)),X=Math.min(s.ae(we),F+s.ae(x/2)),ae=St(R-1,Math.min(X,F-s.ae(x/2)),X),ee=Math.atan(f/g),de=Math.hypot(f,g);let Ae=c;return Ae+=s.ak(y/de/Math.max(.5,Math.cos(s.ae(x/2)))),Ae+=R*s.ak(Math.cos(ee))/2,Ae-=s.ak(Math.max(1,ae/H/r))/2,Ae}}const Ft=Vt(9.314,3);function sr(v,r){const c=(r.roundZoom?Math.round:Math.floor)(v.zoom+s.ak(v.tileSize/r.tileSize));return Math.max(0,c)}function st(v,r){const c=v.getCameraFrustum(),f=v.getClippingPlane(),g=v.screenPointToMercatorCoordinate(v.getCameraPoint()),y=s.a1.fromLngLat(v.center,v.elevation);g.z=y.z+Math.cos(v.pitchInRadians)*v.cameraToCenterDistance/v.worldSize;const x=v.getCoveringTilesDetailsProvider(),R=x.allowVariableZoom(v,r),F=sr(v,r),H=r.minzoom||0,X=r.maxzoom!==void 0?r.maxzoom:v.maxZoom,ae=Math.min(Math.max(0,F),X),ee=Math.pow(2,ae),de=[ee*g.x,ee*g.y,0],Ae=[ee*y.x,ee*y.y,0],Fe=Math.hypot(y.x-g.x,y.y-g.y),De=Math.abs(y.z-g.z),je=Math.hypot(Fe,De),Ue=it=>({zoom:0,x:0,y:0,wrap:it,fullyVisible:!1}),et=[],Xe=[];if(v.renderWorldCopies&&x.allowWorldCopies())for(let it=1;it<=3;it++)et.push(Ue(-it)),et.push(Ue(it));for(et.push(Ue(0));et.length>0;){const it=et.pop(),dt=it.x,Je=it.y;let mt=it.fullyVisible;const Et={x:dt,y:Je,z:it.zoom},xt=x.getTileBoundingVolume(Et,it.wrap,v.elevation,r);if(!mt){const Qt=ut(c,xt,f);if(Qt===0)continue;mt=Qt===2}const At=x.distanceToTile2d(g.x,g.y,Et,xt);let kt=F;R&&(kt=(r.calculateTileZoom||Ft)(v.zoom+s.ak(v.tileSize/r.tileSize),At,De,je,v.fov)),kt=(r.roundZoom?Math.round:Math.floor)(kt),kt=Math.max(0,kt);const er=Math.min(kt,X);if(it.wrap=x.getWrap(y,Et,it.wrap),it.zoom>=er){if(it.zoom<H)continue;const Qt=ae-it.zoom,Ht=de[0]-.5-(dt<<Qt),br=de[1]-.5-(Je<<Qt),Qr=r.reparseOverscaled?Math.max(it.zoom,kt):it.zoom;Xe.push({tileID:new s.Z(it.zoom===X?Qr:it.zoom,it.wrap,it.zoom,dt,Je),distanceSq:s.al([Ae[0]-.5-dt,Ae[1]-.5-Je]),tileDistanceToCamera:Math.sqrt(Ht*Ht+br*br)})}else for(let Qt=0;Qt<4;Qt++)et.push({zoom:it.zoom+1,x:(dt<<1)+Qt%2,y:(Je<<1)+(Qt>>1),wrap:it.wrap,fullyVisible:mt})}return Xe.sort((it,dt)=>it.distanceSq-dt.distanceSq).map(it=>it.tileID)}const qe=s.a2.fromPoints([new s.P(0,0),new s.P(s.$,s.$)]);class Ct extends s.E{constructor(r,c,f){super(),this.id=r,this.dispatcher=f,this.on("data",g=>this._dataHandler(g)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((g,y,x,R)=>{const F=new(dn(y.type))(g,y,x,R);if(F.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${F.id}`);return F})(r,c,f,this),this._tiles={},this._cache=new ct(0,g=>this._unloadTile(g)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new be,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const c=this._tiles[r];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,c,f){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(r),this._tileLoaded(r,c,f)}catch(g){r.state="errored",g.status!==404?this._source.fire(new s.k(g,{tile:r})):this.update(this.transform,this.terrain)}})}_unloadTile(r){this._source.unloadTile&&this._source.unloadTile(r)}_abortTile(r){this._source.abortTile&&this._source.abortTile(r),this._source.fire(new s.l("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const f=this._tiles[c];f.upload(r),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(wt).map(r=>r.key)}getRenderableIds(r){const c=[];for(const f in this._tiles)this._isIdRenderable(f,r)&&c.push(this._tiles[f]);return r?c.sort((f,g)=>{const y=f.tileID,x=g.tileID,R=new s.P(y.canonical.x,y.canonical.y)._rotate(-this.transform.bearingInRadians),F=new s.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians);return y.overscaledZ-x.overscaledZ||F.y-R.y||F.x-R.x}).map(f=>f.tileID.key):c.map(f=>f.tileID).sort(wt).map(f=>f.key)}hasRenderableParent(r){const c=this.findLoadedParent(r,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(r,c){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(c||!this._tiles[r].holdingForFade())}reload(r){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)r?this._reloadTile(c,"expired"):this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(r,c){return s._(this,void 0,void 0,function*(){const f=this._tiles[r];f&&(f.state!=="loading"&&(f.state=c),yield this._loadTile(f,r,c))})}_tileLoaded(r,c,f){r.timeAdded=D.now(),f==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(c,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const c=this.getRenderableIds();for(let g=0;g<c.length;g++){const y=c[g];if(r.neighboringTiles&&r.neighboringTiles[y]){const x=this.getTileByID(y);f(r,x),f(x,r)}}function f(g,y){g.needsHillshadePrepare=!0,g.needsTerrainPrepare=!0;let x=y.tileID.canonical.x-g.tileID.canonical.x;const R=y.tileID.canonical.y-g.tileID.canonical.y,F=Math.pow(2,g.tileID.canonical.z),H=y.tileID.key;x===0&&R===0||Math.abs(R)>1||(Math.abs(x)>1&&(Math.abs(x+F)===1?x+=F:Math.abs(x-F)===1&&(x-=F)),y.dem&&g.dem&&(g.dem.backfillBorder(y.dem,x,R),g.neighboringTiles&&g.neighboringTiles[H]&&(g.neighboringTiles[H].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,c){const f=Object.values(r),g=this._getLoadedDescendents(f),y={};for(const x of f){const R=g[x.key];if(!(R!=null&&R.length)){y[x.key]=x;continue}const F=x.overscaledZ+Ct.maxUnderzooming,H=R.filter(ee=>ee.tileID.overscaledZ<=F);if(!H.length){y[x.key]=x;continue}const X=Math.min(...H.map(ee=>ee.tileID.overscaledZ)),ae=H.filter(ee=>ee.tileID.overscaledZ===X).map(ee=>ee.tileID);for(const ee of ae)c[ee.key]=ee;this._areDescendentsComplete(ae,X,x.overscaledZ)||(y[x.key]=x)}return y}_getLoadedDescendents(r){var c;const f={};for(const g in this._tiles){const y=this._tiles[g];if(y.hasData())for(const x of r)y.tileID.isChildOf(x)&&(f[c=x.key]||(f[c]=[])).push(y)}return f}_areDescendentsComplete(r,c,f){return r.length===1&&r[0].isOverscaled()?r[0].overscaledZ===c:Math.pow(4,c-f)===r.length}findLoadedParent(r,c){if(r.key in this._loadedParentTiles){const f=this._loadedParentTiles[r.key];return f&&f.tileID.overscaledZ>=c?f:null}for(let f=r.overscaledZ-1;f>=c;f--){const g=r.scaledTo(f),y=this._getLoadedTile(g);if(y)return y}}findLoadedSibling(r){return this._getLoadedTile(r)}_getLoadedTile(r){const c=this._tiles[r.key];return c&&c.hasData()?c:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const c=Math.ceil(r.width/this._source.tileSize)+1,f=Math.ceil(r.height/this._source.tileSize)+1,g=Math.floor(c*f*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(y)}handleWrapJump(r){const c=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,c){const f={};for(const g in this._tiles){const y=this._tiles[g];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+c),f[y.tileID.key]=y}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(g,this._tiles[g])}}update(r,c){if(!this._sourceLoaded||this._paused)return;let f;this.transform=r,this.terrain=c,this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(H=>new s.Z(H.canonical.z,H.wrap,H.canonical.z,H.canonical.x,H.canonical.y)):(f=st(r,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:c,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(H=>this._source.hasTile(H)))):f=[],this.usedForTerrain&&(f=this._addTerrainIdealTiles(f));const g=sr(r,this._source),y=Math.max(g-Ct.maxOverzooming,this._source.minzoom),x=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,x&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const R=this._updateRetainedTiles(f,g);jt(this._source.type)&&!c&&this._updateFadingTiles(R,y);for(const H in R)this._tiles[H].clearFadeHold();const F=s.am(this._tiles,R);for(const H of F){const X=this._tiles[H];X.hasSymbolBuckets&&!X.holdingForFade()?X.setHoldDuration(this.map._fadeDuration):X.hasSymbolBuckets&&!X.symbolFadeFinished()||this._removeTile(H)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}_addTerrainIdealTiles(r){const c=[];for(const f of r)if(f.canonical.z>this._source.minzoom){const g=f.scaledTo(f.canonical.z-1);c.push(g);const y=f.scaledTo(Math.max(this._source.minzoom,Math.min(f.canonical.z,5)));c.push(y)}return r.concat(c)}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,c){var f;const g={},y={},x=Math.max(c-Ct.maxOverzooming,this._source.minzoom);let R={};for(const F of r){const H=this._addTile(F);g[F.key]=F,H.hasData()||(R[F.key]=F)}R=this._retainLoadedChildren(R,g);for(const F in R){const H=R[F];let X=this._tiles[F],ae=X==null?void 0:X.wasRequested();for(let ee=H.overscaledZ-1;ee>=x;--ee){const de=H.scaledTo(ee);if(y[de.key])break;if(y[de.key]=!0,X=this.getTile(de),!X&&ae&&(X=this._addTile(de)),X){const Ae=X.hasData();if((Ae||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||ae)&&(g[de.key]=de),ae=X.wasRequested(),Ae)break}}}return g}_updateFadingTiles(r,c){const f={},g={},y=Object.keys(r),x=D.now();for(const R of y){const F=r[R],H=this._tiles[R];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=x)continue;const X=this.findLoadedParent(F,c),ae=this.findLoadedSibling(F),ee=X||ae||null;ee&&(this._addTile(ee.tileID),f[ee.tileID.key]=ee.tileID),g[R]=F}this._retainLoadedChildren(g,r);for(const R in f)r[R]||(this._coveredTiles[R]=!0,r[R]=f[R])}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const c=[];let f,g=this._tiles[r].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}c.push(g.key);const y=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(y),f)break;g=y}for(const y of c)this._loadedParentTiles[y]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const r in this._tiles){const c=this._tiles[r].tileID,f=this._getLoadedTile(c);this._loadedSiblingTiles[c.key]=f}}_addTile(r){let c=this._tiles[r.key];if(c)return c;c=this._cache.getAndRemove(r),c&&(this._setTileReloadTimer(r.key,c),c.tileID=r,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,c)));const f=c;return c||(c=new Fi(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(c,r.key,c.state)),c.uses++,this._tiles[r.key]=c,f||this._source.fire(new s.l("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(r,c){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const f=c.getExpiryTimeout();f&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},f))}refreshTiles(r){for(const c in this._tiles)(this._isIdRenderable(c)||this._tiles[c].state=="errored")&&r.some(f=>f.equals(this._tiles[c].tileID.canonical))&&this._reloadTile(c,"expired")}_removeTile(r){const c=this._tiles[r];c&&(c.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}_dataHandler(r){const c=r.sourceDataType;r.dataType==="source"&&c==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&r.dataType==="source"&&c==="content"&&(this.reload(r.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,c,f){const g=[],y=this.transform;if(!y)return g;const x=y.getCoveringTilesDetailsProvider().allowWorldCopies(),R=f?y.getCameraQueryGeometry(r):r,F=de=>y.screenPointToMercatorCoordinate(de,this.terrain),H=this.transformBbox(r,F,!x),X=this.transformBbox(R,F,!x),ae=this.getIds(),ee=s.a2.fromPoints(X);for(let de=0;de<ae.length;de++){const Ae=this._tiles[ae[de]];if(Ae.holdingForFade())continue;const Fe=x?[Ae.tileID]:[Ae.tileID.unwrapTo(-1),Ae.tileID.unwrapTo(0)],De=Math.pow(2,y.zoom-Ae.tileID.overscaledZ),je=c*Ae.queryPadding*s.$/Ae.tileSize/De;for(const Ue of Fe){const et=ee.map(Xe=>Ue.getTilePoint(new s.a1(Xe.x,Xe.y)));if(et.expandBy(je),et.intersects(qe)){const Xe=H.map(dt=>Ue.getTilePoint(dt)),it=X.map(dt=>Ue.getTilePoint(dt));g.push({tile:Ae,tileID:x?Ue:Ue.unwrapTo(0),queryGeometry:Xe,cameraQueryGeometry:it,scale:De})}}}return g}transformBbox(r,c,f){let g=r.map(c);if(f){const y=s.a2.fromPoints(r);y.shrinkBy(.001*Math.min(y.width(),y.height()));const x=y.map(c);s.a2.fromPoints(g).covers(x)||(g=g.map(R=>R.x>.5?new s.a1(R.x-1,R.y,R.z):R))}return g}getVisibleCoordinates(r){const c=this.getRenderableIds(r).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(c),c}hasTransition(){if(this._source.hasTransition())return!0;if(jt(this._source.type)){const r=D.now();for(const c in this._tiles)if(this._tiles[c].fadeEndTime>=r)return!0}return!1}setFeatureState(r,c,f){this._state.updateState(r=r||"_geojsonTileLayer",c,f)}removeFeatureState(r,c,f){this._state.removeFeatureState(r=r||"_geojsonTileLayer",c,f)}getFeatureState(r,c){return this._state.getState(r=r||"_geojsonTileLayer",c)}setDependencies(r,c,f){const g=this._tiles[r];g&&g.setDependencies(c,f)}reloadTilesForDependencies(r,c){for(const f in this._tiles)this._tiles[f].hasDependency(r,c)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(r,c))}}function wt(v,r){const c=Math.abs(2*v.wrap)-+(v.wrap<0),f=Math.abs(2*r.wrap)-+(r.wrap<0);return v.overscaledZ-r.overscaledZ||f-c||r.canonical.y-v.canonical.y||r.canonical.x-v.canonical.x}function jt(v){return v==="raster"||v==="image"||v==="video"}Ct.maxOverzooming=10,Ct.maxUnderzooming=3;class ie{constructor(r,c){this.reset(r,c)}reset(r,c){this.points=r||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=s.ah(r,0,1);let c=1,f=this._distances[c];const g=r*this.paddedLength+this.padding;for(;f<g&&c<this._distances.length;)f=this._distances[++c];const y=c-1,x=this._distances[y],R=f-x,F=R>0?(g-x)/R:0;return this.points[y].mult(1-F).add(this.points[c].mult(F))}}function k(v,r){let c=!0;return v==="always"||v!=="never"&&r!=="never"||(c=!1),c}class C{constructor(r,c,f){const g=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(r/f),this.yCellCount=Math.ceil(c/f);for(let x=0;x<this.xCellCount*this.yCellCount;x++)g.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=c,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,c,f,g,y){this._forEachCell(c,f,g,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(y)}insertCircle(r,c,f,g){this._forEachCell(c-g,f-g,c+g,f+g,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(c),this.circles.push(f),this.circles.push(g)}_insertBoxCell(r,c,f,g,y,x){this.boxCells[y].push(x)}_insertCircleCell(r,c,f,g,y,x){this.circleCells[y].push(x)}_query(r,c,f,g,y,x,R){if(f<0||r>this.width||g<0||c>this.height)return[];const F=[];if(r<=0&&c<=0&&this.width<=f&&this.height<=g){if(y)return[{key:null,x1:r,y1:c,x2:f,y2:g}];for(let H=0;H<this.boxKeys.length;H++)F.push({key:this.boxKeys[H],x1:this.bboxes[4*H],y1:this.bboxes[4*H+1],x2:this.bboxes[4*H+2],y2:this.bboxes[4*H+3]});for(let H=0;H<this.circleKeys.length;H++){const X=this.circles[3*H],ae=this.circles[3*H+1],ee=this.circles[3*H+2];F.push({key:this.circleKeys[H],x1:X-ee,y1:ae-ee,x2:X+ee,y2:ae+ee})}}else this._forEachCell(r,c,f,g,this._queryCell,F,{hitTest:y,overlapMode:x,seenUids:{box:{},circle:{}}},R);return F}query(r,c,f,g){return this._query(r,c,f,g,!1,null)}hitTest(r,c,f,g,y,x){return this._query(r,c,f,g,!0,y,x).length>0}hitTestCircle(r,c,f,g,y){const x=r-f,R=r+f,F=c-f,H=c+f;if(R<0||x>this.width||H<0||F>this.height)return!1;const X=[];return this._forEachCell(x,F,R,H,this._queryCellCircle,X,{hitTest:!0,overlapMode:g,circle:{x:r,y:c,radius:f},seenUids:{box:{},circle:{}}},y),X.length>0}_queryCell(r,c,f,g,y,x,R,F){const{seenUids:H,hitTest:X,overlapMode:ae}=R,ee=this.boxCells[y];if(ee!==null){const Ae=this.bboxes;for(const Fe of ee)if(!H.box[Fe]){H.box[Fe]=!0;const De=4*Fe,je=this.boxKeys[Fe];if(r<=Ae[De+2]&&c<=Ae[De+3]&&f>=Ae[De+0]&&g>=Ae[De+1]&&(!F||F(je))&&(!X||!k(ae,je.overlapMode))&&(x.push({key:je,x1:Ae[De],y1:Ae[De+1],x2:Ae[De+2],y2:Ae[De+3]}),X))return!0}}const de=this.circleCells[y];if(de!==null){const Ae=this.circles;for(const Fe of de)if(!H.circle[Fe]){H.circle[Fe]=!0;const De=3*Fe,je=this.circleKeys[Fe];if(this._circleAndRectCollide(Ae[De],Ae[De+1],Ae[De+2],r,c,f,g)&&(!F||F(je))&&(!X||!k(ae,je.overlapMode))){const Ue=Ae[De],et=Ae[De+1],Xe=Ae[De+2];if(x.push({key:je,x1:Ue-Xe,y1:et-Xe,x2:Ue+Xe,y2:et+Xe}),X)return!0}}}return!1}_queryCellCircle(r,c,f,g,y,x,R,F){const{circle:H,seenUids:X,overlapMode:ae}=R,ee=this.boxCells[y];if(ee!==null){const Ae=this.bboxes;for(const Fe of ee)if(!X.box[Fe]){X.box[Fe]=!0;const De=4*Fe,je=this.boxKeys[Fe];if(this._circleAndRectCollide(H.x,H.y,H.radius,Ae[De+0],Ae[De+1],Ae[De+2],Ae[De+3])&&(!F||F(je))&&!k(ae,je.overlapMode))return x.push(!0),!0}}const de=this.circleCells[y];if(de!==null){const Ae=this.circles;for(const Fe of de)if(!X.circle[Fe]){X.circle[Fe]=!0;const De=3*Fe,je=this.circleKeys[Fe];if(this._circlesCollide(Ae[De],Ae[De+1],Ae[De+2],H.x,H.y,H.radius)&&(!F||F(je))&&!k(ae,je.overlapMode))return x.push(!0),!0}}}_forEachCell(r,c,f,g,y,x,R,F){const H=this._convertToXCellCoord(r),X=this._convertToYCellCoord(c),ae=this._convertToXCellCoord(f),ee=this._convertToYCellCoord(g);for(let de=H;de<=ae;de++)for(let Ae=X;Ae<=ee;Ae++)if(y.call(this,r,c,f,g,this.xCellCount*Ae+de,x,R,F))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,c,f,g,y,x){const R=g-r,F=y-c,H=f+x;return H*H>R*R+F*F}_circleAndRectCollide(r,c,f,g,y,x,R){const F=(x-g)/2,H=Math.abs(r-(g+F));if(H>F+f)return!1;const X=(R-y)/2,ae=Math.abs(c-(y+X));if(ae>X+f)return!1;if(H<=F||ae<=X)return!0;const ee=H-F,de=ae-X;return ee*ee+de*de<=f*f}}function M(v,r,c){const f=s.L();if(!v){const{vecSouth:ae,vecEast:ee}=O(r),de=A();de[0]=ee[0],de[1]=ee[1],de[2]=ae[0],de[3]=ae[1],g=de,(X=(x=(y=de)[0])*(H=y[3])-(F=y[2])*(R=y[1]))&&(g[0]=H*(X=1/X),g[1]=-R*X,g[2]=-F*X,g[3]=x*X),f[0]=de[0],f[1]=de[1],f[4]=de[2],f[5]=de[3]}var g,y,x,R,F,H,X;return s.N(f,f,[1/c,1/c,1]),f}function P(v,r,c,f){if(v){const g=s.L();if(!r){const{vecSouth:y,vecEast:x}=O(c);g[0]=x[0],g[1]=x[1],g[4]=y[0],g[5]=y[1]}return s.N(g,g,[f,f,1]),g}return c.pixelsToClipSpaceMatrix}function O(v){const r=Math.cos(v.rollInRadians),c=Math.sin(v.rollInRadians),f=Math.cos(v.pitchInRadians),g=Math.cos(v.bearingInRadians),y=Math.sin(v.bearingInRadians),x=s.ar();x[0]=-g*f*c-y*r,x[1]=-y*f*c+g*r;const R=s.as(x);R<1e-9?s.at(x):s.au(x,x,1/R);const F=s.ar();F[0]=g*f*r-y*c,F[1]=y*f*r+g*c;const H=s.as(F);return H<1e-9?s.at(F):s.au(F,F,1/H),{vecEast:F,vecSouth:x}}function xe(v,r,c,f){let g;f?(g=[v,r,f(v,r),1],s.aw(g,g,c)):(g=[v,r,0,1],gr(g,g,c));const y=g[3];return{point:new s.P(g[0]/y,g[1]/y),signedDistanceFromCamera:y,isOccluded:!1}}function he(v,r){return .5+v/r*.5}function Y(v,r){return v.x>=-r[0]&&v.x<=r[0]&&v.y>=-r[1]&&v.y<=r[1]}function U(v,r,c,f,g,y,x,R,F,H,X,ae,ee){const de=c?v.textSizeData:v.iconSizeData,Ae=s.an(de,r.transform.zoom),Fe=[256/r.width*2+1,256/r.height*2+1],De=c?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;De.clear();const je=v.lineVertexArray,Ue=c?v.text.placedSymbolArray:v.icon.placedSymbolArray,et=r.transform.width/r.transform.height;let Xe=!1;for(let it=0;it<Ue.length;it++){const dt=Ue.get(it);if(dt.hidden||dt.writingMode===s.ao.vertical&&!Xe){Wr(dt.numGlyphs,De);continue}Xe=!1;const Je=new s.P(dt.anchorX,dt.anchorY),mt={getElevation:ee,pitchedLabelPlaneMatrix:f,lineVertexArray:je,pitchWithMap:y,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:r.transform,tileAnchorPoint:Je,unwrappedTileID:F,width:H,height:X,translation:ae},Et=ze(dt.anchorX,dt.anchorY,mt);if(!Y(Et.point,Fe)){Wr(dt.numGlyphs,De);continue}const xt=he(r.transform.cameraToCenterDistance,Et.signedDistanceFromCamera),At=s.ap(de,Ae,dt),kt=y?At*r.transform.getPitchedTextCorrection(dt.anchorX,dt.anchorY,F)/xt:At*xt,er=pe({projectionContext:mt,pitchedLabelPlaneMatrixInverse:g,symbol:dt,fontSize:kt,flip:!1,keepUpright:x,glyphOffsetArray:v.glyphOffsetArray,dynamicLayoutVertexArray:De,aspectRatio:et,rotateToLine:R});Xe=er.useVertical,(er.notEnoughRoom||Xe||er.needsFlipping&&pe({projectionContext:mt,pitchedLabelPlaneMatrixInverse:g,symbol:dt,fontSize:kt,flip:!0,keepUpright:x,glyphOffsetArray:v.glyphOffsetArray,dynamicLayoutVertexArray:De,aspectRatio:et,rotateToLine:R}).notEnoughRoom)&&Wr(dt.numGlyphs,De)}c?v.text.dynamicLayoutVertexBuffer.updateData(De):v.icon.dynamicLayoutVertexBuffer.updateData(De)}function J(v,r,c,f,g,y,x,R){const F=y.glyphStartIndex+y.numGlyphs,H=y.lineStartIndex,X=y.lineStartIndex+y.lineLength,ae=r.getoffsetX(y.glyphStartIndex),ee=r.getoffsetX(F-1),de=$t(v*ae,c,f,g,y.segment,H,X,R,x);if(!de)return null;const Ae=$t(v*ee,c,f,g,y.segment,H,X,R,x);return Ae?R.projectionCache.anyProjectionOccluded?null:{first:de,last:Ae}:null}function ue(v,r,c,f){return v===s.ao.horizontal&&Math.abs(c.y-r.y)>Math.abs(c.x-r.x)*f?{useVertical:!0}:(v===s.ao.vertical?r.y<c.y:r.x>c.x)?{needsFlipping:!0}:null}function pe(v){const{projectionContext:r,pitchedLabelPlaneMatrixInverse:c,symbol:f,fontSize:g,flip:y,keepUpright:x,glyphOffsetArray:R,dynamicLayoutVertexArray:F,aspectRatio:H,rotateToLine:X}=v,ae=g/24,ee=f.lineOffsetX*ae,de=f.lineOffsetY*ae;let Ae;if(f.numGlyphs>1){const Fe=f.glyphStartIndex+f.numGlyphs,De=f.lineStartIndex,je=f.lineStartIndex+f.lineLength,Ue=J(ae,R,ee,de,y,f,X,r);if(!Ue)return{notEnoughRoom:!0};const et=bt(Ue.first.point.x,Ue.first.point.y,r,c),Xe=bt(Ue.last.point.x,Ue.last.point.y,r,c);if(x&&!y){const it=ue(f.writingMode,et,Xe,H);if(it)return it}Ae=[Ue.first];for(let it=f.glyphStartIndex+1;it<Fe-1;it++){const dt=$t(ae*R.getoffsetX(it),ee,de,y,f.segment,De,je,r,X);if(!dt)return{notEnoughRoom:!0};Ae.push(dt)}Ae.push(Ue.last)}else{if(x&&!y){const De=rt(r.tileAnchorPoint.x,r.tileAnchorPoint.y,r).point,je=f.lineStartIndex+f.segment+1,Ue=new s.P(r.lineVertexArray.getx(je),r.lineVertexArray.gety(je)),et=rt(Ue.x,Ue.y,r),Xe=et.signedDistanceFromCamera>0?et.point:Ze(r.tileAnchorPoint,Ue,De,1,r),it=bt(De.x,De.y,r,c),dt=bt(Xe.x,Xe.y,r,c),Je=ue(f.writingMode,it,dt,H);if(Je)return Je}const Fe=$t(ae*R.getoffsetX(f.glyphStartIndex),ee,de,y,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,r,X);if(!Fe||r.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Ae=[Fe]}for(const Fe of Ae)s.av(F,Fe.point,Fe.angle);return{}}function Ze(v,r,c,f,g){const y=v.add(v.sub(r)._unit()),x=rt(y.x,y.y,g).point,R=c.sub(x);return c.add(R._mult(f/R.mag()))}function ke(v,r,c){const f=r.projectionCache;if(f.projections[v])return f.projections[v];const g=new s.P(r.lineVertexArray.getx(v),r.lineVertexArray.gety(v)),y=rt(g.x,g.y,r);if(y.signedDistanceFromCamera>0)return f.projections[v]=y.point,f.anyProjectionOccluded=f.anyProjectionOccluded||y.isOccluded,y.point;const x=v-c.direction;return Ze(c.distanceFromAnchor===0?r.tileAnchorPoint:new s.P(r.lineVertexArray.getx(x),r.lineVertexArray.gety(x)),g,c.previousVertex,c.absOffsetX-c.distanceFromAnchor+1,r)}function rt(v,r,c){const f=v+c.translation[0],g=r+c.translation[1];let y;return c.pitchWithMap?(y=xe(f,g,c.pitchedLabelPlaneMatrix,c.getElevation),y.isOccluded=!1):(y=c.transform.projectTileCoordinates(f,g,c.unwrappedTileID,c.getElevation),y.point.x=(.5*y.point.x+.5)*c.width,y.point.y=(.5*-y.point.y+.5)*c.height),y}function bt(v,r,c,f){if(c.pitchWithMap){const g=[v,r,0,1];return s.aw(g,g,f),c.transform.projectTileCoordinates(g[0]/g[3],g[1]/g[3],c.unwrappedTileID,c.getElevation).point}return{x:v/c.width*2-1,y:1-r/c.height*2}}function ze(v,r,c){return c.transform.projectTileCoordinates(v,r,c.unwrappedTileID,c.getElevation)}function gt(v,r,c){return v._unit()._perp()._mult(r*c)}function Ut(v,r,c,f,g,y,x,R,F){if(R.projectionCache.offsets[v])return R.projectionCache.offsets[v];const H=c.add(r);if(v+F.direction<f||v+F.direction>=g)return R.projectionCache.offsets[v]=H,H;const X=ke(v+F.direction,R,F),ae=gt(X.sub(c),x,F.direction),ee=c.add(ae),de=X.add(ae);return R.projectionCache.offsets[v]=s.ax(y,H,ee,de)||H,R.projectionCache.offsets[v]}function $t(v,r,c,f,g,y,x,R,F){const H=f?v-r:v+r;let X=H>0?1:-1,ae=0;f&&(X*=-1,ae=Math.PI),X<0&&(ae+=Math.PI);let ee,de=X>0?y+g:y+g+1;R.projectionCache.cachedAnchorPoint?ee=R.projectionCache.cachedAnchorPoint:(ee=rt(R.tileAnchorPoint.x,R.tileAnchorPoint.y,R).point,R.projectionCache.cachedAnchorPoint=ee);let Ae,Fe,De=ee,je=ee,Ue=0,et=0;const Xe=Math.abs(H),it=[];let dt;for(;Ue+et<=Xe;){if(de+=X,de<y||de>=x)return null;Ue+=et,je=De,Fe=Ae;const Et={absOffsetX:Xe,direction:X,distanceFromAnchor:Ue,previousVertex:je};if(De=ke(de,R,Et),c===0)it.push(je),dt=De.sub(je);else{let xt;const At=De.sub(je);xt=At.mag()===0?gt(ke(de+X,R,Et).sub(De),c,X):gt(At,c,X),Fe||(Fe=je.add(xt)),Ae=Ut(de,xt,De,y,x,Fe,c,R,Et),it.push(Fe),dt=Ae.sub(Fe)}et=dt.mag()}const Je=dt._mult((Xe-Ue)/et)._add(Fe||je),mt=ae+Math.atan2(De.y-je.y,De.x-je.x);return it.push(Je),{point:Je,angle:F?mt:0,path:it}}const Mr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wr(v,r){for(let c=0;c<v;c++){const f=r.length;r.resize(f+4),r.float32.set(Mr,3*f)}}function gr(v,r,c){const f=r[0],g=r[1];return v[0]=c[0]*f+c[4]*g+c[12],v[1]=c[1]*f+c[5]*g+c[13],v[3]=c[3]*f+c[7]*g+c[15],v}const lr=100;class Xr{constructor(r,c=new C(r.width+200,r.height+200,25),f=new C(r.width+200,r.height+200,25)){this.transform=r,this.grid=c,this.ignoredGrid=f,this.pitchFactor=Math.cos(r.pitch*Math.PI/180)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+lr,this.screenBottomBoundary=r.height+lr,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,c,f,g,y,x,R,F,H,X,ae,ee){const de=this.projectAndGetPerspectiveRatio(r.anchorPointX+F[0],r.anchorPointY+F[1],y,X,ee),Ae=f*de.perspectiveRatio;let Fe;if(x||R)Fe=this._projectCollisionBox(r,Ae,g,y,x,R,F,de,X,ae,ee);else{const dt=de.x+(ae?ae.x*Ae:0),Je=de.y+(ae?ae.y*Ae:0);Fe={allPointsOccluded:!1,box:[dt+r.x1*Ae,Je+r.y1*Ae,dt+r.x2*Ae,Je+r.y2*Ae]}}const[De,je,Ue,et]=Fe.box,Xe=x?Fe.allPointsOccluded:de.isOccluded;let it=Xe;return it||(it=de.perspectiveRatio<this.perspectiveRatioCutoff),it||(it=!this.isInsideGrid(De,je,Ue,et)),it||c!=="always"&&this.grid.hitTest(De,je,Ue,et,c,H)?{box:[De,je,Ue,et],placeable:!1,offscreen:!1,occluded:Xe}:{box:[De,je,Ue,et],placeable:!0,offscreen:this.isOffscreen(De,je,Ue,et),occluded:Xe}}placeCollisionCircles(r,c,f,g,y,x,R,F,H,X,ae,ee,de,Ae){const Fe=[],De=new s.P(c.anchorX,c.anchorY),je=this.getPerspectiveRatio(De.x,De.y,x,Ae),Ue=(H?y*this.transform.getPitchedTextCorrection(c.anchorX,c.anchorY,x)/je:y*je)/s.aB,et={getElevation:Ae,pitchedLabelPlaneMatrix:R,lineVertexArray:f,pitchWithMap:H,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:De,unwrappedTileID:x,width:this.transform.width,height:this.transform.height,translation:de},Xe=J(Ue,g,c.lineOffsetX*Ue,c.lineOffsetY*Ue,!1,c,!1,et);let it=!1,dt=!1,Je=!0;if(Xe){const mt=.5*ae*je+ee,Et=new s.P(-100,-100),xt=new s.P(this.screenRightBoundary,this.screenBottomBoundary),At=new ie,kt=Xe.first,er=Xe.last;let Qt=[];for(let Qr=kt.path.length-1;Qr>=1;Qr--)Qt.push(kt.path[Qr]);for(let Qr=1;Qr<er.path.length;Qr++)Qt.push(er.path[Qr]);const Ht=2.5*mt;if(H){const Qr=this.projectPathToScreenSpace(Qt,et);Qt=Qr.some(ki=>ki.signedDistanceFromCamera<=0)?[]:Qr.map(ki=>ki.point)}let br=[];if(Qt.length>0){const Qr=Qt[0].clone(),ki=Qt[0].clone();for(let Ji=1;Ji<Qt.length;Ji++)Qr.x=Math.min(Qr.x,Qt[Ji].x),Qr.y=Math.min(Qr.y,Qt[Ji].y),ki.x=Math.max(ki.x,Qt[Ji].x),ki.y=Math.max(ki.y,Qt[Ji].y);br=Qr.x>=Et.x&&ki.x<=xt.x&&Qr.y>=Et.y&&ki.y<=xt.y?[Qt]:ki.x<Et.x||Qr.x>xt.x||ki.y<Et.y||Qr.y>xt.y?[]:s.ay([Qt],Et.x,Et.y,xt.x,xt.y)}for(const Qr of br){At.reset(Qr,.25*mt);let ki=0;ki=At.length<=.5*mt?1:Math.ceil(At.paddedLength/Ht)+1;for(let Ji=0;Ji<ki;Ji++){const qi=Ji/Math.max(ki-1,1),an=At.lerp(qi),Qi=an.x+lr,Fn=an.y+lr;Fe.push(Qi,Fn,mt,0);const en=Qi-mt,Di=Fn-mt,cn=Qi+mt,ri=Fn+mt;if(Je=Je&&this.isOffscreen(en,Di,cn,ri),dt=dt||this.isInsideGrid(en,Di,cn,ri),r!=="always"&&this.grid.hitTestCircle(Qi,Fn,mt,r,X)&&(it=!0,!F))return{circles:[],offscreen:!1,collisionDetected:it}}}}return{circles:!F&&it||!dt||je<this.perspectiveRatioCutoff?[]:Fe,offscreen:Je,collisionDetected:it}}projectPathToScreenSpace(r,c){const f=function(g,y){const x=s.L();return s.aq(x,y.pitchedLabelPlaneMatrix),g.map(R=>{const F=xe(R.x,R.y,x,y.getElevation),H=y.transform.projectTileCoordinates(F.point.x,F.point.y,y.unwrappedTileID,y.getElevation);return H.point.x=(.5*H.point.x+.5)*y.width,H.point.y=(.5*-H.point.y+.5)*y.height,H})}(r,c);return function(g){let y=0,x=0,R=0,F=0;for(let H=0;H<g.length;H++)g[H].isOccluded?(R=H+1,F=0):(F++,F>x&&(x=F,y=R));return g.slice(y,y+x)}(f)}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[],f=new s.a2;for(const ae of r){const ee=new s.P(ae.x+lr,ae.y+lr);f.extend(ee),c.push(ee)}const{minX:g,minY:y,maxX:x,maxY:R}=f,F=this.grid.query(g,y,x,R).concat(this.ignoredGrid.query(g,y,x,R)),H={},X={};for(const ae of F){const ee=ae.key;if(H[ee.bucketInstanceId]===void 0&&(H[ee.bucketInstanceId]={}),H[ee.bucketInstanceId][ee.featureIndex])continue;const de=[new s.P(ae.x1,ae.y1),new s.P(ae.x2,ae.y1),new s.P(ae.x2,ae.y2),new s.P(ae.x1,ae.y2)];s.az(c,de)&&(H[ee.bucketInstanceId][ee.featureIndex]=!0,X[ee.bucketInstanceId]===void 0&&(X[ee.bucketInstanceId]=[]),X[ee.bucketInstanceId].push(ee.featureIndex))}return X}insertCollisionBox(r,c,f,g,y,x){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:y,collisionGroupID:x,overlapMode:c},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,c,f,g,y,x){const R=f?this.ignoredGrid:this.grid,F={bucketInstanceId:g,featureIndex:y,collisionGroupID:x,overlapMode:c};for(let H=0;H<r.length;H+=4)R.insertCircle(F,r[H],r[H+1],r[H+2])}projectAndGetPerspectiveRatio(r,c,f,g,y){if(y){let x;g?(x=[r,c,g(r,c),1],s.aw(x,x,y)):(x=[r,c,0,1],gr(x,x,y));const R=x[3];return{x:(x[0]/R+1)/2*this.transform.width+lr,y:(-x[1]/R+1)/2*this.transform.height+lr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/R*.5,isOccluded:!1,signedDistanceFromCamera:R}}{const x=this.transform.projectTileCoordinates(r,c,f,g);return{x:(x.point.x+1)/2*this.transform.width+lr,y:(1-x.point.y)/2*this.transform.height+lr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5,isOccluded:x.isOccluded,signedDistanceFromCamera:x.signedDistanceFromCamera}}}getPerspectiveRatio(r,c,f,g){const y=this.transform.projectTileCoordinates(r,c,f,g);return .5+this.transform.cameraToCenterDistance/y.signedDistanceFromCamera*.5}isOffscreen(r,c,f,g){return f<lr||r>=this.screenRightBoundary||g<lr||c>this.screenBottomBoundary}isInsideGrid(r,c,f,g){return f>=0&&r<this.gridRightBoundary&&g>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const r=s.ag([]);return s.M(r,r,[-100,-100,0]),r}_projectCollisionBox(r,c,f,g,y,x,R,F,H,X,ae){let ee=1,de=0,Ae=0,Fe=1;const De=r.anchorPointX+R[0],je=r.anchorPointY+R[1];if(x&&!y){const Qt=this.projectAndGetPerspectiveRatio(De+1,je,g,H,ae),Ht=Qt.x-F.x,br=Math.atan((Qt.y-F.y)/Ht)+(Ht<0?Math.PI:0),Qr=Math.sin(br),ki=Math.cos(br);ee=ki,de=Qr,Ae=-Qr,Fe=ki}else if(!x&&y){const Qt=O(this.transform);ee=Qt.vecEast[0],de=Qt.vecEast[1],Ae=Qt.vecSouth[0],Fe=Qt.vecSouth[1]}let Ue=F.x,et=F.y,Xe=c;y&&(Ue=De,et=je,Xe=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),Xe*=this.transform.getPitchedTextCorrection(De,je,g),X||(Xe*=s.ah(.5+F.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),X&&(Ue+=ee*X.x*Xe+Ae*X.y*Xe,et+=de*X.x*Xe+Fe*X.y*Xe);const it=r.x1*Xe,dt=r.x2*Xe,Je=(it+dt)/2,mt=r.y1*Xe,Et=r.y2*Xe,xt=(mt+Et)/2,At=[{offsetX:it,offsetY:mt},{offsetX:Je,offsetY:mt},{offsetX:dt,offsetY:mt},{offsetX:dt,offsetY:xt},{offsetX:dt,offsetY:Et},{offsetX:Je,offsetY:Et},{offsetX:it,offsetY:Et},{offsetX:it,offsetY:xt}];let kt=[];for(const{offsetX:Qt,offsetY:Ht}of At)kt.push(new s.P(Ue+ee*Qt+Ae*Ht,et+de*Qt+Fe*Ht));let er=!1;if(y){const Qt=kt.map(Ht=>this.projectAndGetPerspectiveRatio(Ht.x,Ht.y,g,H,ae));er=Qt.some(Ht=>!Ht.isOccluded),kt=Qt.map(Ht=>new s.P(Ht.x,Ht.y))}else er=!0;return{box:s.aA(kt),allPointsOccluded:!er}}}class ft{constructor(r,c,f,g){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?c:-c))):g&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class Bt{constructor(r,c,f,g,y){this.text=new ft(r?r.text:null,c,f,y),this.icon=new ft(r?r.icon:null,c,g,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class mr{constructor(r,c,f){this.text=r,this.icon=c,this.skipFade=f}}class Wt{constructor(r,c,f,g,y){this.bucketInstanceId=r,this.featureIndex=c,this.sourceLayerIndex=f,this.bucketIndex=g,this.tileID=y}}class vi{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const c=++this.maxGroupID;this.collisionGroups[r]={ID:c,predicate:f=>f.collisionGroupID===c}}return this.collisionGroups[r]}}function Gr(v,r,c,f,g){const{horizontalAlign:y,verticalAlign:x}=s.aH(v);return new s.P(-(y-.5)*r+f[0]*g,-(x-.5)*c+f[1]*g)}class mi{constructor(r,c,f,g,y){this.transform=r.clone(),this.terrain=c,this.collisionIndex=new Xr(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new vi(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(r){const c=this.terrain;return c?(f,g)=>c.getElevation(r,f,g):null}getBucketParts(r,c,f,g){const y=f.getBucket(c),x=f.latestFeatureIndex;if(!y||!x||c.id!==y.layerIds[0])return;const R=f.collisionBoxArray,F=y.layers[0].layout,H=y.layers[0].paint,X=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),ae=f.tileSize/s.$,ee=f.tileID.toUnwrapped(),de=F.get("text-rotation-alignment")==="map",Ae=s.aC(f,1,this.transform.zoom),Fe=s.aD(this.collisionIndex.transform,f,H.get("text-translate"),H.get("text-translate-anchor")),De=s.aD(this.collisionIndex.transform,f,H.get("icon-translate"),H.get("icon-translate-anchor")),je=M(de,this.transform,Ae);this.retainedQueryData[y.bucketInstanceId]=new Wt(y.bucketInstanceId,x,y.sourceLayerIndex,y.index,f.tileID);const Ue={bucket:y,layout:F,translationText:Fe,translationIcon:De,unwrappedTileID:ee,pitchedLabelPlaneMatrix:je,scale:X,textPixelRatio:ae,holdingForFade:f.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:s.an(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(g)for(const et of y.sortKeyRanges){const{sortKey:Xe,symbolInstanceStart:it,symbolInstanceEnd:dt}=et;r.push({sortKey:Xe,symbolInstanceStart:it,symbolInstanceEnd:dt,parameters:Ue})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:Ue})}attemptAnchorPlacement(r,c,f,g,y,x,R,F,H,X,ae,ee,de,Ae,Fe,De,je,Ue,et,Xe){const it=s.aE[r.textAnchor],dt=[r.textOffset0,r.textOffset1],Je=Gr(it,f,g,dt,y),mt=this.collisionIndex.placeCollisionBox(c,ee,F,H,X,R,x,De,ae.predicate,et,Je,Xe);if((!Ue||this.collisionIndex.placeCollisionBox(Ue,ee,F,H,X,R,x,je,ae.predicate,et,Je,Xe).placeable)&&mt.placeable){let Et;if(this.prevPlacement&&this.prevPlacement.variableOffsets[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID].text&&(Et=this.prevPlacement.variableOffsets[de.crossTileID].anchor),de.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[de.crossTileID]={textOffset:dt,width:f,height:g,anchor:it,textBoxScale:y,prevAnchor:Et},this.markUsedJustification(Ae,it,de,Fe),Ae.allowVerticalPlacement&&(this.markUsedOrientation(Ae,Fe,de),this.placedOrientations[de.crossTileID]=Fe),{shift:Je,placedGlyphBoxes:mt}}}placeLayerBucketPart(r,c,f){const{bucket:g,layout:y,translationText:x,translationIcon:R,unwrappedTileID:F,pitchedLabelPlaneMatrix:H,textPixelRatio:X,holdingForFade:ae,collisionBoxArray:ee,partiallyEvaluatedTextSize:de,collisionGroup:Ae}=r.parameters,Fe=y.get("text-optional"),De=y.get("icon-optional"),je=s.aF(y,"text-overlap","text-allow-overlap"),Ue=je==="always",et=s.aF(y,"icon-overlap","icon-allow-overlap"),Xe=et==="always",it=y.get("text-rotation-alignment")==="map",dt=y.get("text-pitch-alignment")==="map",Je=y.get("icon-text-fit")!=="none",mt=y.get("symbol-z-order")==="viewport-y",Et=Ue&&(Xe||!g.hasIconData()||De),xt=Xe&&(Ue||!g.hasTextData()||Fe);!g.collisionArrays&&ee&&g.deserializeCollisionBoxes(ee);const At=this.retainedQueryData[g.bucketInstanceId].tileID,kt=this._getTerrainElevationFunc(At),er=this.transform.getFastPathSimpleProjectionMatrix(At),Qt=(Ht,br,Qr)=>{var ki,Ji;if(c[Ht.crossTileID])return;if(ae)return void(this.placements[Ht.crossTileID]=new mr(!1,!1,!1));let qi=!1,an=!1,Qi=!0,Fn=null,en={box:null,placeable:!1,offscreen:null,occluded:!1},Di={placeable:!1},cn=null,ri=null,Jn=null,ka=0,el=0,to=0;br.textFeatureIndex?ka=br.textFeatureIndex:Ht.useRuntimeCollisionCircles&&(ka=Ht.featureIndex),br.verticalTextFeatureIndex&&(el=br.verticalTextFeatureIndex);const tl=br.textBox;if(tl){const Cs=Sn=>{let Pn=s.ao.horizontal;if(g.allowVerticalPlacement&&!Sn&&this.prevPlacement){const fs=this.prevPlacement.placedOrientations[Ht.crossTileID];fs&&(this.placedOrientations[Ht.crossTileID]=fs,Pn=fs,this.markUsedOrientation(g,Pn,Ht))}return Pn},io=(Sn,Pn)=>{if(g.allowVerticalPlacement&&Ht.numVerticalGlyphVertices>0&&br.verticalTextBox){for(const fs of g.writingModes)if(fs===s.ao.vertical?(en=Pn(),Di=en):en=Sn(),en&&en.placeable)break}else en=Sn()},Ra=Ht.textAnchorOffsetStartIndex,no=Ht.textAnchorOffsetEndIndex;if(no===Ra){const Sn=(Pn,fs)=>{const tn=this.collisionIndex.placeCollisionBox(Pn,je,X,At,F,dt,it,x,Ae.predicate,kt,void 0,er);return tn&&tn.placeable&&(this.markUsedOrientation(g,fs,Ht),this.placedOrientations[Ht.crossTileID]=fs),tn};io(()=>Sn(tl,s.ao.horizontal),()=>{const Pn=br.verticalTextBox;return g.allowVerticalPlacement&&Ht.numVerticalGlyphVertices>0&&Pn?Sn(Pn,s.ao.vertical):{box:null,offscreen:null}}),Cs(en&&en.placeable)}else{let Sn=s.aE[(Ji=(ki=this.prevPlacement)===null||ki===void 0?void 0:ki.variableOffsets[Ht.crossTileID])===null||Ji===void 0?void 0:Ji.anchor];const Pn=(tn,Jh,X0)=>{const q0=tn.x2-tn.x1,R1=tn.y2-tn.y1,Jd=Ht.textBoxScale,zc=Je&&et==="never"?Jh:null;let Ss=null,va=je==="never"?1:2,Zs="never";Sn&&va++;for(let La=0;La<va;La++){for(let Qh=Ra;Qh<no;Qh++){const Qd=g.textAnchorOffsets.get(Qh);if(Sn&&Qd.textAnchor!==Sn)continue;const eu=this.attemptAnchorPlacement(Qd,tn,q0,R1,Jd,it,dt,X,At,F,Ae,Zs,Ht,g,X0,x,R,zc,kt);if(eu&&(Ss=eu.placedGlyphBoxes,Ss&&Ss.placeable))return qi=!0,Fn=eu.shift,Ss}Sn?Sn=null:Zs=je}return f&&!Ss&&(Ss={box:this.collisionIndex.placeCollisionBox(tl,"always",X,At,F,dt,it,x,Ae.predicate,kt,void 0,er).box,offscreen:!1,placeable:!1,occluded:!1}),Ss};io(()=>Pn(tl,br.iconBox,s.ao.horizontal),()=>{const tn=br.verticalTextBox;return g.allowVerticalPlacement&&(!en||!en.placeable)&&Ht.numVerticalGlyphVertices>0&&tn?Pn(tn,br.verticalIconBox,s.ao.vertical):{box:null,occluded:!0,offscreen:null}}),en&&(qi=en.placeable,Qi=en.offscreen);const fs=Cs(en&&en.placeable);if(!qi&&this.prevPlacement){const tn=this.prevPlacement.variableOffsets[Ht.crossTileID];tn&&(this.variableOffsets[Ht.crossTileID]=tn,this.markUsedJustification(g,tn.anchor,Ht,fs))}}}if(cn=en,qi=cn&&cn.placeable,Qi=cn&&cn.offscreen,Ht.useRuntimeCollisionCircles&&Ht.centerJustifiedTextSymbolIndex>=0){const Cs=g.text.placedSymbolArray.get(Ht.centerJustifiedTextSymbolIndex),io=s.ap(g.textSizeData,de,Cs),Ra=y.get("text-padding");ri=this.collisionIndex.placeCollisionCircles(je,Cs,g.lineVertexArray,g.glyphOffsetArray,io,F,H,f,dt,Ae.predicate,Ht.collisionCircleDiameter,Ra,x,kt),ri.circles.length&&ri.collisionDetected&&!f&&s.w("Collisions detected, but collision boxes are not shown"),qi=Ue||ri.circles.length>0&&!ri.collisionDetected,Qi=Qi&&ri.offscreen}if(br.iconFeatureIndex&&(to=br.iconFeatureIndex),br.iconBox){const Cs=io=>this.collisionIndex.placeCollisionBox(io,et,X,At,F,dt,it,R,Ae.predicate,kt,Je&&Fn?Fn:void 0,er);Di&&Di.placeable&&br.verticalIconBox?(Jn=Cs(br.verticalIconBox),an=Jn.placeable):(Jn=Cs(br.iconBox),an=Jn.placeable),Qi=Qi&&Jn.offscreen}const Lc=Fe||Ht.numHorizontalGlyphVertices===0&&Ht.numVerticalGlyphVertices===0,ro=De||Ht.numIconVertices===0;Lc||ro?ro?Lc||(an=an&&qi):qi=an&&qi:an=qi=an&&qi;const rl=an&&Jn.placeable;if(qi&&cn.placeable&&this.collisionIndex.insertCollisionBox(cn.box,je,y.get("text-ignore-placement"),g.bucketInstanceId,Di&&Di.placeable&&el?el:ka,Ae.ID),rl&&this.collisionIndex.insertCollisionBox(Jn.box,et,y.get("icon-ignore-placement"),g.bucketInstanceId,to,Ae.ID),ri&&qi&&this.collisionIndex.insertCollisionCircles(ri.circles,je,y.get("text-ignore-placement"),g.bucketInstanceId,ka,Ae.ID),f&&this.storeCollisionData(g.bucketInstanceId,Qr,br,cn,Jn,ri),Ht.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(g.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ht.crossTileID]=new mr((qi||Et)&&!(cn!=null&&cn.occluded),(an||xt)&&!(Jn!=null&&Jn.occluded),Qi||g.justReloaded),c[Ht.crossTileID]=!0};if(mt){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ht=g.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let br=Ht.length-1;br>=0;--br){const Qr=Ht[br];Qt(g.symbolInstances.get(Qr),g.collisionArrays[Qr],Qr)}}else for(let Ht=r.symbolInstanceStart;Ht<r.symbolInstanceEnd;Ht++)Qt(g.symbolInstances.get(Ht),g.collisionArrays[Ht],Ht);g.justReloaded=!1}storeCollisionData(r,c,f,g,y,x){if(f.textBox||f.iconBox){let R,F;this.collisionBoxArrays.has(r)?R=this.collisionBoxArrays.get(r):(R=new Map,this.collisionBoxArrays.set(r,R)),R.has(c)?F=R.get(c):(F={text:null,icon:null},R.set(c,F)),f.textBox&&(F.text=g.box),f.iconBox&&(F.icon=y.box)}if(x){let R=this.collisionCircleArrays[r];R===void 0&&(R=this.collisionCircleArrays[r]=[]);for(let F=0;F<x.circles.length;F+=4)R.push(x.circles[F+0]-lr),R.push(x.circles[F+1]-lr),R.push(x.circles[F+2]),R.push(x.collisionDetected?1:0)}}markUsedJustification(r,c,f,g){let y;y=g===s.ao.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[s.aG(c)];const x=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const R of x)R>=0&&(r.text.placedSymbolArray.get(R).crossTileID=y>=0&&R!==y?0:f.crossTileID)}markUsedOrientation(r,c,f){const g=c===s.ao.horizontal||c===s.ao.horizontalOnly?c:0,y=c===s.ao.vertical?c:0,x=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const R of x)r.text.placedSymbolArray.get(R).placedOrientation=g;f.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let f=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const g=c?c.symbolFadeChange(r):1,y=c?c.opacities:{},x=c?c.variableOffsets:{},R=c?c.placedOrientations:{};for(const F in this.placements){const H=this.placements[F],X=y[F];X?(this.opacities[F]=new Bt(X,g,H.text,H.icon),f=f||H.text!==X.text.placed||H.icon!==X.icon.placed):(this.opacities[F]=new Bt(null,g,H.text,H.icon,H.skipFade),f=f||H.text||H.icon)}for(const F in y){const H=y[F];if(!this.opacities[F]){const X=new Bt(H,g,!1,!1);X.isHidden()||(this.opacities[F]=X,f=f||H.text.placed||H.icon.placed)}}for(const F in x)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=x[F]);for(const F in R)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=R[F]);if(c&&c.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:r)}updateLayerOpacities(r,c){const f={};for(const g of c){const y=g.getBucket(r);y&&g.latestFeatureIndex&&r.id===y.layerIds[0]&&this.updateBucketOpacities(y,g.tileID,f,g.collisionBoxArray)}}updateBucketOpacities(r,c,f,g){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const y=r.layers[0],x=y.layout,R=new Bt(null,0,!1,!1,!0),F=x.get("text-allow-overlap"),H=x.get("icon-allow-overlap"),X=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ae=x.get("text-rotation-alignment")==="map",ee=x.get("text-pitch-alignment")==="map",de=x.get("icon-text-fit")!=="none",Ae=new Bt(null,0,F&&(H||!r.hasIconData()||x.get("icon-optional")),H&&(F||!r.hasTextData()||x.get("text-optional")),!0);!r.collisionArrays&&g&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(g);const Fe=(je,Ue,et)=>{for(let Xe=0;Xe<Ue/4;Xe++)je.opacityVertexArray.emplaceBack(et);je.hasVisibleVertices=je.hasVisibleVertices||et!==Vi},De=this.collisionBoxArrays.get(r.bucketInstanceId);for(let je=0;je<r.symbolInstances.length;je++){const Ue=r.symbolInstances.get(je),{numHorizontalGlyphVertices:et,numVerticalGlyphVertices:Xe,crossTileID:it}=Ue;let dt=this.opacities[it];f[it]?dt=R:dt||(dt=Ae,this.opacities[it]=dt),f[it]=!0;const Je=Ue.numIconVertices>0,mt=this.placedOrientations[Ue.crossTileID],Et=mt===s.ao.vertical,xt=mt===s.ao.horizontal||mt===s.ao.horizontalOnly;if(et>0||Xe>0){const kt=pn(dt.text);Fe(r.text,et,Et?Vi:kt),Fe(r.text,Xe,xt?Vi:kt);const er=dt.text.isHidden();[Ue.rightJustifiedTextSymbolIndex,Ue.centerJustifiedTextSymbolIndex,Ue.leftJustifiedTextSymbolIndex].forEach(br=>{br>=0&&(r.text.placedSymbolArray.get(br).hidden=er||Et?1:0)}),Ue.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(Ue.verticalPlacedTextSymbolIndex).hidden=er||xt?1:0);const Qt=this.variableOffsets[Ue.crossTileID];Qt&&this.markUsedJustification(r,Qt.anchor,Ue,mt);const Ht=this.placedOrientations[Ue.crossTileID];Ht&&(this.markUsedJustification(r,"left",Ue,Ht),this.markUsedOrientation(r,Ht,Ue))}if(Je){const kt=pn(dt.icon),er=!(de&&Ue.verticalPlacedIconSymbolIndex&&Et);Ue.placedIconSymbolIndex>=0&&(Fe(r.icon,Ue.numIconVertices,er?kt:Vi),r.icon.placedSymbolArray.get(Ue.placedIconSymbolIndex).hidden=dt.icon.isHidden()),Ue.verticalPlacedIconSymbolIndex>=0&&(Fe(r.icon,Ue.numVerticalIconVertices,er?Vi:kt),r.icon.placedSymbolArray.get(Ue.verticalPlacedIconSymbolIndex).hidden=dt.icon.isHidden())}const At=De&&De.has(je)?De.get(je):{text:null,icon:null};if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const kt=r.collisionArrays[je];if(kt){let er=new s.P(0,0);if(kt.textBox||kt.verticalTextBox){let Qt=!0;if(X){const Ht=this.variableOffsets[it];Ht?(er=Gr(Ht.anchor,Ht.width,Ht.height,Ht.textOffset,Ht.textBoxScale),ae&&er._rotate(ee?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Qt=!1}if(kt.textBox||kt.verticalTextBox){let Ht;kt.textBox&&(Ht=Et),kt.verticalTextBox&&(Ht=xt),gi(r.textCollisionBox.collisionVertexArray,dt.text.placed,!Qt||Ht,At.text,er.x,er.y)}}if(kt.iconBox||kt.verticalIconBox){const Qt=!!(!xt&&kt.verticalIconBox);let Ht;kt.iconBox&&(Ht=Qt),kt.verticalIconBox&&(Ht=!Qt),gi(r.iconCollisionBox.collisionVertexArray,dt.icon.placed,Ht,At.icon,de?er.x:0,de?er.y:0)}}}}if(r.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);r.bucketInstanceId in this.collisionCircleArrays&&(r.collisionCircleArray=this.collisionCircleArrays[r.bucketInstanceId],delete this.collisionCircleArrays[r.bucketInstanceId])}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,c){const f=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*f>r}setStale(){this.stale=!0}}function gi(v,r,c,f,g,y){f&&f.length!==0||(f=[0,0,0,0]);const x=f[0]-lr,R=f[1]-lr,F=f[2]-lr,H=f[3]-lr;v.emplaceBack(r?1:0,c?1:0,g||0,y||0,x,R),v.emplaceBack(r?1:0,c?1:0,g||0,y||0,F,R),v.emplaceBack(r?1:0,c?1:0,g||0,y||0,F,H),v.emplaceBack(r?1:0,c?1:0,g||0,y||0,x,H)}const Gi=Math.pow(2,25),Ln=Math.pow(2,24),Ei=Math.pow(2,17),on=Math.pow(2,16),zn=Math.pow(2,9),ti=Math.pow(2,8),ln=Math.pow(2,1);function pn(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const r=v.placed?1:0,c=Math.floor(127*v.opacity);return c*Gi+r*Ln+c*Ei+r*on+c*zn+r*ti+c*ln+r}const Vi=0;class di{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,c,f,g,y){const x=this._bucketParts;for(;this._currentTileIndex<r.length;)if(c.getBucketParts(x,g,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((R,F)=>R.sortKey-F.sortKey));this._currentPartIndex<x.length;)if(c.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,y())return!0;return!1}}class fa{constructor(r,c,f,g,y,x,R,F){this.placement=new mi(r,c,x,R,F),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(r,c,f){const g=D.now(),y=()=>!this._forceFullPlacement&&D.now()-g>2;for(;this._currentPlacementIndex>=0;){const x=c[r[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=R)&&(!x.maxzoom||x.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new di(x)),this._inProgressLayer.continuePlacement(f[x.source],this.placement,this._showCollisionBoxes,x,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Kn=512/s.$/2;class ac{constructor(r,c,f){this.tileID=r,this.bucketInstanceId=f,this._symbolsByKey={};const g=new Map;for(let y=0;y<c.length;y++){const x=c.get(y),R=x.key,F=g.get(R);F?F.push(x):g.set(R,[x])}for(const[y,x]of g){const R={positions:x.map(F=>({x:Math.floor(F.anchorX*Kn),y:Math.floor(F.anchorY*Kn)})),crossTileIDs:x.map(F=>F.crossTileID)};if(R.positions.length>128){const F=new s.aI(R.positions.length,16,Uint16Array);for(const{x:H,y:X}of R.positions)F.add(H,X);F.finish(),delete R.positions,R.index=F}this._symbolsByKey[y]=R}}getScaledCoordinates(r,c){const{x:f,y:g,z:y}=this.tileID.canonical,{x,y:R,z:F}=c.canonical,H=Kn/Math.pow(2,F-y),X=(R*s.$+r.anchorY)*H,ae=g*s.$*Kn;return{x:Math.floor((x*s.$+r.anchorX)*H-f*s.$*Kn),y:Math.floor(X-ae)}}findMatches(r,c,f){const g=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let y=0;y<r.length;y++){const x=r.get(y);if(x.crossTileID)continue;const R=this._symbolsByKey[x.key];if(!R)continue;const F=this.getScaledCoordinates(x,c);if(R.index){const H=R.index.range(F.x-g,F.y-g,F.x+g,F.y+g).sort();for(const X of H){const ae=R.crossTileIDs[X];if(!f[ae]){f[ae]=!0,x.crossTileID=ae;break}}}else if(R.positions)for(let H=0;H<R.positions.length;H++){const X=R.positions[H],ae=R.crossTileIDs[H];if(Math.abs(X.x-F.x)<=g&&Math.abs(X.y-F.y)<=g&&!f[ae]){f[ae]=!0,x.crossTileID=ae;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class oc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ld{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const c=Math.round((r-this.lng)/360);if(c!==0)for(const f in this.indexes){const g=this.indexes[f],y={};for(const x in g){const R=g[x];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+c),y[R.tileID.key]=R}this.indexes[f]=y}this.lng=r}addBucket(r,c,f){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let y=0;y<c.symbolInstances.length;y++)c.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const g=this.usedCrossTileIDs[r.overscaledZ];for(const y in this.indexes){const x=this.indexes[y];if(Number(y)>r.overscaledZ)for(const R in x){const F=x[R];F.tileID.isChildOf(r)&&F.findMatches(c.symbolInstances,r,g)}else{const R=x[r.scaledTo(Number(y)).key];R&&R.findMatches(c.symbolInstances,r,g)}}for(let y=0;y<c.symbolInstances.length;y++){const x=c.symbolInstances.get(y);x.crossTileID||(x.crossTileID=f.generate(),g[x.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new ac(r,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(r,c){for(const f of c.getCrossTileIDsLists())for(const g of f)delete this.usedCrossTileIDs[r][g]}removeStaleBuckets(r){let c=!1;for(const f in this.indexes){const g=this.indexes[f];for(const y in g)r[g[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,g[y]),delete g[y],c=!0)}return c}}class Ka{constructor(){this.layerIndexes={},this.crossTileIDs=new oc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,c,f){let g=this.layerIndexes[r.id];g===void 0&&(g=this.layerIndexes[r.id]=new ld);let y=!1;const x={};g.handleWrapJump(f);for(const R of c){const F=R.getBucket(r);F&&r.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),g.addBucket(R.tileID,F,this.crossTileIDs)&&(y=!0),x[F.bucketInstanceId]=!0)}return g.removeStaleBuckets(x)&&(y=!0),y}pruneUnusedLayers(r){const c={};r.forEach(f=>{c[f]=!0});for(const f in this.layerIndexes)c[f]||delete this.layerIndexes[f]}}var Ro="void main() {fragColor=vec4(1.0);}";const Ms={prelude:ei(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ei("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ei("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ei(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ei(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ei(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ei(Ro,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ei(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ei(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ei("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ei("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:ei(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:ei("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ei(Ro,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ei(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ei(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ei(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ei(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ei(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ei(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ei(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ei(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ei(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ei(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ei(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ei(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:ei(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ei(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ei(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ei(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ei("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ei("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ei("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ei("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ei(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ei("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ei(v,r){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=r.match(/in ([\w]+) ([\w]+)/g),g=v.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=y?y.concat(g):g,R={};return{fragmentSource:v=v.replace(c,(F,H,X,ae,ee)=>(R[ee]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
in ${X} ${ae} ${ee};
#else
uniform ${X} ${ae} u_${ee};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ee}
    ${X} ${ae} ${ee} = u_${ee};
#endif
`)),vertexSource:r=r.replace(c,(F,H,X,ae,ee)=>{const de=ae==="float"?"vec2":"vec4",Ae=ee.match(/color/)?"color":de;return R[ee]?H==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${X} ${de} a_${ee};
out ${X} ${ae} ${ee};
#else
uniform ${X} ${ae} u_${ee};
#endif
`:Ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = a_${ee};
#else
    ${X} ${ae} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = unpack_mix_${Ae}(a_${ee}, u_${ee}_t);
#else
    ${X} ${ae} ${ee} = u_${ee};
#endif
`:H==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
in ${X} ${de} a_${ee};
#else
uniform ${X} ${ae} u_${ee};
#endif
`:Ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${X} ${ae} ${ee} = a_${ee};
#else
    ${X} ${ae} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${X} ${ae} ${ee} = unpack_mix_${Ae}(a_${ee}, u_${ee}_t);
#else
    ${X} ${ae} ${ee} = u_${ee};
#endif
`}),staticAttributes:f,staticUniforms:x}}class Lo{constructor(r,c,f){this.vertexBuffer=r,this.indexBuffer=c,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var $a=s.aJ([{name:"a_pos",type:"Int16",components:2}]);const Ca="#define PROJECTION_MERCATOR",zo="mercator";class si{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return zo}get shaderDefine(){return Ca}get shaderPreludeCode(){return Ms.projectionMercator}get vertexShaderPreludeCode(){return Ms.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(r){}getMeshFromTileID(r,c,f,g,y){if(this._cachedMesh)return this._cachedMesh;const x=new s.aL;x.emplaceBack(0,0),x.emplaceBack(s.$,0),x.emplaceBack(0,s.$),x.emplaceBack(s.$,s.$);const R=r.createVertexBuffer(x,$a.members),F=s.aM.simpleSegment(0,0,4,2),H=new s.aN;H.emplaceBack(1,0,2),H.emplaceBack(1,2,3);const X=r.createIndexBuffer(H);return this._cachedMesh=new Lo(R,X,F),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(r){}}class Fo{constructor(r=0,c=0,f=0,g=0){if(isNaN(r)||r<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(g)||g<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=c,this.left=f,this.right=g}interpolate(r,c,f){return c.top!=null&&r.top!=null&&(this.top=s.C.number(r.top,c.top,f)),c.bottom!=null&&r.bottom!=null&&(this.bottom=s.C.number(r.bottom,c.bottom,f)),c.left!=null&&r.left!=null&&(this.left=s.C.number(r.left,c.left,f)),c.right!=null&&r.right!=null&&(this.right=s.C.number(r.right,c.right,f)),this}getCenter(r,c){const f=s.ah((this.left+r-this.right)/2,0,r),g=s.ah((this.top+c-this.bottom)/2,0,c);return new s.P(f,g)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Fo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mh(v,r){if(!v.renderWorldCopies||v.lngRange)return;const c=r.lng-v.center.lng;r.lng+=c>180?-360:c<-180?360:0}function gh(v){return Math.max(0,Math.floor(v))}class cs{constructor(r,c,f,g,y,x){this._callbacks=r,this._tileSize=512,this._renderWorldCopies=x===void 0||!!x,this._minZoom=c||0,this._maxZoom=f||22,this._minPitch=g??0,this._maxPitch=y??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=gh(this._zoom),this._scale=s.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Fo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(r,c,f){this._latRange=r.latRange,this._lngRange=r.lngRange,this._width=r.width,this._height=r.height,this._center=r.center,this._elevation=r.elevation,this._minElevationForCurrentTile=r.minElevationForCurrentTile,this._zoom=r.zoom,this._tileZoom=gh(this._zoom),this._scale=s.af(this._zoom),this._bearingInRadians=r.bearingInRadians,this._fovInRadians=r.fovInRadians,this._pitchInRadians=r.pitchInRadians,this._rollInRadians=r.rollInRadians,this._unmodified=r.unmodified,this._edgeInsets=new Fo(r.padding.top,r.padding.bottom,r.padding.left,r.padding.right),this._minZoom=r.minZoom,this._maxZoom=r.maxZoom,this._minPitch=r.minPitch,this._maxPitch=r.maxPitch,this._renderWorldCopies=r.renderWorldCopies,this._cameraToCenterDistance=r.cameraToCenterDistance,this._nearZ=r.nearZ,this._farZ=r.farZ,this._autoCalculateNearFarZ=!f&&r.autoCalculateNearFarZ,c&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(r){this._minElevationForCurrentTile=r}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(r){this._minZoom!==r&&(this._minZoom=r,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(r){this._minPitch!==r&&(this._minPitch=r,this.setPitch(Math.max(this.pitch,r)))}get maxPitch(){return this._maxPitch}setMaxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.setPitch(Math.min(this.pitch,r)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(r){const c=s.aO(r,-180,180)*Math.PI/180;var f,g,y,x,R,F,H,X,ae;this._bearingInRadians!==c&&(this._unmodified=!1,this._bearingInRadians=c,this._calcMatrices(),this._rotationMatrix=A(),f=this._rotationMatrix,y=-this._bearingInRadians,x=(g=this._rotationMatrix)[0],R=g[1],F=g[2],H=g[3],X=Math.sin(y),ae=Math.cos(y),f[0]=x*ae+F*X,f[1]=R*ae+H*X,f[2]=x*-X+F*ae,f[3]=R*-X+H*ae)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(r){const c=s.ah(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==c&&(this._unmodified=!1,this._pitchInRadians=c,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(r){const c=r/180*Math.PI;this._rollInRadians!==c&&(this._unmodified=!1,this._rollInRadians=c,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aP(this._fovInRadians)}setFov(r){r=s.ah(r,.1,150),this.fov!==r&&(this._unmodified=!1,this._fovInRadians=s.ae(r),this._calcMatrices())}get zoom(){return this._zoom}setZoom(r){const c=this.getConstrained(this._center,r).zoom;this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this._tileZoom=Math.max(0,Math.floor(c)),this._scale=s.af(c),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(r,c){this._autoCalculateNearFarZ=!1,this._nearZ=r,this._farZ=c,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,c,f){this._unmodified=!1,this._edgeInsets.interpolate(r,c,f),this._constrain(),this._calcMatrices()}resize(r,c,f=!0){this._width=r,this._height=c,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ot([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(r){r?(this._lngRange=[r.getWest(),r.getEast()],this._latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-s.ai,s.ai])}getConstrained(r,c){return this._callbacks.getConstrained(r,c)}getCameraQueryGeometry(r,c){if(c.length===1)return[c[0],r];{const{minX:f,minY:g,maxX:y,maxY:x}=s.a2.fromPoints(c).extend(r);return[new s.P(f,g),new s.P(y,g),new s.P(y,x),new s.P(f,x),new s.P(f,g)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const r=this._unmodified,{center:c,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(c),this.setZoom(f),this._unmodified=r,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let r=s.ag(new Float64Array(16));s.N(r,r,[this._width/2,-this._height/2,1]),s.M(r,r,[1,-1,0]),this._clipSpaceToPixelsMatrix=r,r=s.ag(new Float64Array(16)),s.N(r,r,[1,-1,1]),s.M(r,r,[-1,-1,0]),s.N(r,r,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=r,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(r,c,f,g){const y=f!==void 0?f:this.bearing,x=g=g!==void 0?g:this.pitch,R=s.a1.fromLngLat(r,c),F=-Math.cos(s.ae(x)),H=Math.sin(s.ae(x)),X=H*Math.sin(s.ae(y)),ae=-H*Math.cos(s.ae(y));let ee=this.elevation;const de=c-ee;let Ae;F*de>=0||Math.abs(F)<.1?(Ae=1e4,ee=c+Ae*F):Ae=-de/F;let Fe,De,je=s.aQ(1,R.y),Ue=0;do{if(Ue+=1,Ue>10)break;De=Ae/je,Fe=new s.a1(R.x+X*De,R.y+ae*De),je=1/Fe.meterInMercatorCoordinateUnits()}while(Math.abs(Ae-De*je)>1e-12);return{center:Fe.toLngLat(),elevation:ee,zoom:s.ak(this.height/2/Math.tan(this.fovInRadians/2)/De/this.tileSize)}}recalculateZoomAndCenter(r){if(this.elevation-r==0)return;const c=s.aj(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/c,g=s.a1.fromLngLat(this.center,this.elevation),y=yt(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=r;const x=this.calculateCenterFromCameraLngLatAlt(y.toLngLat(),s.aQ(y.z,g.y),this.bearing,this.pitch);this._elevation=x.elevation,this._center=x.center,this.setZoom(x.zoom)}getCameraPoint(){const r=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(r*Math.sin(this.rollInRadians),r*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const r=s.aj(1,this.center.lat)*this.worldSize;return yt(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/r).toLngLat()}getMercatorTileCoordinates(r){if(!r)return[0,0,1,1];const c=r.canonical.z>=0?1<<r.canonical.z:Math.pow(2,r.canonical.z);return[r.canonical.x/c,r.canonical.y/c,1/c/s.$,1/c/s.$]}}class jn{constructor(r,c){this.min=r,this.max=c,this.center=s.aR([],s.aS([],this.min,this.max),.5)}quadrant(r){const c=[r%2==0,r<2],f=s.aT(this.min),g=s.aT(this.max);for(let y=0;y<c.length;y++)f[y]=c[y]?this.min[y]:this.center[y],g[y]=c[y]?this.center[y]:this.max[y];return g[2]=this.max[2],new jn(f,g)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersectsFrustum(r){let c=!0;for(let f=0;f<r.planes.length;f++){const g=this.intersectsPlane(r.planes[f]);if(g===0)return 0;g===1&&(c=!1)}return c?2:r.aabb.min[0]>this.max[0]||r.aabb.min[1]>this.max[1]||r.aabb.min[2]>this.max[2]||r.aabb.max[0]<this.min[0]||r.aabb.max[1]<this.min[1]||r.aabb.max[2]<this.min[2]?0:1}intersectsPlane(r){let c=r[3],f=r[3];for(let g=0;g<3;g++)r[g]>0?(c+=r[g]*this.min[g],f+=r[g]*this.max[g]):(f+=r[g]*this.min[g],c+=r[g]*this.max[g]);return c>=0?2:f<0?0:1}}class hs{distanceToTile2d(r,c,f,g){const y=g.distanceX([r,c]),x=g.distanceY([r,c]);return Math.hypot(y,x)}getWrap(r,c,f){return f}getTileBoundingVolume(r,c,f,g){var y,x;let R=0,F=0;if(g!=null&&g.terrain){const X=new s.Z(r.z,c,r.z,r.x,r.y),ae=g.terrain.getMinMaxElevation(X);R=(y=ae.minElevation)!==null&&y!==void 0?y:Math.min(0,f),F=(x=ae.maxElevation)!==null&&x!==void 0?x:Math.max(0,f)}const H=1<<r.z;return new jn([c+r.x/H,r.y/H,R],[c+(r.x+1)/H,(r.y+1)/H,F])}allowVariableZoom(r,c){const f=r.fov*(Math.abs(Math.cos(r.rollInRadians))*r.height+Math.abs(Math.sin(r.rollInRadians))*r.width)/r.height,g=s.ah(78.5-f/2,0,60);return!!c.terrain||r.pitch>g}allowWorldCopies(){return!0}prepareNextFrame(){}}class Cn{constructor(r,c,f){this.points=r,this.planes=c,this.aabb=f}static fromInvProjectionMatrix(r,c=1,f=0,g,y){const x=y?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],R=Math.pow(2,f),F=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(ee=>function(de,Ae,Fe,De){const je=s.aw([],de,Ae),Ue=1/je[3]/Fe*De;return s.aY(je,je,[Ue,Ue,1/je[3],Ue])}(ee,r,c,R));g&&function(ee,de,Ae,Fe){const De=Fe?4:0,je=Fe?0:4;let Ue=0;const et=[],Xe=[];for(let Je=0;Je<4;Je++){const mt=s.aU([],ee[Je+je],ee[Je+De]),Et=s.aZ(mt);s.aR(mt,mt,1/Et),et.push(Et),Xe.push(mt)}for(let Je=0;Je<4;Je++){const mt=s.a_(ee[Je+De],Xe[Je],Ae);Ue=mt!==null&&mt>=0?Math.max(Ue,mt):Math.max(Ue,et[Je])}const it=function(Je,mt){const Et=s.aU([],Je[mt[0]],Je[mt[1]]),xt=s.aU([],Je[mt[2]],Je[mt[1]]),At=[0,0,0,0];return s.aV(At,s.aW([],Et,xt)),At[3]=-s.aX(At,Je[mt[0]]),At}(ee,de),dt=function(Je,mt){const Et=s.a$(Je),xt=s.b0([],Je,1/Et),At=s.aU([],mt,s.aR([],xt,s.aX(mt,xt))),kt=s.a$(At);if(kt>0){const er=Math.sqrt(1-xt[3]*xt[3]),Qt=s.aR([],xt,-xt[3]),Ht=s.aS([],Qt,s.aR([],At,er/kt));return s.b1(mt,Ht)}return null}(Ae,it);if(dt!==null){const Je=dt/s.aX(Xe[0],it);Ue=Math.min(Ue,Je)}for(let Je=0;Je<4;Je++){const mt=Math.min(Ue,et[Je]);ee[Je+je]=[ee[Je+De][0]+Xe[Je][0]*mt,ee[Je+De][1]+Xe[Je][1]*mt,ee[Je+De][2]+Xe[Je][2]*mt,1]}}(F,x[0],g,y);const H=x.map(ee=>{const de=s.aU([],F[ee[0]],F[ee[1]]),Ae=s.aU([],F[ee[2]],F[ee[1]]),Fe=s.aV([],s.aW([],de,Ae)),De=-s.aX(Fe,F[ee[1]]);return Fe.concat(De)}),X=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],ae=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const ee of F)for(let de=0;de<3;de++)X[de]=Math.min(X[de],ee[de]),ae[de]=Math.max(ae[de],ee[de]);return new Cn(F,H,new jn(X,ae))}}class ji{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(r){this._helper.setMinZoom(r)}setMaxZoom(r){this._helper.setMaxZoom(r)}setMinPitch(r){this._helper.setMinPitch(r)}setMaxPitch(r){this._helper.setMaxPitch(r)}setRenderWorldCopies(r){this._helper.setRenderWorldCopies(r)}setBearing(r){this._helper.setBearing(r)}setPitch(r){this._helper.setPitch(r)}setRoll(r){this._helper.setRoll(r)}setFov(r){this._helper.setFov(r)}setZoom(r){this._helper.setZoom(r)}setCenter(r){this._helper.setCenter(r)}setElevation(r){this._helper.setElevation(r)}setMinElevationForCurrentTile(r){this._helper.setMinElevationForCurrentTile(r)}setPadding(r){this._helper.setPadding(r)}interpolatePadding(r,c,f){return this._helper.interpolatePadding(r,c,f)}isPaddingEqual(r){return this._helper.isPaddingEqual(r)}resize(r,c,f=!0){this._helper.resize(r,c,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(r){this._helper.setMaxBounds(r)}overrideNearFarZ(r,c){this._helper.overrideNearFarZ(r,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(r){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),r)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(r,c){}constructor(r,c,f,g,y){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new cs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(x,R)=>this.getConstrained(x,R)},r,c,f,g,y),this._coveringTilesDetailsProvider=new hs}clone(){const r=new ji;return r.apply(this),r}apply(r,c,f){this._helper.apply(r,c,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(r){const c=[new s.b2(0,r)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new s.P(0,0)),g=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),y=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),x=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),R=Math.floor(Math.min(f.x,g.x,y.x,x.x)),F=Math.floor(Math.max(f.x,g.x,y.x,x.x)),H=1;for(let X=R-H;X<=F+H;X++)X!==0&&c.push(new s.b2(X,r))}return c}getCameraFrustum(){return Cn.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(r){const c=this.screenPointToLocation(this.centerPoint,r),f=r?r.getElevationForLngLatZoom(c,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(r,c){const f=s.aj(this.elevation,this.center.lat),g=this.screenPointToMercatorCoordinateAtZ(c,f),y=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),x=s.a1.fromLngLat(r),R=new s.a1(x.x-(g.x-y.x),x.y-(g.y-y.y));this.setCenter(R==null?void 0:R.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(r,c){return c?this.coordinatePoint(s.a1.fromLngLat(r),c.getElevationForLngLatZoom(r,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(s.a1.fromLngLat(r))}screenPointToLocation(r,c){var f;return(f=this.screenPointToMercatorCoordinate(r,c))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(r,c){if(c){const f=c.pointCoordinate(r);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(r)}screenPointToMercatorCoordinateAtZ(r,c){const f=c||0,g=[r.x,r.y,0,1],y=[r.x,r.y,1,1];s.aw(g,g,this._pixelMatrixInverse),s.aw(y,y,this._pixelMatrixInverse);const x=g[3],R=y[3],F=g[1]/x,H=y[1]/R,X=g[2]/x,ae=y[2]/R,ee=X===ae?0:(f-X)/(ae-X);return new s.a1(s.C.number(g[0]/x,y[0]/R,ee)/this.worldSize,s.C.number(F,H,ee)/this.worldSize,f)}coordinatePoint(r,c=0,f=this._pixelMatrix){const g=[r.x*this.worldSize,r.y*this.worldSize,c,1];return s.aw(g,g,f),new s.P(g[0]/g[3],g[1]/g[3])}getBounds(){const r=Math.max(0,this._helper._height/2-He(this));return new Ot().extend(this.screenPointToLocation(new s.P(0,r))).extend(this.screenPointToLocation(new s.P(this._helper._width,r))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(r,c){return c?c.pointCoordinate(r)!=null:r.y>this.height/2-He(this)}calculatePosMatrix(r,c=!1,f){var g;const y=(g=r.key)!==null&&g!==void 0?g:s.b3(r.wrap,r.canonical.z,r.canonical.z,r.canonical.x,r.canonical.y),x=c?this._alignedPosMatrixCache:this._posMatrixCache;if(x.has(y)){const H=x.get(y);return f?H.f32:H.f64}const R=nt(r,this.worldSize);s.O(R,c?this._alignedProjMatrix:this._viewProjMatrix,R);const F={f64:R,f32:new Float32Array(R)};return x.set(y,F),f?F.f32:F.f64}calculateFogMatrix(r){const c=r.key,f=this._fogMatrixCacheF32;if(f.has(c))return f.get(c);const g=nt(r,this.worldSize);return s.O(g,this._fogMatrix,g),f.set(c,new Float32Array(g)),f.get(c)}getConstrained(r,c){c=s.ah(+c,this.minZoom,this.maxZoom);const f={center:new s.S(r.lng,r.lat),zoom:c};let g=this._helper._lngRange;!this._helper._renderWorldCopies&&g===null&&(g=[-179.9999999999,179.9999999999]);const y=this.tileSize*s.af(f.zoom);let x=0,R=y,F=0,H=y,X=0,ae=0;const{x:ee,y:de}=this.size;if(this._helper._latRange){const et=this._helper._latRange;x=s.U(et[1])*y,R=s.U(et[0])*y,R-x<de&&(X=de/(R-x))}g&&(F=s.aO(s.V(g[0])*y,0,y),H=s.aO(s.V(g[1])*y,0,y),H<F&&(H+=y),H-F<ee&&(ae=ee/(H-F)));const{x:Ae,y:Fe}=Te(y,r);let De,je;const Ue=Math.max(ae||0,X||0);if(Ue){const et=new s.P(ae?(H+F)/2:Ae,X?(R+x)/2:Fe);return f.center=Ge(y,et).wrap(),f.zoom+=s.ak(Ue),f}if(this._helper._latRange){const et=de/2;Fe-et<x&&(je=x+et),Fe+et>R&&(je=R-et)}if(g){const et=(F+H)/2;let Xe=Ae;this._helper._renderWorldCopies&&(Xe=s.aO(Ae,et-y/2,et+y/2));const it=ee/2;Xe-it<F&&(De=F+it),Xe+it>H&&(De=H-it)}if(De!==void 0||je!==void 0){const et=new s.P(De??Ae,je??Fe);f.center=Ge(y,et).wrap()}return f}calculateCenterFromCameraLngLatAlt(r,c,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(r,c,f,g)}_calculateNearFarZIfNeeded(r,c,f){if(!this._helper.autoCalculateNearFarZ)return;const g=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),y=r-g*this._helper._pixelPerMeter/Math.cos(c),x=g<0?y:r,R=Math.PI/2+this.pitchInRadians,F=s.ae(this.fov)*(Math.abs(Math.cos(s.ae(this.roll)))*this.height+Math.abs(Math.sin(s.ae(this.roll)))*this.width)/this.height*(.5+f.y/this.height),H=Math.sin(F)*x/Math.sin(s.ah(Math.PI-R-F,.01,Math.PI-.01)),X=He(this),ae=Math.atan(X/this._helper.cameraToCenterDistance),ee=s.ae(.75),de=ae>ee?2*ae*(.5+f.y/(2*X)):ee,Ae=Math.sin(de)*x/Math.sin(s.ah(Math.PI-R-de,.01,Math.PI-.01)),Fe=Math.min(H,Ae);this._helper._farZ=1.01*(Math.cos(Math.PI/2-c)*Fe+x),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const r=this.centerOffset,c=Te(this.worldSize,this.center),f=c.x,g=c.y;this._helper._pixelPerMeter=s.aj(1,this.center.lat)*this.worldSize;const y=s.ae(Math.min(this.pitch,we)),x=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(y));let R;this._calculateNearFarZIfNeeded(x,y,r),R=new Float64Array(16),s.b4(R,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.aq(this._invProjMatrix,R),R[8]=2*-r.x/this._helper._width,R[9]=2*r.y/this._helper._height,this._projectionMatrix=s.b5(R),s.N(R,R,[1,-1,1]),s.M(R,R,[0,0,-this._helper.cameraToCenterDistance]),s.b6(R,R,-this.rollInRadians),s.b7(R,R,this.pitchInRadians),s.b6(R,R,-this.bearingInRadians),s.M(R,R,[-f,-g,0]),this._mercatorMatrix=s.N([],R,[this.worldSize,this.worldSize,this.worldSize]),s.N(R,R,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,R),s.M(R,R,[0,0,-this.elevation]),this._viewProjMatrix=R,this._invViewProjMatrix=s.aq([],R);const F=[0,0,-1,1];s.aw(F,F,this._invViewProjMatrix),this._cameraPosition=[F[0]/F[3],F[1]/F[3],F[2]/F[3]],this._fogMatrix=new Float64Array(16),s.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,x,this._helper._farZ),this._fogMatrix[8]=2*-r.x/this.width,this._fogMatrix[9]=2*r.y/this.height,s.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.M(this._fogMatrix,this._fogMatrix,[-f,-g,0]),s.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,R);const H=this._helper._width%2/2,X=this._helper._height%2/2,ae=Math.cos(this.bearingInRadians),ee=Math.sin(-this.bearingInRadians),de=f-Math.round(f)+ae*H+ee*X,Ae=g-Math.round(g)+ae*X+ee*H,Fe=new Float64Array(R);if(s.M(Fe,Fe,[de>.5?de-1:de,Ae>.5?Ae-1:Ae,0]),this._alignedProjMatrix=Fe,R=s.aq(new Float64Array(16),this._pixelMatrix),!R)throw new Error("failed to invert matrix");this._pixelMatrixInverse=R,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const r=this.screenPointToMercatorCoordinate(new s.P(0,0)),c=[r.x*this.worldSize,r.y*this.worldSize,0,1];return s.aw(c,c,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const r=s.aj(1,this.center.lat)*this.worldSize;return yt(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/r).toLngLat()}lngLatToCameraDepth(r,c){const f=s.a1.fromLngLat(r),g=[f.x*this.worldSize,f.y*this.worldSize,c,1];return s.aw(g,g,this._viewProjMatrix),g[2]/g[3]}getProjectionData(r){const{overscaledTileID:c,aligned:f,applyTerrainMatrix:g}=r,y=this._helper.getMercatorTileCoordinates(c),x=c?this.calculatePosMatrix(c,f,!0):null;let R;return R=c&&c.terrainRttPosMatrix32f&&g?c.terrainRttPosMatrix32f:x||s.b8(),{mainMatrix:R,tileMercatorCoords:y,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:R}}isLocationOccluded(r){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(r,c,f){return 1}transformLightDirection(r){return s.aT(r)}getRayDirectionFromPixel(r){throw new Error("Not implemented.")}projectTileCoordinates(r,c,f,g){const y=this.calculatePosMatrix(f);let x;g?(x=[r,c,g(r,c),1],s.aw(x,x,y)):(x=[r,c,0,1],gr(x,x,y));const R=x[3];return{point:new s.P(x[0]/R,x[1]/R),signedDistanceFromCamera:R,isOccluded:!1}}populateCache(r){for(const c of r)this.calculatePosMatrix(c)}getMatrixForModel(r,c){const f=s.a1.fromLngLat(r,c),g=f.meterInMercatorCoordinateUnits(),y=s.b9();return s.M(y,y,[f.x,f.y,f.z]),s.b6(y,y,Math.PI),s.b7(y,y,Math.PI/2),s.N(y,y,[-g,g,g]),y}getProjectionDataForCustomLayer(r=!0){const c=new s.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:c,applyGlobeMatrix:r}),g=nt(c,this.worldSize);s.O(g,this._viewProjMatrix,g),f.tileMercatorCoords=[0,0,1,1];const y=[s.$,s.$,this.worldSize/this._helper.pixelsPerMeter],x=s.ba();return s.N(x,g,y),f.fallbackMatrix=x,f.mainMatrix=x,f}getFastPathSimpleProjectionMatrix(r){return this.calculatePosMatrix(r)}}function n0(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function us(v){if(v.useSlerp)if(v.k<1){const r=s.bb(v.startEulerAngles.roll,v.startEulerAngles.pitch,v.startEulerAngles.bearing),c=s.bb(v.endEulerAngles.roll,v.endEulerAngles.pitch,v.endEulerAngles.bearing),f=new Float64Array(4);s.bc(f,r,c,v.k);const g=s.bd(f);v.tr.setRoll(g.roll),v.tr.setPitch(g.pitch),v.tr.setBearing(g.bearing)}else v.tr.setRoll(v.endEulerAngles.roll),v.tr.setPitch(v.endEulerAngles.pitch),v.tr.setBearing(v.endEulerAngles.bearing);else v.tr.setRoll(s.C.number(v.startEulerAngles.roll,v.endEulerAngles.roll,v.k)),v.tr.setPitch(s.C.number(v.startEulerAngles.pitch,v.endEulerAngles.pitch,v.k)),v.tr.setBearing(s.C.number(v.startEulerAngles.bearing,v.endEulerAngles.bearing,v.k))}function Is(v,r,c,f,g){const y=g.padding,x=Te(g.worldSize,c.getNorthWest()),R=Te(g.worldSize,c.getNorthEast()),F=Te(g.worldSize,c.getSouthEast()),H=Te(g.worldSize,c.getSouthWest()),X=s.ae(-f),ae=x.rotate(X),ee=R.rotate(X),de=F.rotate(X),Ae=H.rotate(X),Fe=new s.P(Math.max(ae.x,ee.x,Ae.x,de.x),Math.max(ae.y,ee.y,Ae.y,de.y)),De=new s.P(Math.min(ae.x,ee.x,Ae.x,de.x),Math.min(ae.y,ee.y,Ae.y,de.y)),je=Fe.sub(De),Ue=(g.width-(y.left+y.right+r.left+r.right))/je.x,et=(g.height-(y.top+y.bottom+r.top+r.bottom))/je.y;if(et<0||Ue<0)return void n0();const Xe=Math.min(s.ak(g.scale*Math.min(Ue,et)),v.maxZoom),it=s.P.convert(v.offset),dt=new s.P((r.left-r.right)/2,(r.top-r.bottom)/2).rotate(s.ae(f)),Je=it.add(dt).mult(g.scale/s.af(Xe));return{center:Ge(g.worldSize,x.add(F).div(2).sub(Je)),zoom:Xe,bearing:f}}class rs{get useGlobeControls(){return!1}handlePanInertia(r,c){const f=r.mag(),g=Math.abs(He(c));return{easingOffset:r.mult(Math.min(.75*g/f,1)),easingCenter:c.center}}handleMapControlsRollPitchBearingZoom(r,c){r.bearingDelta&&c.setBearing(c.bearing+r.bearingDelta),r.pitchDelta&&c.setPitch(c.pitch+r.pitchDelta),r.rollDelta&&c.setRoll(c.roll+r.rollDelta),r.zoomDelta&&c.setZoom(c.zoom+r.zoomDelta)}handleMapControlsPan(r,c,f){r.around.distSqr(c.centerPoint)<.01||c.setLocationAtPoint(f,r.around)}cameraForBoxAndBearing(r,c,f,g,y){return Is(r,c,f,g,y)}handleJumpToCenterZoom(r,c){r.zoom!==(c.zoom!==void 0?+c.zoom:r.zoom)&&r.setZoom(+c.zoom),c.center!==void 0&&r.setCenter(s.S.convert(c.center))}handleEaseTo(r,c){const f=r.zoom,g=r.padding,y={roll:r.roll,pitch:r.pitch,bearing:r.bearing},x={roll:c.roll===void 0?r.roll:c.roll,pitch:c.pitch===void 0?r.pitch:c.pitch,bearing:c.bearing===void 0?r.bearing:c.bearing},R=c.zoom!==void 0,F=!r.isPaddingEqual(c.padding);let H=!1;const X=R?+c.zoom:r.zoom;let ae=r.centerPoint.add(c.offsetAsPoint);const ee=r.screenPointToLocation(ae),{center:de,zoom:Ae}=r.getConstrained(s.S.convert(c.center||ee),X??f);mh(r,de);const Fe=Te(r.worldSize,ee),De=Te(r.worldSize,de).sub(Fe),je=s.af(Ae-f);return H=Ae!==f,{easeFunc:Ue=>{if(H&&r.setZoom(s.C.number(f,Ae,Ue)),s.be(y,x)||us({startEulerAngles:y,endEulerAngles:x,tr:r,k:Ue,useSlerp:y.roll!=x.roll}),F&&(r.interpolatePadding(g,c.padding,Ue),ae=r.centerPoint.add(c.offsetAsPoint)),c.around)r.setLocationAtPoint(c.around,c.aroundPoint);else{const et=s.af(r.zoom-f),Xe=Ae>f?Math.min(2,je):Math.max(.5,je),it=Math.pow(Xe,1-Ue),dt=Ge(r.worldSize,Fe.add(De.mult(Ue*it)).mult(et));r.setLocationAtPoint(r.renderWorldCopies?dt.wrap():dt,ae)}},isZooming:H,elevationCenter:de}}handleFlyTo(r,c){const f=c.zoom!==void 0,g=r.zoom,y=r.getConstrained(s.S.convert(c.center||c.locationAtOffset),f?+c.zoom:g),x=y.center,R=y.zoom;mh(r,x);const F=Te(r.worldSize,c.locationAtOffset),H=Te(r.worldSize,x).sub(F),X=H.mag(),ae=s.af(R-g);let ee;if(c.minZoom!==void 0){const de=Math.min(+c.minZoom,g,R),Ae=r.getConstrained(x,de).zoom;ee=s.af(Ae-g)}return{easeFunc:(de,Ae,Fe,De)=>{r.setZoom(de===1?R:g+s.ak(Ae));const je=de===1?x:Ge(r.worldSize,F.add(H.mult(Fe)).mult(Ae));r.setLocationAtPoint(r.renderWorldCopies?je.wrap():je,De)},scaleOfZoom:ae,targetCenter:x,scaleOfMinZoom:ee,pixelPathLength:X}}}class Ki{constructor(r,c,f){this.blendFunction=r,this.blendColor=c,this.mask=f}}Ki.Replace=[1,0],Ki.disabled=new Ki(Ki.Replace,s.bf.transparent,[!1,!1,!1,!1]),Ki.unblended=new Ki(Ki.Replace,s.bf.transparent,[!0,!0,!0,!0]),Ki.alphaBlended=new Ki([1,771],s.bf.transparent,[!0,!0,!0,!0]);const Do=2305;class jr{constructor(r,c,f){this.enable=r,this.mode=c,this.frontFace=f}}jr.disabled=new jr(!1,1029,Do),jr.backCCW=new jr(!0,1029,Do),jr.frontCCW=new jr(!0,1028,Do);class Yr{constructor(r,c,f){this.func=r,this.mask=c,this.range=f}}Yr.ReadOnly=!1,Yr.ReadWrite=!0,Yr.disabled=new Yr(519,Yr.ReadOnly,[0,1]);const Sa=7680;class yi{constructor(r,c,f,g,y,x){this.test=r,this.ref=c,this.mask=f,this.fail=g,this.depthFail=y,this.pass=x}}yi.disabled=new yi({func:519,mask:0},0,0,Sa,Sa,Sa);const As=new WeakMap;function pa(v){var r;if(As.has(v))return As.get(v);{const c=(r=v.getParameter(v.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return As.set(v,c),c}}class ma{get awaitingQuery(){return!!this._readbackQueue}constructor(r){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=r;const c=r.context,f=c.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const g=new s.aL;g.emplaceBack(-1,-1),g.emplaceBack(2,-1),g.emplaceBack(-1,2);const y=new s.aN;y.emplaceBack(0,1,2),this._fullscreenTriangle=new Lo(c.createVertexBuffer(g,$a.members),c.createIndexBuffer(y),s.aM.simpleSegment(0,0,g.length,y.length)),this._resultBuffer=new Uint8Array(4),c.activeTexture.set(f.TEXTURE1);const x=f.createTexture();f.bindTexture(f.TEXTURE_2D,x),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=c.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(x),pa(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const r=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),r.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(r,c){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(r,c),this._updateCount++,this._measuredError}_bindFramebuffer(){const r=this._cachedRenderContext.context,c=r.gl;r.activeTexture.set(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,this._fbo.colorAttachment.get()),r.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(r,c){const f=this._cachedRenderContext.context,g=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:s.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,g.TRIANGLES,Yr.disabled,yi.disabled,Ki.unblended,jr.disabled,((y,x)=>({u_input:y,u_output_expected:x}))(r,c),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&pa(g)){g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.readBuffer(g.COLOR_ATTACHMENT0),g.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),g.bindBuffer(g.PIXEL_PACK_BUFFER,null);const y=g.fenceSync(g.SYNC_GPU_COMMANDS_COMPLETE,0);g.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:y}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const r=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&pa(r)){const c=r.clientWaitSync(this._readbackQueue.sync,0,0);if(c===r.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(c===r.TIMEOUT_EXPIRED)return;r.bindBuffer(r.PIXEL_PACK_BUFFER,this._pbo),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),r.bindBuffer(r.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),r.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=ma._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(r){let c=0;return c+=r[0]/256,c+=r[1]/65536,c+=r[2]/16777216,r[3]<127&&(c=-c),c/128}}const _h=s.$/128;function cd(v,r){const c=v.granularity!==void 0?Math.max(v.granularity,1):1,f=c+(v.generateBorders?2:0),g=c+(v.extendToNorthPole||v.generateBorders?1:0)+(v.extendToSouthPole||v.generateBorders?1:0),y=f+1,x=g+1,R=v.generateBorders?-1:0,F=v.generateBorders||v.extendToNorthPole?-1:0,H=c+(v.generateBorders?1:0),X=c+(v.generateBorders||v.extendToSouthPole?1:0),ae=y*x,ee=f*g*6,de=y*x>65536;if(de&&r==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Ae=de||r==="32bit",Fe=new Int16Array(2*ae);let De=0;for(let et=F;et<=X;et++)for(let Xe=R;Xe<=H;Xe++){let it=Xe/c*s.$;Xe===-1&&(it=-_h),Xe===c+1&&(it=s.$+_h);let dt=et/c*s.$;et===-1&&(dt=v.extendToNorthPole?s.bh:-_h),et===c+1&&(dt=v.extendToSouthPole?s.bi:s.$+_h),Fe[De++]=it,Fe[De++]=dt}const je=Ae?new Uint32Array(ee):new Uint16Array(ee);let Ue=0;for(let et=0;et<g;et++)for(let Xe=0;Xe<f;Xe++){const it=Xe+1+et*y,dt=Xe+(et+1)*y,Je=Xe+1+(et+1)*y;je[Ue++]=Xe+et*y,je[Ue++]=dt,je[Ue++]=it,je[Ue++]=it,je[Ue++]=dt,je[Ue++]=Je}return{vertices:Fe.buffer.slice(0),indices:je.buffer.slice(0),uses32bitIndices:Ae}}const xl=new s.aK({fill:new s.bj(128,2),line:new s.bj(512,0),tile:new s.bj(128,32),stencil:new s.bj(128,1),circle:3});class lc{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ms.projectionGlobe}get vertexShaderPreludeCode(){return Ms.projectionMercator.vertexSource}get subdivisionGranularity(){return xl}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(r){this._errorMeasurement||(this._errorMeasurement=new ma(r));const c=s.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-c*Math.PI*2))-.5*Math.PI,g=this._errorMeasurement.updateErrorLoop(c,f),y=D.now();g!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=g,this._errorMeasurementLastChangeTime=y);const x=Math.min(Math.max((y-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bl(x))}_getMeshKey(r){return`${r.granularity.toString(36)}_${r.generateBorders?"b":""}${r.extendToNorthPole?"n":""}${r.extendToSouthPole?"s":""}`}getMeshFromTileID(r,c,f,g,y){const x=(y==="stencil"?xl.stencil:xl.tile).getGranularityForZoomLevel(c.z);return this._getMesh(r,{granularity:x,generateBorders:f,extendToNorthPole:c.y===0&&g,extendToSouthPole:c.y===(1<<c.z)-1&&g})}_getMesh(r,c){const f=this._getMeshKey(c);if(f in this._tileMeshCache)return this._tileMeshCache[f];const g=function(y,x){const R=cd(x,"16bit"),F=s.aL.deserialize({arrayBuffer:R.vertices,length:R.vertices.byteLength/2/2}),H=s.aN.deserialize({arrayBuffer:R.indices,length:R.indices.byteLength/2/3});return new Lo(y.createVertexBuffer(F,$a.members),y.createIndexBuffer(H),s.aM.simpleSegment(0,0,F.length,H.length))}(r,c);return this._tileMeshCache[f]=g,g}recalculate(r){}hasTransition(){const r=D.now();let c=!1;return c=c||(r-this._errorMeasurementLastChangeTime)/1e3<.7,c=c||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,c}setErrorQueryLatitudeDegrees(r){this._errorQueryLatitudeDegrees=r}}const vh=new s.r({type:new s.D(s.v.projection.type)});class yh extends s.E{constructor(r){super(),this._transitionable=new s.t(vh,void 0),this.setProjection(r),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0)),this._mercatorProjection=new si,this._verticalPerspectiveProjection=new lc}get transitionState(){const r=this.properties.get("type");if(typeof r=="string"&&r==="mercator")return 0;if(typeof r=="string"&&r==="vertical-perspective")return 1;if(r instanceof s.bm){if(r.from==="vertical-perspective"&&r.to==="mercator")return 1-r.transition;if(r.from==="mercator"&&r.to==="vertical-perspective")return r.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(r){this._mercatorProjection.updateGPUdependent(r),this._verticalPerspectiveProjection.updateGPUdependent(r)}getMeshFromTileID(r,c,f,g,y){return this.currentProjection.getMeshFromTileID(r,c,f,g,y)}setProjection(r){this._transitionable.setValue("type",(r==null?void 0:r.type)||"mercator")}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}setErrorQueryLatitudeDegrees(r){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(r),this._mercatorProjection.setErrorQueryLatitudeDegrees(r)}}function bh(v){const r=Ml(v.worldSize,v.center.lat);return 2*Math.PI*r}function $s(v,r,c,f,g){const y=1/(1<<g),x=r/s.$*y+f*y,R=s.bo((v/s.$*y+c*y)*Math.PI*2+Math.PI,2*Math.PI),F=2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI,H=Math.cos(F),X=new Float64Array(3);return X[0]=Math.sin(R)*H,X[1]=Math.sin(F),X[2]=Math.cos(R)*H,X}function Zn(v){return function(r,c){const f=Math.cos(c),g=new Float64Array(3);return g[0]=Math.sin(r)*f,g[1]=Math.sin(c),g[2]=Math.cos(r)*f,g}(v.lng*Math.PI/180,v.lat*Math.PI/180)}function Ml(v,r){return v/(2*Math.PI)/Math.cos(r*Math.PI/180)}function cc(v){const r=Math.asin(v[1])/Math.PI*180,c=Math.sqrt(v[0]*v[0]+v[2]*v[2]);if(c>1e-6){const f=v[0]/c,g=Math.acos(v[2]/c),y=(f>0?g:-g)/Math.PI*180;return new s.S(s.aO(y,-180,180),r)}return new s.S(0,r)}function Bo(v){return Math.cos(v*Math.PI/180)}function yn(v,r){const c=Bo(v),f=Bo(r);return s.ak(f/c)}function s0(v,r){const c=v.rotate(r.bearingInRadians),f=r.zoom+yn(r.center.lat,0),g=s.bk(1/Bo(r.center.lat),1/Bo(Math.min(Math.abs(r.center.lat),60)),s.bn(f,7,3,0,1)),y=360/bh({worldSize:r.worldSize,center:{lat:r.center.lat}});return new s.S(r.center.lng-c.x*y*g,s.ah(r.center.lat+c.y*y,-s.ai,s.ai))}function hc(v){const r=.5*v,c=Math.sin(r),f=Math.cos(r);return Math.log(c+f)-Math.log(f-c)}function hd(v,r,c,f){const g=v.lat+c*f;if(Math.abs(c)>1){const y=(Math.sign(v.lat+c)!==Math.sign(v.lat)?-Math.abs(v.lat):Math.abs(v.lat))*Math.PI/180,x=Math.abs(v.lat+c)*Math.PI/180,R=hc(y+f*(x-y)),F=hc(y),H=hc(x);return new s.S(v.lng+r*((R-F)/(H-F)),g)}return new s.S(v.lng+r*f,g)}class h1{constructor(r){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=r}swapBuffers(){if(!this._hadAnyChanges)return;const r=this._cachePrevious;this._cachePrevious=this._cache,this._cache=r,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(r,c,f,g){const y=`${r.z}_${r.x}_${r.y}_${g!=null&&g.terrain?"t":""}`,x=this._cache.get(y);if(x)return x;const R=this._cachePrevious.get(y);if(R)return this._cache.set(y,R),R;const F=this._boundingVolumeFactory(r,c,f,g);return this._cache.set(y,F),this._hadAnyChanges=!0,F}}class Il{constructor(r,c,f,g){this.min=f,this.max=g,this.points=r,this.planes=c}static fromAabb(r,c){const f=[];for(let g=0;g<8;g++)f.push([1&~g?r[0]:c[0],(g>>1&1)==1?c[1]:r[1],(g>>2&1)==1?c[2]:r[2]]);return new Il(f,[[-1,0,0,c[0]],[1,0,0,-r[0]],[0,-1,0,c[1]],[0,1,0,-r[1]],[0,0,-1,c[2]],[0,0,1,-r[2]]],r,c)}static fromCenterSizeAngles(r,c,f){const g=s.br([],f[0],f[1],f[2]),y=s.bs([],[c[0],0,0],g),x=s.bs([],[0,c[1],0],g),R=s.bs([],[0,0,c[2]],g),F=[...r],H=[...r];for(let ae=0;ae<8;ae++)for(let ee=0;ee<3;ee++){const de=r[ee]+y[ee]*(1&~ae?-1:1)+x[ee]*((ae>>1&1)==1?1:-1)+R[ee]*((ae>>2&1)==1?1:-1);F[ee]=Math.min(F[ee],de),H[ee]=Math.max(H[ee],de)}const X=[];for(let ae=0;ae<8;ae++){const ee=[...r];s.aS(ee,ee,s.aR([],y,1&~ae?-1:1)),s.aS(ee,ee,s.aR([],x,(ae>>1&1)==1?1:-1)),s.aS(ee,ee,s.aR([],R,(ae>>2&1)==1?1:-1)),X.push(ee)}return new Il(X,[[...y,-s.aX(y,X[0])],[...x,-s.aX(x,X[0])],[...R,-s.aX(R,X[0])],[-y[0],-y[1],-y[2],-s.aX(y,X[7])],[-x[0],-x[1],-x[2],-s.aX(x,X[7])],[-R[0],-R[1],-R[2],-s.aX(R,X[7])]],F,H)}intersectsFrustum(r){let c=!0;const f=this.points.length,g=this.planes.length,y=r.planes.length,x=r.points.length;for(let R=0;R<y;R++){const F=r.planes[R];let H=0;for(let X=0;X<f;X++){const ae=this.points[X];F[0]*ae[0]+F[1]*ae[1]+F[2]*ae[2]+F[3]>=0&&H++}if(H===0)return 0;H<f&&(c=!1)}if(c)return 2;for(let R=0;R<g;R++){const F=this.planes[R];let H=0;for(let X=0;X<x;X++){const ae=r.points[X];F[0]*ae[0]+F[1]*ae[1]+F[2]*ae[2]+F[3]>=0&&H++}if(H===0)return 0}return 1}intersectsPlane(r){const c=this.points.length;let f=0;for(let g=0;g<c;g++){const y=this.points[g];r[0]*y[0]+r[1]*y[1]+r[2]*y[2]+r[3]>=0&&f++}return f===c?2:f===0?0:1}}function $n(v,r,c){const f=v-r;return f<0?-f:Math.max(0,f-c)}function uc(v,r,c,f,g){const y=v-c;let x;return x=y<0?Math.min(-y,1+y-g):y>1?Math.min(Math.max(y-g,0),1-y):0,Math.max(x,$n(r,f,g))}class ga{constructor(){this._boundingVolumeCache=new h1(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(r,c,f,g){const y=1<<f.z,x=1/y,R=f.x/y,F=f.y/y;let H=2;return H=Math.min(H,uc(r,c,R,F,x)),H=Math.min(H,uc(r,c,R+.5,-F-x,x)),H=Math.min(H,uc(r,c,R+.5,2-F-x,x)),H}getWrap(r,c,f){const g=1<<c.z,y=1/g,x=c.x/g,R=$n(r.x,x,y),F=$n(r.x,x-1,y),H=$n(r.x,x+1,y),X=Math.min(R,F,H);return X===H?1:X===F?-1:0}allowVariableZoom(r,c){return sr(r,c)>4}allowWorldCopies(){return!1}getTileBoundingVolume(r,c,f,g){return this._boundingVolumeCache.getTileBoundingVolume(r,c,f,g)}_computeTileBoundingVolume(r,c,f,g){var y,x;let R=0,F=0;if(g!=null&&g.terrain){const H=new s.Z(r.z,c,r.z,r.x,r.y),X=g.terrain.getMinMaxElevation(H);R=(y=X.minElevation)!==null&&y!==void 0?y:Math.min(0,f),F=(x=X.maxElevation)!==null&&x!==void 0?x:Math.max(0,f)}if(R/=s.bu,F/=s.bu,R+=1,F+=1,r.z<=0)return Il.fromAabb([-F,-F,-F],[F,F,F]);if(r.z===1)return Il.fromAabb([r.x===0?-F:0,r.y===0?0:-F,-F],[r.x===0?0:F,r.y===0?F:0,F]);{const H=[$s(0,0,r.x,r.y,r.z),$s(s.$,0,r.x,r.y,r.z),$s(s.$,s.$,r.x,r.y,r.z),$s(0,s.$,r.x,r.y,r.z)],X=[];for(const At of H)X.push(s.aR([],At,F));if(F!==R)for(const At of H)X.push(s.aR([],At,R));r.y===0&&X.push([0,1,0]),r.y===(1<<r.z)-1&&X.push([0,-1,0]);const ae=[1,1,1],ee=[-1,-1,-1];for(const At of X)for(let kt=0;kt<3;kt++)ae[kt]=Math.min(ae[kt],At[kt]),ee[kt]=Math.max(ee[kt],At[kt]);const de=$s(s.$/2,s.$/2,r.x,r.y,r.z),Ae=s.aW([],[0,1,0],de);s.aV(Ae,Ae);const Fe=s.aW([],de,Ae);s.aV(Fe,Fe);const De=s.aW([],H[2],H[1]);s.aV(De,De);const je=s.aW([],H[0],H[3]);s.aV(je,je),X.push(s.aR([],de,F)),r.y>=(1<<r.z)/2&&X.push(s.aR([],$s(s.$/2,0,r.x,r.y,r.z),F)),r.y<(1<<r.z)/2&&X.push(s.aR([],$s(s.$/2,s.$,r.x,r.y,r.z),F));const Ue=dc(de,X),et=dc(Fe,X),Xe=[-de[0],-de[1],-de[2],Ue.max],it=[de[0],de[1],de[2],-Ue.min],dt=[-Fe[0],-Fe[1],-Fe[2],et.max],Je=[Fe[0],Fe[1],Fe[2],-et.min],mt=[...De,0],Et=[...je,0],xt=[];return r.y===0?xt.push(s.bt(Et,mt,Xe),s.bt(Et,mt,it)):xt.push(s.bt(dt,mt,Xe),s.bt(dt,mt,it),s.bt(dt,Et,Xe),s.bt(dt,Et,it)),r.y===(1<<r.z)-1?xt.push(s.bt(Et,mt,Xe),s.bt(Et,mt,it)):xt.push(s.bt(Je,mt,Xe),s.bt(Je,mt,it),s.bt(Je,Et,Xe),s.bt(Je,Et,it)),new Il(xt,[Xe,it,dt,Je,mt,Et],ae,ee)}}}function dc(v,r){let c=1/0,f=-1/0;for(const g of r){const y=s.aX(v,g);c=Math.min(c,y),f=Math.max(f,y)}return{min:c,max:f}}class fc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(r){this._helper.setMinZoom(r)}setMaxZoom(r){this._helper.setMaxZoom(r)}setMinPitch(r){this._helper.setMinPitch(r)}setMaxPitch(r){this._helper.setMaxPitch(r)}setRenderWorldCopies(r){this._helper.setRenderWorldCopies(r)}setBearing(r){this._helper.setBearing(r)}setPitch(r){this._helper.setPitch(r)}setRoll(r){this._helper.setRoll(r)}setFov(r){this._helper.setFov(r)}setZoom(r){this._helper.setZoom(r)}setCenter(r){this._helper.setCenter(r)}setElevation(r){this._helper.setElevation(r)}setMinElevationForCurrentTile(r){this._helper.setMinElevationForCurrentTile(r)}setPadding(r){this._helper.setPadding(r)}interpolatePadding(r,c,f){return this._helper.interpolatePadding(r,c,f)}isPaddingEqual(r){return this._helper.isPaddingEqual(r)}resize(r,c){this._helper.resize(r,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(r){this._helper.setMaxBounds(r)}overrideNearFarZ(r,c){this._helper.overrideNearFarZ(r,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(r){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),r)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(r){}constructor(){this._cachedClippingPlane=s.bv(),this._projectionMatrix=s.b9(),this._globeViewProjMatrix32f=s.b8(),this._globeViewProjMatrixNoCorrection=s.b9(),this._globeViewProjMatrixNoCorrectionInverted=s.b9(),this._globeProjMatrixInverted=s.b9(),this._cameraPosition=s.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new cs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(r,c)=>this.getConstrained(r,c)}),this._coveringTilesDetailsProvider=new ga}clone(){const r=new fc;return r.apply(this),r}apply(r,c){this._globeLatitudeErrorCorrectionRadians=c||0,this._helper.apply(r)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const r=s.bp();return r[0]=this._cameraPosition[0],r[1]=this._cameraPosition[1],r[2]=this._cameraPosition[2],r}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(r){const{overscaledTileID:c,applyGlobeMatrix:f}=r,g=this._helper.getMercatorTileCoordinates(c);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:g,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(r){const c=this.pitchInRadians,f=this.cameraToCenterDistance/r,g=Math.sin(c)*f,y=Math.cos(c)*f+1,x=1/Math.sqrt(g*g+y*y)*1;let R=-g,F=y;const H=Math.sqrt(R*R+F*F);R/=H,F/=H;const X=[0,R,F];s.bw(X,X,[0,0,0],-this.bearingInRadians),s.bx(X,X,[0,0,0],-1*this.center.lat*Math.PI/180),s.by(X,X,[0,0,0],this.center.lng*Math.PI/180);const ae=1/s.aZ(X);return s.aR(X,X,ae),[...X,-x*ae]}isLocationOccluded(r){return!this.isSurfacePointVisible(Zn(r))}transformLightDirection(r){const c=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,g=Math.cos(f),y=[Math.sin(c)*g,Math.sin(f),Math.cos(c)*g],x=[y[2],0,-y[0]],R=[0,0,0];s.aW(R,x,y),s.aV(x,x),s.aV(R,R);const F=[0,0,0];return s.aV(F,[x[0]*r[0]+R[0]*r[1]+y[0]*r[2],x[1]*r[0]+R[1]*r[1]+y[1]*r[2],x[2]*r[0]+R[2]*r[1]+y[2]*r[2]]),F}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(r,c,f){const g=function(R,F,H){const X=1/(1<<H.z);return new s.a1(R/s.$*X+H.x*X,F/s.$*X+H.y*X)}(r,c,f.canonical),y=(x=g.y,[s.bo(g.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-x*Math.PI*2))-.5*Math.PI]);var x;return this.getCircleRadiusCorrection()/Math.cos(y[1])}projectTileCoordinates(r,c,f,g){const y=f.canonical,x=$s(r,c,y.x,y.y,y.z),R=1+(g?g(r,c):0)/s.bu,F=[x[0]*R,x[1]*R,x[2]*R,1];s.aw(F,F,this._globeViewProjMatrixNoCorrection);const H=this._cachedClippingPlane,X=H[0]*x[0]+H[1]*x[1]+H[2]*x[2]+H[3]<0;return{point:new s.P(F[0]/F[3],F[1]/F[3]),signedDistanceFromCamera:F[3],isOccluded:X}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const r=Ml(this.worldSize,this.center.lat),c=s.ba(),f=s.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*r),s.b4(c,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const g=this.centerOffset;c[8]=2*-g.x/this._helper._width,c[9]=2*g.y/this._helper._height,this._projectionMatrix=s.b5(c),this._globeProjMatrixInverted=s.ba(),s.aq(this._globeProjMatrixInverted,c),s.M(c,c,[0,0,-this.cameraToCenterDistance]),s.b6(c,c,this.rollInRadians),s.b7(c,c,-this.pitchInRadians),s.b6(c,c,this.bearingInRadians),s.M(c,c,[0,0,-r]);const y=s.bp();y[0]=r,y[1]=r,y[2]=r,s.b7(f,c,this.center.lat*Math.PI/180),s.bz(f,f,-this.center.lng*Math.PI/180),s.N(f,f,y),this._globeViewProjMatrixNoCorrection=f,s.b7(c,c,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.bz(c,c,-this.center.lng*Math.PI/180),s.N(c,c,y),this._globeViewProjMatrix32f=new Float32Array(c),this._globeViewProjMatrixNoCorrectionInverted=s.ba(),s.aq(this._globeViewProjMatrixNoCorrectionInverted,f);const x=s.bp();this._cameraPosition=s.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/r,s.bw(this._cameraPosition,this._cameraPosition,x,-this.rollInRadians),s.bx(this._cameraPosition,this._cameraPosition,x,this.pitchInRadians),s.bw(this._cameraPosition,this._cameraPosition,x,-this.bearingInRadians),s.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bx(this._cameraPosition,this._cameraPosition,x,-this.center.lat*Math.PI/180),s.by(this._cameraPosition,this._cameraPosition,x,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(r);const R=s.b5(this._globeViewProjMatrixNoCorrectionInverted);s.N(R,R,[1,1,-1]),this._cachedFrustum=Cn.fromInvProjectionMatrix(R,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(r){s.w("calculateFogMatrix is not supported on globe projection.");const c=s.ba();return s.ag(c),c}getVisibleUnwrappedCoordinates(r){return[new s.b2(0,r)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(r){r&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(r,c){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=Zn(r);s.aR(f,f,1+c/s.bu);const g=s.bv();return s.aw(g,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),g[2]/g[3]}populateCache(r){}getBounds(){const r=.5*this.width,c=.5*this.height,f=[new s.P(0,0),new s.P(r,0),new s.P(this.width,0),new s.P(this.width,c),new s.P(this.width,this.height),new s.P(r,this.height),new s.P(0,this.height),new s.P(0,c)],g=[];for(const ae of f)g.push(this.unprojectScreenPoint(ae));let y=0,x=0,R=0,F=0;const H=this.center;for(const ae of g){const ee=s.bA(H.lng,ae.lng),de=s.bA(H.lat,ae.lat);ee<x&&(x=ee),ee>y&&(y=ee),de<F&&(F=de),de>R&&(R=de)}const X=[H.lng+x,H.lat+F,H.lng+y,H.lat+R];return this.isSurfacePointOnScreen([0,1,0])&&(X[3]=90,X[0]=-180,X[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(X[1]=-90,X[0]=-180,X[2]=180),new Ot(X)}getConstrained(r,c){const f=s.ah(r.lat,-s.ai,s.ai),g=s.ah(+c,this.minZoom+yn(0,f),this.maxZoom);return{center:new s.S(r.lng,f),zoom:g}}calculateCenterFromCameraLngLatAlt(r,c,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(r,c,f,g)}setLocationAtPoint(r,c){const f=Zn(this.unprojectScreenPoint(c)),g=Zn(r),y=s.bp();s.bB(y);const x=s.bp();s.by(x,f,y,-this.center.lng*Math.PI/180),s.bx(x,x,y,this.center.lat*Math.PI/180);const R=g[0]*g[0]+g[2]*g[2],F=x[0]*x[0];if(R<F)return;const H=Math.sqrt(R-F),X=-H,ae=s.bC(g[0],g[2],x[0],H),ee=s.bC(g[0],g[2],x[0],X),de=s.bp();s.by(de,g,y,-ae);const Ae=s.bC(de[1],de[2],x[1],x[2]),Fe=s.bp();s.by(Fe,g,y,-ee);const De=s.bC(Fe[1],Fe[2],x[1],x[2]),je=.5*Math.PI,Ue=Ae>=-je&&Ae<=je,et=De>=-je&&De<=je;let Xe,it;if(Ue&&et){const Et=this.center.lng*Math.PI/180,xt=this.center.lat*Math.PI/180;s.bD(ae,Et)+s.bD(Ae,xt)<s.bD(ee,Et)+s.bD(De,xt)?(Xe=ae,it=Ae):(Xe=ee,it=De)}else if(Ue)Xe=ae,it=Ae;else{if(!et)return;Xe=ee,it=De}const dt=Xe/Math.PI*180,Je=it/Math.PI*180,mt=this.center.lat;this.setCenter(new s.S(dt,s.ah(Je,-90,90))),this.setZoom(this.zoom+yn(mt,this.center.lat))}locationToScreenPoint(r,c){const f=Zn(r);if(c){const g=c.getElevationForLngLatZoom(r,this._helper._tileZoom);s.aR(f,f,1+g/s.bu)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(r){const c=s.bv();return s.aw(c,[...r,1],this._globeViewProjMatrixNoCorrection),c[0]/=c[3],c[1]/=c[3],new s.P((.5*c[0]+.5)*this.width,(.5*-c[1]+.5)*this.height)}screenPointToMercatorCoordinate(r,c){if(c){const f=c.pointCoordinate(r);if(f)return f}return s.a1.fromLngLat(this.unprojectScreenPoint(r))}screenPointToLocation(r,c){var f;return(f=this.screenPointToMercatorCoordinate(r,c))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(r,c){const f=this._cameraPosition,g=this.getRayDirectionFromPixel(r);return!!this.rayPlanetIntersection(f,g)}getRayDirectionFromPixel(r){const c=s.bv();c[0]=r.x/this.width*2-1,c[1]=-1*(r.y/this.height*2-1),c[2]=1,c[3]=1,s.aw(c,c,this._globeViewProjMatrixNoCorrectionInverted),c[0]/=c[3],c[1]/=c[3],c[2]/=c[3];const f=s.bp();f[0]=c[0]-this._cameraPosition[0],f[1]=c[1]-this._cameraPosition[1],f[2]=c[2]-this._cameraPosition[2];const g=s.bp();return s.aV(g,f),g}isSurfacePointVisible(r){const c=this._cachedClippingPlane;return c[0]*r[0]+c[1]*r[1]+c[2]*r[2]+c[3]>=0}isSurfacePointOnScreen(r){if(!this.isSurfacePointVisible(r))return!1;const c=s.bv();return s.aw(c,[...r,1],this._globeViewProjMatrixNoCorrection),c[0]/=c[3],c[1]/=c[3],c[2]/=c[3],c[0]>-1&&c[0]<1&&c[1]>-1&&c[1]<1&&c[2]>-1&&c[2]<1}rayPlanetIntersection(r,c){const f=s.aX(r,c),g=s.bp(),y=s.bp();s.aR(y,c,f),s.aU(g,r,y);const x=1-s.aX(g,g);if(x<0)return null;const R=s.aX(r,r)-1,F=-f+(f<0?1:-1)*Math.sqrt(x),H=R/F,X=F;return{tMin:Math.min(H,X),tMax:Math.max(H,X)}}unprojectScreenPoint(r){const c=this._cameraPosition,f=this.getRayDirectionFromPixel(r),g=this.rayPlanetIntersection(c,f);if(g){const X=s.bp();s.aS(X,c,[f[0]*g.tMin,f[1]*g.tMin,f[2]*g.tMin]);const ae=s.bp();return s.aV(ae,X),cc(ae)}const y=this._cachedClippingPlane,x=y[0]*f[0]+y[1]*f[1]+y[2]*f[2],R=-s.b1(y,c)/x,F=s.bp();if(R>0)s.aS(F,c,[f[0]*R,f[1]*R,f[2]*R]);else{const X=s.bp();s.aS(X,c,[2*f[0],2*f[1],2*f[2]]);const ae=s.b1(this._cachedClippingPlane,X);s.aU(F,X,[this._cachedClippingPlane[0]*ae,this._cachedClippingPlane[1]*ae,this._cachedClippingPlane[2]*ae])}const H=function(X){const ae=s.bp();return ae[0]=X[0]*-X[3],ae[1]=X[1]*-X[3],ae[2]=X[2]*-X[3],{center:ae,radius:Math.sqrt(1-X[3]*X[3])}}(y);return cc(function(X,ae,ee){const de=s.bp();s.aU(de,ee,X);const Ae=s.bp();return s.bq(Ae,X,de,ae/s.a$(de)),Ae}(H.center,H.radius,F))}getMatrixForModel(r,c){const f=s.S.convert(r),g=1/s.bu,y=s.b9();return s.bz(y,y,f.lng/180*Math.PI),s.b7(y,y,-f.lat/180*Math.PI),s.M(y,y,[0,0,1+c/s.bu]),s.b7(y,y,.5*Math.PI),s.N(y,y,[g,g,g]),y}getProjectionDataForCustomLayer(r=!0){const c=this.getProjectionData({overscaledTileID:new s.Z(0,0,0,0,0),applyGlobeMatrix:r});return c.tileMercatorCoords=[0,0,1,1],c}getFastPathSimpleProjectionMatrix(r){}}class pc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(r){this._helper.setMinZoom(r)}setMaxZoom(r){this._helper.setMaxZoom(r)}setMinPitch(r){this._helper.setMinPitch(r)}setMaxPitch(r){this._helper.setMaxPitch(r)}setRenderWorldCopies(r){this._helper.setRenderWorldCopies(r)}setBearing(r){this._helper.setBearing(r)}setPitch(r){this._helper.setPitch(r)}setRoll(r){this._helper.setRoll(r)}setFov(r){this._helper.setFov(r)}setZoom(r){this._helper.setZoom(r)}setCenter(r){this._helper.setCenter(r)}setElevation(r){this._helper.setElevation(r)}setMinElevationForCurrentTile(r){this._helper.setMinElevationForCurrentTile(r)}setPadding(r){this._helper.setPadding(r)}interpolatePadding(r,c,f){return this._helper.interpolatePadding(r,c,f)}isPaddingEqual(r){return this._helper.isPaddingEqual(r)}resize(r,c,f=!0){this._helper.resize(r,c,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(r){this._helper.setMaxBounds(r)}overrideNearFarZ(r,c){this._helper.overrideNearFarZ(r,c)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(r){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),r)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(r,c){this._globeness=r,this._globeLatitudeErrorCorrectionRadians=c,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new cs({calcMatrices:()=>{this._calcMatrices()},getConstrained:(r,c)=>this.getConstrained(r,c)}),this._globeness=1,this._mercatorTransform=new ji,this._verticalPerspectiveTransform=new fc}clone(){const r=new pc;return r._globeness=this._globeness,r._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,r.apply(this),r}apply(r){this._helper.apply(r),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(r){const c=this._mercatorTransform.getProjectionData(r),f=this._verticalPerspectiveTransform.getProjectionData(r);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:c.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:r.applyGlobeMatrix?this._globeness:0,fallbackMatrix:c.fallbackMatrix}}isLocationOccluded(r){return this.currentTransform.isLocationOccluded(r)}transformLightDirection(r){return this.currentTransform.transformLightDirection(r)}getPixelScale(){return s.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(r,c,f){const g=this._mercatorTransform.getPitchedTextCorrection(r,c,f),y=this._verticalPerspectiveTransform.getPitchedTextCorrection(r,c,f);return s.bk(g,y,this._globeness)}projectTileCoordinates(r,c,f,g){return this.currentTransform.projectTileCoordinates(r,c,f,g)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(r){return this.currentTransform.calculateFogMatrix(r)}getVisibleUnwrappedCoordinates(r){return this.currentTransform.getVisibleUnwrappedCoordinates(r)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(r){this._mercatorTransform.recalculateZoomAndCenter(r),this._verticalPerspectiveTransform.recalculateZoomAndCenter(r)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(r,c){return this.currentTransform.lngLatToCameraDepth(r,c)}populateCache(r){this._mercatorTransform.populateCache(r),this._verticalPerspectiveTransform.populateCache(r)}getBounds(){return this.currentTransform.getBounds()}getConstrained(r,c){return this.currentTransform.getConstrained(r,c)}calculateCenterFromCameraLngLatAlt(r,c,f,g){return this._helper.calculateCenterFromCameraLngLatAlt(r,c,f,g)}setLocationAtPoint(r,c){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(r,c),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(r,c),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(r,c){return this.currentTransform.locationToScreenPoint(r,c)}screenPointToMercatorCoordinate(r,c){return this.currentTransform.screenPointToMercatorCoordinate(r,c)}screenPointToLocation(r,c){return this.currentTransform.screenPointToLocation(r,c)}isPointOnMapSurface(r,c){return this.currentTransform.isPointOnMapSurface(r,c)}getRayDirectionFromPixel(r){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(r)}getMatrixForModel(r,c){return this.currentTransform.getMatrixForModel(r,c)}getProjectionDataForCustomLayer(r=!0){const c=this._mercatorTransform.getProjectionDataForCustomLayer(r);if(!this.isGlobeRendering)return c;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(r);return f.fallbackMatrix=c.mainMatrix,f}getFastPathSimpleProjectionMatrix(r){return this.currentTransform.getFastPathSimpleProjectionMatrix(r)}}class is{get useGlobeControls(){return!0}handlePanInertia(r,c){const f=s0(r,c);return Math.abs(f.lng-c.center.lng)>180&&(f.lng=c.center.lng+179.5*Math.sign(f.lng-c.center.lng)),{easingCenter:f,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(r,c){const f=r.around,g=c.screenPointToLocation(f);r.bearingDelta&&c.setBearing(c.bearing+r.bearingDelta),r.pitchDelta&&c.setPitch(c.pitch+r.pitchDelta),r.rollDelta&&c.setRoll(c.roll+r.rollDelta);const y=c.zoom;r.zoomDelta&&c.setZoom(c.zoom+r.zoomDelta);const x=c.zoom-y;if(x===0)return;const R=s.bA(c.center.lng,g.lng),F=R/(Math.abs(R/180)+1),H=s.bA(c.center.lat,g.lat),X=c.getRayDirectionFromPixel(f),ae=c.cameraPosition,ee=-1*s.aX(ae,X),de=s.bp();s.aS(de,ae,[X[0]*ee,X[1]*ee,X[2]*ee]);const Ae=s.aZ(de)-1,Fe=Math.exp(.5*-Math.max(Ae-.3,0)),De=Ml(c.worldSize,c.center.lat)/Math.min(c.width,c.height),je=s.bn(De,.9,.5,1,.25),Ue=(1-s.af(-x))*Math.min(Fe,je),et=c.center.lat,Xe=c.zoom,it=new s.S(c.center.lng+F*Ue,s.ah(c.center.lat+H*Ue,-s.ai,s.ai));c.setLocationAtPoint(g,f);const dt=c.center,Je=s.bn(Math.abs(R),45,85,0,1),mt=s.bn(De,.75,.35,0,1),Et=Math.pow(Math.max(Je,mt),.25),xt=s.bA(dt.lng,it.lng),At=s.bA(dt.lat,it.lat);c.setCenter(new s.S(dt.lng+xt*Et,dt.lat+At*Et).wrap()),c.setZoom(Xe+yn(et,c.center.lat))}handleMapControlsPan(r,c,f){if(!r.panDelta)return;const g=c.center.lat,y=c.zoom;c.setCenter(s0(r.panDelta,c).wrap()),c.setZoom(y+yn(g,c.center.lat))}cameraForBoxAndBearing(r,c,f,g,y){const x=Is(r,c,f,g,y),R=c.left/y.width*2-1,F=(y.width-c.right)/y.width*2-1,H=c.top/y.height*-2+1,X=(y.height-c.bottom)/y.height*-2+1,ae=s.bA(f.getWest(),f.getEast())<0,ee=ae?f.getEast():f.getWest(),de=ae?f.getWest():f.getEast(),Ae=Math.max(f.getNorth(),f.getSouth()),Fe=Math.min(f.getNorth(),f.getSouth()),De=ee+.5*s.bA(ee,de),je=Ae+.5*s.bA(Ae,Fe),Ue=y.clone();Ue.setCenter(x.center),Ue.setBearing(x.bearing),Ue.setPitch(0),Ue.setRoll(0),Ue.setZoom(x.zoom);const et=Ue.modelViewProjectionMatrix,Xe=[Zn(f.getNorthWest()),Zn(f.getNorthEast()),Zn(f.getSouthWest()),Zn(f.getSouthEast()),Zn(new s.S(de,je)),Zn(new s.S(ee,je)),Zn(new s.S(De,Ae)),Zn(new s.S(De,Fe))],it=Zn(x.center);let dt=Number.POSITIVE_INFINITY;for(const Je of Xe)R<0&&(dt=is.getLesserNonNegativeNonNull(dt,is.solveVectorScale(Je,it,et,"x",R))),F>0&&(dt=is.getLesserNonNegativeNonNull(dt,is.solveVectorScale(Je,it,et,"x",F))),H>0&&(dt=is.getLesserNonNegativeNonNull(dt,is.solveVectorScale(Je,it,et,"y",H))),X<0&&(dt=is.getLesserNonNegativeNonNull(dt,is.solveVectorScale(Je,it,et,"y",X)));if(Number.isFinite(dt)&&dt!==0)return x.zoom=Ue.zoom+s.ak(dt),x;n0()}handleJumpToCenterZoom(r,c){const f=r.center.lat,g=r.getConstrained(c.center?s.S.convert(c.center):r.center,r.zoom).center;r.setCenter(g.wrap());const y=c.zoom!==void 0?+c.zoom:r.zoom+yn(f,g.lat);r.zoom!==y&&r.setZoom(y)}handleEaseTo(r,c){const f=r.zoom,g=r.center,y=r.padding,x={roll:r.roll,pitch:r.pitch,bearing:r.bearing},R={roll:c.roll===void 0?r.roll:c.roll,pitch:c.pitch===void 0?r.pitch:c.pitch,bearing:c.bearing===void 0?r.bearing:c.bearing},F=c.zoom!==void 0,H=!r.isPaddingEqual(c.padding);let X=!1;const ae=c.center?s.S.convert(c.center):g,ee=r.getConstrained(ae,f).center;mh(r,ee);const de=r.clone();de.setCenter(ee),de.setZoom(F?+c.zoom:f+yn(g.lat,ae.lat)),de.setBearing(c.bearing);const Ae=new s.P(s.ah(r.centerPoint.x+c.offsetAsPoint.x,0,r.width),s.ah(r.centerPoint.y+c.offsetAsPoint.y,0,r.height));de.setLocationAtPoint(ee,Ae);const Fe=(c.offset&&c.offsetAsPoint.mag())>0?de.center:ee,De=F?+c.zoom:f+yn(g.lat,Fe.lat),je=f+yn(g.lat,0),Ue=De+yn(Fe.lat,0),et=s.bA(g.lng,Fe.lng),Xe=s.bA(g.lat,Fe.lat),it=s.af(Ue-je);return X=De!==f,{easeFunc:dt=>{if(s.be(x,R)||us({startEulerAngles:x,endEulerAngles:R,tr:r,k:dt,useSlerp:x.roll!=R.roll}),H&&r.interpolatePadding(y,c.padding,dt),c.around)s.w("Easing around a point is not supported under globe projection."),r.setLocationAtPoint(c.around,c.aroundPoint);else{const Je=Ue>je?Math.min(2,it):Math.max(.5,it),mt=Math.pow(Je,1-dt),Et=hd(g,et,Xe,dt*mt);r.setCenter(Et.wrap())}if(X){const Je=s.C.number(je,Ue,dt)+yn(0,r.center.lat);r.setZoom(Je)}},isZooming:X,elevationCenter:Fe}}handleFlyTo(r,c){const f=c.zoom!==void 0,g=r.center,y=r.zoom,x=r.padding,R=!r.isPaddingEqual(c.padding),F=r.getConstrained(s.S.convert(c.center||c.locationAtOffset),y).center,H=f?+c.zoom:r.zoom+yn(r.center.lat,F.lat),X=r.clone();X.setCenter(F),X.setZoom(H),X.setBearing(c.bearing);const ae=new s.P(s.ah(r.centerPoint.x+c.offsetAsPoint.x,0,r.width),s.ah(r.centerPoint.y+c.offsetAsPoint.y,0,r.height));X.setLocationAtPoint(F,ae);const ee=X.center;mh(r,ee);const de=function(Xe,it,dt){const Je=Zn(it),mt=Zn(dt),Et=s.aX(Je,mt),xt=Math.acos(Et),At=bh(Xe);return xt/(2*Math.PI)*At}(r,g,ee),Ae=y+yn(g.lat,0),Fe=H+yn(ee.lat,0),De=s.af(Fe-Ae);let je;if(typeof c.minZoom=="number"){const Xe=+c.minZoom+yn(ee.lat,0),it=Math.min(Xe,Ae,Fe)+yn(0,ee.lat),dt=r.getConstrained(ee,it).zoom+yn(ee.lat,0);je=s.af(dt-Ae)}const Ue=s.bA(g.lng,ee.lng),et=s.bA(g.lat,ee.lat);return{easeFunc:(Xe,it,dt,Je)=>{const mt=hd(g,Ue,et,dt);R&&r.interpolatePadding(x,c.padding,Xe);const Et=Xe===1?ee:mt;r.setCenter(Et.wrap());const xt=Ae+s.ak(it);r.setZoom(Xe===1?H:xt+yn(0,Et.lat))},scaleOfZoom:De,targetCenter:ee,scaleOfMinZoom:je,pixelPathLength:de}}static solveVectorScale(r,c,f,g,y){const x=g==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],R=[f[3],f[7],f[11],f[15]],F=r[0]*x[0]+r[1]*x[1]+r[2]*x[2],H=r[0]*R[0]+r[1]*R[1]+r[2]*R[2],X=c[0]*x[0]+c[1]*x[1]+c[2]*x[2],ae=c[0]*R[0]+c[1]*R[1]+c[2]*R[2];return X+y*H===F+y*ae||R[3]*(F-X)+x[3]*(ae-H)+F*ae==X*H?null:(X+x[3]-y*ae-y*R[3])/(X-F-y*ae+y*H)}static getLesserNonNegativeNonNull(r,c){return c!==null&&c>=0&&c<r?c:r}}class a0{constructor(r){this._globe=r,this._mercatorCameraHelper=new rs,this._verticalPerspectiveCameraHelper=new is}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(r,c){return this.currentHelper.handlePanInertia(r,c)}handleMapControlsRollPitchBearingZoom(r,c){return this.currentHelper.handleMapControlsRollPitchBearingZoom(r,c)}handleMapControlsPan(r,c,f){this.currentHelper.handleMapControlsPan(r,c,f)}cameraForBoxAndBearing(r,c,f,g,y){return this.currentHelper.cameraForBoxAndBearing(r,c,f,g,y)}handleJumpToCenterZoom(r,c){this.currentHelper.handleJumpToCenterZoom(r,c)}handleEaseTo(r,c){return this.currentHelper.handleEaseTo(r,c)}handleFlyTo(r,c){return this.currentHelper.handleFlyTo(r,c)}}const wh=(v,r)=>s.y(v,r&&r.filter(c=>c.identifier!=="source.canvas")),u1=s.bE();class ud extends s.E{constructor(r,c={}){var f,g;super(),this._rtlPluginLoaded=()=>{for(const x in this.sourceCaches){const R=this.sourceCaches[x].getSource().type;R!=="vector"&&R!=="geojson"||this.sourceCaches[x].reload()}},this.map=r,this.dispatcher=new It(Ce(),r._getMapId()),this.dispatcher.registerMessageHandler("GG",(x,R)=>this.getGlyphs(x,R)),this.dispatcher.registerMessageHandler("GI",(x,R)=>this.getImages(x,R)),this.dispatcher.registerMessageHandler("GDA",(x,R)=>this.getDashes(x,R)),this.imageManager=new $,this.imageManager.setEventedParent(this);const y=((f=r._container)===null||f===void 0?void 0:f.lang)||typeof document<"u"&&((g=document.documentElement)===null||g===void 0?void 0:g.lang)||void 0;this.glyphManager=new Be(r._requestManager,c.localIdeographFontFamily,y),this.lineAtlas=new ye(256,512),this.crossTileSymbolIndex=new Ka,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",s.bG()),xi().on(Xi,this._rtlPluginLoaded),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const R=this.sourceCaches[x.sourceId];if(!R)return;const F=R.getSource();if(F&&F.vectorLayerIds)for(const H in this._layers){const X=this._layers[H];X.source===F.id&&this._validateLayer(X)}})}setGlobalStateProperty(r,c){var f,g,y;this._checkLoaded();const x=c===null?(y=(g=(f=this.stylesheet.state)===null||f===void 0?void 0:f[r])===null||g===void 0?void 0:g.default)!==null&&y!==void 0?y:null:c;if(s.bH(x,this._globalState[r]))return this;this._globalState[r]=x,this._applyGlobalStateChanges([r])}getGlobalState(){return this._globalState}setGlobalState(r){this._checkLoaded();const c=[];for(const f in r)!s.bH(this._globalState[f],r[f].default)&&(c.push(f),this._globalState[f]=r[f].default);this._applyGlobalStateChanges(c)}_applyGlobalStateChanges(r){if(r.length===0)return;const c=new Set,f={};for(const g of r){f[g]=this._globalState[g];for(const y in this._layers){const x=this._layers[y],R=x.getLayoutAffectingGlobalStateRefs(),F=x.getPaintAffectingGlobalStateRefs();if(R.has(g)&&c.add(x.source),F.has(g))for(const{name:H,value:X}of F.get(g))this._updatePaintProperty(x,H,X)}}this.dispatcher.broadcast("UGS",f);for(const g in this.sourceCaches)c.has(g)&&(this._reloadSource(g),this._changed=!0)}loadURL(r,c={},f){this.fire(new s.l("dataloading",{dataType:"style"})),c.validate=typeof c.validate!="boolean"||c.validate;const g=this.map._requestManager.transformRequest(r,"Style");this._loadStyleRequest=new AbortController;const y=this._loadStyleRequest;s.j(g,this._loadStyleRequest).then(x=>{this._loadStyleRequest=null,this._load(x.data,c,f)}).catch(x=>{this._loadStyleRequest=null,x&&!y.signal.aborted&&this.fire(new s.k(x))})}loadJSON(r,c={},f){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,D.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,c.validate=c.validate!==!1,this._load(r,c,f)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(u1,{validate:!1})}_load(r,c,f){var g,y;let x=c.transformStyle?c.transformStyle(f,r):r;if(!c.validate||!wh(this,s.z(x))){x=Object.assign({},x),this._loaded=!0,this.stylesheet=x;for(const R in x.sources)this.addSource(R,x.sources[R],{validate:!1});x.sprite?this._loadSprite(x.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(x.glyphs),this._createLayers(),this.light=new Ee(this.stylesheet.light),this._setProjectionInternal(((g=this.stylesheet.projection)===null||g===void 0?void 0:g.type)||"mercator"),this.sky=new $e(this.stylesheet.sky),this.map.setTerrain((y=this.stylesheet.terrain)!==null&&y!==void 0?y:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){var r;const c=s.bI(this.stylesheet.layers);this.setGlobalState((r=this.stylesheet.state)!==null&&r!==void 0?r:null),this.dispatcher.broadcast("SL",c),this._order=c.map(f=>f.id),this._layers={},this._serializedLayers=null;for(const f of c){const g=s.bJ(f,this._globalState);g.setEventedParent(this,{layer:{id:f.id}}),this._layers[f.id]=g}}_loadSprite(r,c=!1,f=void 0){let g;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,x,R,F){return s._(this,void 0,void 0,function*(){const H=oe(y),X=R>1?"@2x":"",ae={},ee={};for(const{id:de,url:Ae}of H){const Fe=x.transformRequest(ve(Ae,X,".json"),"SpriteJSON");ae[de]=s.j(Fe,F);const De=x.transformRequest(ve(Ae,X,".png"),"SpriteImage");ee[de]=N.getImage(De,F)}return yield Promise.all([...Object.values(ae),...Object.values(ee)]),function(de,Ae){return s._(this,void 0,void 0,function*(){const Fe={};for(const De in de){Fe[De]={};const je=D.getImageCanvasContext((yield Ae[De]).data),Ue=(yield de[De]).data;for(const et in Ue){const{width:Xe,height:it,x:dt,y:Je,sdf:mt,pixelRatio:Et,stretchX:xt,stretchY:At,content:kt,textFitWidth:er,textFitHeight:Qt}=Ue[et];Fe[De][et]={data:null,pixelRatio:Et,sdf:mt,stretchX:xt,stretchY:At,content:kt,textFitWidth:er,textFitHeight:Qt,spriteData:{width:Xe,height:it,x:dt,y:Je,context:je}}}}return Fe})}(ae,ee)})}(r,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const x in y){this._spritesImagesIds[x]=[];const R=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(F=>!(F in y)):[];for(const F of R)this.imageManager.removeImage(F),this._changedImages[F]=!0;for(const F in y[x]){const H=x==="default"?F:`${x}:${F}`;this._spritesImagesIds[x].push(H),H in this.imageManager.images?this.imageManager.updateImage(H,y[x][F],!1):this.imageManager.addImage(H,y[x][F]),c&&(this._changedImages[H]=!0)}}}).catch(y=>{this._spriteRequest=null,g=y,this.fire(new s.k(g))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),c&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),f&&f(g)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(r){const c=this.sourceCaches[r.source];if(!c)return;const f=r.sourceLayer;if(!f)return;const g=c.getSource();(g.type==="geojson"||g.vectorLayerIds&&g.vectorLayerIds.indexOf(f)===-1)&&this.fire(new s.k(new Error(`Source layer "${f}" does not exist on source "${g.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r,c=!1){const f=this._serializedAllLayers();if(!r||r.length===0)return Object.values(c?s.bK(f):f);const g=[];for(const y of r)if(f[y]){const x=c?s.bK(f[y]):f[y];g.push(x)}return g}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const c=Object.keys(this._layers);for(const f of c){const g=this._layers[f];g.type!=="custom"&&(r[f]=g.serialize())}return r}hasTransitions(){var r,c,f;if(!((r=this.light)===null||r===void 0)&&r.hasTransition()||!((c=this.sky)===null||c===void 0)&&c.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const g in this.sourceCaches)if(this.sourceCaches[g].hasTransition())return!0;for(const g in this._layers)if(this._layers[g].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const c=this._changed;if(c){const g=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(g.length||y.length)&&this._updateWorkerLayers(g,y);for(const x in this._updatedSources){const R=this._updatedSources[x];if(R==="reload")this._reloadSource(x);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(r);this.light.updateTransitions(r),this.sky.updateTransitions(r),this._resetUpdates()}const f={};for(const g in this.sourceCaches){const y=this.sourceCaches[g];f[g]=y.used,y.used=!1}for(const g of this._order){const y=this._layers[g];y.recalculate(r,this._availableImages),!y.isHidden(r.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const g in f){const y=this.sourceCaches[g];!!f[g]!=!!y.used&&y.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:g}))}this.light.recalculate(r),this.sky.recalculate(r),this.projection.recalculate(r),this.z=r.zoom,c&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,c){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(r,!1),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,c={}){var f;this._checkLoaded();const g=this.serialize();if(r=c.transformStyle?c.transformStyle(g,r):r,((f=c.validate)===null||f===void 0||f)&&wh(this,s.z(r)))return!1;(r=s.bK(r)).layers=s.bI(r.layers);const y=s.bL(g,r),x=this._getOperationsToPerform(y);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(const R of x.operations)R();return this.stylesheet=r,this._serializedLayers=null,!0}_getOperationsToPerform(r){const c=[],f=[];for(const g of r)switch(g.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":c.push(()=>this.addLayer.apply(this,g.args));break;case"removeLayer":c.push(()=>this.removeLayer.apply(this,g.args));break;case"setPaintProperty":c.push(()=>this.setPaintProperty.apply(this,g.args));break;case"setLayoutProperty":c.push(()=>this.setLayoutProperty.apply(this,g.args));break;case"setFilter":c.push(()=>this.setFilter.apply(this,g.args));break;case"addSource":c.push(()=>this.addSource.apply(this,g.args));break;case"removeSource":c.push(()=>this.removeSource.apply(this,g.args));break;case"setLayerZoomRange":c.push(()=>this.setLayerZoomRange.apply(this,g.args));break;case"setLight":c.push(()=>this.setLight.apply(this,g.args));break;case"setGeoJSONSourceData":c.push(()=>this.setGeoJSONSourceData.apply(this,g.args));break;case"setGlyphs":c.push(()=>this.setGlyphs.apply(this,g.args));break;case"setSprite":c.push(()=>this.setSprite.apply(this,g.args));break;case"setTerrain":c.push(()=>this.map.setTerrain.apply(this,g.args));break;case"setSky":c.push(()=>this.setSky.apply(this,g.args));break;case"setProjection":this.setProjection.apply(this,g.args);break;case"setGlobalState":c.push(()=>this.setGlobalState.apply(this,g.args));break;case"setTransition":c.push(()=>{});break;default:f.push(g.command)}return{operations:c,unimplemented:f}}addImage(r,c){if(this.getImage(r))return this.fire(new s.k(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,c),this._afterImageUpdated(r)}updateImage(r,c){this.imageManager.updateImage(r,c)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new s.k(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,c,f={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.z.source,`sources.${r}`,c,null,f))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const g=this.sourceCaches[r]=new Ct(r,c,this.dispatcher);g.style=this,g.setEventedParent(this,()=>({isSourceLoaded:g.loaded(),source:g.serialize(),sourceId:r})),g.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===r)return this.fire(new s.k(new Error(`Source "${r}" cannot be removed while layer "${f}" is using it.`)));const c=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],c.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),c.setEventedParent(null),c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,c){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const f=this.sourceCaches[r].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(c),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,c,f={}){this._checkLoaded();const g=r.id;if(this.getLayer(g))return void this.fire(new s.k(new Error(`Layer "${g}" already exists on this map.`)));let y;if(r.type==="custom"){if(wh(this,s.bM(r)))return;y=s.bJ(r,this._globalState)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(g,r.source),r=s.bK(r),r=s.e(r,{source:g})),this._validate(s.z.layer,`layers.${g}`,r,{arrayIndex:-1},f))return;y=s.bJ(r,this._globalState),this._validateLayer(y),y.setEventedParent(this,{layer:{id:g}})}const x=c?this._order.indexOf(c):this._order.length;if(c&&x===-1)this.fire(new s.k(new Error(`Cannot add layer "${g}" before non-existing layer "${c}".`)));else{if(this._order.splice(x,0,g),this._layerOrderChanged=!0,this._layers[g]=y,this._removedLayers[g]&&y.source&&y.type!=="custom"){const R=this._removedLayers[g];delete this._removedLayers[g],R.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(r,c){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new s.k(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===c)return;const f=this._order.indexOf(r);this._order.splice(f,1);const g=c?this._order.indexOf(c):this._order.length;c&&g===-1?this.fire(new s.k(new Error(`Cannot move layer "${r}" before non-existing layer "${c}".`))):(this._order.splice(g,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const c=this._layers[r];if(!c)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${r}".`)));c.setEventedParent(null);const f=this._order.indexOf(r);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=c,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],c.onRemove&&c.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,c,f){this._checkLoaded();const g=this.getLayer(r);g?g.minzoom===c&&g.maxzoom===f||(c!=null&&(g.minzoom=c),f!=null&&(g.maxzoom=f),this._updateLayer(g)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,c,f={}){this._checkLoaded();const g=this.getLayer(r);if(g){if(!s.bH(g.filter,c))return c==null?(g.setFilter(void 0),void this._updateLayer(g)):void(this._validate(s.z.filter,`layers.${g.id}.filter`,c,null,f)||(g.setFilter(s.bK(c)),this._updateLayer(g)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return s.bK(this.getLayer(r).filter)}setLayoutProperty(r,c,f,g={}){this._checkLoaded();const y=this.getLayer(r);y?s.bH(y.getLayoutProperty(c),f)||(y.setLayoutProperty(c,f,g),this._updateLayer(y)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,c){const f=this.getLayer(r);if(f)return f.getLayoutProperty(c);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,c,f,g={}){this._checkLoaded();const y=this.getLayer(r);y?s.bH(y.getPaintProperty(c),f)||this._updatePaintProperty(y,c,f,g):this.fire(new s.k(new Error(`Cannot style non-existing layer "${r}".`)))}_updatePaintProperty(r,c,f,g={}){r.setPaintProperty(c,f,g)&&this._updateLayer(r),this._changed=!0,this._updatedPaintProps[r.id]=!0,this._serializedLayers=null}getPaintProperty(r,c){return this.getLayer(r).getPaintProperty(c)}setFeatureState(r,c){this._checkLoaded();const f=r.source,g=r.sourceLayer,y=this.sourceCaches[f];if(y===void 0)return void this.fire(new s.k(new Error(`The source '${f}' does not exist in the map's style.`)));const x=y.getSource().type;x==="geojson"&&g?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||g?(r.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),y.setFeatureState(g,r.id,c)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,c){this._checkLoaded();const f=r.source,g=this.sourceCaches[f];if(g===void 0)return void this.fire(new s.k(new Error(`The source '${f}' does not exist in the map's style.`)));const y=g.getSource().type,x=y==="vector"?r.sourceLayer:void 0;y!=="vector"||x?c&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):g.removeFeatureState(x,r.id,c):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const c=r.source,f=r.sourceLayer,g=this.sourceCaches[c];if(g!==void 0)return g.getSource().type!=="vector"||f?(r.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),g.getFeatureState(f,r.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=s.bN(this.sourceCaches,y=>y.serialize()),c=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,g=this.stylesheet;return s.bO({version:g.version,name:g.name,metadata:g.metadata,light:g.light,sky:g.sky,center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,sprite:g.sprite,glyphs:g.glyphs,transition:g.transition,projection:g.projection,sources:r,layers:c,terrain:f},y=>y!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const c=x=>this._layers[x].type==="fill-extrusion",f={},g=[];for(let x=this._order.length-1;x>=0;x--){const R=this._order[x];if(c(R)){f[R]=x;for(const F of r){const H=F[R];if(H)for(const X of H)g.push(X)}}}g.sort((x,R)=>R.intersectionZ-x.intersectionZ);const y=[];for(let x=this._order.length-1;x>=0;x--){const R=this._order[x];if(c(R))for(let F=g.length-1;F>=0;F--){const H=g[F].feature;if(f[H.layer.id]<x)break;y.push(H),g.pop()}else for(const F of r){const H=F[R];if(H)for(const X of H)y.push(X.feature)}}return y}queryRenderedFeatures(r,c,f){c&&c.filter&&this._validate(s.z.filter,"queryRenderedFeatures.filter",c.filter,null,c);const g={};if(c&&c.layers){if(!(Array.isArray(c.layers)||c.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const H of c.layers){const X=this._layers[H];if(!X)return this.fire(new s.k(new Error(`The layer '${H}' does not exist in the map's style and cannot be queried for features.`))),[];g[X.source]=!0}}const y=[];c.availableImages=this._availableImages;const x=this._serializedAllLayers(),R=c.layers instanceof Set?c.layers:Array.isArray(c.layers)?new Set(c.layers):null,F=Object.assign(Object.assign({},c),{layers:R,globalState:this._globalState});for(const H in this.sourceCaches)c.layers&&!g[H]||y.push(Jt(this.sourceCaches[H],this._layers,x,r,F,f,this.map.terrain?(X,ae,ee)=>this.map.terrain.getElevation(X,ae,ee):void 0));return this.placement&&y.push(function(H,X,ae,ee,de,Ae,Fe){const De={},je=Ae.queryRenderedSymbols(ee),Ue=[];for(const et of Object.keys(je).map(Number))Ue.push(Fe[et]);Ue.sort(dr);for(const et of Ue){const Xe=et.featureIndex.lookupSymbolFeatures(je[et.bucketInstanceId],X,et.bucketIndex,et.sourceLayerIndex,{filterSpec:de.filter,globalState:de.globalState},de.layers,de.availableImages,H);for(const it in Xe){const dt=De[it]=De[it]||[],Je=Xe[it];Je.sort((mt,Et)=>{const xt=et.featureSortOrder;if(xt){const At=xt.indexOf(mt.featureIndex);return xt.indexOf(Et.featureIndex)-At}return Et.featureIndex-mt.featureIndex});for(const mt of Je)dt.push(mt)}}return function(et,Xe,it){for(const dt in et)for(const Je of et[dt])zt(Je,it[Xe[dt].source]);return et}(De,H,ae)}(this._layers,x,this.sourceCaches,r,F,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(r,c){c!=null&&c.filter&&this._validate(s.z.filter,"querySourceFeatures.filter",c.filter,null,c);const f=this.sourceCaches[r];return f?function(g,y){const x=g.getRenderableIds().map(H=>g.getTileByID(H)),R=[],F={};for(let H=0;H<x.length;H++){const X=x[H],ae=X.tileID.canonical.key;F[ae]||(F[ae]=!0,X.querySourceFeatures(R,y))}return R}(f,c?Object.assign(Object.assign({},c),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(r,c={}){this._checkLoaded();const f=this.light.getLight();let g=!1;for(const x in r)if(!s.bH(r[x],f[x])){g=!0;break}if(!g)return;const y={now:D.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,c),this.light.updateTransitions(y)}getProjection(){var r;return(r=this.stylesheet)===null||r===void 0?void 0:r.projection}setProjection(r){if(this._checkLoaded(),this.projection){if(this.projection.name===r.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=r,this._setProjectionInternal(r.type)}getSky(){var r;return(r=this.stylesheet)===null||r===void 0?void 0:r.sky}setSky(r,c={}){this._checkLoaded();const f=this.getSky();let g=!1;if(!r&&!f)return;if(r&&!f)g=!0;else if(!r&&f)g=!0;else for(const x in r)if(!s.bH(r[x],f[x])){g=!0;break}if(!g)return;const y={now:D.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=r,this.sky.setSky(r,c),this.sky.updateTransitions(y)}_setProjectionInternal(r){const c=function(f){if(Array.isArray(f)){const g=new yh({type:f});return{projection:g,transform:new pc,cameraHelper:new a0(g)}}switch(f){case"mercator":return{projection:new si,transform:new ji,cameraHelper:new rs};case"globe":{const g=new yh({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:g,transform:new pc,cameraHelper:new a0(g)}}case"vertical-perspective":return{projection:new lc,transform:new fc,cameraHelper:new is};default:return s.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new si,transform:new ji,cameraHelper:new rs}}}(r);this.projection=c.projection,this.map.migrateProjection(c.transform,c.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(r,c,f,g,y={}){return(!y||y.validate!==!1)&&wh(this,r.call(s.z,s.e({key:c,style:this.serialize(),value:f,styleSpec:s.v},g)))}_remove(r=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),xi().off(Xi,this._rtlPluginLoaded);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const f=this.sourceCaches[c];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),r&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const c in this.sourceCaches)this.sourceCaches[c].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,c,f,g,y=!1){let x=!1,R=!1;const F={};for(const H of this._order){const X=this._layers[H];if(X.type!=="symbol")continue;if(!F[X.source]){const ee=this.sourceCaches[X.source];F[X.source]=ee.getRenderableIds(!0).map(de=>ee.getTileByID(de)).sort((de,Ae)=>Ae.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(Ae.tileID)?-1:1))}const ae=this.crossTileSymbolIndex.addLayer(X,F[X.source],r.center.lng);x=x||ae}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(D.now(),r.zoom))&&(this.pauseablePlacement=new fa(r,this.map.terrain,this._order,y,c,f,g,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(D.now()),R=!0),x&&this.pauseablePlacement.placement.setStale()),R||x)for(const H of this._order){const X=this._layers[H];X.type==="symbol"&&this.placement.updateLayerOpacities(X,F[X.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(D.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,c){return s._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(c.icons);this._updateTilesForChangedImages();const g=this.sourceCaches[c.source];return g&&g.setDependencies(c.tileID.key,c.type,c.icons),f})}getGlyphs(r,c){return s._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(c.stacks),g=this.sourceCaches[c.source];return g&&g.setDependencies(c.tileID.key,c.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,c={}){this._checkLoaded(),r&&this._validate(s.z.glyphs,"glyphs",r,null,c)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}getDashes(r,c){return s._(this,void 0,void 0,function*(){const f={};for(const[g,y]of Object.entries(c.dashes))f[g]=this.lineAtlas.getDash(y.dasharray,y.round);return f})}addSprite(r,c,f={},g){this._checkLoaded();const y=[{id:r,url:c}],x=[...oe(this.stylesheet.sprite),...y];this._validate(s.z.sprite,"sprite",x,null,f)||(this.stylesheet.sprite=x,this._loadSprite(y,!0,g))}removeSprite(r){this._checkLoaded();const c=oe(this.stylesheet.sprite);if(c.find(f=>f.id===r)){if(this._spritesImagesIds[r])for(const f of this._spritesImagesIds[r])this.imageManager.removeImage(f),this._changedImages[f]=!0;c.splice(c.findIndex(f=>f.id===r),1),this.stylesheet.sprite=c.length>0?c:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return oe(this.stylesheet.sprite)}setSprite(r,c={},f){this._checkLoaded(),r&&this._validate(s.z.sprite,"sprite",r,null,c)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,f):(this._unloadSprite(),f&&f(null)))}}var d1=s.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class f1{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,c,f,g,y,x,R,F,H){this.context=r;let X=this.boundPaintVertexBuffers.length!==g.length;for(let ae=0;!X&&ae<g.length;ae++)this.boundPaintVertexBuffers[ae]!==g[ae]&&(X=!0);!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==f||X||this.boundIndexBuffer!==y||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==R||this.boundDynamicVertexBuffer2!==F||this.boundDynamicVertexBuffer3!==H?this.freshBind(c,f,g,y,x,R,F,H):(r.bindVertexArray.set(this.vao),R&&R.bind(),y&&y.dynamicDraw&&y.bind(),F&&F.bind(),H&&H.bind())}freshBind(r,c,f,g,y,x,R,F){const H=r.numAttributes,X=this.context,ae=X.gl;this.vao&&this.destroy(),this.vao=X.createVertexArray(),X.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=g,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=F,c.enableAttributes(ae,r);for(const ee of f)ee.enableAttributes(ae,r);x&&x.enableAttributes(ae,r),R&&R.enableAttributes(ae,r),F&&F.enableAttributes(ae,r),c.bind(),c.setVertexAttribPointers(ae,r,y);for(const ee of f)ee.bind(),ee.setVertexAttribPointers(ae,r,y);x&&(x.bind(),x.setVertexAttribPointers(ae,r,y)),g&&g.bind(),R&&(R.bind(),R.setVertexAttribPointers(ae,r,y)),F&&(F.bind(),F.setVertexAttribPointers(ae,r,y)),X.currentNumAttributes=H}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const xh=(v,r,c,f,g)=>({u_texture:0,u_ele_delta:v,u_fog_matrix:r,u_fog_color:c?c.properties.get("fog-color"):s.bf.white,u_fog_ground_blend:c?c.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:g?0:c?c.calculateFogBlendOpacity(f):0,u_horizon_color:c?c.properties.get("horizon-color"):s.bf.white,u_horizon_fog_blend:c?c.properties.get("horizon-fog-blend"):1,u_is_globe_mode:g?1:0}),dd={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Go(v){const r=[];for(let c=0;c<v.length;c++){if(v[c]===null)continue;const f=v[c].split(" ");r.push(f.pop())}return r}class fd{constructor(r,c,f,g,y,x,R,F,H=[]){const X=r.gl;this.program=X.createProgram();const ae=Go(c.staticAttributes),ee=f?f.getBinderAttributes():[],de=ae.concat(ee),Ae=Ms.prelude.staticUniforms?Go(Ms.prelude.staticUniforms):[],Fe=R.staticUniforms?Go(R.staticUniforms):[],De=c.staticUniforms?Go(c.staticUniforms):[],je=f?f.getBinderUniforms():[],Ue=Ae.concat(Fe).concat(De).concat(je),et=[];for(const xt of Ue)et.indexOf(xt)<0&&et.push(xt);const Xe=f?f.defines():[];pa(X)&&Xe.unshift("#version 300 es"),y&&Xe.push("#define OVERDRAW_INSPECTOR;"),x&&Xe.push("#define TERRAIN3D;"),F&&Xe.push(F),H&&Xe.push(...H);let it=Xe.concat(Ms.prelude.fragmentSource,R.fragmentSource,c.fragmentSource).join(`
`),dt=Xe.concat(Ms.prelude.vertexSource,R.vertexSource,c.vertexSource).join(`
`);pa(X)||(it=function(xt){return xt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(it),dt=function(xt){return xt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(dt));const Je=X.createShader(X.FRAGMENT_SHADER);if(X.isContextLost())return void(this.failedToCreate=!0);if(X.shaderSource(Je,it),X.compileShader(Je),!X.getShaderParameter(Je,X.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${X.getShaderInfoLog(Je)}`);X.attachShader(this.program,Je);const mt=X.createShader(X.VERTEX_SHADER);if(X.isContextLost())return void(this.failedToCreate=!0);if(X.shaderSource(mt,dt),X.compileShader(mt),!X.getShaderParameter(mt,X.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${X.getShaderInfoLog(mt)}`);X.attachShader(this.program,mt),this.attributes={};const Et={};this.numAttributes=de.length;for(let xt=0;xt<this.numAttributes;xt++)de[xt]&&(X.bindAttribLocation(this.program,xt,de[xt]),this.attributes[de[xt]]=xt);if(X.linkProgram(this.program),!X.getProgramParameter(this.program,X.LINK_STATUS))throw new Error(`Program failed to link: ${X.getProgramInfoLog(this.program)}`);X.deleteShader(mt),X.deleteShader(Je);for(let xt=0;xt<et.length;xt++){const At=et[xt];if(At&&!Et[At]){const kt=X.getUniformLocation(this.program,At);kt&&(Et[At]=kt)}}this.fixedUniforms=g(r,Et),this.terrainUniforms=((xt,At)=>({u_depth:new s.bP(xt,At.u_depth),u_terrain:new s.bP(xt,At.u_terrain),u_terrain_dim:new s.bg(xt,At.u_terrain_dim),u_terrain_matrix:new s.bR(xt,At.u_terrain_matrix),u_terrain_unpack:new s.bS(xt,At.u_terrain_unpack),u_terrain_exaggeration:new s.bg(xt,At.u_terrain_exaggeration)}))(r,Et),this.projectionUniforms=((xt,At)=>({u_projection_matrix:new s.bR(xt,At.u_projection_matrix),u_projection_tile_mercator_coords:new s.bS(xt,At.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.bS(xt,At.u_projection_clipping_plane),u_projection_transition:new s.bg(xt,At.u_projection_transition),u_projection_fallback_matrix:new s.bR(xt,At.u_projection_fallback_matrix)}))(r,Et),this.binderUniforms=f?f.getUniforms(r,Et):[]}draw(r,c,f,g,y,x,R,F,H,X,ae,ee,de,Ae,Fe,De,je,Ue,et){const Xe=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(f),r.setStencilMode(g),r.setColorMode(y),r.setCullFace(x),F){r.activeTexture.set(Xe.TEXTURE2),Xe.bindTexture(Xe.TEXTURE_2D,F.depthTexture),r.activeTexture.set(Xe.TEXTURE3),Xe.bindTexture(Xe.TEXTURE_2D,F.texture);for(const dt in this.terrainUniforms)this.terrainUniforms[dt].set(F[dt])}if(H)for(const dt in H)this.projectionUniforms[dd[dt]].set(H[dt]);if(R)for(const dt in this.fixedUniforms)this.fixedUniforms[dt].set(R[dt]);De&&De.setUniforms(r,this.binderUniforms,Ae,{zoom:Fe});let it=0;switch(c){case Xe.LINES:it=2;break;case Xe.TRIANGLES:it=3;break;case Xe.LINE_STRIP:it=1}for(const dt of de.get()){const Je=dt.vaos||(dt.vaos={});(Je[X]||(Je[X]=new f1)).bind(r,this,ae,De?De.getPaintVertexBuffers():[],ee,dt.vertexOffset,je,Ue,et),Xe.drawElements(c,dt.primitiveLength*it,Xe.UNSIGNED_SHORT,dt.primitiveOffset*it*2)}}}function Mh(v,r,c){const f=1/s.aC(c,1,r.transform.tileZoom),g=Math.pow(2,c.tileID.overscaledZ),y=c.tileSize*Math.pow(2,r.transform.tileZoom)/g,x=y*(c.tileID.canonical.x+c.tileID.wrap*g),R=y*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[f,v.fromScale,v.toScale],u_fade:v.t,u_pixel_coord_upper:[x>>16,R>>16],u_pixel_coord_lower:[65535&x,65535&R]}}const Js=(v,r,c,f)=>{const g=v.style.light,y=g.properties.get("position"),x=[y.x,y.y,y.z],R=s.bV();g.properties.get("anchor")==="viewport"&&s.bW(R,v.transform.bearingInRadians),s.bX(x,x,R);const F=v.transform.transformLightDirection(x),H=g.properties.get("color");return{u_lightpos:x,u_lightpos_globe:F,u_lightintensity:g.properties.get("intensity"),u_lightcolor:[H.r,H.g,H.b],u_vertical_gradient:+r,u_opacity:c,u_fill_translate:f}},p1=(v,r,c,f,g,y,x)=>s.e(Js(v,r,c,f),Mh(y,v,x),{u_height_factor:-Math.pow(2,g.overscaledZ)/x.tileSize/8}),Ih=(v,r,c,f)=>s.e(Mh(r,v,c),{u_fill_translate:f}),mc=(v,r)=>({u_world:v,u_fill_translate:r}),gc=(v,r,c,f,g)=>s.e(Ih(v,r,c,g),{u_world:f}),m1=(v,r,c,f,g)=>{const y=v.transform;let x,R,F=0;if(c.paint.get("circle-pitch-alignment")==="map"){const H=s.aC(r,1,y.zoom);x=!0,R=[H,H],F=H/(s.$*Math.pow(2,r.tileID.overscaledZ))*2*Math.PI*g}else x=!1,R=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+x,u_device_pixel_ratio:v.pixelRatio,u_extrude_scale:R,u_globe_extrude_scale:F,u_translate:f}},Ah=v=>({u_pixel_extrude_scale:[1/v.width,1/v.height]}),g1=v=>({u_viewport_size:[v.width,v.height]}),Vo=(v,r=1)=>({u_color:v,u_overlay:0,u_overlay_scale:r}),o0=(v,r,c,f)=>{const g=s.aC(v,1,r)/(s.$*Math.pow(2,v.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:s.aC(v,1,r),u_intensity:c,u_globe_extrude_scale:g}},pd=(v,r,c,f)=>{const g=s.L();s.bY(g,0,v.width,v.height,0,0,1);const y=v.context.gl;return{u_matrix:g,u_world:[y.drawingBufferWidth,y.drawingBufferHeight],u_image:c,u_color_ramp:f,u_opacity:r.paint.get("heatmap-opacity")}},_1=(v,r,c)=>{const f=c.paint.get("hillshade-accent-color");let g;switch(c.paint.get("hillshade-method")){case"basic":g=4;break;case"combined":g=1;break;case"igor":g=2;break;case"multidirectional":g=3;break;default:g=0}const y=c.getIlluminationProperties();for(let x=0;x<y.directionRadians.length;x++)c.paint.get("hillshade-illumination-anchor")==="viewport"&&(y.directionRadians[x]+=v.transform.bearingInRadians);return{u_image:0,u_latrange:md(0,r.tileID),u_exaggeration:c.paint.get("hillshade-exaggeration"),u_altitudes:y.altitudeRadians,u_azimuths:y.directionRadians,u_accent:f,u_method:g,u_highlights:y.highlightColor,u_shadows:y.shadowColor}},l0=(v,r)=>{const c=r.stride,f=s.L();return s.bY(f,0,s.$,-s.$,0,0,1),s.M(f,f,[0,-s.$,0]),{u_matrix:f,u_image:1,u_dimension:[c,c],u_zoom:v.overscaledZ,u_unpack:r.getUnpackVector()}};function md(v,r){const c=Math.pow(2,r.canonical.z),f=r.canonical.y;return[new s.a1(0,f/c).toLngLat().lat,new s.a1(0,(f+1)/c).toLngLat().lat]}const c0=(v,r,c=0)=>({u_image:0,u_unpack:r.getUnpackVector(),u_dimension:[r.stride,r.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:c,u_opacity:v.paint.get("color-relief-opacity")}),Th=(v,r,c,f)=>{const g=v.transform;return{u_translation:_d(v,r,c),u_ratio:f/s.aC(r,1,g.zoom),u_device_pixel_ratio:v.pixelRatio,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},h0=(v,r,c,f,g)=>s.e(Th(v,r,c,f),{u_image:0,u_image_height:g}),u0=(v,r,c,f,g)=>{const y=v.transform,x=gd(r,y);return{u_translation:_d(v,r,c),u_texsize:r.imageAtlasTexture.size,u_ratio:f/s.aC(r,1,y.zoom),u_device_pixel_ratio:v.pixelRatio,u_image:0,u_scale:[x,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},jo=(v,r,c,f,g)=>{const y=gd(r,v.transform);return s.e(Th(v,r,c,f),{u_tileratio:y,u_crossfade_from:g.fromScale,u_crossfade_to:g.toScale,u_image:0,u_mix:g.t,u_lineatlas_width:v.lineAtlas.width,u_lineatlas_height:v.lineAtlas.height})};function gd(v,r){return 1/s.aC(v,1,r.tileZoom)}function _d(v,r,c){return s.aD(v.transform,r,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const _c=(v,r,c,f,g)=>{return{u_tl_parent:v,u_scale_parent:r,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(x=f.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(y=f.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:v1(f.paint.get("raster-hue-rotate")),u_coords_top:[g[0].x,g[0].y,g[1].x,g[1].y],u_coords_bottom:[g[3].x,g[3].y,g[2].x,g[2].y]};var y,x};function v1(v){v*=Math.PI/180;const r=Math.sin(v),c=Math.cos(v);return[(2*c+1)/3,(-Math.sqrt(3)*r-c+1)/3,(Math.sqrt(3)*r-c+1)/3]}const vc=(v,r,c,f,g,y,x,R,F,H,X,ae,ee)=>{const de=x.transform;return{u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:de.cameraToCenterDistance,u_pitch:de.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:de.width/de.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_label_plane_matrix:R,u_coord_matrix:F,u_is_text:+X,u_pitch_with_map:+f,u_is_along_line:g,u_is_variable_anchor:y,u_texsize:ae,u_texture:0,u_translation:H,u_pitched_scale:ee}},d0=(v,r,c,f,g,y,x,R,F,H,X,ae,ee,de)=>{const Ae=x.transform;return s.e(vc(v,r,c,f,g,y,x,R,F,H,X,ae,de),{u_gamma_scale:f?Math.cos(Ae.pitch*Math.PI/180)*Ae.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:1})},y1=(v,r,c,f,g,y,x,R,F,H,X,ae,ee)=>s.e(d0(v,r,c,f,g,y,x,R,F,H,!0,X,0,ee),{u_texsize_icon:ae,u_texture_icon:1}),f0=(v,r)=>({u_opacity:v,u_color:r}),p0=(v,r,c,f,g)=>s.e(function(y,x,R,F){const H=R.imageManager.getPattern(y.from.toString()),X=R.imageManager.getPattern(y.to.toString()),{width:ae,height:ee}=R.imageManager.getPixelSize(),de=Math.pow(2,F.tileID.overscaledZ),Ae=F.tileSize*Math.pow(2,R.transform.tileZoom)/de,Fe=Ae*(F.tileID.canonical.x+F.tileID.wrap*de),De=Ae*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:H.tl,u_pattern_br_a:H.br,u_pattern_tl_b:X.tl,u_pattern_br_b:X.br,u_texsize:[ae,ee],u_mix:x.t,u_pattern_size_a:H.displaySize,u_pattern_size_b:X.displaySize,u_scale_a:x.fromScale,u_scale_b:x.toScale,u_tile_units_to_pixels:1/s.aC(F,1,R.transform.tileZoom),u_pixel_coord_upper:[Fe>>16,De>>16],u_pixel_coord_lower:[65535&Fe,65535&De]}}(c,g,r,f),{u_opacity:v}),vd=(v,r)=>{},yd={fillExtrusion:(v,r)=>({u_lightpos:new s.bT(v,r.u_lightpos),u_lightpos_globe:new s.bT(v,r.u_lightpos_globe),u_lightintensity:new s.bg(v,r.u_lightintensity),u_lightcolor:new s.bT(v,r.u_lightcolor),u_vertical_gradient:new s.bg(v,r.u_vertical_gradient),u_opacity:new s.bg(v,r.u_opacity),u_fill_translate:new s.bU(v,r.u_fill_translate)}),fillExtrusionPattern:(v,r)=>({u_lightpos:new s.bT(v,r.u_lightpos),u_lightpos_globe:new s.bT(v,r.u_lightpos_globe),u_lightintensity:new s.bg(v,r.u_lightintensity),u_lightcolor:new s.bT(v,r.u_lightcolor),u_vertical_gradient:new s.bg(v,r.u_vertical_gradient),u_height_factor:new s.bg(v,r.u_height_factor),u_opacity:new s.bg(v,r.u_opacity),u_fill_translate:new s.bU(v,r.u_fill_translate),u_image:new s.bP(v,r.u_image),u_texsize:new s.bU(v,r.u_texsize),u_pixel_coord_upper:new s.bU(v,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.bU(v,r.u_pixel_coord_lower),u_scale:new s.bT(v,r.u_scale),u_fade:new s.bg(v,r.u_fade)}),fill:(v,r)=>({u_fill_translate:new s.bU(v,r.u_fill_translate)}),fillPattern:(v,r)=>({u_image:new s.bP(v,r.u_image),u_texsize:new s.bU(v,r.u_texsize),u_pixel_coord_upper:new s.bU(v,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.bU(v,r.u_pixel_coord_lower),u_scale:new s.bT(v,r.u_scale),u_fade:new s.bg(v,r.u_fade),u_fill_translate:new s.bU(v,r.u_fill_translate)}),fillOutline:(v,r)=>({u_world:new s.bU(v,r.u_world),u_fill_translate:new s.bU(v,r.u_fill_translate)}),fillOutlinePattern:(v,r)=>({u_world:new s.bU(v,r.u_world),u_image:new s.bP(v,r.u_image),u_texsize:new s.bU(v,r.u_texsize),u_pixel_coord_upper:new s.bU(v,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.bU(v,r.u_pixel_coord_lower),u_scale:new s.bT(v,r.u_scale),u_fade:new s.bg(v,r.u_fade),u_fill_translate:new s.bU(v,r.u_fill_translate)}),circle:(v,r)=>({u_camera_to_center_distance:new s.bg(v,r.u_camera_to_center_distance),u_scale_with_map:new s.bP(v,r.u_scale_with_map),u_pitch_with_map:new s.bP(v,r.u_pitch_with_map),u_extrude_scale:new s.bU(v,r.u_extrude_scale),u_device_pixel_ratio:new s.bg(v,r.u_device_pixel_ratio),u_globe_extrude_scale:new s.bg(v,r.u_globe_extrude_scale),u_translate:new s.bU(v,r.u_translate)}),collisionBox:(v,r)=>({u_pixel_extrude_scale:new s.bU(v,r.u_pixel_extrude_scale)}),collisionCircle:(v,r)=>({u_viewport_size:new s.bU(v,r.u_viewport_size)}),debug:(v,r)=>({u_color:new s.bQ(v,r.u_color),u_overlay:new s.bP(v,r.u_overlay),u_overlay_scale:new s.bg(v,r.u_overlay_scale)}),depth:vd,clippingMask:vd,heatmap:(v,r)=>({u_extrude_scale:new s.bg(v,r.u_extrude_scale),u_intensity:new s.bg(v,r.u_intensity),u_globe_extrude_scale:new s.bg(v,r.u_globe_extrude_scale)}),heatmapTexture:(v,r)=>({u_matrix:new s.bR(v,r.u_matrix),u_world:new s.bU(v,r.u_world),u_image:new s.bP(v,r.u_image),u_color_ramp:new s.bP(v,r.u_color_ramp),u_opacity:new s.bg(v,r.u_opacity)}),hillshade:(v,r)=>({u_image:new s.bP(v,r.u_image),u_latrange:new s.bU(v,r.u_latrange),u_exaggeration:new s.bg(v,r.u_exaggeration),u_altitudes:new s.b_(v,r.u_altitudes),u_azimuths:new s.b_(v,r.u_azimuths),u_accent:new s.bQ(v,r.u_accent),u_method:new s.bP(v,r.u_method),u_shadows:new s.bZ(v,r.u_shadows),u_highlights:new s.bZ(v,r.u_highlights)}),hillshadePrepare:(v,r)=>({u_matrix:new s.bR(v,r.u_matrix),u_image:new s.bP(v,r.u_image),u_dimension:new s.bU(v,r.u_dimension),u_zoom:new s.bg(v,r.u_zoom),u_unpack:new s.bS(v,r.u_unpack)}),colorRelief:(v,r)=>({u_image:new s.bP(v,r.u_image),u_unpack:new s.bS(v,r.u_unpack),u_dimension:new s.bU(v,r.u_dimension),u_elevation_stops:new s.bP(v,r.u_elevation_stops),u_color_stops:new s.bP(v,r.u_color_stops),u_color_ramp_size:new s.bP(v,r.u_color_ramp_size),u_opacity:new s.bg(v,r.u_opacity)}),line:(v,r)=>({u_translation:new s.bU(v,r.u_translation),u_ratio:new s.bg(v,r.u_ratio),u_device_pixel_ratio:new s.bg(v,r.u_device_pixel_ratio),u_units_to_pixels:new s.bU(v,r.u_units_to_pixels)}),lineGradient:(v,r)=>({u_translation:new s.bU(v,r.u_translation),u_ratio:new s.bg(v,r.u_ratio),u_device_pixel_ratio:new s.bg(v,r.u_device_pixel_ratio),u_units_to_pixels:new s.bU(v,r.u_units_to_pixels),u_image:new s.bP(v,r.u_image),u_image_height:new s.bg(v,r.u_image_height)}),linePattern:(v,r)=>({u_translation:new s.bU(v,r.u_translation),u_texsize:new s.bU(v,r.u_texsize),u_ratio:new s.bg(v,r.u_ratio),u_device_pixel_ratio:new s.bg(v,r.u_device_pixel_ratio),u_image:new s.bP(v,r.u_image),u_units_to_pixels:new s.bU(v,r.u_units_to_pixels),u_scale:new s.bT(v,r.u_scale),u_fade:new s.bg(v,r.u_fade)}),lineSDF:(v,r)=>({u_translation:new s.bU(v,r.u_translation),u_ratio:new s.bg(v,r.u_ratio),u_device_pixel_ratio:new s.bg(v,r.u_device_pixel_ratio),u_units_to_pixels:new s.bU(v,r.u_units_to_pixels),u_image:new s.bP(v,r.u_image),u_mix:new s.bg(v,r.u_mix),u_tileratio:new s.bg(v,r.u_tileratio),u_crossfade_from:new s.bg(v,r.u_crossfade_from),u_crossfade_to:new s.bg(v,r.u_crossfade_to),u_lineatlas_width:new s.bg(v,r.u_lineatlas_width),u_lineatlas_height:new s.bg(v,r.u_lineatlas_height)}),raster:(v,r)=>({u_tl_parent:new s.bU(v,r.u_tl_parent),u_scale_parent:new s.bg(v,r.u_scale_parent),u_buffer_scale:new s.bg(v,r.u_buffer_scale),u_fade_t:new s.bg(v,r.u_fade_t),u_opacity:new s.bg(v,r.u_opacity),u_image0:new s.bP(v,r.u_image0),u_image1:new s.bP(v,r.u_image1),u_brightness_low:new s.bg(v,r.u_brightness_low),u_brightness_high:new s.bg(v,r.u_brightness_high),u_saturation_factor:new s.bg(v,r.u_saturation_factor),u_contrast_factor:new s.bg(v,r.u_contrast_factor),u_spin_weights:new s.bT(v,r.u_spin_weights),u_coords_top:new s.bS(v,r.u_coords_top),u_coords_bottom:new s.bS(v,r.u_coords_bottom)}),symbolIcon:(v,r)=>({u_is_size_zoom_constant:new s.bP(v,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bP(v,r.u_is_size_feature_constant),u_size_t:new s.bg(v,r.u_size_t),u_size:new s.bg(v,r.u_size),u_camera_to_center_distance:new s.bg(v,r.u_camera_to_center_distance),u_pitch:new s.bg(v,r.u_pitch),u_rotate_symbol:new s.bP(v,r.u_rotate_symbol),u_aspect_ratio:new s.bg(v,r.u_aspect_ratio),u_fade_change:new s.bg(v,r.u_fade_change),u_label_plane_matrix:new s.bR(v,r.u_label_plane_matrix),u_coord_matrix:new s.bR(v,r.u_coord_matrix),u_is_text:new s.bP(v,r.u_is_text),u_pitch_with_map:new s.bP(v,r.u_pitch_with_map),u_is_along_line:new s.bP(v,r.u_is_along_line),u_is_variable_anchor:new s.bP(v,r.u_is_variable_anchor),u_texsize:new s.bU(v,r.u_texsize),u_texture:new s.bP(v,r.u_texture),u_translation:new s.bU(v,r.u_translation),u_pitched_scale:new s.bg(v,r.u_pitched_scale)}),symbolSDF:(v,r)=>({u_is_size_zoom_constant:new s.bP(v,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bP(v,r.u_is_size_feature_constant),u_size_t:new s.bg(v,r.u_size_t),u_size:new s.bg(v,r.u_size),u_camera_to_center_distance:new s.bg(v,r.u_camera_to_center_distance),u_pitch:new s.bg(v,r.u_pitch),u_rotate_symbol:new s.bP(v,r.u_rotate_symbol),u_aspect_ratio:new s.bg(v,r.u_aspect_ratio),u_fade_change:new s.bg(v,r.u_fade_change),u_label_plane_matrix:new s.bR(v,r.u_label_plane_matrix),u_coord_matrix:new s.bR(v,r.u_coord_matrix),u_is_text:new s.bP(v,r.u_is_text),u_pitch_with_map:new s.bP(v,r.u_pitch_with_map),u_is_along_line:new s.bP(v,r.u_is_along_line),u_is_variable_anchor:new s.bP(v,r.u_is_variable_anchor),u_texsize:new s.bU(v,r.u_texsize),u_texture:new s.bP(v,r.u_texture),u_gamma_scale:new s.bg(v,r.u_gamma_scale),u_device_pixel_ratio:new s.bg(v,r.u_device_pixel_ratio),u_is_halo:new s.bP(v,r.u_is_halo),u_translation:new s.bU(v,r.u_translation),u_pitched_scale:new s.bg(v,r.u_pitched_scale)}),symbolTextAndIcon:(v,r)=>({u_is_size_zoom_constant:new s.bP(v,r.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bP(v,r.u_is_size_feature_constant),u_size_t:new s.bg(v,r.u_size_t),u_size:new s.bg(v,r.u_size),u_camera_to_center_distance:new s.bg(v,r.u_camera_to_center_distance),u_pitch:new s.bg(v,r.u_pitch),u_rotate_symbol:new s.bP(v,r.u_rotate_symbol),u_aspect_ratio:new s.bg(v,r.u_aspect_ratio),u_fade_change:new s.bg(v,r.u_fade_change),u_label_plane_matrix:new s.bR(v,r.u_label_plane_matrix),u_coord_matrix:new s.bR(v,r.u_coord_matrix),u_is_text:new s.bP(v,r.u_is_text),u_pitch_with_map:new s.bP(v,r.u_pitch_with_map),u_is_along_line:new s.bP(v,r.u_is_along_line),u_is_variable_anchor:new s.bP(v,r.u_is_variable_anchor),u_texsize:new s.bU(v,r.u_texsize),u_texsize_icon:new s.bU(v,r.u_texsize_icon),u_texture:new s.bP(v,r.u_texture),u_texture_icon:new s.bP(v,r.u_texture_icon),u_gamma_scale:new s.bg(v,r.u_gamma_scale),u_device_pixel_ratio:new s.bg(v,r.u_device_pixel_ratio),u_is_halo:new s.bP(v,r.u_is_halo),u_translation:new s.bU(v,r.u_translation),u_pitched_scale:new s.bg(v,r.u_pitched_scale)}),background:(v,r)=>({u_opacity:new s.bg(v,r.u_opacity),u_color:new s.bQ(v,r.u_color)}),backgroundPattern:(v,r)=>({u_opacity:new s.bg(v,r.u_opacity),u_image:new s.bP(v,r.u_image),u_pattern_tl_a:new s.bU(v,r.u_pattern_tl_a),u_pattern_br_a:new s.bU(v,r.u_pattern_br_a),u_pattern_tl_b:new s.bU(v,r.u_pattern_tl_b),u_pattern_br_b:new s.bU(v,r.u_pattern_br_b),u_texsize:new s.bU(v,r.u_texsize),u_mix:new s.bg(v,r.u_mix),u_pattern_size_a:new s.bU(v,r.u_pattern_size_a),u_pattern_size_b:new s.bU(v,r.u_pattern_size_b),u_scale_a:new s.bg(v,r.u_scale_a),u_scale_b:new s.bg(v,r.u_scale_b),u_pixel_coord_upper:new s.bU(v,r.u_pixel_coord_upper),u_pixel_coord_lower:new s.bU(v,r.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bg(v,r.u_tile_units_to_pixels)}),terrain:(v,r)=>({u_texture:new s.bP(v,r.u_texture),u_ele_delta:new s.bg(v,r.u_ele_delta),u_fog_matrix:new s.bR(v,r.u_fog_matrix),u_fog_color:new s.bQ(v,r.u_fog_color),u_fog_ground_blend:new s.bg(v,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bg(v,r.u_fog_ground_blend_opacity),u_horizon_color:new s.bQ(v,r.u_horizon_color),u_horizon_fog_blend:new s.bg(v,r.u_horizon_fog_blend),u_is_globe_mode:new s.bg(v,r.u_is_globe_mode)}),terrainDepth:(v,r)=>({u_ele_delta:new s.bg(v,r.u_ele_delta)}),terrainCoords:(v,r)=>({u_texture:new s.bP(v,r.u_texture),u_terrain_coords_id:new s.bg(v,r.u_terrain_coords_id),u_ele_delta:new s.bg(v,r.u_ele_delta)}),projectionErrorMeasurement:(v,r)=>({u_input:new s.bg(v,r.u_input),u_output_expected:new s.bg(v,r.u_output_expected)}),atmosphere:(v,r)=>({u_sun_pos:new s.bT(v,r.u_sun_pos),u_atmosphere_blend:new s.bg(v,r.u_atmosphere_blend),u_globe_position:new s.bT(v,r.u_globe_position),u_globe_radius:new s.bg(v,r.u_globe_radius),u_inv_proj_matrix:new s.bR(v,r.u_inv_proj_matrix)}),sky:(v,r)=>({u_sky_color:new s.bQ(v,r.u_sky_color),u_horizon_color:new s.bQ(v,r.u_horizon_color),u_horizon:new s.bU(v,r.u_horizon),u_horizon_normal:new s.bU(v,r.u_horizon_normal),u_sky_horizon_blend:new s.bg(v,r.u_sky_horizon_blend),u_sky_blend:new s.bg(v,r.u_sky_blend)})};class m0{constructor(r,c,f){this.context=r;const g=r.gl;this.buffer=g.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ch={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Pa{constructor(r,c,f,g){this.length=c.length,this.attributes=f,this.itemSize=c.bytesPerElement,this.dynamicDraw=g,this.context=r;const y=r.gl;this.buffer=y.createBuffer(),r.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,c){for(let f=0;f<this.attributes.length;f++){const g=c.attributes[this.attributes[f].name];g!==void 0&&r.enableVertexAttribArray(g)}}setVertexAttribPointers(r,c,f){for(let g=0;g<this.attributes.length;g++){const y=this.attributes[g],x=c.attributes[y.name];x!==void 0&&r.vertexAttribPointer(x,y.components,r[Ch[y.type]],!1,this.itemSize,y.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Mi{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class bd extends Mi{getDefault(){return s.bf.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class wd extends Mi{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class g0 extends Mi{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class xd extends Mi{getDefault(){return[!0,!0,!0,!0]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Zo extends Mi{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Md extends Mi{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class b1 extends Mi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const c=this.current;(r.func!==c.func||r.ref!==c.ref||r.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class w1 extends Mi{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class x1 extends Mi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=r,this.dirty=!1}}class M1 extends Mi{getDefault(){return[0,1]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class _0 extends Mi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=r,this.dirty=!1}}class I1 extends Mi{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class v0 extends Mi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.BLEND):c.disable(c.BLEND),this.current=r,this.dirty=!1}}class Sh extends Mi{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Ph extends Mi{getDefault(){return s.bf.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Eh extends Mi{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Id extends Mi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=r,this.dirty=!1}}class Oo extends Mi{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class yc extends Mi{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class Al extends Mi{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Gs extends Mi{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class y0 extends Mi{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class b0 extends Mi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Ad extends Mi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class No extends Mi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class kh extends Mi{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Rh extends Mi{getDefault(){return null}set(r){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class bc extends Mi{getDefault(){return null}set(r){var c;if(r===this.current&&!this.dirty)return;const f=this.gl;pa(f)?f.bindVertexArray(r):(c=f.getExtension("OES_vertex_array_object"))===null||c===void 0||c.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class Lh extends Mi{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class w0 extends Mi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Tl extends Mi{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ja extends Mi{constructor(r,c){super(r),this.context=r,this.parent=c}getDefault(){return null}}class x0 extends Ja{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class Td extends Ja{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class oi extends Ja{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}const wc="Framebuffer is not complete";class A1{constructor(r,c,f,g,y){this.context=r,this.width=c,this.height=f;const x=r.gl,R=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new x0(r,R),g)this.depthAttachment=y?new oi(r,R):new Td(r,R);else if(y)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error(wc)}destroy(){const r=this.context.gl,c=this.colorAttachment.get();if(c&&r.deleteTexture(c),this.depthAttachment){const f=this.depthAttachment.get();f&&r.deleteRenderbuffer(f)}r.deleteFramebuffer(this.framebuffer)}}class M0{constructor(r){var c,f;if(this.gl=r,this.clearColor=new bd(this),this.clearDepth=new wd(this),this.clearStencil=new g0(this),this.colorMask=new xd(this),this.depthMask=new Zo(this),this.stencilMask=new Md(this),this.stencilFunc=new b1(this),this.stencilOp=new w1(this),this.stencilTest=new x1(this),this.depthRange=new M1(this),this.depthTest=new _0(this),this.depthFunc=new I1(this),this.blend=new v0(this),this.blendFunc=new Sh(this),this.blendColor=new Ph(this),this.blendEquation=new Eh(this),this.cullFace=new Id(this),this.cullFaceSide=new Oo(this),this.frontFace=new yc(this),this.program=new Al(this),this.activeTexture=new Gs(this),this.viewport=new y0(this),this.bindFramebuffer=new b0(this),this.bindRenderbuffer=new Ad(this),this.bindTexture=new No(this),this.bindVertexBuffer=new kh(this),this.bindElementBuffer=new Rh(this),this.bindVertexArray=new bc(this),this.pixelStoreUnpack=new Lh(this),this.pixelStoreUnpackPremultiplyAlpha=new w0(this),this.pixelStoreUnpackFlipY=new Tl(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),pa(r)){this.HALF_FLOAT=r.HALF_FLOAT;const g=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(c=r.RGBA16F)!==null&&c!==void 0?c:g==null?void 0:g.RGBA16F_EXT,this.RGB16F=(f=r.RGB16F)!==null&&f!==void 0?f:g==null?void 0:g.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const g=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=g==null?void 0:g.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,c){return new m0(this,r,c)}createVertexBuffer(r,c,f){return new Pa(this,r,c,f)}createRenderbuffer(r,c,f){const g=this.gl,y=g.createRenderbuffer();return this.bindRenderbuffer.set(y),g.renderbufferStorage(g.RENDERBUFFER,r,c,f),this.bindRenderbuffer.set(null),y}createFramebuffer(r,c,f,g){return new A1(this,r,c,f,g)}clear({color:r,depth:c,stencil:f}){const g=this.gl;let y=0;r&&(y|=g.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(y|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),f!==void 0&&(y|=g.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),g.clear(y)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){s.bH(r.blendFunction,Ki.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return pa(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var c;return pa(this.gl)?this.gl.deleteVertexArray(r):(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}let Qa;function I0(v,r,c,f,g){const y=v.context,x=v.transform,R=y.gl,F=v.useProgram("collisionBox"),H=[];let X=0,ae=0;for(let je=0;je<f.length;je++){const Ue=f[je],et=r.getTile(Ue).getBucket(c);if(!et)continue;const Xe=g?et.textCollisionBox:et.iconCollisionBox,it=et.collisionCircleArray;it.length>0&&(H.push({circleArray:it,circleOffset:ae,coord:Ue}),X+=it.length/4,ae=X),Xe&&F.draw(y,R.LINES,Yr.disabled,yi.disabled,v.colorModeForRenderPass(),jr.disabled,Ah(v.transform),v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ue),x.getProjectionData({overscaledTileID:Ue,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),c.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,null,v.transform.zoom,null,null,Xe.collisionVertexBuffer)}if(!g||!H.length)return;const ee=v.useProgram("collisionCircle"),de=new s.b$;de.resize(4*X),de._trim();let Ae=0;for(const je of H)for(let Ue=0;Ue<je.circleArray.length/4;Ue++){const et=4*Ue,Xe=je.circleArray[et+0],it=je.circleArray[et+1],dt=je.circleArray[et+2],Je=je.circleArray[et+3];de.emplace(Ae++,Xe,it,dt,Je,0),de.emplace(Ae++,Xe,it,dt,Je,1),de.emplace(Ae++,Xe,it,dt,Je,2),de.emplace(Ae++,Xe,it,dt,Je,3)}(!Qa||Qa.length<2*X)&&(Qa=function(je){const Ue=2*je,et=new s.c1;et.resize(Ue),et._trim();for(let Xe=0;Xe<Ue;Xe++){const it=6*Xe;et.uint16[it+0]=4*Xe+0,et.uint16[it+1]=4*Xe+1,et.uint16[it+2]=4*Xe+2,et.uint16[it+3]=4*Xe+2,et.uint16[it+4]=4*Xe+3,et.uint16[it+5]=4*Xe+0}return et}(X));const Fe=y.createIndexBuffer(Qa,!0),De=y.createVertexBuffer(de,s.c0.members,!0);for(const je of H){const Ue=g1(v.transform);ee.draw(y,R.TRIANGLES,Yr.disabled,yi.disabled,v.colorModeForRenderPass(),jr.disabled,Ue,v.style.map.terrain&&v.style.map.terrain.getTerrainData(je.coord),null,c.id,De,Fe,s.aM.simpleSegment(0,2*je.circleOffset,je.circleArray.length,je.circleArray.length/2),null,v.transform.zoom,null,null,null)}De.destroy(),Fe.destroy()}const T1=s.ag(new Float32Array(16));function A0(v,r,c,f,g,y){const{horizontalAlign:x,verticalAlign:R}=s.aH(v);return new s.P((-(x-.5)*r/g+f[0])*y,(-(R-.5)*c/g+f[1])*y)}function C1(v,r,c,f,g,y){const x=r.tileAnchorPoint.add(new s.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let R=f.mult(y);c||(R=R.rotate(-g));const F=x.add(R);return xe(F.x,F.y,r.pitchedLabelPlaneMatrix,r.getElevation).point}if(c){const R=rt(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(v),F=Math.atan(R.y/R.x)+(R.x<0?Math.PI:0);return v.add(f.rotate(F))}return v.add(f)}function Cd(v,r,c,f,g,y,x,R,F,H,X,ae){const ee=v.text.placedSymbolArray,de=v.text.dynamicLayoutVertexArray,Ae=v.icon.dynamicLayoutVertexArray,Fe={};de.clear();for(let De=0;De<ee.length;De++){const je=ee.get(De),Ue=je.hidden||!je.crossTileID||v.allowVerticalPlacement&&!je.placedOrientation?null:f[je.crossTileID];if(Ue){const et=new s.P(je.anchorX,je.anchorY),Xe={getElevation:ae,width:g.width,height:g.height,pitchedLabelPlaneMatrix:y,pitchWithMap:c,transform:g,tileAnchorPoint:et,translation:H,unwrappedTileID:X},it=c?ze(et.x,et.y,Xe):rt(et.x,et.y,Xe),dt=he(g.cameraToCenterDistance,it.signedDistanceFromCamera);let Je=s.ap(v.textSizeData,R,je)*dt/s.aB;c&&(Je*=v.tilePixelRatio/x);const{width:mt,height:Et,anchor:xt,textOffset:At,textBoxScale:kt}=Ue,er=A0(xt,mt,Et,At,kt,Je),Qt=g.getPitchedTextCorrection(et.x+H[0],et.y+H[1],X),Ht=C1(it.point,Xe,r,er,-g.bearingInRadians,Qt),br=v.allowVerticalPlacement&&je.placedOrientation===s.ao.vertical?Math.PI/2:0;for(let Qr=0;Qr<je.numGlyphs;Qr++)s.av(de,Ht,br);F&&je.associatedIconIndex>=0&&(Fe[je.associatedIconIndex]={shiftedAnchor:Ht,angle:br})}else Wr(je.numGlyphs,de)}if(F){Ae.clear();const De=v.icon.placedSymbolArray;for(let je=0;je<De.length;je++){const Ue=De.get(je);if(Ue.hidden)Wr(Ue.numGlyphs,Ae);else{const et=Fe[je];if(et)for(let Xe=0;Xe<Ue.numGlyphs;Xe++)s.av(Ae,et.shiftedAnchor,et.angle);else Wr(Ue.numGlyphs,Ae)}}v.icon.dynamicLayoutVertexBuffer.updateData(Ae)}v.text.dynamicLayoutVertexBuffer.updateData(de)}function zh(v,r,c){return c.iconsInText&&r?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function xc(v,r,c,f,g,y,x,R,F,H,X,ae,ee){const de=v.context,Ae=de.gl,Fe=v.transform,De=R==="map",je=F==="map",Ue=R!=="viewport"&&c.layout.get("symbol-placement")!=="point",et=De&&!je&&!Ue,Xe=!c.layout.get("symbol-sort-key").isConstant();let it=!1;const dt=v.getDepthModeForSublayer(0,Yr.ReadOnly),Je=c._unevaluatedLayout.hasValue("text-variable-anchor")||c._unevaluatedLayout.hasValue("text-variable-anchor-offset"),mt=[],Et=Fe.getCircleRadiusCorrection();for(const xt of f){const At=r.getTile(xt),kt=At.getBucket(c);if(!kt)continue;const er=g?kt.text:kt.icon;if(!er||!er.segments.get().length||!er.hasVisibleVertices)continue;const Qt=er.programConfigurations.get(c.id),Ht=g||kt.sdfIcons,br=g?kt.textSizeData:kt.iconSizeData,Qr=je||Fe.pitch!==0,ki=v.useProgram(zh(Ht,g,kt),Qt),Ji=s.an(br,Fe.zoom),qi=v.style.map.terrain&&v.style.map.terrain.getTerrainData(xt);let an,Qi,Fn,en,Di=[0,0],cn=null;if(g)Qi=At.glyphAtlasTexture,Fn=Ae.LINEAR,an=At.glyphAtlasTexture.size,kt.iconsInText&&(Di=At.imageAtlasTexture.size,cn=At.imageAtlasTexture,en=Qr||v.options.rotating||v.options.zooming||br.kind==="composite"||br.kind==="camera"?Ae.LINEAR:Ae.NEAREST);else{const Sn=c.layout.get("icon-size").constantOr(0)!==1||kt.iconsNeedLinear;Qi=At.imageAtlasTexture,Fn=Ht||v.options.rotating||v.options.zooming||Sn||Qr?Ae.LINEAR:Ae.NEAREST,an=At.imageAtlasTexture.size}const ri=s.aC(At,1,v.transform.zoom),Jn=M(De,v.transform,ri),ka=s.L();s.aq(ka,Jn);const el=P(je,De,v.transform,ri),to=s.aD(Fe,At,y,x),tl=Fe.getProjectionData({overscaledTileID:xt,applyGlobeMatrix:!ee,applyTerrainMatrix:!0}),Lc=Je&&kt.hasTextData(),ro=c.layout.get("icon-text-fit")!=="none"&&Lc&&kt.hasIconData();if(Ue){const Sn=v.style.map.terrain?(fs,tn)=>v.style.map.terrain.getElevation(xt,fs,tn):null,Pn=c.layout.get("text-rotation-alignment")==="map";U(kt,v,g,Jn,ka,je,H,Pn,xt.toUnwrapped(),Fe.width,Fe.height,to,Sn)}const rl=g&&Je||ro,Cs=Ue||rl?T1:je?Jn:v.transform.clipSpaceToPixelsMatrix,io=Ht&&c.paint.get(g?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ra;Ra=Ht?kt.iconsInText?y1(br.kind,Ji,et,je,Ue,rl,v,Cs,el,to,an,Di,Et):d0(br.kind,Ji,et,je,Ue,rl,v,Cs,el,to,g,an,0,Et):vc(br.kind,Ji,et,je,Ue,rl,v,Cs,el,to,g,an,Et);const no={program:ki,buffers:er,uniformValues:Ra,projectionData:tl,atlasTexture:Qi,atlasTextureIcon:cn,atlasInterpolation:Fn,atlasInterpolationIcon:en,isSDF:Ht,hasHalo:io};if(Xe&&kt.canOverlap){it=!0;const Sn=er.segments.get();for(const Pn of Sn)mt.push({segments:new s.aM([Pn]),sortKey:Pn.sortKey,state:no,terrainData:qi})}else mt.push({segments:er.segments,sortKey:0,state:no,terrainData:qi})}it&&mt.sort((xt,At)=>xt.sortKey-At.sortKey);for(const xt of mt){const At=xt.state;if(de.activeTexture.set(Ae.TEXTURE0),At.atlasTexture.bind(At.atlasInterpolation,Ae.CLAMP_TO_EDGE),At.atlasTextureIcon&&(de.activeTexture.set(Ae.TEXTURE1),At.atlasTextureIcon&&At.atlasTextureIcon.bind(At.atlasInterpolationIcon,Ae.CLAMP_TO_EDGE)),At.isSDF){const kt=At.uniformValues;At.hasHalo&&(kt.u_is_halo=1,Mc(At.buffers,xt.segments,c,v,At.program,dt,X,ae,kt,At.projectionData,xt.terrainData)),kt.u_is_halo=0}Mc(At.buffers,xt.segments,c,v,At.program,dt,X,ae,At.uniformValues,At.projectionData,xt.terrainData)}}function Mc(v,r,c,f,g,y,x,R,F,H,X){const ae=f.context;g.draw(ae,ae.gl.TRIANGLES,y,x,R,jr.backCCW,F,X,H,c.id,v.layoutVertexBuffer,v.indexBuffer,r,c.paint,f.transform.zoom,v.programConfigurations.get(c.id),v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer)}function Sd(v,r,c,f,g){const y=v.context,x=y.gl,R=yi.disabled,F=new Ki([x.ONE,x.ONE],s.bf.transparent,[!0,!0,!0,!0]),H=r.getBucket(c);if(!H)return;const X=f.key;let ae=c.heatmapFbos.get(X);ae||(ae=Ic(y,r.tileSize,r.tileSize),c.heatmapFbos.set(X,ae)),y.bindFramebuffer.set(ae.framebuffer),y.viewport.set([0,0,r.tileSize,r.tileSize]),y.clear({color:s.bf.transparent});const ee=H.programConfigurations.get(c.id),de=v.useProgram("heatmap",ee,!g),Ae=v.transform.getProjectionData({overscaledTileID:r.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Fe=v.style.map.terrain.getTerrainData(f);de.draw(y,x.TRIANGLES,Yr.disabled,R,F,jr.disabled,o0(r,v.transform.zoom,c.paint.get("heatmap-intensity"),1),Fe,Ae,c.id,H.layoutVertexBuffer,H.indexBuffer,H.segments,c.paint,v.transform.zoom,ee)}function T0(v,r,c,f,g){const y=v.context,x=y.gl,R=v.transform;y.setColorMode(v.colorModeForRenderPass());const F=Ac(y,r),H=c.key,X=r.heatmapFbos.get(H);if(!X)return;y.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,X.colorAttachment.get()),y.activeTexture.set(x.TEXTURE1),F.bind(x.LINEAR,x.CLAMP_TO_EDGE);const ae=R.getProjectionData({overscaledTileID:c,applyTerrainMatrix:g,applyGlobeMatrix:!f});v.useProgram("heatmapTexture").draw(y,x.TRIANGLES,Yr.disabled,yi.disabled,v.colorModeForRenderPass(),jr.disabled,pd(v,r,0,1),null,ae,r.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments,r.paint,R.zoom),X.destroy(),r.heatmapFbos.delete(H)}function Ic(v,r,c){var f,g;const y=v.gl,x=y.createTexture();y.bindTexture(y.TEXTURE_2D,x),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR);const R=(f=v.HALF_FLOAT)!==null&&f!==void 0?f:y.UNSIGNED_BYTE,F=(g=v.RGBA16F)!==null&&g!==void 0?g:y.RGBA;y.texImage2D(y.TEXTURE_2D,0,F,r,c,0,y.RGBA,R,null);const H=v.createFramebuffer(r,c,!1,!1);return H.colorAttachment.set(x),H}function Ac(v,r){return r.colorRampTexture||(r.colorRampTexture=new s.T(v,r.colorRamp,v.gl.RGBA)),r.colorRampTexture}function Tc(v,r,c,f,g){if(!c||!f||!f.imageAtlas)return;const y=f.imageAtlas.patternPositions;let x=y[c.to.toString()],R=y[c.from.toString()];if(!x&&R&&(x=R),!R&&x&&(R=x),!x||!R){const F=g.getPaintProperty(r);x=y[F],R=y[F]}x&&R&&v.setConstantPatternPositions(x,R)}function Uo(v,r,c,f,g,y,x,R){const F=v.context.gl,H="fill-pattern",X=c.paint.get(H),ae=X&&X.constantOr(1),ee=c.getCrossfadeParameters();let de,Ae,Fe,De,je;const Ue=v.transform,et=c.paint.get("fill-translate"),Xe=c.paint.get("fill-translate-anchor");x?(Ae=ae&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",de=F.LINES):(Ae=ae?"fillPattern":"fill",de=F.TRIANGLES);const it=X.constantOr(null);for(const dt of f){const Je=r.getTile(dt);if(ae&&!Je.patternsLoaded())continue;const mt=Je.getBucket(c);if(!mt)continue;const Et=mt.programConfigurations.get(c.id),xt=v.useProgram(Ae,Et),At=v.style.map.terrain&&v.style.map.terrain.getTerrainData(dt);ae&&(v.context.activeTexture.set(F.TEXTURE0),Je.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Et.updatePaintBuffers(ee)),Tc(Et,H,it,Je,c);const kt=Ue.getProjectionData({overscaledTileID:dt,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),er=s.aD(Ue,Je,et,Xe);if(x){De=mt.indexBuffer2,je=mt.segments2;const Ht=[F.drawingBufferWidth,F.drawingBufferHeight];Fe=Ae==="fillOutlinePattern"&&ae?gc(v,ee,Je,Ht,er):mc(Ht,er)}else De=mt.indexBuffer,je=mt.segments,Fe=ae?Ih(v,ee,Je,er):{u_fill_translate:er};const Qt=v.stencilModeForClipping(dt);xt.draw(v.context,de,g,Qt,y,jr.backCCW,Fe,At,kt,c.id,mt.layoutVertexBuffer,De,je,c.paint,v.transform.zoom,Et)}}function Cc(v,r,c,f,g,y,x,R){const F=v.context,H=F.gl,X="fill-extrusion-pattern",ae=c.paint.get(X),ee=ae.constantOr(1),de=c.getCrossfadeParameters(),Ae=c.paint.get("fill-extrusion-opacity"),Fe=ae.constantOr(null),De=v.transform;for(const je of f){const Ue=r.getTile(je),et=Ue.getBucket(c);if(!et)continue;const Xe=v.style.map.terrain&&v.style.map.terrain.getTerrainData(je),it=et.programConfigurations.get(c.id),dt=v.useProgram(ee?"fillExtrusionPattern":"fillExtrusion",it);ee&&(v.context.activeTexture.set(H.TEXTURE0),Ue.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),it.updatePaintBuffers(de));const Je=De.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!R,applyTerrainMatrix:!0});Tc(it,X,Fe,Ue,c);const mt=s.aD(De,Ue,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Et=c.paint.get("fill-extrusion-vertical-gradient"),xt=ee?p1(v,Et,Ae,mt,je,de,Ue):Js(v,Et,Ae,mt);dt.draw(F,F.gl.TRIANGLES,g,y,x,jr.backCCW,xt,Xe,Je,c.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,c.paint,v.transform.zoom,it,v.style.map.terrain&&et.centroidVertexBuffer)}}function Pd(v,r,c,f,g,y,x,R,F){var H;const X=v.style.projection,ae=v.context,ee=v.transform,de=ae.gl,Ae=[`#define NUM_ILLUMINATION_SOURCES ${c.paint.get("hillshade-highlight-color").values.length}`],Fe=v.useProgram("hillshade",null,!1,Ae),De=!v.options.moving;for(const je of f){const Ue=r.getTile(je),et=Ue.fbo;if(!et)continue;const Xe=X.getMeshFromTileID(ae,je.canonical,R,!0,"raster"),it=(H=v.style.map.terrain)===null||H===void 0?void 0:H.getTerrainData(je);ae.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,et.colorAttachment.get());const dt=ee.getProjectionData({overscaledTileID:je,aligned:De,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Fe.draw(ae,de.TRIANGLES,y,g[je.overscaledZ],x,jr.backCCW,_1(v,Ue,c),it,dt,c.id,Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)}}function Ho(v,r,c,f,g,y,x,R,F){var H;const X=v.style.projection,ae=v.context,ee=v.transform,de=ae.gl,Ae=v.useProgram("colorRelief"),Fe=!v.options.moving;let De=!0,je=0;for(const Ue of f){const et=r.getTile(Ue),Xe=et.dem;if(De){const xt=de.getParameter(de.MAX_TEXTURE_SIZE),{elevationTexture:At,colorTexture:kt}=c.getColorRampTextures(ae,xt,Xe.getUnpackVector());ae.activeTexture.set(de.TEXTURE1),At.bind(de.NEAREST,de.CLAMP_TO_EDGE),ae.activeTexture.set(de.TEXTURE4),kt.bind(de.LINEAR,de.CLAMP_TO_EDGE),De=!1,je=At.size[0]}if(!Xe||!Xe.data)continue;const it=Xe.stride,dt=Xe.getPixels();if(ae.activeTexture.set(de.TEXTURE0),ae.pixelStoreUnpackPremultiplyAlpha.set(!1),et.demTexture=et.demTexture||v.getTileTexture(it),et.demTexture){const xt=et.demTexture;xt.update(dt,{premultiply:!1}),xt.bind(de.LINEAR,de.CLAMP_TO_EDGE)}else et.demTexture=new s.T(ae,dt,de.RGBA,{premultiply:!1}),et.demTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE);const Je=X.getMeshFromTileID(ae,Ue.canonical,R,!0,"raster"),mt=(H=v.style.map.terrain)===null||H===void 0?void 0:H.getTerrainData(Ue),Et=ee.getProjectionData({overscaledTileID:Ue,aligned:Fe,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Ae.draw(ae,de.TRIANGLES,y,g[Ue.overscaledZ],x,jr.backCCW,c0(c,et.dem,je),mt,Et,c.id,Je.vertexBuffer,Je.indexBuffer,Je.segments)}}const Ed=[new s.P(0,0),new s.P(s.$,0),new s.P(s.$,s.$),new s.P(0,s.$)];function Sc(v,r,c,f,g,y,x,R,F=!1,H=!1){const X=f[f.length-1].overscaledZ,ae=v.context,ee=ae.gl,de=v.useProgram("raster"),Ae=v.transform,Fe=v.style.projection,De=v.colorModeForRenderPass(),je=!v.options.moving;for(const Ue of f){const et=v.getDepthModeForSublayer(Ue.overscaledZ-X,c.paint.get("raster-opacity")===1?Yr.ReadWrite:Yr.ReadOnly,ee.LESS),Xe=r.getTile(Ue);Xe.registerFadeDuration(c.paint.get("raster-fade-duration"));const it=r.findLoadedParent(Ue,0),dt=r.findLoadedSibling(Ue),Je=Fh(Xe,it||dt||null,r,c,v.transform,v.style.map.terrain);let mt,Et;const xt=c.paint.get("raster-resampling")==="nearest"?ee.NEAREST:ee.LINEAR;ae.activeTexture.set(ee.TEXTURE0),Xe.texture.bind(xt,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST),ae.activeTexture.set(ee.TEXTURE1),it?(it.texture.bind(xt,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST),mt=Math.pow(2,it.tileID.overscaledZ-Xe.tileID.overscaledZ),Et=[Xe.tileID.canonical.x*mt%1,Xe.tileID.canonical.y*mt%1]):Xe.texture.bind(xt,ee.CLAMP_TO_EDGE,ee.LINEAR_MIPMAP_NEAREST),Xe.texture.useMipmap&&ae.extTextureFilterAnisotropic&&v.transform.pitch>20&&ee.texParameterf(ee.TEXTURE_2D,ae.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ae.extTextureFilterAnisotropicMax);const At=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Ue),kt=Ae.getProjectionData({overscaledTileID:Ue,aligned:je,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),er=_c(Et||[0,0],mt||1,Je,c,R),Qt=Fe.getMeshFromTileID(ae,Ue.canonical,y,x,"raster");de.draw(ae,ee.TRIANGLES,et,g?g[Ue.overscaledZ]:yi.disabled,De,F?jr.frontCCW:jr.backCCW,er,At,kt,c.id,Qt.vertexBuffer,Qt.indexBuffer,Qt.segments)}}function Fh(v,r,c,f,g,y){const x=f.paint.get("raster-fade-duration");if(!y&&x>0){const R=D.now(),F=(R-v.timeAdded)/x,H=r?(R-r.timeAdded)/x:-1,X=c.getSource(),ae=sr(g,{tileSize:X.tileSize,roundZoom:X.roundZoom}),ee=!r||Math.abs(r.tileID.overscaledZ-ae)>Math.abs(v.tileID.overscaledZ-ae),de=ee&&v.refreshedUponExpiration?1:s.ah(ee?F:1-H,0,1);return v.refreshedUponExpiration&&F>=1&&(v.refreshedUponExpiration=!1),r?{opacity:1,mix:1-de}:{opacity:de,mix:0}}return{opacity:1,mix:0}}const kd=new s.bf(1,0,0,1),C0=new s.bf(0,1,0,1),S0=new s.bf(0,0,1,1),Dh=new s.bf(1,0,1,1),Rd=new s.bf(0,1,1,1);function P0(v,r,c,f){sn(v,0,r+c/2,v.transform.width,c,f)}function Ld(v,r,c,f){sn(v,r-c/2,0,c,v.transform.height,f)}function sn(v,r,c,f,g,y){const x=v.context,R=x.gl;R.enable(R.SCISSOR_TEST),R.scissor(r*v.pixelRatio,c*v.pixelRatio,f*v.pixelRatio,g*v.pixelRatio),x.clear({color:y}),R.disable(R.SCISSOR_TEST)}function Wo(v,r,c){const f=v.context,g=f.gl,y=v.useProgram("debug"),x=Yr.disabled,R=yi.disabled,F=v.colorModeForRenderPass(),H="$debug",X=v.style.map.terrain&&v.style.map.terrain.getTerrainData(c);f.activeTexture.set(g.TEXTURE0);const ae=r.getTileByID(c.key).latestRawTileData,ee=Math.floor((ae&&ae.byteLength||0)/1024),de=r.getTile(c).tileSize,Ae=512/Math.min(de,512)*(c.overscaledZ/v.transform.zoom)*.5;let Fe=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Fe+=` => ${c.overscaledZ}`),function(je,Ue){je.initDebugOverlayCanvas();const et=je.debugOverlayCanvas,Xe=je.context.gl,it=je.debugOverlayCanvas.getContext("2d");it.clearRect(0,0,et.width,et.height),it.shadowColor="white",it.shadowBlur=2,it.lineWidth=1.5,it.strokeStyle="white",it.textBaseline="top",it.font="bold 36px Open Sans, sans-serif",it.fillText(Ue,5,5),it.strokeText(Ue,5,5),je.debugOverlayTexture.update(et),je.debugOverlayTexture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE)}(v,`${Fe} ${ee}kB`);const De=v.transform.getProjectionData({overscaledTileID:c,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(f,g.TRIANGLES,x,R,Ki.alphaBlended,jr.disabled,Vo(s.bf.transparent,Ae),null,De,H,v.debugBuffer,v.quadTriangleIndexBuffer,v.debugSegments),y.draw(f,g.LINE_STRIP,x,R,F,jr.disabled,Vo(s.bf.red),X,De,H,v.debugBuffer,v.tileBorderIndexBuffer,v.debugSegments)}function Ts(v,r,c,f){const{isRenderingGlobe:g}=f,y=v.context,x=y.gl,R=v.transform,F=v.colorModeForRenderPass(),H=v.getDepthModeFor3D(),X=v.useProgram("terrain");y.bindFramebuffer.set(null),y.viewport.set([0,0,v.width,v.height]);for(const ae of c){const ee=r.getTerrainMesh(ae.tileID),de=v.renderToTexture.getTexture(ae),Ae=r.getTerrainData(ae.tileID);y.activeTexture.set(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,de.texture);const Fe=r.getMeshFrameDelta(R.zoom),De=R.calculateFogMatrix(ae.tileID.toUnwrapped()),je=xh(Fe,De,v.style.sky,R.pitch,g),Ue=R.getProjectionData({overscaledTileID:ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});X.draw(y,x.TRIANGLES,H,yi.disabled,F,jr.backCCW,je,Ae,Ue,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments)}}function Bh(v,r){if(!r.mesh){const c=new s.aL;c.emplaceBack(-1,-1),c.emplaceBack(1,-1),c.emplaceBack(1,1),c.emplaceBack(-1,1);const f=new s.aN;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),r.mesh=new Lo(v.createVertexBuffer(c,$a.members),v.createIndexBuffer(f),s.aM.simpleSegment(0,0,c.length,f.length))}return r.mesh}class Gh{constructor(r,c){this.context=new M0(r),this.transform=c,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ct.maxUnderzooming+Ct.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ka}resize(r,c,f){if(this.width=Math.floor(r*f),this.height=Math.floor(c*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style._order)this.style._layers[g].resize()}setup(){const r=this.context,c=new s.aL;c.emplaceBack(0,0),c.emplaceBack(s.$,0),c.emplaceBack(0,s.$),c.emplaceBack(s.$,s.$),this.tileExtentBuffer=r.createVertexBuffer(c,$a.members),this.tileExtentSegments=s.aM.simpleSegment(0,0,4,2);const f=new s.aL;f.emplaceBack(0,0),f.emplaceBack(s.$,0),f.emplaceBack(0,s.$),f.emplaceBack(s.$,s.$),this.debugBuffer=r.createVertexBuffer(f,$a.members),this.debugSegments=s.aM.simpleSegment(0,0,4,5);const g=new s.c6;g.emplaceBack(0,0,0,0),g.emplaceBack(s.$,0,s.$,0),g.emplaceBack(0,s.$,0,s.$),g.emplaceBack(s.$,s.$,s.$,s.$),this.rasterBoundsBuffer=r.createVertexBuffer(g,d1.members),this.rasterBoundsSegments=s.aM.simpleSegment(0,0,4,2);const y=new s.aL;y.emplaceBack(0,0),y.emplaceBack(s.$,0),y.emplaceBack(0,s.$),y.emplaceBack(s.$,s.$),this.rasterBoundsBufferPosOnly=r.createVertexBuffer(y,$a.members),this.rasterBoundsSegmentsPosOnly=s.aM.simpleSegment(0,0,4,5);const x=new s.aL;x.emplaceBack(0,0),x.emplaceBack(1,0),x.emplaceBack(0,1),x.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(x,$a.members),this.viewportSegments=s.aM.simpleSegment(0,0,4,2);const R=new s.c7;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(R);const F=new s.aN;F.emplaceBack(1,0,2),F.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(F);const H=this.context.gl;this.stencilClearMode=new yi({func:H.ALWAYS,mask:0},0,255,H.ZERO,H.ZERO,H.ZERO),this.tileExtentMesh=new Lo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const r=this.context,c=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=s.L();s.bY(f,0,this.width,this.height,0,0,1),s.N(f,f,[c.drawingBufferWidth,c.drawingBufferHeight,0]);const g={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(r,c.TRIANGLES,Yr.disabled,this.stencilClearMode,Ki.disabled,jr.disabled,null,null,g,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,c,f){if(this.currentStencilSource===r.source||!r.isTileClipped()||!c||!c.length)return;this.currentStencilSource=r.source,this.nextStencilID+c.length>256&&this.clearStencil();const g=this.context;g.setColorMode(Ki.disabled),g.setDepthMode(Yr.disabled);const y={};for(const x of c)y[x.key]=this.nextStencilID++;this._renderTileMasks(y,c,f,!0),this._renderTileMasks(y,c,f,!1),this._tileClippingMaskIDs=y}_renderTileMasks(r,c,f,g){const y=this.context,x=y.gl,R=this.style.projection,F=this.transform,H=this.useProgram("clippingMask");for(const X of c){const ae=r[X.key],ee=this.style.map.terrain&&this.style.map.terrain.getTerrainData(X),de=R.getMeshFromTileID(this.context,X.canonical,g,!0,"stencil"),Ae=F.getProjectionData({overscaledTileID:X,applyGlobeMatrix:!f,applyTerrainMatrix:!0});H.draw(y,x.TRIANGLES,Yr.disabled,new yi({func:x.ALWAYS,mask:0},ae,255,x.KEEP,x.KEEP,x.REPLACE),Ki.disabled,f?jr.disabled:jr.backCCW,null,ee,Ae,"$clipping",de.vertexBuffer,de.indexBuffer,de.segments)}}_renderTilesDepthBuffer(){const r=this.context,c=r.gl,f=this.style.projection,g=this.transform,y=this.useProgram("depth"),x=this.getDepthModeFor3D(),R=st(g,{tileSize:g.tileSize});for(const F of R){const H=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),X=f.getMeshFromTileID(this.context,F.canonical,!0,!0,"raster"),ae=g.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!0,applyTerrainMatrix:!0});y.draw(r,c.TRIANGLES,x,yi.disabled,Ki.disabled,jr.backCCW,null,H,ae,"$clipping",X.vertexBuffer,X.indexBuffer,X.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,c=this.context.gl;return new yi({func:c.NOTEQUAL,mask:255},r,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(r){const c=this.context.gl;return new yi({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,c.KEEP,c.KEEP,c.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(r){const c=this.context.gl,f=r.sort((x,R)=>R.overscaledZ-x.overscaledZ),g=f[f.length-1].overscaledZ,y=f[0].overscaledZ-g+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const x={};for(let R=0;R<y;R++)x[R+g]=new yi({func:c.GEQUAL,mask:255},R+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=y,[x,f]}return[{[g]:yi.disabled},f]}stencilConfigForOverlapTwoPass(r){const c=this.context.gl,f=r.sort((x,R)=>R.overscaledZ-x.overscaledZ),g=f[f.length-1].overscaledZ,y=f[0].overscaledZ-g+1;if(this.clearStencil(),y>1){const x={},R={};for(let F=0;F<y;F++)x[F+g]=new yi({func:c.GREATER,mask:255},y+1+F,255,c.KEEP,c.KEEP,c.REPLACE),R[F+g]=new yi({func:c.GREATER,mask:255},1+F,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID=2*y+1,[x,R,f]}return this.nextStencilID=3,[{[g]:new yi({func:c.GREATER,mask:255},2,255,c.KEEP,c.KEEP,c.REPLACE)},{[g]:new yi({func:c.GREATER,mask:255},1,255,c.KEEP,c.KEEP,c.REPLACE)},f]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Ki([r.CONSTANT_COLOR,r.ONE],new s.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ki.unblended:Ki.alphaBlended}getDepthModeForSublayer(r,c,f){if(!this.opaquePassEnabledForLayer())return Yr.disabled;const g=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Yr(f||this.context.gl.LEQUAL,c,[g,g])}getDepthModeFor3D(){return new Yr(this.context.gl.LEQUAL,Yr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,c){var f,g;this.style=r,this.options=c,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(D.now()),this.imageManager.beginFrame();const y=this.style._order,x=this.style.sourceCaches,R={},F={},H={},X={isRenderingToTexture:!1,isRenderingGlobe:((f=r.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const ee in x){const de=x[ee];de.used&&de.prepare(this.context),R[ee]=de.getVisibleCoordinates(!1),F[ee]=R[ee].slice().reverse(),H[ee]=de.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ee=0;ee<y.length;ee++)if(this.style._layers[y[ee]].is3D()){this.opaquePassCutoff=ee;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const ee of y){const de=this.style._layers[ee];if(!de.hasOffscreenPass()||de.isHidden(this.transform.zoom))continue;const Ae=F[de.source];(de.type==="custom"||Ae.length)&&this.renderLayer(this,x[de.source],de,Ae,X)}if((g=this.style.projection)===null||g===void 0||g.updateGPUdependent({context:this.context,useProgram:ee=>this.useProgram(ee)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?s.bf.black:s.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(ee,de){const Ae=ee.context,Fe=Ae.gl,De=((dt,Je,mt)=>{const Et=Math.cos(Je.rollInRadians),xt=Math.sin(Je.rollInRadians),At=He(Je),kt=Je.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:dt.properties.get("sky-color"),u_horizon_color:dt.properties.get("horizon-color"),u_horizon:[(Je.width/2-At*xt)*mt,(Je.height/2+At*Et)*mt],u_horizon_normal:[-xt,Et],u_sky_horizon_blend:dt.properties.get("sky-horizon-blend")*Je.height/2*mt,u_sky_blend:kt}})(de,ee.style.map.transform,ee.pixelRatio),je=new Yr(Fe.LEQUAL,Yr.ReadWrite,[0,1]),Ue=yi.disabled,et=ee.colorModeForRenderPass(),Xe=ee.useProgram("sky"),it=Bh(Ae,de);Xe.draw(Ae,Fe.TRIANGLES,je,Ue,et,jr.disabled,De,null,void 0,"sky",it.vertexBuffer,it.indexBuffer,it.segments)}(this,this.style.sky),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const ee=this.style._layers[y[this.currentLayer]],de=x[ee.source],Ae=R[ee.source];this._renderTileClippingMasks(ee,Ae,!1),this.renderLayer(this,de,ee,Ae,X)}this.renderPass="translucent";let ae=!1;for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const ee=this.style._layers[y[this.currentLayer]],de=x[ee.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(ee,X))continue;this.opaquePassEnabledForLayer()||ae||(ae=!0,X.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Ae=(ee.type==="symbol"?H:F)[ee.source];this._renderTileClippingMasks(ee,R[ee.source],!!this.renderToTexture),this.renderLayer(this,de,ee,Ae,X)}if(X.isRenderingGlobe&&function(ee,de,Ae){const Fe=ee.context,De=Fe.gl,je=ee.useProgram("atmosphere"),Ue=new Yr(De.LEQUAL,Yr.ReadOnly,[0,1]),et=ee.transform,Xe=function(kt,er){const Qt=kt.properties.get("position"),Ht=[-Qt.x,-Qt.y,-Qt.z],br=s.ag(new Float64Array(16));return kt.properties.get("anchor")==="map"&&(s.b6(br,br,er.rollInRadians),s.b7(br,br,-er.pitchInRadians),s.b6(br,br,er.bearingInRadians),s.b7(br,br,er.center.lat*Math.PI/180),s.bz(br,br,-er.center.lng*Math.PI/180)),s.c5(Ht,Ht,br),Ht}(Ae,ee.transform),it=et.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),dt=de.properties.get("atmosphere-blend")*it.projectionTransition;if(dt===0)return;const Je=Ml(et.worldSize,et.center.lat),mt=et.inverseProjectionMatrix,Et=new Float64Array(4);Et[3]=1,s.aw(Et,Et,et.modelViewProjectionMatrix),Et[0]/=Et[3],Et[1]/=Et[3],Et[2]/=Et[3],Et[3]=1,s.aw(Et,Et,mt),Et[0]/=Et[3],Et[1]/=Et[3],Et[2]/=Et[3],Et[3]=1;const xt=((kt,er,Qt,Ht,br)=>({u_sun_pos:kt,u_atmosphere_blend:er,u_globe_position:Qt,u_globe_radius:Ht,u_inv_proj_matrix:br}))(Xe,dt,[Et[0],Et[1],Et[2]],Je,mt),At=Bh(Fe,de);je.draw(Fe,De.TRIANGLES,Ue,yi.disabled,Ki.alphaBlended,jr.disabled,xt,null,null,"atmosphere",At.vertexBuffer,At.indexBuffer,At.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const ee=function(de,Ae){let Fe=null;const De=Object.values(de._layers).flatMap(Xe=>Xe.source&&!Xe.isHidden(Ae)?[de.sourceCaches[Xe.source]]:[]),je=De.filter(Xe=>Xe.getSource().type==="vector"),Ue=De.filter(Xe=>Xe.getSource().type!=="vector"),et=Xe=>{(!Fe||Fe.getSource().maxzoom<Xe.getSource().maxzoom)&&(Fe=Xe)};return je.forEach(Xe=>et(Xe)),Fe||Ue.forEach(Xe=>et(Xe)),Fe}(this.style,this.transform.zoom);ee&&function(de,Ae,Fe){for(let De=0;De<Fe.length;De++)Wo(de,Ae,Fe[De])}(this,ee,ee.getVisibleCoordinates())}this.options.showPadding&&function(ee){const de=ee.transform.padding;P0(ee,ee.transform.height-(de.top||0),3,kd),P0(ee,de.bottom||0,3,C0),Ld(ee,de.left||0,3,S0),Ld(ee,ee.transform.width-(de.right||0),3,Dh);const Ae=ee.transform.centerPoint;(function(Fe,De,je,Ue){sn(Fe,De-1,je-10,2,20,Ue),sn(Fe,De-10,je-1,20,2,Ue)})(ee,Ae.x,ee.transform.height-Ae.y,Rd)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(r){if(!this.style||!this.style.map||!this.style.map.terrain)return;const c=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let g=this.terrainFacilitator.dirty;g||(g=r?!s.c8(c,f):!s.c9(c,f)),g||(g=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),g&&(s.ca(c,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,x){const R=y.context,F=R.gl,H=y.transform,X=Ki.unblended,ae=new Yr(F.LEQUAL,Yr.ReadWrite,[0,1]),ee=x.sourceCache.getRenderableTiles(),de=y.useProgram("terrainDepth");R.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),R.clear({color:s.bf.transparent,depth:1});for(const Ae of ee){const Fe=x.getTerrainMesh(Ae.tileID),De=x.getTerrainData(Ae.tileID),je=H.getProjectionData({overscaledTileID:Ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Ue={u_ele_delta:x.getMeshFrameDelta(H.zoom)};de.draw(R,F.TRIANGLES,ae,yi.disabled,X,jr.backCCW,Ue,De,je,"terrain",Fe.vertexBuffer,Fe.indexBuffer,Fe.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,x){const R=y.context,F=R.gl,H=y.transform,X=Ki.unblended,ae=new Yr(F.LEQUAL,Yr.ReadWrite,[0,1]),ee=x.getCoordsTexture(),de=x.sourceCache.getRenderableTiles(),Ae=y.useProgram("terrainCoords");R.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),R.clear({color:s.bf.transparent,depth:1}),x.coordsIndex=[];for(const Fe of de){const De=x.getTerrainMesh(Fe.tileID),je=x.getTerrainData(Fe.tileID);R.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,ee.texture);const Ue={u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(H.zoom)},et=H.getProjectionData({overscaledTileID:Fe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Ae.draw(R,F.TRIANGLES,ae,yi.disabled,X,jr.backCCW,Ue,je,et,"terrain",De.vertexBuffer,De.indexBuffer,De.segments),x.coordsIndex.push(Fe.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(r,c,f,g,y){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(g||[]).length)&&(this.id=f.id,s.cb(f)?function(x,R,F,H,X,ae){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:ee}=ae,de=yi.disabled,Ae=x.colorModeForRenderPass();(F._unevaluatedLayout.hasValue("text-variable-anchor")||F._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Fe,De,je,Ue,et,Xe,it,dt,Je){const mt=De.transform,Et=De.style.map.terrain,xt=et==="map",At=Xe==="map";for(const kt of Fe){const er=Ue.getTile(kt),Qt=er.getBucket(je);if(!Qt||!Qt.text||!Qt.text.segments.get().length)continue;const Ht=s.an(Qt.textSizeData,mt.zoom),br=s.aC(er,1,De.transform.zoom),Qr=M(xt,De.transform,br),ki=je.layout.get("icon-text-fit")!=="none"&&Qt.hasIconData();if(Ht){const Ji=Math.pow(2,mt.zoom-er.tileID.overscaledZ),qi=Et?(an,Qi)=>Et.getElevation(kt,an,Qi):null;Cd(Qt,xt,At,Je,mt,Qr,Ji,Ht,ki,s.aD(mt,er,it,dt),kt.toUnwrapped(),qi)}}}(H,x,F,R,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),X),F.paint.get("icon-opacity").constantOr(1)!==0&&xc(x,R,F,H,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),de,Ae,ee),F.paint.get("text-opacity").constantOr(1)!==0&&xc(x,R,F,H,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),de,Ae,ee),R.map.showCollisionBoxes&&(I0(x,R,F,H,!0),I0(x,R,F,H,!1))}(r,c,f,g,this.style.placement.variableOffsets,y):s.cc(f)?function(x,R,F,H,X){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:ae}=X,ee=F.paint.get("circle-opacity"),de=F.paint.get("circle-stroke-width"),Ae=F.paint.get("circle-stroke-opacity"),Fe=!F.layout.get("circle-sort-key").isConstant();if(ee.constantOr(1)===0&&(de.constantOr(1)===0||Ae.constantOr(1)===0))return;const De=x.context,je=De.gl,Ue=x.transform,et=x.getDepthModeForSublayer(0,Yr.ReadOnly),Xe=yi.disabled,it=x.colorModeForRenderPass(),dt=[],Je=Ue.getCircleRadiusCorrection();for(let mt=0;mt<H.length;mt++){const Et=H[mt],xt=R.getTile(Et),At=xt.getBucket(F);if(!At)continue;const kt=F.paint.get("circle-translate"),er=F.paint.get("circle-translate-anchor"),Qt=s.aD(Ue,xt,kt,er),Ht=At.programConfigurations.get(F.id),br=x.useProgram("circle",Ht),Qr=At.layoutVertexBuffer,ki=At.indexBuffer,Ji=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Et),qi={programConfiguration:Ht,program:br,layoutVertexBuffer:Qr,indexBuffer:ki,uniformValues:m1(x,xt,F,Qt,Je),terrainData:Ji,projectionData:Ue.getProjectionData({overscaledTileID:Et,applyGlobeMatrix:!ae,applyTerrainMatrix:!0})};if(Fe){const an=At.segments.get();for(const Qi of an)dt.push({segments:new s.aM([Qi]),sortKey:Qi.sortKey,state:qi})}else dt.push({segments:At.segments,sortKey:0,state:qi})}Fe&&dt.sort((mt,Et)=>mt.sortKey-Et.sortKey);for(const mt of dt){const{programConfiguration:Et,program:xt,layoutVertexBuffer:At,indexBuffer:kt,uniformValues:er,terrainData:Qt,projectionData:Ht}=mt.state;xt.draw(De,je.TRIANGLES,et,Xe,it,jr.backCCW,er,Qt,Ht,F.id,At,kt,mt.segments,F.paint,x.transform.zoom,Et)}}(r,c,f,g,y):s.cd(f)?function(x,R,F,H,X){if(F.paint.get("heatmap-opacity")===0)return;const ae=x.context,{isRenderingToTexture:ee,isRenderingGlobe:de}=X;if(x.style.map.terrain){for(const Ae of H){const Fe=R.getTile(Ae);R.hasRenderableParent(Ae)||(x.renderPass==="offscreen"?Sd(x,Fe,F,Ae,de):x.renderPass==="translucent"&&T0(x,F,Ae,ee,de))}ae.viewport.set([0,0,x.width,x.height])}else x.renderPass==="offscreen"?function(Ae,Fe,De,je){const Ue=Ae.context,et=Ue.gl,Xe=Ae.transform,it=yi.disabled,dt=new Ki([et.ONE,et.ONE],s.bf.transparent,[!0,!0,!0,!0]);(function(Je,mt,Et){const xt=Je.gl;Je.activeTexture.set(xt.TEXTURE1),Je.viewport.set([0,0,mt.width/4,mt.height/4]);let At=Et.heatmapFbos.get(s.c2);At?(xt.bindTexture(xt.TEXTURE_2D,At.colorAttachment.get()),Je.bindFramebuffer.set(At.framebuffer)):(At=Ic(Je,mt.width/4,mt.height/4),Et.heatmapFbos.set(s.c2,At))})(Ue,Ae,De),Ue.clear({color:s.bf.transparent});for(let Je=0;Je<je.length;Je++){const mt=je[Je];if(Fe.hasRenderableParent(mt))continue;const Et=Fe.getTile(mt),xt=Et.getBucket(De);if(!xt)continue;const At=xt.programConfigurations.get(De.id),kt=Ae.useProgram("heatmap",At),er=Xe.getProjectionData({overscaledTileID:mt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Qt=Xe.getCircleRadiusCorrection();kt.draw(Ue,et.TRIANGLES,Yr.disabled,it,dt,jr.backCCW,o0(Et,Xe.zoom,De.paint.get("heatmap-intensity"),Qt),null,er,De.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,De.paint,Xe.zoom,At)}Ue.viewport.set([0,0,Ae.width,Ae.height])}(x,R,F,H):x.renderPass==="translucent"&&function(Ae,Fe){const De=Ae.context,je=De.gl;De.setColorMode(Ae.colorModeForRenderPass());const Ue=Fe.heatmapFbos.get(s.c2);Ue&&(De.activeTexture.set(je.TEXTURE0),je.bindTexture(je.TEXTURE_2D,Ue.colorAttachment.get()),De.activeTexture.set(je.TEXTURE1),Ac(De,Fe).bind(je.LINEAR,je.CLAMP_TO_EDGE),Ae.useProgram("heatmapTexture").draw(De,je.TRIANGLES,Yr.disabled,yi.disabled,Ae.colorModeForRenderPass(),jr.disabled,pd(Ae,Fe,0,1),null,null,Fe.id,Ae.viewportBuffer,Ae.quadTriangleIndexBuffer,Ae.viewportSegments,Fe.paint,Ae.transform.zoom))}(x,F)}(r,c,f,g,y):s.ce(f)?function(x,R,F,H,X){if(x.renderPass!=="translucent")return;const{isRenderingToTexture:ae}=X,ee=F.paint.get("line-opacity"),de=F.paint.get("line-width");if(ee.constantOr(1)===0||de.constantOr(1)===0)return;const Ae=x.getDepthModeForSublayer(0,Yr.ReadOnly),Fe=x.colorModeForRenderPass(),De=F.paint.get("line-dasharray"),je=De.constantOr(1),Ue=F.paint.get("line-pattern"),et=Ue.constantOr(1),Xe=F.paint.get("line-gradient"),it=F.getCrossfadeParameters(),dt=et?"linePattern":je?"lineSDF":Xe?"lineGradient":"line",Je=x.context,mt=Je.gl,Et=x.transform;let xt=!0;for(const At of H){const kt=R.getTile(At);if(et&&!kt.patternsLoaded())continue;const er=kt.getBucket(F);if(!er)continue;const Qt=er.programConfigurations.get(F.id),Ht=x.context.program.get(),br=x.useProgram(dt,Qt),Qr=xt||br.program!==Ht,ki=x.style.map.terrain&&x.style.map.terrain.getTerrainData(At),Ji=Ue.constantOr(null),qi=De&&De.constantOr(null);if(Ji&&kt.imageAtlas){const Di=kt.imageAtlas,cn=Di.patternPositions[Ji.to.toString()],ri=Di.patternPositions[Ji.from.toString()];cn&&ri&&Qt.setConstantPatternPositions(cn,ri)}else if(qi){const Di=F.layout.get("line-cap")==="round",cn=x.lineAtlas.getDash(qi.to,Di),ri=x.lineAtlas.getDash(qi.from,Di);Qt.setConstantDashPositions(cn,ri)}const an=Et.getProjectionData({overscaledTileID:At,applyGlobeMatrix:!ae,applyTerrainMatrix:!0}),Qi=Et.getPixelScale(),Fn=et?u0(x,kt,F,Qi,it):je?jo(x,kt,F,Qi,it):Xe?h0(x,kt,F,Qi,er.lineClipsArray.length):Th(x,kt,F,Qi);if(et)Je.activeTexture.set(mt.TEXTURE0),kt.imageAtlasTexture.bind(mt.LINEAR,mt.CLAMP_TO_EDGE),Qt.updatePaintBuffers(it);else if(je)(Qr||x.lineAtlas.dirty)&&(Je.activeTexture.set(mt.TEXTURE0),x.lineAtlas.bind(Je)),Qt.updatePaintBuffers(it);else if(Xe){const Di=er.gradients[F.id];let cn=Di.texture;if(F.gradientVersion!==Di.version){let ri=256;if(F.stepInterpolant){const Jn=R.getSource().maxzoom,ka=At.canonical.z===Jn?Math.ceil(1<<x.transform.maxZoom-At.canonical.z):1;ri=s.ah(s.c3(er.maxLineLength/s.$*1024*ka),256,Je.maxTextureSize)}Di.gradient=s.c4({expression:F.gradientExpression(),evaluationKey:"lineProgress",resolution:ri,image:Di.gradient||void 0,clips:er.lineClipsArray}),Di.texture?Di.texture.update(Di.gradient):Di.texture=new s.T(Je,Di.gradient,mt.RGBA),Di.version=F.gradientVersion,cn=Di.texture}Je.activeTexture.set(mt.TEXTURE0),cn.bind(F.stepInterpolant?mt.NEAREST:mt.LINEAR,mt.CLAMP_TO_EDGE)}const en=x.stencilModeForClipping(At);br.draw(Je,mt.TRIANGLES,Ae,en,Fe,jr.disabled,Fn,ki,an,F.id,er.layoutVertexBuffer,er.indexBuffer,er.segments,F.paint,x.transform.zoom,Qt,er.layoutVertexBuffer2),xt=!1}}(r,c,f,g,y):s.cf(f)?function(x,R,F,H,X){const ae=F.paint.get("fill-color"),ee=F.paint.get("fill-opacity");if(ee.constantOr(1)===0)return;const{isRenderingToTexture:de}=X,Ae=x.colorModeForRenderPass(),Fe=F.paint.get("fill-pattern"),De=x.opaquePassEnabledForLayer()&&!Fe.constantOr(1)&&ae.constantOr(s.bf.transparent).a===1&&ee.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===De){const je=x.getDepthModeForSublayer(1,x.renderPass==="opaque"?Yr.ReadWrite:Yr.ReadOnly);Uo(x,R,F,H,je,Ae,!1,de)}if(x.renderPass==="translucent"&&F.paint.get("fill-antialias")){const je=x.getDepthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Yr.ReadOnly);Uo(x,R,F,H,je,Ae,!0,de)}}(r,c,f,g,y):s.cg(f)?function(x,R,F,H,X){const ae=F.paint.get("fill-extrusion-opacity");if(ae===0)return;const{isRenderingToTexture:ee}=X;if(x.renderPass==="translucent"){const de=new Yr(x.context.gl.LEQUAL,Yr.ReadWrite,x.depthRangeFor3D);if(ae!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))Cc(x,R,F,H,de,yi.disabled,Ki.disabled,ee),Cc(x,R,F,H,de,x.stencilModeFor3D(),x.colorModeForRenderPass(),ee);else{const Ae=x.colorModeForRenderPass();Cc(x,R,F,H,de,yi.disabled,Ae,ee)}}}(r,c,f,g,y):s.ch(f)?function(x,R,F,H,X){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const{isRenderingToTexture:ae}=X,ee=x.context,de=x.style.projection.useSubdivision,Ae=x.getDepthModeForSublayer(0,Yr.ReadOnly),Fe=x.colorModeForRenderPass();if(x.renderPass==="offscreen")(function(De,je,Ue,et,Xe,it,dt){const Je=De.context,mt=Je.gl;for(const Et of Ue){const xt=je.getTile(Et),At=xt.dem;if(!At||!At.data||!xt.needsHillshadePrepare)continue;const kt=At.dim,er=At.stride,Qt=At.getPixels();if(Je.activeTexture.set(mt.TEXTURE1),Je.pixelStoreUnpackPremultiplyAlpha.set(!1),xt.demTexture=xt.demTexture||De.getTileTexture(er),xt.demTexture){const br=xt.demTexture;br.update(Qt,{premultiply:!1}),br.bind(mt.NEAREST,mt.CLAMP_TO_EDGE)}else xt.demTexture=new s.T(Je,Qt,mt.RGBA,{premultiply:!1}),xt.demTexture.bind(mt.NEAREST,mt.CLAMP_TO_EDGE);Je.activeTexture.set(mt.TEXTURE0);let Ht=xt.fbo;if(!Ht){const br=new s.T(Je,{width:kt,height:kt,data:null},mt.RGBA);br.bind(mt.LINEAR,mt.CLAMP_TO_EDGE),Ht=xt.fbo=Je.createFramebuffer(kt,kt,!0,!1),Ht.colorAttachment.set(br.texture)}Je.bindFramebuffer.set(Ht.framebuffer),Je.viewport.set([0,0,kt,kt]),De.useProgram("hillshadePrepare").draw(Je,mt.TRIANGLES,Xe,it,dt,jr.disabled,l0(xt.tileID,At),null,null,et.id,De.rasterBoundsBuffer,De.quadTriangleIndexBuffer,De.rasterBoundsSegments),xt.needsHillshadePrepare=!1}})(x,R,H,F,Ae,yi.disabled,Fe),ee.viewport.set([0,0,x.width,x.height]);else if(x.renderPass==="translucent")if(de){const[De,je,Ue]=x.stencilConfigForOverlapTwoPass(H);Pd(x,R,F,Ue,De,Ae,Fe,!1,ae),Pd(x,R,F,Ue,je,Ae,Fe,!0,ae)}else{const[De,je]=x.getStencilConfigForOverlapAndUpdateStencilID(H);Pd(x,R,F,je,De,Ae,Fe,!1,ae)}}(r,c,f,g,y):s.ci(f)?function(x,R,F,H,X){if(x.renderPass!=="translucent"||!H.length)return;const{isRenderingToTexture:ae}=X,ee=x.style.projection.useSubdivision,de=x.getDepthModeForSublayer(0,Yr.ReadOnly),Ae=x.colorModeForRenderPass();if(ee){const[Fe,De,je]=x.stencilConfigForOverlapTwoPass(H);Ho(x,R,F,je,Fe,de,Ae,!1,ae),Ho(x,R,F,je,De,de,Ae,!0,ae)}else{const[Fe,De]=x.getStencilConfigForOverlapAndUpdateStencilID(H);Ho(x,R,F,De,Fe,de,Ae,!1,ae)}}(r,c,f,g,y):s.cj(f)?function(x,R,F,H,X){if(x.renderPass!=="translucent"||F.paint.get("raster-opacity")===0||!H.length)return;const{isRenderingToTexture:ae}=X,ee=R.getSource(),de=x.style.projection.useSubdivision;if(ee instanceof Dr)Sc(x,R,F,H,null,!1,!1,ee.tileCoords,ee.flippedWindingOrder,ae);else if(de){const[Ae,Fe,De]=x.stencilConfigForOverlapTwoPass(H);Sc(x,R,F,De,Ae,!1,!0,Ed,!1,ae),Sc(x,R,F,De,Fe,!0,!0,Ed,!1,ae)}else{const[Ae,Fe]=x.getStencilConfigForOverlapAndUpdateStencilID(H);Sc(x,R,F,Fe,Ae,!1,!0,Ed,!1,ae)}}(r,c,f,g,y):s.ck(f)?function(x,R,F,H,X){const ae=F.paint.get("background-color"),ee=F.paint.get("background-opacity");if(ee===0)return;const{isRenderingToTexture:de}=X,Ae=x.context,Fe=Ae.gl,De=x.style.projection,je=x.transform,Ue=je.tileSize,et=F.paint.get("background-pattern");if(x.isPatternMissing(et))return;const Xe=!et&&ae.a===1&&ee===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==Xe)return;const it=yi.disabled,dt=x.getDepthModeForSublayer(0,Xe==="opaque"?Yr.ReadWrite:Yr.ReadOnly),Je=x.colorModeForRenderPass(),mt=x.useProgram(et?"backgroundPattern":"background"),Et=H||st(je,{tileSize:Ue,terrain:x.style.map.terrain});et&&(Ae.activeTexture.set(Fe.TEXTURE0),x.imageManager.bind(x.context));const xt=F.getCrossfadeParameters();for(const At of Et){const kt=je.getProjectionData({overscaledTileID:At,applyGlobeMatrix:!de,applyTerrainMatrix:!0}),er=et?p0(ee,x,et,{tileID:At,tileSize:Ue},xt):f0(ee,ae),Qt=x.style.map.terrain&&x.style.map.terrain.getTerrainData(At),Ht=De.getMeshFromTileID(Ae,At.canonical,!1,!0,"raster");mt.draw(Ae,Fe.TRIANGLES,dt,it,Je,jr.backCCW,er,Qt,kt,F.id,Ht.vertexBuffer,Ht.indexBuffer,Ht.segments)}}(r,0,f,g,y):s.cl(f)&&function(x,R,F,H){const{isRenderingGlobe:X}=H,ae=x.context,ee=F.implementation,de=x.style.projection,Ae=x.transform,Fe=Ae.getProjectionDataForCustomLayer(X),De={farZ:Ae.farZ,nearZ:Ae.nearZ,fov:Ae.fov*Math.PI/180,modelViewProjectionMatrix:Ae.modelViewProjectionMatrix,projectionMatrix:Ae.projectionMatrix,shaderData:{variantName:de.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${de.shaderPreludeCode.vertexSource}`,define:de.shaderDefine},defaultProjectionData:Fe},je=ee.renderingMode?ee.renderingMode:"2d";if(x.renderPass==="offscreen"){const Ue=ee.prerender;Ue&&(x.setCustomLayerDefaults(),ae.setColorMode(x.colorModeForRenderPass()),Ue.call(ee,ae.gl,De),ae.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),ae.setColorMode(x.colorModeForRenderPass()),ae.setStencilMode(yi.disabled);const Ue=je==="3d"?x.getDepthModeFor3D():x.getDepthModeForSublayer(0,Yr.ReadOnly);ae.setDepthMode(Ue),ee.render(ae.gl,De),ae.setDirty(),x.setBaseState(),ae.bindFramebuffer.set(null)}}(r,0,f,y))}saveTileTexture(r){const c=this._tileTextures[r.size[0]];c?c.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const c=this._tileTextures[r];return c&&c.length>0?c.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const c=this.imageManager.getPattern(r.from.toString()),f=this.imageManager.getPattern(r.to.toString());return!c||!f}useProgram(r,c,f=!1,g=[]){this.cache=this.cache||{};const y=!!this.style.map.terrain,x=this.style.projection,R=f?Ms.projectionMercator:x.shaderPreludeCode,F=f?Ca:x.shaderDefine,H=r+(c?c.cacheKey:"")+`/${f?zo:x.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(y?"/terrain":"")+(g?`/${g.join("/")}`:"");return this.cache[H]||(this.cache[H]=new fd(this.context,Ms[r],c,yd[r],this._showOverdrawInspector,y,R,F,g)),this.cache[H]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:c}=this.context.gl;return this.width!==r||this.height!==c}}function zd(v,r){let c,f=!1,g=null,y=null;const x=()=>{g=null,f&&(v.apply(y,c),g=setTimeout(x,r),f=!1)};return(...R)=>(f=!0,y=this,c=R,g||x(),g)}class Xo{constructor(r){this._getCurrentHash=()=>{const c=window.location.hash.replace("#","");if(this._hashName){let f;return c.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(f=g)}),(f&&f[1]||"").split("/")}return c.split("/")},this._onHashChange=()=>{const c=this._getCurrentHash();if(!this._isValidHash(c))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:f,pitch:+(c[4]||0)}),!0},this._updateHashUnthrottled=()=>{const c=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,c)},this._removeHash=()=>{const c=this._getCurrentHash();if(c.length===0)return;const f=c.join("/");let g=f;g.split("&").length>0&&(g=g.split("&")[0]),this._hashName&&(g=`${this._hashName}=${f}`);let y=window.location.hash.replace(g,"");y.startsWith("#&")?y=y.slice(0,1)+y.slice(2):y==="#"&&(y="");let x=window.location.href.replace(/(#.+)?$/,y);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=zd(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(r){const c=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,g=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,g),x=Math.round(c.lng*y)/y,R=Math.round(c.lat*y)/y,F=this._map.getBearing(),H=this._map.getPitch();let X="";if(X+=r?`/${x}/${R}/${f}`:`${f}/${R}/${x}`,(F||H)&&(X+="/"+Math.round(10*F)/10),H&&(X+=`/${Math.round(H)}`),this._hashName){const ae=this._hashName;let ee=!1;const de=window.location.hash.slice(1).split("&").map(Ae=>{const Fe=Ae.split("=")[0];return Fe===ae?(ee=!0,`${Fe}=${X}`):Ae}).filter(Ae=>Ae);return ee||de.push(`${ae}=${X}`),`#${de.join("&")}`}return`#${X}`}_isValidHash(r){if(r.length<3||r.some(isNaN))return!1;try{new s.S(+r[2],+r[1])}catch{return!1}const c=+r[0],f=+(r[3]||0),g=+(r[4]||0);return c>=this._map.getMinZoom()&&c<=this._map.getMaxZoom()&&f>=-180&&f<=180&&g>=this._map.getMinPitch()&&g<=this._map.getMaxPitch()}}const qo={linearity:.3,easing:s.cm(0,0,.3,1)},Pc=s.e({deceleration:2500,maxSpeed:1400},qo),Fd=s.e({deceleration:20,maxSpeed:1400},qo),E0=s.e({deceleration:1e3,maxSpeed:360},qo),k0=s.e({deceleration:1e3,maxSpeed:90},qo),R0=s.e({deceleration:1e3,maxSpeed:360},qo);class L0{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:D.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,c=D.now();for(;r.length>0&&c-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)c.zoom+=y.zoomDelta||0,c.bearing+=y.bearingDelta||0,c.pitch+=y.pitchDelta||0,c.roll+=y.rollDelta||0,y.panDelta&&c.pan._add(y.panDelta),y.around&&(c.around=y.around),y.pinchAround&&(c.pinchAround=y.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(c.pan.mag()){const y=Qs(c.pan.mag(),f,s.e({},Pc,r||{})),x=c.pan.mult(y.amount/c.pan.mag()),R=this._map.cameraHelper.handlePanInertia(x,this._map.transform);g.center=R.easingCenter,g.offset=R.easingOffset,Cl(g,y)}if(c.zoom){const y=Qs(c.zoom,f,Fd);g.zoom=this._map.transform.zoom+y.amount,Cl(g,y)}if(c.bearing){const y=Qs(c.bearing,f,E0);g.bearing=this._map.transform.bearing+s.ah(y.amount,-179,179),Cl(g,y)}if(c.pitch){const y=Qs(c.pitch,f,k0);g.pitch=this._map.transform.pitch+y.amount,Cl(g,y)}if(c.roll){const y=Qs(c.roll,f,R0);g.roll=this._map.transform.roll+s.ah(y.amount,-179,179),Cl(g,y)}if(g.zoom||g.bearing){const y=c.pinchAround===void 0?c.around:c.pinchAround;g.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),s.e(g,{noMoveStart:!0})}}function Cl(v,r){(!v.duration||v.duration<r.duration)&&(v.duration=r.duration,v.easing=r.easing)}function Qs(v,r,c){const{maxSpeed:f,linearity:g,deceleration:y}=c,x=s.ah(v*g/(r/1e3),-f,f),R=Math.abs(x)/(y*g);return{easing:c.easing,duration:1e3*R,amount:x*(R/2)}}class vs extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f,g={}){f=f instanceof MouseEvent?f:new MouseEvent(r,f);const y=V.mousePos(c.getCanvas(),f),x=c.unproject(y);super(r,s.e({point:y,lngLat:x,originalEvent:f},g)),this._defaultPrevented=!1,this.target=c}}class Sl extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f){const g=r==="touchend"?f.changedTouches:f.touches,y=V.touchPos(c.getCanvasContainer(),g),x=y.map(F=>c.unproject(F)),R=y.reduce((F,H,X,ae)=>F.add(H.div(ae.length)),new s.P(0,0));super(r,{points:y,point:R,lngLats:x,lngLat:c.unproject(R),originalEvent:f}),this._defaultPrevented=!1}}class Dd extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,c,f){super(r,{originalEvent:f}),this._defaultPrevented=!1}}class z0{constructor(r,c){this._map=r,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Dd(r.type,this._map,r))}mousedown(r,c){return this._mousedownPos=c,this._firePreventable(new vs(r.type,this._map,r))}mouseup(r){this._map.fire(new vs(r.type,this._map,r))}click(r,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new vs(r.type,this._map,r))}dblclick(r){return this._firePreventable(new vs(r.type,this._map,r))}mouseover(r){this._map.fire(new vs(r.type,this._map,r))}mouseout(r){this._map.fire(new vs(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Sl(r.type,this._map,r))}touchmove(r){this._map.fire(new Sl(r.type,this._map,r))}touchend(r){this._map.fire(new Sl(r.type,this._map,r))}touchcancel(r){this._map.fire(new Sl(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class F0{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new vs(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new vs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new vs(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pl{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.screenPointToLocation(s.P.convert(r),this._map.terrain)}}class Bd{constructor(r,c){this._map=r,this._tr=new Pl(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,c){this.isEnabled()&&r.shiftKey&&r.button===0&&(V.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(r,c){if(!this._active)return;const f=c;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const g=this._startPos;this._lastPos=f,this._box||(this._box=V.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const y=Math.min(g.x,f.x),x=Math.max(g.x,f.x),R=Math.min(g.y,f.y),F=Math.max(g.y,f.y);V.setTransform(this._box,`translate(${y}px,${R}px)`),this._box.style.width=x-y+"px",this._box.style.height=F-R+"px"}mouseupWindow(r,c){if(!this._active||r.button!==0)return;const f=this._startPos,g=c;if(this.reset(),V.suppressClick(),f.x!==g.x||f.y!==g.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:r})),{cameraAnimation:y=>y.fitScreenCoordinates(f,g,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,c){return this._map.fire(new s.l(r,{originalEvent:c}))}}function Vh(v,r){if(v.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${v.length}, points ${r.length}`);const c={};for(let f=0;f<v.length;f++)c[v[f].identifier]=r[f];return c}class jh{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,c,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),f.length===this.numTouches&&(this.centroid=function(g){const y=new s.P(0,0);for(const x of g)y._add(x);return y.div(g.length)}(c),this.touches=Vh(f,c)))}touchmove(r,c,f){if(this.aborted||!this.centroid)return;const g=Vh(f,c);for(const y in this.touches){const x=g[y];(!x||x.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(r,c,f){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const g=!this.aborted&&this.centroid;if(this.reset(),g)return g}}}class Zh{constructor(r){this.singleTap=new jh(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,c,f){this.singleTap.touchstart(r,c,f)}touchmove(r,c,f){this.singleTap.touchmove(r,c,f)}touchend(r,c,f){const g=this.singleTap.touchend(r,c,f);if(g){const y=r.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(g)<30;if(y&&x||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=g,this.count===this.numTaps)return this.reset(),g}}}class Vs{constructor(r){this._tr=new Pl(r),this._zoomIn=new Zh({numTouches:1,numTaps:2}),this._zoomOut=new Zh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,c,f){this._zoomIn.touchstart(r,c,f),this._zoomOut.touchstart(r,c,f)}touchmove(r,c,f){this._zoomIn.touchmove(r,c,f),this._zoomOut.touchmove(r,c,f)}touchend(r,c,f){const g=this._zoomIn.touchend(r,c,f),y=this._zoomOut.touchend(r,c,f),x=this._tr;return g?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(g)},{originalEvent:r})}):y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(y)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ds{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const c=this._moveFunction(...r);if(c.bearingDelta||c.pitchDelta||c.rollDelta||c.around||c.panDelta)return this._active=!0,c}dragStart(r,c){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=Array.isArray(c)?c[0]:c,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,c){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const g=Array.isArray(c)?c[0]:c;return!this._moved&&g.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=g,this._move(f,g))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&V.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const D0=0,ea=2,El={[D0]:1,[ea]:2};class Ec{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const c=V.mouseButton(r);this._eventButton=c}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(c,f){const g=El[f];return c.buttons===void 0||(c.buttons&g)!==g}(r,this._eventButton)}isValidEndEvent(r){return V.mouseButton(r)===this._eventButton}}class S1{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}class P1{constructor(r=new Ec({checkCorrectEvent:()=>!0}),c=new S1){this.mouseMoveStateManager=r,this.oneFingerTouchMoveStateManager=c}_executeRelevantHandler(r,c,f){return r instanceof MouseEvent?c(r):typeof TouchEvent<"u"&&r instanceof TouchEvent?f(r):void 0}startMove(r){this._executeRelevantHandler(r,c=>this.mouseMoveStateManager.startMove(c),c=>this.oneFingerTouchMoveStateManager.startMove(c))}endMove(r){this._executeRelevantHandler(r,c=>this.mouseMoveStateManager.endMove(c),c=>this.oneFingerTouchMoveStateManager.endMove(c))}isValidStartEvent(r){return this._executeRelevantHandler(r,c=>this.mouseMoveStateManager.isValidStartEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidStartEvent(c))}isValidMoveEvent(r){return this._executeRelevantHandler(r,c=>this.mouseMoveStateManager.isValidMoveEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(c))}isValidEndEvent(r){return this._executeRelevantHandler(r,c=>this.mouseMoveStateManager.isValidEndEvent(c),c=>this.oneFingerTouchMoveStateManager.isValidEndEvent(c))}}const Oh=v=>{v.mousedown=v.dragStart,v.mousemoveWindow=v.dragMove,v.mouseup=v.dragEnd,v.contextmenu=r=>{r.preventDefault()}};class B0{constructor(r,c){this._clickTolerance=r.clickTolerance||1,this._map=c,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(r){return r<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(r,c,f){return this._calculateTransform(r,c,f)}touchmove(r,c,f){if(this._active){if(!this._shouldBePrevented(f.length))return r.preventDefault(),this._calculateTransform(r,c,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",r)}}touchend(r,c,f){this._calculateTransform(r,c,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,c,f){f.length>0&&(this._active=!0);const g=Vh(f,c),y=new s.P(0,0),x=new s.P(0,0);let R=0;for(const H in g){const X=g[H],ae=this._touches[H];ae&&(y._add(X),x._add(X.sub(ae)),R++,g[H]=X)}if(this._touches=g,this._shouldBePrevented(R)||!x.mag())return;const F=x.div(R);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(R),panDelta:F}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,c,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([c[0],c[1]]))}touchmove(r,c,f){if(!this._firstTwoTouches)return;r.preventDefault();const[g,y]=this._firstTwoTouches,x=js(f,c,g),R=js(f,c,y);if(!x||!R)return;const F=this._aroundCenter?null:x.add(R).div(2);return this._move([x,R],F,r)}touchend(r,c,f){if(!this._firstTwoTouches)return;const[g,y]=this._firstTwoTouches,x=js(f,c,g),R=js(f,c,y);x&&R||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function js(v,r,c){for(let f=0;f<v.length;f++)if(v[f].identifier===c)return r[f]}function _r(v,r){return Math.log(v/r)/Math.LN2}class Gd extends Yo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,c){const f=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(_r(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_r(this._distance,f),pinchAround:c}}}function Nh(v,r){return 180*v.angleWith(r)/Math.PI}class Vd extends Yo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,c,f){const g=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Nh(this._vector,g),pinchAround:c}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const c=25/(Math.PI*this._minDiameter)*360,f=Nh(r,this._startVector);return Math.abs(f)<c}}function Ko(v){return Math.abs(v.y)>Math.abs(v.x)}class kl extends Yo{constructor(r){super(),this._currentTouchCount=0,this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,c,f){super.touchstart(r,c,f),this._currentTouchCount=f.length}_start(r){this._lastPoints=r,Ko(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,c,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const g=r[0].sub(this._lastPoints[0]),y=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(g,y,f.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(g.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(r,c,f){if(this._valid!==void 0)return this._valid;const g=r.mag()>=2,y=c.mag()>=2;if(!g&&!y)return;if(!g||!y)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const x=r.y>0==c.y>0;return Ko(r)&&Ko(c)&&x}}const jd={panStep:100,bearingStep:15,pitchStep:10};class li{constructor(r){this._tr=new Pl(r);const c=jd;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let c=0,f=0,g=0,y=0,x=0;switch(r.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:r.shiftKey?f=-1:(r.preventDefault(),y=-1);break;case 39:r.shiftKey?f=1:(r.preventDefault(),y=1);break;case 38:r.shiftKey?g=1:(r.preventDefault(),x=-1);break;case 40:r.shiftKey?g=-1:(r.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(f=0,g=0),{cameraAnimation:R=>{const F=this._tr;R.easeTo({duration:300,easeId:"keyboardHandler",easing:Zd,zoom:c?Math.round(F.zoom)+c*(r.shiftKey?2:1):F.zoom,bearing:F.bearing+f*this._bearingStep,pitch:F.pitch+g*this._pitchStep,offset:[-y*this._panStep,-x*this._panStep],center:F.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Zd(v){return v*(2-v)}const G0=4.000244140625,Od=1/450;class V0{constructor(r,c){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=r,this._tr=new Pl(r),this._triggerRenderFrame=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Od}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(r){return!!this._map.cooperativeGestures.isEnabled()&&!(r.ctrlKey||this._map.cooperativeGestures.isBypassed(r))}wheel(r){if(!this.isEnabled())return;if(this._shouldBePrevented(r))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",r);let c=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const f=D.now(),g=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,c!==0&&c%G0==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":g>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(g*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),r.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=r,this._delta-=c,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=V.mousePos(this._map.getCanvas(),r),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(s.S.convert(f.center)):c,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const R=r.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=R),typeof this._targetZoom=="number"&&(this._targetZoom+=R)}if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>G0?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&F!==0&&(F=1/F);const H=typeof this._targetZoom!="number"?r.scale:s.af(this._targetZoom);this._targetZoom=r.getConstrained(r.getCameraLngLat(),s.ak(H*F)).zoom,this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const c=typeof this._targetZoom!="number"?r.zoom:this._targetZoom,f=this._startZoom,g=this._easing;let y,x=!1;if(this._type==="wheel"&&f&&g){const R=D.now()-this._lastWheelEventTime,F=Math.min((R+5)/200,1),H=g(F);y=s.C.number(f,c,H),F<1?this._frameId||(this._frameId=!0):x=!0}else y=c,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=y,{noInertia:!0,needsRenderFrame:!x,zoomDelta:y-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let c=s.co;if(this._prevEase){const f=this._prevEase,g=(D.now()-f.start)/f.duration,y=f.easing(g+.01)-f.easing(g),x=.27/Math.sqrt(y*y+1e-4)*.01,R=Math.sqrt(.0729-x*x);c=s.cm(x,R,.25,1)}return this._prevEase={start:D.now(),duration:r,easing:c},c}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class j0{constructor(r,c){this._clickZoom=r,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Z0{constructor(r){this._tr=new Pl(r),this.reset()}reset(){this._active=!1}dblclick(r,c){return r.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(c)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nd{constructor(){this._tap=new Zh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,c,f){if(!this._swipePoint)if(this._tapTime){const g=c[0],y=r.timeStamp-this._tapTime<500,x=this._tapPoint.dist(g)<30;y&&x?f.length>0&&(this._swipePoint=g,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(r,c,f)}touchmove(r,c,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const g=c[0],y=g.y-this._swipePoint.y;return this._swipePoint=g,r.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(r,c,f)}touchend(r,c,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const g=this._tap.touchend(r,c,f);g&&(this._tapTime=r.timeStamp,this._tapPoint=g)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ud{constructor(r,c,f){this._el=r,this._mousePan=c,this._touchPan=f}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class O0{constructor(r,c,f,g){this._pitchWithRotate=r.pitchWithRotate,this._rollEnabled=r.rollEnabled,this._mouseRotate=c,this._mousePitch=f,this._mouseRoll=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Hd{constructor(r,c,f,g){this._el=r,this._touchZoom=c,this._touchRotate=f,this._tapDragZoom=g,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class N0{constructor(r,c){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=r,this._options=c,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const r=this._map.getCanvasContainer();r.classList.add("maplibregl-cooperative-gestures"),this._container=V.create("div","maplibregl-cooperative-gesture-screen",r);let c=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(c=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),g=document.createElement("div");g.className="maplibregl-desktop-message",g.textContent=c,this._container.appendChild(g);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=f,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(V.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(r){return r[this._bypassKey]}notifyGestureBlocked(r,c){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:r,originalEvent:c})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Uh=v=>v.zoom||v.drag||v.roll||v.pitch||v.rotate;class eo extends s.l{}function Li(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta||v.rollDelta}class E1{constructor(r,c){this.handleWindowEvent=g=>{this.handleEvent(g,`${g.type}Window`)},this.handleEvent=(g,y)=>{if(g.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=g.type==="renderFrame"?void 0:g,R={needsRenderFrame:!1},F={},H={};for(const{handlerName:ee,handler:de,allowed:Ae}of this._handlers){if(!de.isEnabled())continue;let Fe;if(this._blockedByActive(H,Ae,ee))de.reset();else if(de[y||g.type]){if(s.cp(g,y||g.type)){const De=V.mousePos(this._map.getCanvas(),g);Fe=de[y||g.type](g,De)}else if(s.cq(g,y||g.type)){const De=this._getMapTouches(g.touches),je=V.touchPos(this._map.getCanvas(),De);Fe=de[y||g.type](g,je,De)}else s.cr(y||g.type)||(Fe=de[y||g.type](g));this.mergeHandlerResult(R,F,Fe,ee,x),Fe&&Fe.needsRenderFrame&&this._triggerRenderFrame()}(Fe||de.isActive())&&(H[ee]=de)}const X={};for(const ee in this._previousActiveHandlers)H[ee]||(X[ee]=x);this._previousActiveHandlers=H,(Object.keys(X).length||Li(R))&&(this._changes.push([R,F,X]),this._triggerRenderFrame()),(Object.keys(H).length||Li(R))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ae}=R;ae&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ae(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new L0(r),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[g,y,x]of this._listeners)V.addEventListener(g,y,g===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[r,c,f]of this._listeners)V.removeEventListener(r,c,r===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(r){const c=this._map,f=c.getCanvasContainer();this._add("mapEvent",new z0(c,r));const g=c.boxZoom=new Bd(c,r);this._add("boxZoom",g),r.interactive&&r.boxZoom&&g.enable();const y=c.cooperativeGestures=new N0(c,r.cooperativeGestures);this._add("cooperativeGestures",y),r.cooperativeGestures&&y.enable();const x=new Vs(c),R=new Z0(c);c.doubleClickZoom=new j0(R,x),this._add("tapZoom",x),this._add("clickZoom",R),r.interactive&&r.doubleClickZoom&&c.doubleClickZoom.enable();const F=new Nd;this._add("tapDragZoom",F);const H=c.touchPitch=new kl(c);this._add("touchPitch",H),r.interactive&&r.touchPitch&&c.touchPitch.enable(r.touchPitch);const X=()=>c.project(c.getCenter()),ae=function({enable:Xe,clickTolerance:it,aroundCenter:dt=!0,minPixelCenterThreshold:Je=100,rotateDegreesPerPixelMoved:mt=.8},Et){const xt=new Ec({checkCorrectEvent:At=>V.mouseButton(At)===0&&At.ctrlKey||V.mouseButton(At)===2&&!At.ctrlKey});return new ds({clickTolerance:it,move:(At,kt)=>{const er=Et();if(dt&&Math.abs(er.y-At.y)>Je)return{bearingDelta:s.cn(new s.P(At.x,kt.y),kt,er)};let Qt=(kt.x-At.x)*mt;return dt&&kt.y<er.y&&(Qt=-Qt),{bearingDelta:Qt}},moveStateManager:xt,enable:Xe,assignEvents:Oh})}(r,X),ee=function({enable:Xe,clickTolerance:it,pitchDegreesPerPixelMoved:dt=-.5}){const Je=new Ec({checkCorrectEvent:mt=>V.mouseButton(mt)===0&&mt.ctrlKey||V.mouseButton(mt)===2});return new ds({clickTolerance:it,move:(mt,Et)=>({pitchDelta:(Et.y-mt.y)*dt}),moveStateManager:Je,enable:Xe,assignEvents:Oh})}(r),de=function({enable:Xe,clickTolerance:it,rollDegreesPerPixelMoved:dt=.3},Je){const mt=new Ec({checkCorrectEvent:Et=>V.mouseButton(Et)===2&&Et.ctrlKey});return new ds({clickTolerance:it,move:(Et,xt)=>{const At=Je();let kt=(xt.x-Et.x)*dt;return xt.y<At.y&&(kt=-kt),{rollDelta:kt}},moveStateManager:mt,enable:Xe,assignEvents:Oh})}(r,X);c.dragRotate=new O0(r,ae,ee,de),this._add("mouseRotate",ae,["mousePitch"]),this._add("mousePitch",ee,["mouseRotate","mouseRoll"]),this._add("mouseRoll",de,["mousePitch"]),r.interactive&&r.dragRotate&&c.dragRotate.enable();const Ae=function({enable:Xe,clickTolerance:it}){const dt=new Ec({checkCorrectEvent:Je=>V.mouseButton(Je)===0&&!Je.ctrlKey});return new ds({clickTolerance:it,move:(Je,mt)=>({around:mt,panDelta:mt.sub(Je)}),activateOnStart:!0,moveStateManager:dt,enable:Xe,assignEvents:Oh})}(r),Fe=new B0(r,c);c.dragPan=new Ud(f,Ae,Fe),this._add("mousePan",Ae),this._add("touchPan",Fe,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&c.dragPan.enable(r.dragPan);const De=new Vd,je=new Gd;c.touchZoomRotate=new Hd(f,je,De,F),this._add("touchRotate",De,["touchPan","touchZoom"]),this._add("touchZoom",je,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&c.touchZoomRotate.enable(r.touchZoomRotate);const Ue=c.scrollZoom=new V0(c,()=>this._triggerRenderFrame());this._add("scrollZoom",Ue,["mousePan"]),r.interactive&&r.scrollZoom&&c.scrollZoom.enable(r.scrollZoom);const et=c.keyboard=new li(c);this._add("keyboard",et),r.interactive&&r.keyboard&&c.keyboard.enable(),this._add("blockableMapEvent",new F0(c))}_add(r,c,f){this._handlers.push({handlerName:r,handler:c,allowed:f}),this._handlersById[r]=c}stop(r){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Uh(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,c,f){for(const g in r)if(g!==f&&(!c||c.indexOf(g)<0))return!0;return!1}_getMapTouches(r){const c=[];for(const f of r)this._el.contains(f.target)&&c.push(f);return c}mergeHandlerResult(r,c,f,g,y){if(!f)return;s.e(r,f);const x={handlerName:g,originalEvent:f.originalEvent||y};f.zoomDelta!==void 0&&(c.zoom=x),f.panDelta!==void 0&&(c.drag=x),f.rollDelta!==void 0&&(c.roll=x),f.pitchDelta!==void 0&&(c.pitch=x),f.bearingDelta!==void 0&&(c.rotate=x)}_applyChanges(){const r={},c={},f={};for(const[g,y,x]of this._changes)g.panDelta&&(r.panDelta=(r.panDelta||new s.P(0,0))._add(g.panDelta)),g.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+g.pitchDelta),g.rollDelta&&(r.rollDelta=(r.rollDelta||0)+g.rollDelta),g.around!==void 0&&(r.around=g.around),g.pinchAround!==void 0&&(r.pinchAround=g.pinchAround),g.noInertia&&(r.noInertia=g.noInertia),s.e(c,y),s.e(f,x);this._updateMapTransform(r,c,f),this._changes=[]}_updateMapTransform(r,c,f){const g=this._map,y=g._getTransformForUpdate(),x=g.terrain;if(!(Li(r)||x&&this._terrainMovement))return this._fireEvents(c,f,!0);g._stop(!0);let{panDelta:R,zoomDelta:F,bearingDelta:H,pitchDelta:X,rollDelta:ae,around:ee,pinchAround:de}=r;de!==void 0&&(ee=de),ee=ee||g.transform.centerPoint,x&&!y.isPointOnMapSurface(ee)&&(ee=y.centerPoint);const Ae={panDelta:R,zoomDelta:F,rollDelta:ae,pitchDelta:X,bearingDelta:H,around:ee};this._map.cameraHelper.useGlobeControls&&!y.isPointOnMapSurface(ee)&&(ee=y.centerPoint);const Fe=ee.distSqr(y.centerPoint)<.01?y.center:y.screenPointToLocation(R?ee.sub(R):ee);this._handleMapControls({terrain:x,tr:y,deltasForHelper:Ae,preZoomAroundLoc:Fe,combinedEventsInProgress:c,panDelta:R}),g._applyUpdatedTransform(y),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(c,f,!0)}_handleMapControls({terrain:r,tr:c,deltasForHelper:f,preZoomAroundLoc:g,combinedEventsInProgress:y,panDelta:x}){const R=this._map.cameraHelper;if(R.handleMapControlsRollPitchBearingZoom(f,c),r)return R.useGlobeControls?(this._terrainMovement||!y.drag&&!y.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void R.handleMapControlsPan(f,c,g)):this._terrainMovement||!y.drag&&!y.zoom?void(y.drag&&this._terrainMovement&&x?c.setCenter(c.screenPointToLocation(c.centerPoint.sub(x))):R.handleMapControlsPan(f,c,g)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void R.handleMapControlsPan(f,c,g));R.handleMapControlsPan(f,c,g)}_fireEvents(r,c,f){const g=Uh(this._eventsInProgress),y=Uh(r),x={};for(const ae in r){const{originalEvent:ee}=r[ae];this._eventsInProgress[ae]||(x[`${ae}start`]=ee),this._eventsInProgress[ae]=r[ae]}!g&&y&&this._fireEvent("movestart",y.originalEvent);for(const ae in x)this._fireEvent(ae,x[ae]);y&&this._fireEvent("move",y.originalEvent);for(const ae in r){const{originalEvent:ee}=r[ae];this._fireEvent(ae,ee)}const R={};let F;for(const ae in this._eventsInProgress){const{handlerName:ee,originalEvent:de}=this._eventsInProgress[ae];this._handlersById[ee].isActive()||(delete this._eventsInProgress[ae],F=c[ee]||de,R[`${ae}end`]=F)}for(const ae in R)this._fireEvent(ae,R[ae]);const H=Uh(this._eventsInProgress),X=(g||y)&&!H;if(X&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const ae=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&ae.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(ae)}if(f&&X){this._updatingCamera=!0;const ae=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ee=de=>de!==0&&-this._bearingSnap<de&&de<this._bearingSnap;!ae||!ae.essential&&D.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:F})),ee(this._map.getBearing())&&this._map.resetNorth()):(ee(ae.bearing||this._map.getBearing())&&(ae.bearing=0),ae.freezeElevation=!0,this._map.easeTo(ae,{originalEvent:F})),this._updatingCamera=!1}}_fireEvent(r,c){this._map.fire(new s.l(r,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new eo("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Hh extends s.E{constructor(r,c,f){super(),this._renderFrameCallback=()=>{const g=Math.min((D.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(g)),g<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=f.bearingSnap,this.cameraHelper=c,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(r,c){r.apply(this.transform),this.transform=r,this.cameraHelper=c}getCenter(){return new s.S(this.transform.center.lng,this.transform.center.lat)}setCenter(r,c){return this.jumpTo({center:r},c)}getCenterElevation(){return this.transform.elevation}setCenterElevation(r,c){return this.jumpTo({elevation:r},c),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(r){this._centerClampedToGround=r}panBy(r,c,f){return r=s.P.convert(r).mult(-1),this.panTo(this.transform.center,s.e({offset:r},c),f)}panTo(r,c,f){return this.easeTo(s.e({center:r},c),f)}getZoom(){return this.transform.zoom}setZoom(r,c){return this.jumpTo({zoom:r},c),this}zoomTo(r,c,f){return this.easeTo(s.e({zoom:r},c),f)}zoomIn(r,c){return this.zoomTo(this.getZoom()+1,r,c),this}zoomOut(r,c){return this.zoomTo(this.getZoom()-1,r,c),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(r,c){return r!=this.transform.fov&&(this.transform.setFov(r),this.fire(new s.l("movestart",c)).fire(new s.l("move",c)).fire(new s.l("moveend",c))),this}getBearing(){return this.transform.bearing}setBearing(r,c){return this.jumpTo({bearing:r},c),this}getPadding(){return this.transform.padding}setPadding(r,c){return this.jumpTo({padding:r},c),this}rotateTo(r,c,f){return this.easeTo(s.e({bearing:r},c),f)}resetNorth(r,c){return this.rotateTo(0,s.e({duration:1e3},r),c),this}resetNorthPitch(r,c){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},r),c),this}snapToNorth(r,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,c):this}getPitch(){return this.transform.pitch}setPitch(r,c){return this.jumpTo({pitch:r},c),this}getRoll(){return this.transform.roll}setRoll(r,c){return this.jumpTo({roll:r},c),this}cameraForBounds(r,c){r=Ot.convert(r).adjustAntiMeridian();const f=c&&c.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),f,c)}_cameraForBoxAndBearing(r,c,f,g){const y={top:0,bottom:0,right:0,left:0};if(typeof(g=s.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},g)).padding=="number"){const H=g.padding;g.padding={top:H,bottom:H,right:H,left:H}}const x=s.e(y,g.padding);g.padding=x;const R=this.transform,F=new Ot(r,c);return this.cameraHelper.cameraForBoxAndBearing(g,x,F,f,R)}fitBounds(r,c,f){return this._fitInternal(this.cameraForBounds(r,c),c,f)}fitScreenCoordinates(r,c,f,g,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(r)),this.transform.screenPointToLocation(s.P.convert(c)),f,g),g,y)}_fitInternal(r,c,f){return r?(delete(c=s.e(r,c)).padding,c.linear?this.easeTo(c,f):this.flyTo(c,f)):this}jumpTo(r,c){this.stop();const f=this._getTransformForUpdate();let g=!1,y=!1,x=!1;const R=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,r);const F=f.zoom!==R;return"elevation"in r&&f.elevation!==+r.elevation&&f.setElevation(+r.elevation),"bearing"in r&&f.bearing!==+r.bearing&&(g=!0,f.setBearing(+r.bearing)),"pitch"in r&&f.pitch!==+r.pitch&&(y=!0,f.setPitch(+r.pitch)),"roll"in r&&f.roll!==+r.roll&&(x=!0,f.setRoll(+r.roll)),r.padding==null||f.isPaddingEqual(r.padding)||f.setPadding(r.padding),this._applyUpdatedTransform(f),this.fire(new s.l("movestart",c)).fire(new s.l("move",c)),F&&this.fire(new s.l("zoomstart",c)).fire(new s.l("zoom",c)).fire(new s.l("zoomend",c)),g&&this.fire(new s.l("rotatestart",c)).fire(new s.l("rotate",c)).fire(new s.l("rotateend",c)),y&&this.fire(new s.l("pitchstart",c)).fire(new s.l("pitch",c)).fire(new s.l("pitchend",c)),x&&this.fire(new s.l("rollstart",c)).fire(new s.l("roll",c)).fire(new s.l("rollend",c)),this.fire(new s.l("moveend",c))}calculateCameraOptionsFromTo(r,c,f,g=0){const y=s.a1.fromLngLat(r,c),x=s.a1.fromLngLat(f,g),R=x.x-y.x,F=x.y-y.y,H=x.z-y.z,X=Math.hypot(R,F,H);if(X===0)throw new Error("Can't calculate camera options with same From and To");const ae=Math.hypot(R,F),ee=s.ak(this.transform.cameraToCenterDistance/X/this.transform.tileSize),de=180*Math.atan2(R,-F)/Math.PI;let Ae=180*Math.acos(ae/X)/Math.PI;return Ae=H<0?90-Ae:90+Ae,{center:x.toLngLat(),elevation:g,zoom:ee,pitch:Ae,bearing:de}}calculateCameraOptionsFromCameraLngLatAltRotation(r,c,f,g,y){const x=this.transform.calculateCenterFromCameraLngLatAlt(r,c,f,g);return{center:x.center,elevation:x.elevation,zoom:x.zoom,bearing:f,pitch:g,roll:y}}easeTo(r,c){this._stop(!1,r.easeId),((r=s.e({offset:[0,0],duration:500,easing:s.co},r)).animate===!1||!r.essential&&D.prefersReducedMotion)&&(r.duration=0);const f=this._getTransformForUpdate(),g=this.getBearing(),y=f.pitch,x=f.roll,R="bearing"in r?this._normalizeBearing(r.bearing,g):g,F="pitch"in r?+r.pitch:y,H="roll"in r?this._normalizeBearing(r.roll,x):x,X="padding"in r?r.padding:f.padding,ae=s.P.convert(r.offset);let ee,de;r.around&&(ee=s.S.convert(r.around),de=f.locationToScreenPoint(ee));const Ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Fe=this.cameraHelper.handleEaseTo(f,{bearing:R,pitch:F,roll:H,padding:X,around:ee,aroundPoint:de,offsetAsPoint:ae,offset:r.offset,zoom:r.zoom,center:r.center});return this._rotating=this._rotating||g!==R,this._pitching=this._pitching||F!==y,this._rolling=this._rolling||H!==x,this._padding=!f.isPaddingEqual(X),this._zooming=this._zooming||Fe.isZooming,this._easeId=r.easeId,this._prepareEase(c,r.noMoveStart,Ae),this.terrain&&this._prepareElevation(Fe.elevationCenter),this._ease(De=>{Fe.easeFunc(De),this.terrain&&!r.freezeElevation&&this._updateElevation(De),this._applyUpdatedTransform(f),this._fireMoveEvents(c)},De=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(c,De)},r),this}_prepareEase(r,c,f={}){this._moving=!0,c||f.moving||this.fire(new s.l("movestart",r)),this._zooming&&!f.zooming&&this.fire(new s.l("zoomstart",r)),this._rotating&&!f.rotating&&this.fire(new s.l("rotatestart",r)),this._pitching&&!f.pitching&&this.fire(new s.l("pitchstart",r)),this._rolling&&!f.rolling&&this.fire(new s.l("rollstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const c=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&c!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(f-(c-(f*r+this._elevationStart))/(1-r)),this._elevationTarget=c}this.transform.setElevation(s.C.number(this._elevationStart,this._elevationTarget,r))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(r){if(!this.terrain&&r.elevation>=0&&r.pitch<=90)return{};const c=r.getCameraLngLat(),f=r.getCameraAltitude(),g=this.terrain?this.terrain.getElevationForLngLatZoom(c,r.zoom):0;if(f<g){const y=this.calculateCameraOptionsFromTo(c,g,r.center,r.elevation);return{pitch:y.pitch,zoom:y.zoom}}return{}}_applyUpdatedTransform(r){const c=[];if(c.push(g=>this._elevateCameraIfInsideTerrain(g)),this.transformCameraUpdate&&c.push(g=>this.transformCameraUpdate(g)),!c.length)return;const f=r.clone();for(const g of c){const y=f.clone(),{center:x,zoom:R,roll:F,pitch:H,bearing:X,elevation:ae}=g(y);x&&y.setCenter(x),ae!==void 0&&y.setElevation(ae),R!==void 0&&y.setZoom(R),F!==void 0&&y.setRoll(F),H!==void 0&&y.setPitch(H),X!==void 0&&y.setBearing(X),f.apply(y)}this.transform.apply(f)}_fireMoveEvents(r){this.fire(new s.l("move",r)),this._zooming&&this.fire(new s.l("zoom",r)),this._rotating&&this.fire(new s.l("rotate",r)),this._pitching&&this.fire(new s.l("pitch",r)),this._rolling&&this.fire(new s.l("roll",r))}_afterEase(r,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId;const f=this._zooming,g=this._rotating,y=this._pitching,x=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new s.l("zoomend",r)),g&&this.fire(new s.l("rotateend",r)),y&&this.fire(new s.l("pitchend",r)),x&&this.fire(new s.l("rollend",r)),this.fire(new s.l("moveend",r))}flyTo(r,c){if(!r.essential&&D.prefersReducedMotion){const kt=s.Q(r,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(kt,c)}this.stop(),r=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.co},r);const f=this._getTransformForUpdate(),g=f.bearing,y=f.pitch,x=f.roll,R=f.padding,F="bearing"in r?this._normalizeBearing(r.bearing,g):g,H="pitch"in r?+r.pitch:y,X="roll"in r?this._normalizeBearing(r.roll,x):x,ae="padding"in r?r.padding:f.padding,ee=s.P.convert(r.offset);let de=f.centerPoint.add(ee);const Ae=f.screenPointToLocation(de),Fe=this.cameraHelper.handleFlyTo(f,{bearing:F,pitch:H,roll:X,padding:ae,locationAtOffset:Ae,offsetAsPoint:ee,center:r.center,minZoom:r.minZoom,zoom:r.zoom});let De=r.curve;const je=Math.max(f.width,f.height),Ue=je/Fe.scaleOfZoom,et=Fe.pixelPathLength;typeof Fe.scaleOfMinZoom=="number"&&(De=Math.sqrt(je/Fe.scaleOfMinZoom/et*2));const Xe=De*De;function it(kt){const er=(Ue*Ue-je*je+(kt?-1:1)*Xe*Xe*et*et)/(2*(kt?Ue:je)*Xe*et);return Math.log(Math.sqrt(er*er+1)-er)}function dt(kt){return(Math.exp(kt)-Math.exp(-kt))/2}function Je(kt){return(Math.exp(kt)+Math.exp(-kt))/2}const mt=it(!1);let Et=function(kt){return Je(mt)/Je(mt+De*kt)},xt=function(kt){return je*((Je(mt)*(dt(er=mt+De*kt)/Je(er))-dt(mt))/Xe)/et;var er},At=(it(!0)-mt)/De;if(Math.abs(et)<2e-6||!isFinite(At)){if(Math.abs(je-Ue)<1e-6)return this.easeTo(r,c);const kt=Ue<je?-1:1;At=Math.abs(Math.log(Ue/je))/De,xt=()=>0,Et=er=>Math.exp(kt*De*er)}return r.duration="duration"in r?+r.duration:1e3*At/("screenSpeed"in r?+r.screenSpeed/De:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=g!==F,this._pitching=H!==y,this._rolling=X!==x,this._padding=!f.isPaddingEqual(ae),this._prepareEase(c,!1),this.terrain&&this._prepareElevation(Fe.targetCenter),this._ease(kt=>{const er=kt*At,Qt=1/Et(er),Ht=xt(er);this._rotating&&f.setBearing(s.C.number(g,F,kt)),this._pitching&&f.setPitch(s.C.number(y,H,kt)),this._rolling&&f.setRoll(s.C.number(x,X,kt)),this._padding&&(f.interpolatePadding(R,ae,kt),de=f.centerPoint.add(ee)),Fe.easeFunc(kt,Qt,Ht,de),this.terrain&&!r.freezeElevation&&this._updateElevation(kt),this._applyUpdatedTransform(f),this._fireMoveEvents(c)},()=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(c)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,c){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,c)}return r||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(r,c,f){f.animate===!1||f.duration===0?(r(1),c()):(this._easeStart=D.now(),this._easeOptions=f,this._onEaseFrame=r,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,c){r=s.aO(r,-180,180);const f=Math.abs(r-c);return Math.abs(r-360-c)<f&&(r-=360),Math.abs(r+360-c)<f&&(r+=360),r}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(s.S.convert(r),this.transform.tileZoom):null}}const Wh={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Wd{constructor(r=Wh){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=c=>{!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options.compact,this._container=V.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=V.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=V.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,c){const f=this._map._getUIString(`AttributionControl.${c}`);r.title=f,r.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(g=>typeof g!="string"?"":g)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const g=this._map.style.stylesheet;this.styleOwner=g.owner,this.styleId=g.id}const c=this._map.style.sourceCaches;for(const g in c){const y=c[g];if(y.used||y.usedForTerrain){const x=y.getSource();x.attribution&&r.indexOf(x.attribution)<0&&r.push(x.attribution)}}r=r.filter(g=>String(g).trim()),r.sort((g,y)=>g.length-y.length),r=r.filter((g,y)=>{for(let x=y+1;x<r.length;x++)if(r[x].indexOf(g)>=0)return!1;return!0});const f=r.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,r.length?(this._innerContainer.innerHTML=V.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Xd{constructor(r={}){this._updateCompact=()=>{const c=this._container.children;if(c.length){const f=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=V.create("div","maplibregl-ctrl");const c=V.create("a","maplibregl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://maplibre.org/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class U0{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const c=++this._id;return this._queue.push({callback:r,id:c,cancelled:!1}),c}remove(r){const c=this._currentlyRunning,f=c?this._queue.concat(c):this._queue;for(const g of f)if(g.id===r)return void(g.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const c=this._currentlyRunning=this._queue;this._queue=[];for(const f of c)if(!f.cancelled&&(f.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var k1=s.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class _a extends s.E{constructor(r){super(),this._lastTilesetChange=D.now(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=r._source.tileSize*2**this.deltaZoom,r.usedForTerrain=!0,r.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,c){this.sourceCache.update(r,c),this._renderableTilesKeys=[];const f={};for(const g of st(r,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:c,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[g.key]=!0,this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.terrainRttPosMatrix32f=new Float64Array(16),s.bY(g.terrainRttPosMatrix32f,0,s.$,s.$,0,0,1),this._tiles[g.key]=new Fi(g,this.tileSize),this._lastTilesetChange=D.now());for(const g in this._tiles)f[g]||delete this._tiles[g]}freeRtt(r){for(const c in this._tiles){const f=this._tiles[c];(!r||f.tileID.equals(r)||f.tileID.isChildOf(r)||r.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r,c){return c?this._getTerrainCoordsForTileRanges(r,c):this._getTerrainCoordsForRegularTile(r)}_getTerrainCoordsForRegularTile(r){const c={};for(const f of this._renderableTilesKeys){const g=this._tiles[f].tileID,y=r.clone(),x=s.ba();if(g.canonical.equals(r.canonical))s.bY(x,0,s.$,s.$,0,0,1);else if(g.canonical.isChildOf(r.canonical)){const R=g.canonical.z-r.canonical.z,F=g.canonical.x-(g.canonical.x>>R<<R),H=g.canonical.y-(g.canonical.y>>R<<R),X=s.$>>R;s.bY(x,0,X,X,0,0,1),s.M(x,x,[-F*X,-H*X,0])}else{if(!r.canonical.isChildOf(g.canonical))continue;{const R=r.canonical.z-g.canonical.z,F=r.canonical.x-(r.canonical.x>>R<<R),H=r.canonical.y-(r.canonical.y>>R<<R),X=s.$>>R;s.bY(x,0,s.$,s.$,0,0,1),s.M(x,x,[F*X,H*X,0]),s.N(x,x,[1/2**R,1/2**R,0])}}y.terrainRttPosMatrix32f=new Float32Array(x),c[f]=y}return c}_getTerrainCoordsForTileRanges(r,c){const f={};for(const g of this._renderableTilesKeys){const y=this._tiles[g].tileID;if(!this._isWithinTileRanges(y,c))continue;const x=r.clone(),R=s.ba();if(y.canonical.z===r.canonical.z){const F=r.canonical.x-y.canonical.x,H=r.canonical.y-y.canonical.y;s.bY(R,0,s.$,s.$,0,0,1),s.M(R,R,[F*s.$,H*s.$,0])}else if(y.canonical.z>r.canonical.z){const F=y.canonical.z-r.canonical.z,H=y.canonical.x-(y.canonical.x>>F<<F),X=y.canonical.y-(y.canonical.y>>F<<F),ae=r.canonical.x-(y.canonical.x>>F),ee=r.canonical.y-(y.canonical.y>>F),de=s.$>>F;s.bY(R,0,de,de,0,0,1),s.M(R,R,[-H*de+ae*s.$,-X*de+ee*s.$,0])}else{const F=r.canonical.z-y.canonical.z,H=r.canonical.x-(r.canonical.x>>F<<F),X=r.canonical.y-(r.canonical.y>>F<<F),ae=(r.canonical.x>>F)-y.canonical.x,ee=(r.canonical.y>>F)-y.canonical.y,de=s.$<<F;s.bY(R,0,de,de,0,0,1),s.M(R,R,[H*s.$+ae*de,X*s.$+ee*de,0])}x.terrainRttPosMatrix32f=new Float32Array(R),f[g]=x}return f}getSourceTile(r,c){const f=this.sourceCache._source;let g=r.overscaledZ-this.deltaZoom;if(g>f.maxzoom&&(g=f.maxzoom),g<f.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(g).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!y||!y.dem)&&c)for(;g>=f.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(r.scaledTo(g--).key);return y}anyTilesAfterTime(r=Date.now()){return this._lastTilesetChange>=r}_isWithinTileRanges(r,c){return c[r.canonical.z]&&r.canonical.x>=c[r.canonical.z].minTileX&&r.canonical.x<=c[r.canonical.z].maxTileX&&r.canonical.y>=c[r.canonical.z].minTileY&&r.canonical.y<=c[r.canonical.z].maxTileY}}class Xh{constructor(r,c,f){this._meshCache={},this.painter=r,this.sourceCache=new _a(c),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,c,f,g=s.$){var y;if(!(c>=0&&c<g&&f>=0&&f<g))return 0;const x=this.getTerrainData(r),R=(y=x.tile)===null||y===void 0?void 0:y.dem;if(!R)return 0;const F=s.cs([],[c/g*s.$,f/g*s.$],x.u_terrain_matrix),H=[F[0]*R.dim,F[1]*R.dim],X=Math.floor(H[0]),ae=Math.floor(H[1]),ee=H[0]-X,de=H[1]-ae;return R.get(X,ae)*(1-ee)*(1-de)+R.get(X+1,ae)*ee*(1-de)+R.get(X,ae+1)*(1-ee)*de+R.get(X+1,ae+1)*ee*de}getElevationForLngLatZoom(r,c){if(!s.ct(c,r.wrap()))return 0;const{tileID:f,mercatorX:g,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(r,c);return this.getElevation(f,g%s.$,y%s.$,s.$)}getElevation(r,c,f,g=s.$){return this.getDEMElevation(r,c,f,g)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const g=this.painter.context,y=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(g,y,g.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(g,new s.R({width:1,height:1}),g.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.ag([])}const c=this.sourceCache.getSourceTile(r,!0);if(c&&c.dem&&(!c.demTexture||c.needsTerrainPrepare)){const g=this.painter.context;c.demTexture=this.painter.getTileTexture(c.dem.stride),c.demTexture?c.demTexture.update(c.dem.getPixels(),{premultiply:!1}):c.demTexture=new s.T(g,c.dem.getPixels(),g.gl.RGBA,{premultiply:!1}),c.demTexture.bind(g.gl.NEAREST,g.gl.CLAMP_TO_EDGE),c.needsTerrainPrepare=!1}const f=c&&c+c.tileID.key+r.key;if(f&&!this._demMatrixCache[f]){const g=this.sourceCache.sourceCache._source.maxzoom;let y=r.canonical.z-c.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=g?y=r.canonical.z-g:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=r.canonical.x-(r.canonical.x>>y<<y),R=r.canonical.y-(r.canonical.y>>y<<y),F=s.cu(new Float64Array(16),[1/(s.$<<y),1/(s.$<<y),0]);s.M(F,F,[x*s.$,R*s.$,0]),this._demMatrixCache[r.key]={matrix:F,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:c&&c.dem&&c.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:c&&c.dem&&c.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(c&&c.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:c}}getFramebuffer(r){const c=this.painter,f=c.width/devicePixelRatio,g=c.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===g||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(c.context,{width:f,height:g,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(c.context,{width:f,height:g,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=c.context.createFramebuffer(f,g,!0,!1),this._fbo.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,f,g))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const c=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,x=0;y<this._coordsTextureSize;y++)for(let R=0;R<this._coordsTextureSize;R++,x+=4)c[x+0]=255&R,c[x+1]=255&y,c[x+2]=R>>8<<4|y>>8,c[x+3]=0;const f=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(c.buffer)),g=new s.T(r,f,r.gl.RGBA,{premultiply:!1});return g.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=g,g}pointCoordinate(r){this.painter.maybeDrawDepthAndCoords(!0);const c=new Uint8Array(4),f=this.painter.context,g=f.gl,y=Math.round(r.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(r.y*this.painter.pixelRatio/devicePixelRatio),R=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),g.readPixels(y,R-x-1,1,1,g.RGBA,g.UNSIGNED_BYTE,c),f.bindFramebuffer.set(null);const F=c[0]+(c[2]>>4<<8),H=c[1]+((15&c[2])<<8),X=this.coordsIndex[255-c[3]],ae=X&&this.sourceCache.getTileByID(X);if(!ae)return null;const ee=this._coordsTextureSize,de=(1<<ae.tileID.canonical.z)*ee;return new s.a1((ae.tileID.canonical.x*ee+F)/de+ae.tileID.wrap,(ae.tileID.canonical.y*ee+H)/de,this.getElevation(ae.tileID,F,H,ee))}depthAtPoint(r){const c=new Uint8Array(4),f=this.painter.context,g=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),g.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,g.RGBA,g.UNSIGNED_BYTE,c),f.bindFramebuffer.set(null),(c[0]/16777216+c[1]/65536+c[2]/256+c[3])/256}getTerrainMesh(r){var c;const f=((c=this.painter.style.projection)===null||c===void 0?void 0:c.transitionState)>0,g=f&&r.canonical.y===0,y=f&&r.canonical.y===(1<<r.canonical.z)-1,x=`m_${g?"n":""}_${y?"s":""}`;if(this._meshCache[x])return this._meshCache[x];const R=this.painter.context,F=new s.cv,H=new s.aN,X=this.meshSize,ae=s.$/X,ee=X*X;for(let Je=0;Je<=X;Je++)for(let mt=0;mt<=X;mt++)F.emplaceBack(mt*ae,Je*ae,0);for(let Je=0;Je<ee;Je+=X+1)for(let mt=0;mt<X;mt++)H.emplaceBack(mt+Je,X+mt+Je+1,X+mt+Je+2),H.emplaceBack(mt+Je,X+mt+Je+2,mt+Je+1);const de=F.length,Ae=de+(X+1),Fe=(X+1)*X,De=g?s.bh:0,je=g?0:1,Ue=y?s.bi:s.$,et=y?0:1;for(let Je=0;Je<=X;Je++)F.emplaceBack(Je*ae,De,je);for(let Je=0;Je<=X;Je++)F.emplaceBack(Je*ae,Ue,et);for(let Je=0;Je<X;Je++)H.emplaceBack(Fe+Je,Ae+Je,Ae+Je+1),H.emplaceBack(Fe+Je,Ae+Je+1,Fe+Je+1),H.emplaceBack(0+Je,de+Je+1,de+Je),H.emplaceBack(0+Je,0+Je+1,de+Je+1);const Xe=F.length,it=Xe+2*(X+1);for(const Je of[0,1])for(let mt=0;mt<=X;mt++)for(const Et of[0,1])F.emplaceBack(Je*s.$,mt*ae,Et);for(let Je=0;Je<2*X;Je+=2)H.emplaceBack(Xe+Je,Xe+Je+1,Xe+Je+3),H.emplaceBack(Xe+Je,Xe+Je+3,Xe+Je+2),H.emplaceBack(it+Je,it+Je+3,it+Je+1),H.emplaceBack(it+Je,it+Je+2,it+Je+3);const dt=new Lo(R.createVertexBuffer(F,k1.members),R.createIndexBuffer(H),s.aM.simpleSegment(0,0,F.length,H.length));return this._meshCache[x]=dt,dt}getMeshFrameDelta(r){return 2*Math.PI*s.bu/Math.pow(2,Math.max(r,0))/5}getMinTileElevationForLngLatZoom(r,c){var f;const{tileID:g}=this._getOverscaledTileIDFromLngLatZoom(r,c);return(f=this.getMinMaxElevation(g).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(r){const c=this.getTerrainData(r).tile,f={minElevation:null,maxElevation:null};return c&&c.dem&&(f.minElevation=c.dem.min*this.exaggeration,f.maxElevation=c.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(r,c){const f=s.a1.fromLngLat(r.wrap()),g=(1<<c)*s.$,y=f.x*g,x=f.y*g,R=Math.floor(y/s.$),F=Math.floor(x/s.$);return{tileID:new s.Z(c,0,c,R,F),mercatorX:y,mercatorY:x}}}class Sr{constructor(r,c,f){this._context=r,this._size=c,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const c=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),c.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),c.colorAttachment.set(f.texture),{id:r,fbo:c,texture:f,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(c=>r.id!==c),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const c of this._recentlyUsed)if(!this._objects[c].inUse)return this._objects[c];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const Fr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class kc{constructor(r,c){this.painter=r,this.terrain=c,this.pool=new Sr(r.context,30,c.sourceCache.tileSize*c.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,c){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(f=>!r._layers[f].isHidden(c)),this._coordsAscending={};for(const f in r.sourceCaches){this._coordsAscending[f]={};const g=r.sourceCaches[f].getVisibleCoordinates(),y=r.sourceCaches[f].getSource(),x=y instanceof Dr?y.terrainTileRanges:null;for(const R of g){const F=this.terrain.sourceCache.getTerrainCoords(R,x);for(const H in F)this._coordsAscending[f][H]||(this._coordsAscending[f][H]=[]),this._coordsAscending[f][H].push(F[H])}}this._coordsAscendingStr={};for(const f of r._order){const g=r._layers[f],y=g.source;if(Fr[g.type]&&!this._coordsAscendingStr[y]){this._coordsAscendingStr[y]={};for(const x in this._coordsAscending[y])this._coordsAscendingStr[y][x]=this._coordsAscending[y][x].map(R=>R.key).sort().join()}}for(const f of this._renderableTiles)for(const g in this._coordsAscendingStr){const y=this._coordsAscendingStr[g][f.tileID.key];y&&y!==f.rttCoords[g]&&(f.rtt=[])}}renderLayer(r,c){if(r.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},c),{isRenderingToTexture:!0}),g=r.type,y=this.painter,x=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(Fr[g]&&(this._prevType&&Fr[this._prevType]||this._stacks.push([]),this._prevType=g,this._stacks[this._stacks.length-1].push(r.id),!x))return!0;if(Fr[this._prevType]||Fr[g]&&x){this._prevType=g;const R=this._stacks.length-1,F=this._stacks[R]||[];for(const H of this._renderableTiles){if(this.pool.isFull()&&(Ts(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(H),H.rtt[R]){const ae=this.pool.getObjectForId(H.rtt[R].id);if(ae.stamp===H.rtt[R].stamp){this.pool.useObject(ae);continue}}const X=this.pool.getOrCreateFreeObject();this.pool.useObject(X),this.pool.stampObject(X),H.rtt[R]={id:X.id,stamp:X.stamp},y.context.bindFramebuffer.set(X.fbo.framebuffer),y.context.clear({color:s.bf.transparent,stencil:0}),y.currentStencilSource=void 0;for(let ae=0;ae<F.length;ae++){const ee=y.style._layers[F[ae]],de=ee.source?this._coordsAscending[ee.source][H.tileID.key]:[H.tileID];y.context.viewport.set([0,0,X.fbo.width,X.fbo.height]),y._renderTileClippingMasks(ee,de,!0),y.renderLayer(y,y.style.sourceCaches[ee.source],ee,de,f),ee.source&&(H.rttCoords[ee.source]=this._coordsAscendingStr[ee.source][H.tileID.key])}}return Ts(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),Fr[g]}return!1}}const H0={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use â + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},qh=w,ns={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Wh,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},W0={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class ta{constructor(r,c,f=!1){this.mousedown=y=>{this.startMove(y,V.mousePos(this.element,y)),V.addEventListener(window,"mousemove",this.mousemove),V.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=y=>{this.move(y,V.mousePos(this.element,y))},this.mouseup=y=>{this._rotatePitchHandler.dragEnd(y),this.offTemp()},this.touchstart=y=>{y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,y.targetTouches)[0],this.startMove(y,this._startPos),V.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.addEventListener(window,"touchend",this.touchend))},this.touchmove=y=>{y.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,y.targetTouches)[0],this.move(y,this._lastPos))},this.touchend=y=>{y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=c;const g=new P1;this._rotatePitchHandler=new ds({clickTolerance:3,move:(y,x)=>{const R=c.getBoundingClientRect(),F=new s.P((R.bottom-R.top)/2,(R.right-R.left)/2);return{bearingDelta:s.cn(new s.P(y.x,x.y),x,F),pitchDelta:f?-.5*(x.y-y.y):void 0}},moveStateManager:g,enable:!0,assignEvents:()=>{}}),this.map=r,V.addEventListener(c,"mousedown",this.mousedown),V.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),V.addEventListener(c,"touchcancel",this.reset)}startMove(r,c){this._rotatePitchHandler.dragStart(r,c),V.disableDrag()}move(r,c){const f=this.map,{bearingDelta:g,pitchDelta:y}=this._rotatePitchHandler.dragMove(r,c)||{};g&&f.setBearing(f.getBearing()+g),y&&f.setPitch(f.getPitch()+y)}off(){const r=this.element;V.removeEventListener(r,"mousedown",this.mousedown),V.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend),V.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,"mousemove",this.mousemove),V.removeEventListener(window,"mouseup",this.mouseup),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend)}}let $o;function Rl(v,r,c,f=!1){if(f||!c.getCoveringTilesDetailsProvider().allowWorldCopies())return v==null?void 0:v.wrap();const g=new s.S(v.lng,v.lat);if(v=new s.S(v.lng,v.lat),r){const y=new s.S(v.lng-360,v.lat),x=new s.S(v.lng+360,v.lat),R=c.locationToScreenPoint(v).distSqr(r);c.locationToScreenPoint(y).distSqr(r)<R?v=y:c.locationToScreenPoint(x).distSqr(r)<R&&(v=x)}for(;Math.abs(v.lng-c.center.lng)>180;){const y=c.locationToScreenPoint(v);if(y.x>=0&&y.y>=0&&y.x<=c.width&&y.y<=c.height)break;v.lng>c.center.lng?v.lng-=360:v.lng+=360}return v.lng!==g.lng&&c.isPointOnMapSurface(c.locationToScreenPoint(v))?v:g}const $i={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function mn(v,r,c){const f=v.classList;for(const g in $i)f.remove(`maplibregl-${c}-anchor-${g}`);f.add(`maplibregl-${c}-anchor-${r}`)}class Yh extends s.E{constructor(r){if(super(),this._onKeyPress=c=>{const f=c.code,g=c.charCode||c.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()},this._onMapClick=c=>{const f=c.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()},this._update=c=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((c==null?void 0:c.type)==="terrain"||(c==null?void 0:c.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=Rl(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||c&&c.type!=="moveend"||(this._pos=this._pos.round()),V.setTransform(this._element,`${$i[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${g}`),D.frameAsync(new AbortController).then(()=>{this._updateOpacity(c&&c.type==="moveend")}).catch(()=>{})},this._onMove=c=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=c=>{this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._subpixelPositioning=r&&r.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,this.setOpacity(r==null?void 0:r.opacity,r==null?void 0:r.opacityWhenCovered),r&&r.element)this._element=r.element,this._offset=s.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create("div");const c=V.createNS("http://www.w3.org/2000/svg","svg"),f=41,g=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${f}px`),c.setAttributeNS(null,"width",`${g}px`),c.setAttributeNS(null,"viewBox",`0 0 ${g} ${f}`);const y=V.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const x=V.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const R=V.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const F=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const je of F){const Ue=V.createNS("http://www.w3.org/2000/svg","ellipse");Ue.setAttributeNS(null,"opacity","0.04"),Ue.setAttributeNS(null,"cx","10.5"),Ue.setAttributeNS(null,"cy","5.80029008"),Ue.setAttributeNS(null,"rx",je.rx),Ue.setAttributeNS(null,"ry",je.ry),R.appendChild(Ue)}const H=V.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"fill",this._color);const X=V.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),H.appendChild(X);const ae=V.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"opacity","0.25"),ae.setAttributeNS(null,"fill","#000000");const ee=V.createNS("http://www.w3.org/2000/svg","path");ee.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ae.appendChild(ee);const de=V.createNS("http://www.w3.org/2000/svg","g");de.setAttributeNS(null,"transform","translate(6.0, 7.0)"),de.setAttributeNS(null,"fill","#FFFFFF");const Ae=V.createNS("http://www.w3.org/2000/svg","g");Ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Fe=V.createNS("http://www.w3.org/2000/svg","circle");Fe.setAttributeNS(null,"fill","#000000"),Fe.setAttributeNS(null,"opacity","0.25"),Fe.setAttributeNS(null,"cx","5.5"),Fe.setAttributeNS(null,"cy","5.5"),Fe.setAttributeNS(null,"r","5.4999962");const De=V.createNS("http://www.w3.org/2000/svg","circle");De.setAttributeNS(null,"fill","#FFFFFF"),De.setAttributeNS(null,"cx","5.5"),De.setAttributeNS(null,"cy","5.5"),De.setAttributeNS(null,"r","5.4999962"),Ae.appendChild(Fe),Ae.appendChild(De),x.appendChild(R),x.appendChild(H),x.appendChild(ae),x.appendChild(de),x.appendChild(Ae),c.appendChild(x),c.setAttributeNS(null,"height",f*this._scale+"px"),c.setAttributeNS(null,"width",g*this._scale+"px"),this._element.appendChild(c),this._offset=s.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),mn(this._element,this._anchor,"marker"),r&&r.className)for(const c of r.className.split(" "))this._element.classList.add(c);this._popup=null}addTo(r){return this.remove(),this._map=r,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",r._getUIString("Marker.Title")),r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),r.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=s.S.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const g=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[g,-1*(38.1-13.5+g)],"bottom-right":[-g,-1*(38.1-13.5+g)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(r){return this._subpixelPositioning=r,this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:r?(r.isOpen()?r.remove():(r.setLngLat(this._lngLat),r.addTo(this._map)),this):this}_updateOpacity(r=!1){var c,f;const g=(c=this._map)===null||c===void 0?void 0:c.terrain,y=this._map.transform.isLocationOccluded(this._lngLat);if(!g||y){const de=y?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==de&&(this._element.style.opacity=de))}if(r)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const x=this._map,R=x.terrain.depthAtPoint(this._pos),F=x.terrain.getElevationForLngLatZoom(this._lngLat,x.transform.tileZoom);if(x.transform.lngLatToCameraDepth(this._lngLat,F)-R<.006)return void(this._element.style.opacity=this._opacity);const H=-this._offset.y/x.transform.pixelsPerMeter,X=Math.sin(x.getPitch()*Math.PI/180)*H,ae=x.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),ee=x.transform.lngLatToCameraDepth(this._lngLat,F+X)-ae>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&ee&&this._popup.remove(),this._element.style.opacity=ee?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(r){return this._offset=s.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(r,c){return(this._opacity===void 0||r===void 0&&c===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),r!==void 0&&(this._opacity=r),c!==void 0&&(this._opacityWhenCovered=c),this._map&&this._updateOpacity(!0),this}}const Rc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Jo=0,Qo=!1;const qd={maxWidth:100,unit:"metric"};function Kh(v,r,c){const f=c&&c.maxWidth||100,g=v._container.clientHeight/2,y=v._container.clientWidth/2,x=v.unproject([y-f/2,g]),R=v.unproject([y+f/2,g]),F=Math.round(v.project(R).x-v.project(x).x),H=Math.min(f,F,v._container.clientWidth),X=x.distanceTo(R);if(c&&c.unit==="imperial"){const ae=3.2808*X;ae>5280?Ea(r,H,ae/5280,v._getUIString("ScaleControl.Miles")):Ea(r,H,ae,v._getUIString("ScaleControl.Feet"))}else c&&c.unit==="nautical"?Ea(r,H,X/1852,v._getUIString("ScaleControl.NauticalMiles")):X>=1e3?Ea(r,H,X/1e3,v._getUIString("ScaleControl.Kilometers")):Ea(r,H,X,v._getUIString("ScaleControl.Meters"))}function Ea(v,r,c,f){const g=function(y){const x=Math.pow(10,`${Math.floor(y)}`.length-1);let R=y/x;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(F){const H=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*H)/H}(R),x*R}(c);v.style.width=r*(g/c)+"px",v.innerHTML=`${g}&nbsp;${f}`}const Yd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Kd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $h(v){if(v){if(typeof v=="number"){const r=Math.round(Math.abs(v)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,v),"top-left":new s.P(r,r),"top-right":new s.P(-r,r),bottom:new s.P(0,-v),"bottom-left":new s.P(r,-r),"bottom-right":new s.P(-r,-r),left:new s.P(v,0),right:new s.P(-v,0)}}if(v instanceof s.P||Array.isArray(v)){const r=s.P.convert(v);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:s.P.convert(v.center||[0,0]),top:s.P.convert(v.top||[0,0]),"top-left":s.P.convert(v["top-left"]||[0,0]),"top-right":s.P.convert(v["top-right"]||[0,0]),bottom:s.P.convert(v.bottom||[0,0]),"bottom-left":s.P.convert(v["bottom-left"]||[0,0]),"bottom-right":s.P.convert(v["bottom-right"]||[0,0]),left:s.P.convert(v.left||[0,0]),right:s.P.convert(v.right||[0,0])}}return $h(new s.P(0,0))}const $d=w;p.AJAXError=s.cz,p.Event=s.l,p.Evented=s.E,p.LngLat=s.S,p.MercatorCoordinate=s.a1,p.Point=s.P,p.addProtocol=s.cA,p.config=s.a,p.removeProtocol=s.cB,p.AttributionControl=Wd,p.BoxZoomHandler=Bd,p.CanvasSource=ni,p.CooperativeGesturesHandler=N0,p.DoubleClickZoomHandler=j0,p.DragPanHandler=Ud,p.DragRotateHandler=O0,p.EdgeInsets=Fo,p.FullscreenControl=class extends s.E{constructor(v={}){super(),this._onFullscreenChange=()=>{var r;let c=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((r=c==null?void 0:c.shadowRoot)===null||r===void 0)&&r.fullscreenElement;)c=c.shadowRoot.fullscreenElement;c===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,v&&v.container&&(v.container instanceof HTMLElement?this._container=v.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const v=this._fullscreenButton=V.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);V.create("span","maplibregl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.title=v}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},p.GeoJSONSource=Tr,p.GeolocateControl=class extends s.E{constructor(v){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",r)),this._finish()}},this._updateCamera=r=>{const c=new s.S(r.coords.longitude,r.coords.latitude),f=r.coords.accuracy,g=this._map.getBearing(),y=s.e({bearing:g},this.options.fitBoundsOptions),x=Ot.fromLngLat(c,f);this._map.fitBounds(x,y,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const c=new s.S(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=r.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=r=>{if(this._map){if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&Qo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=V.create("button","maplibregl-ctrl-geolocate",this._container),V.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=r=>{if(this._map){if(r===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=V.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Yh({element:this._dotElement}),this._circleElement=V.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Yh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{const f=(c==null?void 0:c[0])instanceof ResizeObserverEntry;c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},Rc,v)}onAdd(v){return this._map=v,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(r=!1){if($o!==void 0&&!r)return $o;if(window.navigator.permissions===void 0)return $o=!!window.navigator.geolocation,$o;try{$o=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{$o=!!window.navigator.geolocation}return $o})}().then(r=>this._finishSetupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Jo=0,Qo=!1}_isOutOfMapMaxBounds(v){const r=this._map.getMaxBounds(),c=v.coords;return r&&(c.longitude<r.getWest()||c.longitude>r.getEast()||c.latitude<r.getSouth()||c.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const v=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&v))return;const r=this._map.project(v),c=this._map.unproject([r.x+100,r.y]),f=v.distanceTo(c)/100,g=2*this._accuracy/f;this._circleElement.style.width=`${g.toFixed(2)}px`,this._circleElement.style.height=`${g.toFixed(2)}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Jo--,Qo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Jo++,Jo>1?(v={maximumAge:6e5,timeout:0},Qo=!0):(v=this.options.positionOptions,Qo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,v)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},p.GlobeControl=class{constructor(){this._toggleProjection=()=>{var v;const r=(v=this._map.getProjection())===null||v===void 0?void 0:v.type;this._map.setProjection(r!=="mercator"&&r?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var v;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((v=this._map.getProjection())===null||v===void 0?void 0:v.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(v){return this._map=v,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=V.create("button","maplibregl-ctrl-globe",this._container),V.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},p.Hash=Xo,p.ImageSource=Dr,p.KeyboardHandler=li,p.LngLatBounds=Ot,p.LogoControl=Xd,p.Map=class extends Hh{constructor(v){var r,c;s.cw.mark(s.cx.create);const f=Object.assign(Object.assign(Object.assign({},ns),v),{canvasContextAttributes:Object.assign(Object.assign({},ns.canvasContextAttributes),v.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const g=new ji,y=new rs;if(f.minZoom!==void 0&&g.setMinZoom(f.minZoom),f.maxZoom!==void 0&&g.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&g.setMinPitch(f.minPitch),f.maxPitch!==void 0&&g.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&g.setRenderWorldCopies(f.renderWorldCopies),super(g,y,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new U0,this._controls=[],this._mapId=s.a7(),this._contextLost=R=>{R.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.l("webglcontextlost",{originalEvent:R}))},this._contextRestored=R=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:R}))},this._onMapScroll=R=>{if(R.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},H0),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=N.addThrottleControl(()=>this.isMoving()),this._requestManager=new re(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let R=!1;const F=zd(H=>{this._trackResize&&!this._removed&&(this.resize(H),this.redraw())},50);this._resizeObserver=new ResizeObserver(H=>{R?F(H):R=!0}),this._resizeObserver.observe(this._container)}this.handlers=new E1(this,f),this._hash=f.hash&&new Xo(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,s.e({},f.fitBoundsOptions,{duration:0}))));const x=typeof f.style=="string"||((c=(r=f.style)===null||r===void 0?void 0:r.projection)===null||c===void 0?void 0:c.type)!=="globe";this.resize(null,x),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Wd(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new Xd,f.logoPosition),this.on("style.load",()=>{if(x||this._resizeTransform(),this.transform.unmodified){const R=s.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(R)}}),this.on("data",R=>{this._update(R.dataType==="style"),this.fire(new s.l(`${R.dataType}data`,R))}),this.on("dataloading",R=>{this.fire(new s.l(`${R.dataType}dataloading`,R))}),this.on("dataabort",R=>{this.fire(new s.l("sourcedataabort",R))})}_getMapId(){return this._mapId}setGlobalStateProperty(v,r){return this.style.setGlobalStateProperty(v,r),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(v,r){if(r===void 0&&(r=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=v.onAdd(this);this._controls.push(v);const f=this._controlPositions[r];return r.indexOf("bottom")!==-1?f.insertBefore(c,f.firstChild):f.appendChild(c),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(v);return r>-1&&this._controls.splice(r,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}coveringTiles(v){return st(this.transform,v)}calculateCameraOptionsFromTo(v,r,c,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(v,r,c,f)}resize(v,r=!0){const[c,f]=this._containerDimensions(),g=this._getClampedPixelRatio(c,f);if(this._resizeCanvas(c,f,g),this.painter.resize(c,f,g),this.painter.overLimit()){const x=this.painter.context.gl;this._maxCanvasSize=[x.drawingBufferWidth,x.drawingBufferHeight];const R=this._getClampedPixelRatio(c,f);this._resizeCanvas(c,f,R),this.painter.resize(c,f,R)}this._resizeTransform(r);const y=!this._moving;return y&&(this.stop(),this.fire(new s.l("movestart",v)).fire(new s.l("move",v))),this.fire(new s.l("resize",v)),y&&this.fire(new s.l("moveend",v)),this}_resizeTransform(v=!0){var r;const[c,f]=this._containerDimensions();this.transform.resize(c,f,v),(r=this._requestedCameraState)===null||r===void 0||r.resize(c,f,v)}_getClampedPixelRatio(v,r){const{0:c,1:f}=this._maxCanvasSize,g=this.getPixelRatio(),y=v*g,x=r*g;return Math.min(y>c?c/y:1,x>f?f/x:1)*g}getPixelRatio(){var v;return(v=this._overridePixelRatio)!==null&&v!==void 0?v:devicePixelRatio}setPixelRatio(v){this._overridePixelRatio=v,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(v){return this.transform.setMaxBounds(Ot.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.setMinZoom(v),this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.setMaxZoom(v),this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.setMinPitch(v),this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(v>=this.transform.minPitch)return this.transform.setMaxPitch(v),this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.setRenderWorldCopies(v),this._update()}project(v){return this.transform.locationToScreenPoint(s.S.convert(v),this.style&&this.terrain)}unproject(v){return this.transform.screenPointToLocation(s.P.convert(v),this.terrain)}isMoving(){var v;return this._moving||((v=this.handlers)===null||v===void 0?void 0:v.isMoving())}isZooming(){var v;return this._zooming||((v=this.handlers)===null||v===void 0?void 0:v.isZooming())}isRotating(){var v;return this._rotating||((v=this.handlers)===null||v===void 0?void 0:v.isRotating())}_createDelegatedListener(v,r,c){if(v==="mouseenter"||v==="mouseover"){let f=!1;return{layers:r,listener:c,delegates:{mousemove:y=>{const x=r.filter(F=>this.getLayer(F)),R=x.length!==0?this.queryRenderedFeatures(y.point,{layers:x}):[];R.length?f||(f=!0,c.call(this,new vs(v,this,y.originalEvent,{features:R}))):f=!1},mouseout:()=>{f=!1}}}}if(v==="mouseleave"||v==="mouseout"){let f=!1;return{layers:r,listener:c,delegates:{mousemove:x=>{const R=r.filter(F=>this.getLayer(F));(R.length!==0?this.queryRenderedFeatures(x.point,{layers:R}):[]).length?f=!0:f&&(f=!1,c.call(this,new vs(v,this,x.originalEvent)))},mouseout:x=>{f&&(f=!1,c.call(this,new vs(v,this,x.originalEvent)))}}}}{const f=g=>{const y=r.filter(R=>this.getLayer(R)),x=y.length!==0?this.queryRenderedFeatures(g.point,{layers:y}):[];x.length&&(g.features=x,c.call(this,g),delete g.features)};return{layers:r,listener:c,delegates:{[v]:f}}}}_saveDelegatedListener(v,r){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(r)}_removeDelegatedListener(v,r,c){if(!this._delegatedListeners||!this._delegatedListeners[v])return;const f=this._delegatedListeners[v];for(let g=0;g<f.length;g++){const y=f[g];if(y.listener===c&&y.layers.length===r.length&&y.layers.every(x=>r.includes(x))){for(const x in y.delegates)this.off(x,y.delegates[x]);return void f.splice(g,1)}}}on(v,r,c){if(c===void 0)return super.on(v,r);const f=typeof r=="string"?[r]:r,g=this._createDelegatedListener(v,f,c);this._saveDelegatedListener(v,g);for(const y in g.delegates)this.on(y,g.delegates[y]);return{unsubscribe:()=>{this._removeDelegatedListener(v,f,c)}}}once(v,r,c){if(c===void 0)return super.once(v,r);const f=typeof r=="string"?[r]:r,g=this._createDelegatedListener(v,f,c);for(const y in g.delegates){const x=g.delegates[y];g.delegates[y]=(...R)=>{this._removeDelegatedListener(v,f,c),x(...R)}}this._saveDelegatedListener(v,g);for(const y in g.delegates)this.once(y,g.delegates[y]);return this}off(v,r,c){return c===void 0?super.off(v,r):(this._removeDelegatedListener(v,typeof r=="string"?[r]:r,c),this)}queryRenderedFeatures(v,r){if(!this.style)return[];let c;const f=v instanceof s.P||Array.isArray(v),g=f?v:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(f?{}:v)||{},g instanceof s.P||typeof g[0]=="number")c=[s.P.convert(g)];else{const y=s.P.convert(g[0]),x=s.P.convert(g[1]);c=[y,new s.P(x.x,y.y),x,new s.P(y.x,x.y),y]}return this.style.queryRenderedFeatures(c,r,this.transform)}querySourceFeatures(v,r){return this.style.querySourceFeatures(v,r)}setStyle(v,r){return(r=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(v,r))}setTransformRequest(v){return this._requestManager.setTransformRequest(v),this}_getUIString(v){const r=this._locale[v];if(r==null)throw new Error(`Missing UI string '${v}'`);return r}_updateStyle(v,r){var c,f;if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(v,r));const g=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!v)),v?(this.style=new ud(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v,r,g):this.style.loadJSON(v,r,g),this):((f=(c=this.style)===null||c===void 0?void 0:c.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ud(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,r){if(typeof v=="string"){const c=this._requestManager.transformRequest(v,"Style");s.j(c,new AbortController).then(f=>{this._updateDiff(f.data,r)}).catch(f=>{f&&this.fire(new s.k(f))})}else typeof v=="object"&&this._updateDiff(v,r)}_updateDiff(v,r){try{this.style.setState(v,r)&&this._update(!0)}catch(c){s.w(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(v,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(v,r){return this._lazyInitEmptyStyle(),this.style.addSource(v,r),this._update(!0)}isSourceLoaded(v){const r=this.style&&this.style.sourceCaches[v];if(r!==void 0)return r.loaded();this.fire(new s.k(new Error(`There is no source with ID '${v}'`)))}setTerrain(v){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),v){const r=this.style.sourceCaches[v.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${v.source}`);this.terrain===null&&r.reload();for(const c in this.style._layers){const f=this.style._layers[c];f.type==="hillshade"&&f.source===v.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===v.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Xh(this.painter,r,v),this.painter.renderToTexture=new kc(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=c=>{var f;c.dataType==="style"?this.terrain.sourceCache.freeRtt():c.dataType==="source"&&c.tile&&(c.sourceId!==v.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=c.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(c.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:v})),this}getTerrain(){var v,r;return(r=(v=this.terrain)===null||v===void 0?void 0:v.options)!==null&&r!==void 0?r:null}areTilesLoaded(){const v=this.style&&this.style.sourceCaches;for(const r in v){const c=v[r]._tiles;for(const f in c){const g=c[f];if(g.state!=="loaded"&&g.state!=="errored")return!1}}return!0}removeSource(v){return this.style.removeSource(v),this._update(!0)}getSource(v){return this.style.getSource(v)}setSourceTileLodParams(v,r,c){if(c){const f=this.getSource(c);if(!f)throw new Error(`There is no source with ID "${c}", cannot set LOD parameters`);f.calculateTileZoom=Vt(Math.max(1,v),Math.max(1,r))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=Vt(Math.max(1,v),Math.max(1,r));return this._update(!0),this}refreshTiles(v,r){const c=this.style.sourceCaches[v];if(!c)throw new Error(`There is no source cache with ID "${v}", cannot refresh tile`);r===void 0?c.reload(!0):c.refreshTiles(r.map(f=>new s.a4(f.z,f.x,f.y)))}addImage(v,r,c={}){const{pixelRatio:f=1,sdf:g=!1,stretchX:y,stretchY:x,content:R,textFitWidth:F,textFitHeight:H}=c;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||s.b(r))){if(r.width===void 0||r.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:X,height:ae,data:ee}=r,de=r;return this.style.addImage(v,{data:new s.R({width:X,height:ae},new Uint8Array(ee)),pixelRatio:f,stretchX:y,stretchY:x,content:R,textFitWidth:F,textFitHeight:H,sdf:g,version:0,userImage:de}),de.onAdd&&de.onAdd(this,v),this}}{const{width:X,height:ae,data:ee}=D.getImageData(r);this.style.addImage(v,{data:new s.R({width:X,height:ae},ee),pixelRatio:f,stretchX:y,stretchY:x,content:R,textFitWidth:F,textFitHeight:H,sdf:g,version:0})}}updateImage(v,r){const c=this.style.getImage(v);if(!c)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=r instanceof HTMLImageElement||s.b(r)?D.getImageData(r):r,{width:g,height:y,data:x}=f;if(g===void 0||y===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(g!==c.data.width||y!==c.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(r instanceof HTMLImageElement||s.b(r));return c.data.replace(x,R),this.style.updateImage(v,c),this}getImage(v){return this.style.getImage(v)}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v){return N.getImage(this._requestManager.transformRequest(v,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(v,r){return this._lazyInitEmptyStyle(),this.style.addLayer(v,r),this._update(!0)}moveLayer(v,r){return this.style.moveLayer(v,r),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(v,r,c){return this.style.setLayerZoomRange(v,r,c),this._update(!0)}setFilter(v,r,c={}){return this.style.setFilter(v,r,c),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,r,c,f={}){return this.style.setPaintProperty(v,r,c,f),this._update(!0)}getPaintProperty(v,r){return this.style.getPaintProperty(v,r)}setLayoutProperty(v,r,c,f={}){return this.style.setLayoutProperty(v,r,c,f),this._update(!0)}getLayoutProperty(v,r){return this.style.getLayoutProperty(v,r)}setGlyphs(v,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(v,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(v,r,c={}){return this._lazyInitEmptyStyle(),this.style.addSprite(v,r,c,f=>{f||this._update(!0)}),this}removeSprite(v){return this._lazyInitEmptyStyle(),this.style.removeSprite(v),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(v,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(v,r,c=>{c||this._update(!0)}),this}setLight(v,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,r),this._update(!0)}getLight(){return this.style.getLight()}setSky(v,r={}){return this._lazyInitEmptyStyle(),this.style.setSky(v,r),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(v,r){return this.style.setFeatureState(v,r),this._update()}removeFeatureState(v,r){return this.style.removeFeatureState(v,r),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let v=0,r=0;return this._container&&(v=this._container.clientWidth||400,r=this._container.clientHeight||300),[v,r]}_setupContainer(){const v=this._container;v.classList.add("maplibregl-map");const r=this._canvasContainer=V.create("div","maplibregl-canvas-container",v);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=V.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const c=this._containerDimensions(),f=this._getClampedPixelRatio(c[0],c[1]);this._resizeCanvas(c[0],c[1],f);const g=this._controlContainer=V.create("div","maplibregl-control-container",v),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{y[x]=V.create("div",`maplibregl-ctrl-${x} `,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,r,c){this._canvas.width=Math.floor(c*v),this._canvas.height=Math.floor(c*r),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const v=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let r=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{r={requestedAttributes:v},f&&(r.statusMessage=f.statusMessage,r.type=f.type)},{once:!0});let c=null;if(c=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,v):this._canvas.getContext("webgl2",v)||this._canvas.getContext("webgl",v),!c){const f="Failed to initialize WebGL";throw r?(r.message=f,new Error(JSON.stringify(r))):new Error(f)}this.painter=new Gh(c,this.transform),W.testSupport(c)}migrateProjection(v,r){super.migrateProjection(v,r),this.painter.transform=v,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_render(v){var r,c,f,g,y;const x=this._idleTriggered?this._fadeDuration:0,R=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),this._removed)return;let F=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const ae=this.transform.zoom,ee=D.now();this.style.zoomHistory.update(ae,ee);const de=new s.F(ae,{now:ee,fadeDuration:x,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ae=de.crossFadingFactor();Ae===1&&Ae===this._crossFadingFactor||(F=!0,this._crossFadingFactor=Ae),this.style.update(de)}const H=((c=this.style.projection)===null||c===void 0?void 0:c.transitionState)>0!==R;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((g=this.style.projection)===null||g===void 0?void 0:g.transitionState,(y=this.style.projection)===null||y===void 0?void 0:y.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||H)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,H),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cw.mark(s.cx.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||F)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const X=this._sourcesDirty||this._styleDirty||this._placementDirty;return X||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||X||(this._fullyLoaded=!0,s.cw.mark(s.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var v;this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),N.removeThrottleControl(this._imageQueueHandle),(v=this._resizeObserver)===null||v===void 0||v.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r!=null&&r.loseContext&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cw.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,D.frame(this._frameRequest,v=>{s.cw.frame(v),this._frameRequest=null;try{this._render(v)}catch(r){if(!s.cy(r)&&!function(c){return c.message===wc}(r))throw r}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get version(){return qh}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(v){return this._lazyInitEmptyStyle(),this.style.setProjection(v),this._update(!0)}},p.MapMouseEvent=vs,p.MapTouchEvent=Sl,p.MapWheelEvent=Dd,p.Marker=Yh,p.NavigationControl=class{constructor(v){this._updateZoomButtons=()=>{const r=this._map.getZoom(),c=r===this._map.getMaxZoom(),f=r===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(r,c)=>{const f=this._map._getUIString(`NavigationControl.${c}`);r.title=f,r.setAttribute("aria-label",f)},this.options=s.e({},W0,v),this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),V.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),V.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=V.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ta(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(v,r){const c=V.create("button",v,this._container);return c.type="button",c.addEventListener("click",r),c}},p.Popup=class extends s.E{constructor(v){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=V.create("div","maplibregl-popup",this._map.getContainer()),this._tip=V.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Rl(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!r)return;const c=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const g=$h(this.options.offset);if(!f){const x=this._container.offsetWidth,R=this._container.offsetHeight;let F;F=c.y+g.bottom.y<R?["top"]:c.y>this._map.transform.height-R?["bottom"]:[],c.x<x/2?F.push("left"):c.x>this._map.transform.width-x/2&&F.push("right"),f=F.length===0?"bottom":F.join("-")}let y=c.add(g[f]);this.options.subpixelPositioning||(y=y.round()),V.setTransform(this._container,`${$i[f]} translate(${y.x}px,${y.y}px)`),mn(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(Yd),v)}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(v){return this._lngLat=s.S.convert(v),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(document.createTextNode(v))}setHTML(v){const r=document.createDocumentFragment(),c=document.createElement("body");let f;for(c.innerHTML=v;f=c.firstChild,f;)r.appendChild(f);return this.setDOMContent(r)}getMaxWidth(){var v;return(v=this._container)===null||v===void 0?void 0:v.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(v),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(v){return this._container&&this._container.classList.add(v),this}removeClassName(v){return this._container&&this._container.classList.remove(v),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){if(this._container)return this._container.classList.toggle(v)}setSubpixelPositioning(v){this.options.subpixelPositioning=v}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector(Kd);v&&v.focus()}},p.RasterDEMTileSource=kr,p.RasterTileSource=yr,p.ScaleControl=class{constructor(v){this._onMove=()=>{Kh(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,Kh(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},qd),v)}getDefaultPosition(){return"bottom-left"}onAdd(v){return this._map=v,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-scale",v.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},p.ScrollZoomHandler=V0,p.Style=ud,p.TerrainControl=class{constructor(v){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=v}onAdd(v){return this._map=v,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=V.create("button","maplibregl-ctrl-terrain",this._container),V.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},p.TwoFingersTouchPitchHandler=kl,p.TwoFingersTouchRotateHandler=Vd,p.TwoFingersTouchZoomHandler=Gd,p.TwoFingersTouchZoomRotateHandler=Hd,p.VectorTileSource=Ar,p.VideoSource=hi,p.addSourceType=(v,r)=>s._(void 0,void 0,void 0,function*(){if(dn(v))throw new Error(`A source type called "${v}" already exists.`);((c,f)=>{ui[c]=f})(v,r)}),p.clearPrewarmedResources=function(){const v=ot;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(ge),ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},p.createTileMesh=cd,p.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},p.getRTLTextPluginStatus=function(){return xi().getRTLTextPluginStatus()},p.getVersion=function(){return $d},p.getWorkerCount=function(){return Ye.workerCount},p.getWorkerUrl=function(){return s.a.WORKER_URL},p.importScriptInWorkers=function(v){return Lt().broadcast("IS",v)},p.prewarm=function(){Ce().acquire(ge)},p.setMaxParallelImageRequests=function(v){s.a.MAX_PARALLEL_IMAGE_REQUESTS=v},p.setRTLTextPlugin=function(v,r){return xi().setRTLTextPlugin(v,r)},p.setWorkerCount=function(v){Ye.workerCount=v},p.setWorkerUrl=function(v){s.a.WORKER_URL=v}});var d=i;return d})}(Dm)),Dm.exports}var AT=IT();const T_=Hg(AT);var aa=63710088e-1,j8={centimeters:aa*100,centimetres:aa*100,degrees:360/(2*Math.PI),feet:aa*3.28084,inches:aa*39.37,kilometers:aa/1e3,kilometres:aa/1e3,meters:aa,metres:aa,miles:aa/1609.344,millimeters:aa*1e3,millimetres:aa*1e3,nauticalmiles:aa/1852,radians:1,yards:aa*1.0936};function Z8(e,t,i={}){const a={type:"Feature"};return(i.id===0||i.id)&&(a.id=i.id),i.bbox&&(a.bbox=i.bbox),a.properties=t||{},a.geometry=e,a}function Qm(e,t,i={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!wv(e[0])||!wv(e[1]))throw new Error("coordinates must contain numbers");return Z8({type:"Point",coordinates:e},t,i)}function TT(e,t,i={}){for(const h of e){if(h.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(h[h.length-1].length!==h[0].length)throw new Error("First and last Position are not equivalent.");for(let d=0;d<h[h.length-1].length;d++)if(h[h.length-1][d]!==h[0][d])throw new Error("First and last Position are not equivalent.")}return Z8({type:"Polygon",coordinates:e},t,i)}function CT(e,t={}){const i={type:"FeatureCollection"};return t.id&&(i.id=t.id),t.bbox&&(i.bbox=t.bbox),i.features=e,i}function ST(e,t="kilometers"){const i=j8[t];if(!i)throw new Error(t+" units is invalid");return e*i}function PT(e,t="kilometers"){const i=j8[t];if(!i)throw new Error(t+" units is invalid");return e/i}function bv(e){return e%(2*Math.PI)*180/Math.PI}function Na(e){return e%360*Math.PI/180}function wv(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function ET(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Ku(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function kf(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function kT(e,t){return e.type==="FeatureCollection"?"FeatureCollection":e.type==="GeometryCollection"?"GeometryCollection":e.type==="Feature"&&e.geometry!==null?e.geometry.type:e.type}function O8(e,t,i={}){if(i.final===!0)return RT(e,t);const a=Ku(e),h=Ku(t),d=Na(a[0]),p=Na(h[0]),s=Na(a[1]),w=Na(h[1]),A=Math.sin(p-d)*Math.cos(w),z=Math.cos(s)*Math.sin(w)-Math.sin(s)*Math.cos(w)*Math.cos(p-d);return bv(Math.atan2(A,z))}function RT(e,t){let i=O8(t,e);return i=(i+180)%360,i}function LT(e,t,i,a={}){const h=Ku(e),d=Na(h[0]),p=Na(h[1]),s=Na(i),w=PT(t,a.units),A=Math.asin(Math.sin(p)*Math.cos(w)+Math.cos(p)*Math.sin(w)*Math.cos(s)),z=d+Math.atan2(Math.sin(s)*Math.sin(w)*Math.cos(p),Math.cos(w)-Math.sin(p)*Math.sin(A)),B=bv(z),D=bv(A);return Qm([B,D],a.properties)}function N8(e,t,i={}){var a=Ku(e),h=Ku(t),d=Na(h[1]-a[1]),p=Na(h[0]-a[0]),s=Na(a[1]),w=Na(h[1]),A=Math.pow(Math.sin(d/2),2)+Math.pow(Math.sin(p/2),2)*Math.cos(s)*Math.cos(w);return ST(2*Math.atan2(Math.sqrt(A),Math.sqrt(1-A)),i.units)}var U8=N8;function id(e,t,i){if(e!==null)for(var a,h,d,p,s,w,A,z=0,B=0,D,V=e.type,W=V==="FeatureCollection",S=V==="Feature",j=W?e.features.length:1,ne=0;ne<j;ne++){A=W?e.features[ne].geometry:S?e.geometry:e,D=A?A.type==="GeometryCollection":!1,s=D?A.geometries.length:1;for(var te=0;te<s;te++){var Q=0,N=0;if(p=D?A.geometries[te]:A,p!==null){w=p.coordinates;var re=p.type;switch(z=i&&(re==="Polygon"||re==="MultiPolygon")?1:0,re){case null:break;case"Point":if(t(w,B,ne,Q,N)===!1)return!1;B++,Q++;break;case"LineString":case"MultiPoint":for(a=0;a<w.length;a++){if(t(w[a],B,ne,Q,N)===!1)return!1;B++,re==="MultiPoint"&&Q++}re==="LineString"&&Q++;break;case"Polygon":case"MultiLineString":for(a=0;a<w.length;a++){for(h=0;h<w[a].length-z;h++){if(t(w[a][h],B,ne,Q,N)===!1)return!1;B++}re==="MultiLineString"&&Q++,re==="Polygon"&&N++}re==="Polygon"&&Q++;break;case"MultiPolygon":for(a=0;a<w.length;a++){for(N=0,h=0;h<w[a].length;h++){for(d=0;d<w[a][h].length-z;d++){if(t(w[a][h][d],B,ne,Q,N)===!1)return!1;B++}N++}Q++}break;case"GeometryCollection":for(a=0;a<p.geometries.length;a++)if(id(p.geometries[a],t,i)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Ex(e,t){if(e.type==="Feature")t(e,0);else if(e.type==="FeatureCollection")for(var i=0;i<e.features.length&&t(e.features[i],i)!==!1;i++);}function H8(e,t){var i,a,h,d,p,s,w,A,z,B,D=0,V=e.type==="FeatureCollection",W=e.type==="Feature",S=V?e.features.length:1;for(i=0;i<S;i++){for(s=V?e.features[i].geometry:W?e.geometry:e,A=V?e.features[i].properties:W?e.properties:{},z=V?e.features[i].bbox:W?e.bbox:void 0,B=V?e.features[i].id:W?e.id:void 0,w=s?s.type==="GeometryCollection":!1,p=w?s.geometries.length:1,h=0;h<p;h++){if(d=w?s.geometries[h]:s,d===null){if(t(null,D,A,z,B)===!1)return!1;continue}switch(d.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(d,D,A,z,B)===!1)return!1;break}case"GeometryCollection":{for(a=0;a<d.geometries.length;a++)if(t(d.geometries[a],D,A,z,B)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}D++}}function W8(e,t={}){if(e.bbox!=null&&t.recompute!==!0)return e.bbox;const i=[1/0,1/0,-1/0,-1/0];return id(e,a=>{i[0]>a[0]&&(i[0]=a[0]),i[1]>a[1]&&(i[1]=a[1]),i[2]<a[0]&&(i[2]=a[0]),i[3]<a[1]&&(i[3]=a[1])}),i}function xv(e){const t=kf(e);let i=0,a=1,h,d;for(;a<t.length;)h=d||t[0],d=t[a],i+=(d[0]-h[0])*(d[1]+h[1]),a++;return i>0}const ws=11102230246251565e-32,Ir=134217729,X8=(3+8*ws)*ws;function qn(e,t,i,a,h){let d,p,s,w,A=t[0],z=a[0],B=0,D=0;z>A==z>-A?(d=A,A=t[++B]):(d=z,z=a[++D]);let V=0;if(B<e&&D<i)for(z>A==z>-A?(p=A+d,s=d-(p-A),A=t[++B]):(p=z+d,s=d-(p-z),z=a[++D]),d=p,s!==0&&(h[V++]=s);B<e&&D<i;)z>A==z>-A?(p=d+A,w=p-d,s=d-(p-w)+(A-w),A=t[++B]):(p=d+z,w=p-d,s=d-(p-w)+(z-w),z=a[++D]),d=p,s!==0&&(h[V++]=s);for(;B<e;)p=d+A,w=p-d,s=d-(p-w)+(A-w),A=t[++B],d=p,s!==0&&(h[V++]=s);for(;D<i;)p=d+z,w=p-d,s=d-(p-w)+(z-w),z=a[++D],d=p,s!==0&&(h[V++]=s);return(d!==0||V===0)&&(h[V++]=d),V}function ya(e,t,i,a,h,d,p,s){return qn(qn(e,t,i,a,p),p,h,d,s)}function tr(e,t,i,a){let h,d,p,s,w,A,z,B,D,V,W;z=Ir*i,V=z-(z-i),W=i-V;let S=t[0];h=S*i,z=Ir*S,B=z-(z-S),D=S-B,p=D*W-(h-B*V-D*V-B*W);let j=0;p!==0&&(a[j++]=p);for(let ne=1;ne<e;ne++)S=t[ne],s=S*i,z=Ir*S,B=z-(z-S),D=S-B,w=D*W-(s-B*V-D*V-B*W),d=h+w,A=d-h,p=h-(d-A)+(w-A),p!==0&&(a[j++]=p),h=s+d,p=d-(h-s),p!==0&&(a[j++]=p);return(h!==0||j===0)&&(a[j++]=h),j}function q8(e,t){let i=t[0];for(let a=1;a<e;a++)i+=t[a];return i}function Ai(e){return new Float64Array(e)}const zT=(3+16*ws)*ws,FT=(2+12*ws)*ws,DT=(9+64*ws)*ws*ws,_u=Ai(4),kx=Ai(8),Rx=Ai(12),Lx=Ai(16),Rs=Ai(4);function BT(e,t,i,a,h,d,p){let s,w,A,z,B,D,V,W,S,j,ne,te,Q,N,re,oe,ve,Pe;const $=e-h,le=i-h,Me=t-d,Ve=a-d;N=$*Ve,D=Ir*$,V=D-(D-$),W=$-V,D=Ir*Ve,S=D-(D-Ve),j=Ve-S,re=W*j-(N-V*S-W*S-V*j),oe=Me*le,D=Ir*Me,V=D-(D-Me),W=Me-V,D=Ir*le,S=D-(D-le),j=le-S,ve=W*j-(oe-V*S-W*S-V*j),ne=re-ve,B=re-ne,_u[0]=re-(ne+B)+(B-ve),te=N+ne,B=te-N,Q=N-(te-B)+(ne-B),ne=Q-oe,B=Q-ne,_u[1]=Q-(ne+B)+(B-oe),Pe=te+ne,B=Pe-te,_u[2]=te-(Pe-B)+(ne-B),_u[3]=Pe;let Be=q8(4,_u),q=FT*p;if(Be>=q||-Be>=q||(B=e-$,s=e-($+B)+(B-h),B=i-le,A=i-(le+B)+(B-h),B=t-Me,w=t-(Me+B)+(B-d),B=a-Ve,z=a-(Ve+B)+(B-d),s===0&&w===0&&A===0&&z===0)||(q=DT*p+X8*Math.abs(Be),Be+=$*z+Ve*s-(Me*A+le*w),Be>=q||-Be>=q))return Be;N=s*Ve,D=Ir*s,V=D-(D-s),W=s-V,D=Ir*Ve,S=D-(D-Ve),j=Ve-S,re=W*j-(N-V*S-W*S-V*j),oe=w*le,D=Ir*w,V=D-(D-w),W=w-V,D=Ir*le,S=D-(D-le),j=le-S,ve=W*j-(oe-V*S-W*S-V*j),ne=re-ve,B=re-ne,Rs[0]=re-(ne+B)+(B-ve),te=N+ne,B=te-N,Q=N-(te-B)+(ne-B),ne=Q-oe,B=Q-ne,Rs[1]=Q-(ne+B)+(B-oe),Pe=te+ne,B=Pe-te,Rs[2]=te-(Pe-B)+(ne-B),Rs[3]=Pe;const me=qn(4,_u,4,Rs,kx);N=$*z,D=Ir*$,V=D-(D-$),W=$-V,D=Ir*z,S=D-(D-z),j=z-S,re=W*j-(N-V*S-W*S-V*j),oe=Me*A,D=Ir*Me,V=D-(D-Me),W=Me-V,D=Ir*A,S=D-(D-A),j=A-S,ve=W*j-(oe-V*S-W*S-V*j),ne=re-ve,B=re-ne,Rs[0]=re-(ne+B)+(B-ve),te=N+ne,B=te-N,Q=N-(te-B)+(ne-B),ne=Q-oe,B=Q-ne,Rs[1]=Q-(ne+B)+(B-oe),Pe=te+ne,B=Pe-te,Rs[2]=te-(Pe-B)+(ne-B),Rs[3]=Pe;const Ee=qn(me,kx,4,Rs,Rx);N=s*z,D=Ir*s,V=D-(D-s),W=s-V,D=Ir*z,S=D-(D-z),j=z-S,re=W*j-(N-V*S-W*S-V*j),oe=w*A,D=Ir*w,V=D-(D-w),W=w-V,D=Ir*A,S=D-(D-A),j=A-S,ve=W*j-(oe-V*S-W*S-V*j),ne=re-ve,B=re-ne,Rs[0]=re-(ne+B)+(B-ve),te=N+ne,B=te-N,Q=N-(te-B)+(ne-B),ne=Q-oe,B=Q-ne,Rs[1]=Q-(ne+B)+(B-oe),Pe=te+ne,B=Pe-te,Rs[2]=te-(Pe-B)+(ne-B),Rs[3]=Pe;const Ne=qn(Ee,Rx,4,Rs,Lx);return Lx[Ne-1]}function yo(e,t,i,a,h,d){const p=(t-d)*(i-h),s=(e-h)*(a-d),w=p-s,A=Math.abs(p+s);return Math.abs(w)>=zT*A?w:-BT(e,t,i,a,h,d,A)}const GT=(10+96*ws)*ws,VT=(4+48*ws)*ws,jT=(44+576*ws)*ws*ws,Bl=Ai(4),Gl=Ai(4),Vl=Ai(4),ao=Ai(4),oo=Ai(4),lo=Ai(4),Ls=Ai(4),zs=Ai(4),C_=Ai(8),S_=Ai(8),P_=Ai(8),E_=Ai(8),k_=Ai(8),R_=Ai(8),pm=Ai(8),mm=Ai(8),gm=Ai(8),Uc=Ai(4),Hc=Ai(4),Wc=Ai(4),Lr=Ai(8),Or=Ai(16),Oi=Ai(16),Ni=Ai(16),Ti=Ai(32),jl=Ai(32),bn=Ai(48),Ns=Ai(64);let Bu=Ai(1152),L_=Ai(1152);function wn(e,t,i){e=qn(e,Bu,t,i,L_);const a=Bu;return Bu=L_,L_=a,e}function ZT(e,t,i,a,h,d,p,s,w){let A,z,B,D,V,W,S,j,ne,te,Q,N,re,oe,ve,Pe,$,le,Me,Ve,Be,q,me,Ee,Ne,$e,ye,ge,Ye,We,ot,Se,Ce,It,Lt;const Xt=e-p,Jt=i-p,dr=h-p,zt=t-s,Zt=a-s,Ot=d-s;ot=Jt*Ot,me=Ir*Jt,Ee=me-(me-Jt),Ne=Jt-Ee,me=Ir*Ot,$e=me-(me-Ot),ye=Ot-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=dr*Zt,me=Ir*dr,Ee=me-(me-dr),Ne=dr-Ee,me=Ir*Zt,$e=me-(me-Zt),ye=Zt-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se-It,q=Se-ge,Bl[0]=Se-(ge+q)+(q-It),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We-Ce,q=We-ge,Bl[1]=We-(ge+q)+(q-Ce),Lt=Ye+ge,q=Lt-Ye,Bl[2]=Ye-(Lt-q)+(ge-q),Bl[3]=Lt,ot=dr*zt,me=Ir*dr,Ee=me-(me-dr),Ne=dr-Ee,me=Ir*zt,$e=me-(me-zt),ye=zt-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=Xt*Ot,me=Ir*Xt,Ee=me-(me-Xt),Ne=Xt-Ee,me=Ir*Ot,$e=me-(me-Ot),ye=Ot-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se-It,q=Se-ge,Gl[0]=Se-(ge+q)+(q-It),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We-Ce,q=We-ge,Gl[1]=We-(ge+q)+(q-Ce),Lt=Ye+ge,q=Lt-Ye,Gl[2]=Ye-(Lt-q)+(ge-q),Gl[3]=Lt,ot=Xt*Zt,me=Ir*Xt,Ee=me-(me-Xt),Ne=Xt-Ee,me=Ir*Zt,$e=me-(me-Zt),ye=Zt-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=Jt*zt,me=Ir*Jt,Ee=me-(me-Jt),Ne=Jt-Ee,me=Ir*zt,$e=me-(me-zt),ye=zt-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se-It,q=Se-ge,Vl[0]=Se-(ge+q)+(q-It),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We-Ce,q=We-ge,Vl[1]=We-(ge+q)+(q-Ce),Lt=Ye+ge,q=Lt-Ye,Vl[2]=Ye-(Lt-q)+(ge-q),Vl[3]=Lt,A=qn(qn(qn(tr(tr(4,Bl,Xt,Lr),Lr,Xt,Or),Or,tr(tr(4,Bl,zt,Lr),Lr,zt,Oi),Oi,Ti),Ti,qn(tr(tr(4,Gl,Jt,Lr),Lr,Jt,Or),Or,tr(tr(4,Gl,Zt,Lr),Lr,Zt,Oi),Oi,jl),jl,Ns),Ns,qn(tr(tr(4,Vl,dr,Lr),Lr,dr,Or),Or,tr(tr(4,Vl,Ot,Lr),Lr,Ot,Oi),Oi,Ti),Ti,Bu);let Yt=q8(A,Bu),Ar=VT*w;if(Yt>=Ar||-Yt>=Ar||(q=e-Xt,z=e-(Xt+q)+(q-p),q=t-zt,V=t-(zt+q)+(q-s),q=i-Jt,B=i-(Jt+q)+(q-p),q=a-Zt,W=a-(Zt+q)+(q-s),q=h-dr,D=h-(dr+q)+(q-p),q=d-Ot,S=d-(Ot+q)+(q-s),z===0&&B===0&&D===0&&V===0&&W===0&&S===0)||(Ar=jT*w+X8*Math.abs(Yt),Yt+=(Xt*Xt+zt*zt)*(Jt*S+Ot*B-(Zt*D+dr*W))+2*(Xt*z+zt*V)*(Jt*Ot-Zt*dr)+((Jt*Jt+Zt*Zt)*(dr*V+zt*D-(Ot*z+Xt*S))+2*(Jt*B+Zt*W)*(dr*zt-Ot*Xt))+((dr*dr+Ot*Ot)*(Xt*W+Zt*z-(zt*B+Jt*V))+2*(dr*D+Ot*S)*(Xt*Zt-zt*Jt)),Yt>=Ar||-Yt>=Ar))return Yt;if((B!==0||W!==0||D!==0||S!==0)&&(ot=Xt*Xt,me=Ir*Xt,Ee=me-(me-Xt),Ne=Xt-Ee,Se=Ne*Ne-(ot-Ee*Ee-(Ee+Ee)*Ne),Ce=zt*zt,me=Ir*zt,Ee=me-(me-zt),Ne=zt-Ee,It=Ne*Ne-(Ce-Ee*Ee-(Ee+Ee)*Ne),ge=Se+It,q=ge-Se,ao[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,ao[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,ao[2]=Ye-(Lt-q)+(ge-q),ao[3]=Lt),(D!==0||S!==0||z!==0||V!==0)&&(ot=Jt*Jt,me=Ir*Jt,Ee=me-(me-Jt),Ne=Jt-Ee,Se=Ne*Ne-(ot-Ee*Ee-(Ee+Ee)*Ne),Ce=Zt*Zt,me=Ir*Zt,Ee=me-(me-Zt),Ne=Zt-Ee,It=Ne*Ne-(Ce-Ee*Ee-(Ee+Ee)*Ne),ge=Se+It,q=ge-Se,oo[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,oo[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,oo[2]=Ye-(Lt-q)+(ge-q),oo[3]=Lt),(z!==0||V!==0||B!==0||W!==0)&&(ot=dr*dr,me=Ir*dr,Ee=me-(me-dr),Ne=dr-Ee,Se=Ne*Ne-(ot-Ee*Ee-(Ee+Ee)*Ne),Ce=Ot*Ot,me=Ir*Ot,Ee=me-(me-Ot),Ne=Ot-Ee,It=Ne*Ne-(Ce-Ee*Ee-(Ee+Ee)*Ne),ge=Se+It,q=ge-Se,lo[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,lo[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,lo[2]=Ye-(Lt-q)+(ge-q),lo[3]=Lt),z!==0&&(j=tr(4,Bl,z,C_),A=wn(A,ya(tr(j,C_,2*Xt,Or),Or,tr(tr(4,lo,z,Lr),Lr,Zt,Oi),Oi,tr(tr(4,oo,z,Lr),Lr,-Ot,Ni),Ni,Ti,bn),bn)),V!==0&&(ne=tr(4,Bl,V,S_),A=wn(A,ya(tr(ne,S_,2*zt,Or),Or,tr(tr(4,oo,V,Lr),Lr,dr,Oi),Oi,tr(tr(4,lo,V,Lr),Lr,-Jt,Ni),Ni,Ti,bn),bn)),B!==0&&(te=tr(4,Gl,B,P_),A=wn(A,ya(tr(te,P_,2*Jt,Or),Or,tr(tr(4,ao,B,Lr),Lr,Ot,Oi),Oi,tr(tr(4,lo,B,Lr),Lr,-zt,Ni),Ni,Ti,bn),bn)),W!==0&&(Q=tr(4,Gl,W,E_),A=wn(A,ya(tr(Q,E_,2*Zt,Or),Or,tr(tr(4,lo,W,Lr),Lr,Xt,Oi),Oi,tr(tr(4,ao,W,Lr),Lr,-dr,Ni),Ni,Ti,bn),bn)),D!==0&&(N=tr(4,Vl,D,k_),A=wn(A,ya(tr(N,k_,2*dr,Or),Or,tr(tr(4,oo,D,Lr),Lr,zt,Oi),Oi,tr(tr(4,ao,D,Lr),Lr,-Zt,Ni),Ni,Ti,bn),bn)),S!==0&&(re=tr(4,Vl,S,R_),A=wn(A,ya(tr(re,R_,2*Ot,Or),Or,tr(tr(4,ao,S,Lr),Lr,Jt,Oi),Oi,tr(tr(4,oo,S,Lr),Lr,-Xt,Ni),Ni,Ti,bn),bn)),z!==0||V!==0){if(B!==0||W!==0||D!==0||S!==0?(ot=B*Ot,me=Ir*B,Ee=me-(me-B),Ne=B-Ee,me=Ir*Ot,$e=me-(me-Ot),ye=Ot-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=Jt*S,me=Ir*Jt,Ee=me-(me-Jt),Ne=Jt-Ee,me=Ir*S,$e=me-(me-S),ye=S-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se+It,q=ge-Se,Ls[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,Ls[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,Ls[2]=Ye-(Lt-q)+(ge-q),Ls[3]=Lt,ot=D*-Zt,me=Ir*D,Ee=me-(me-D),Ne=D-Ee,me=Ir*-Zt,$e=me-(me- -Zt),ye=-Zt-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=dr*-W,me=Ir*dr,Ee=me-(me-dr),Ne=dr-Ee,me=Ir*-W,$e=me-(me- -W),ye=-W-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se+It,q=ge-Se,zs[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,zs[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,zs[2]=Ye-(Lt-q)+(ge-q),zs[3]=Lt,ve=qn(4,Ls,4,zs,mm),ot=B*S,me=Ir*B,Ee=me-(me-B),Ne=B-Ee,me=Ir*S,$e=me-(me-S),ye=S-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=D*W,me=Ir*D,Ee=me-(me-D),Ne=D-Ee,me=Ir*W,$e=me-(me-W),ye=W-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se-It,q=Se-ge,Hc[0]=Se-(ge+q)+(q-It),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We-Ce,q=We-ge,Hc[1]=We-(ge+q)+(q-Ce),Lt=Ye+ge,q=Lt-Ye,Hc[2]=Ye-(Lt-q)+(ge-q),Hc[3]=Lt,le=4):(mm[0]=0,ve=1,Hc[0]=0,le=1),z!==0){const yr=tr(ve,mm,z,Ni);A=wn(A,qn(tr(j,C_,z,Or),Or,tr(yr,Ni,2*Xt,Ti),Ti,bn),bn);const kr=tr(le,Hc,z,Lr);A=wn(A,ya(tr(kr,Lr,2*Xt,Or),Or,tr(kr,Lr,z,Oi),Oi,tr(yr,Ni,z,Ti),Ti,jl,Ns),Ns),W!==0&&(A=wn(A,tr(tr(4,lo,z,Lr),Lr,W,Or),Or)),S!==0&&(A=wn(A,tr(tr(4,oo,-z,Lr),Lr,S,Or),Or))}if(V!==0){const yr=tr(ve,mm,V,Ni);A=wn(A,qn(tr(ne,S_,V,Or),Or,tr(yr,Ni,2*zt,Ti),Ti,bn),bn);const kr=tr(le,Hc,V,Lr);A=wn(A,ya(tr(kr,Lr,2*zt,Or),Or,tr(kr,Lr,V,Oi),Oi,tr(yr,Ni,V,Ti),Ti,jl,Ns),Ns)}}if(B!==0||W!==0){if(D!==0||S!==0||z!==0||V!==0?(ot=D*zt,me=Ir*D,Ee=me-(me-D),Ne=D-Ee,me=Ir*zt,$e=me-(me-zt),ye=zt-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=dr*V,me=Ir*dr,Ee=me-(me-dr),Ne=dr-Ee,me=Ir*V,$e=me-(me-V),ye=V-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se+It,q=ge-Se,Ls[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,Ls[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,Ls[2]=Ye-(Lt-q)+(ge-q),Ls[3]=Lt,Ve=-Ot,Be=-S,ot=z*Ve,me=Ir*z,Ee=me-(me-z),Ne=z-Ee,me=Ir*Ve,$e=me-(me-Ve),ye=Ve-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=Xt*Be,me=Ir*Xt,Ee=me-(me-Xt),Ne=Xt-Ee,me=Ir*Be,$e=me-(me-Be),ye=Be-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se+It,q=ge-Se,zs[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,zs[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,zs[2]=Ye-(Lt-q)+(ge-q),zs[3]=Lt,Pe=qn(4,Ls,4,zs,gm),ot=D*V,me=Ir*D,Ee=me-(me-D),Ne=D-Ee,me=Ir*V,$e=me-(me-V),ye=V-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=z*S,me=Ir*z,Ee=me-(me-z),Ne=z-Ee,me=Ir*S,$e=me-(me-S),ye=S-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se-It,q=Se-ge,Wc[0]=Se-(ge+q)+(q-It),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We-Ce,q=We-ge,Wc[1]=We-(ge+q)+(q-Ce),Lt=Ye+ge,q=Lt-Ye,Wc[2]=Ye-(Lt-q)+(ge-q),Wc[3]=Lt,Me=4):(gm[0]=0,Pe=1,Wc[0]=0,Me=1),B!==0){const yr=tr(Pe,gm,B,Ni);A=wn(A,qn(tr(te,P_,B,Or),Or,tr(yr,Ni,2*Jt,Ti),Ti,bn),bn);const kr=tr(Me,Wc,B,Lr);A=wn(A,ya(tr(kr,Lr,2*Jt,Or),Or,tr(kr,Lr,B,Oi),Oi,tr(yr,Ni,B,Ti),Ti,jl,Ns),Ns),S!==0&&(A=wn(A,tr(tr(4,ao,B,Lr),Lr,S,Or),Or)),V!==0&&(A=wn(A,tr(tr(4,lo,-B,Lr),Lr,V,Or),Or))}if(W!==0){const yr=tr(Pe,gm,W,Ni);A=wn(A,qn(tr(Q,E_,W,Or),Or,tr(yr,Ni,2*Zt,Ti),Ti,bn),bn);const kr=tr(Me,Wc,W,Lr);A=wn(A,ya(tr(kr,Lr,2*Zt,Or),Or,tr(kr,Lr,W,Oi),Oi,tr(yr,Ni,W,Ti),Ti,jl,Ns),Ns)}}if(D!==0||S!==0){if(z!==0||V!==0||B!==0||W!==0?(ot=z*Zt,me=Ir*z,Ee=me-(me-z),Ne=z-Ee,me=Ir*Zt,$e=me-(me-Zt),ye=Zt-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=Xt*W,me=Ir*Xt,Ee=me-(me-Xt),Ne=Xt-Ee,me=Ir*W,$e=me-(me-W),ye=W-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se+It,q=ge-Se,Ls[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,Ls[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,Ls[2]=Ye-(Lt-q)+(ge-q),Ls[3]=Lt,Ve=-zt,Be=-V,ot=B*Ve,me=Ir*B,Ee=me-(me-B),Ne=B-Ee,me=Ir*Ve,$e=me-(me-Ve),ye=Ve-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=Jt*Be,me=Ir*Jt,Ee=me-(me-Jt),Ne=Jt-Ee,me=Ir*Be,$e=me-(me-Be),ye=Be-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se+It,q=ge-Se,zs[0]=Se-(ge-q)+(It-q),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We+Ce,q=ge-We,zs[1]=We-(ge-q)+(Ce-q),Lt=Ye+ge,q=Lt-Ye,zs[2]=Ye-(Lt-q)+(ge-q),zs[3]=Lt,oe=qn(4,Ls,4,zs,pm),ot=z*W,me=Ir*z,Ee=me-(me-z),Ne=z-Ee,me=Ir*W,$e=me-(me-W),ye=W-$e,Se=Ne*ye-(ot-Ee*$e-Ne*$e-Ee*ye),Ce=B*V,me=Ir*B,Ee=me-(me-B),Ne=B-Ee,me=Ir*V,$e=me-(me-V),ye=V-$e,It=Ne*ye-(Ce-Ee*$e-Ne*$e-Ee*ye),ge=Se-It,q=Se-ge,Uc[0]=Se-(ge+q)+(q-It),Ye=ot+ge,q=Ye-ot,We=ot-(Ye-q)+(ge-q),ge=We-Ce,q=We-ge,Uc[1]=We-(ge+q)+(q-Ce),Lt=Ye+ge,q=Lt-Ye,Uc[2]=Ye-(Lt-q)+(ge-q),Uc[3]=Lt,$=4):(pm[0]=0,oe=1,Uc[0]=0,$=1),D!==0){const yr=tr(oe,pm,D,Ni);A=wn(A,qn(tr(N,k_,D,Or),Or,tr(yr,Ni,2*dr,Ti),Ti,bn),bn);const kr=tr($,Uc,D,Lr);A=wn(A,ya(tr(kr,Lr,2*dr,Or),Or,tr(kr,Lr,D,Oi),Oi,tr(yr,Ni,D,Ti),Ti,jl,Ns),Ns),V!==0&&(A=wn(A,tr(tr(4,oo,D,Lr),Lr,V,Or),Or)),W!==0&&(A=wn(A,tr(tr(4,ao,-D,Lr),Lr,W,Or),Or))}if(S!==0){const yr=tr(oe,pm,S,Ni);A=wn(A,qn(tr(re,R_,S,Or),Or,tr(yr,Ni,2*Ot,Ti),Ti,bn),bn);const kr=tr($,Uc,S,Lr);A=wn(A,ya(tr(kr,Lr,2*Ot,Or),Or,tr(kr,Lr,S,Oi),Oi,tr(yr,Ni,S,Ti),Ti,jl,Ns),Ns)}}return Bu[A-1]}function OT(e,t,i,a,h,d,p,s){const w=e-p,A=i-p,z=h-p,B=t-s,D=a-s,V=d-s,W=A*V,S=z*D,j=w*w+B*B,ne=z*B,te=w*V,Q=A*A+D*D,N=w*D,re=A*B,oe=z*z+V*V,ve=j*(W-S)+Q*(ne-te)+oe*(N-re),Pe=(Math.abs(W)+Math.abs(S))*j+(Math.abs(ne)+Math.abs(te))*Q+(Math.abs(N)+Math.abs(re))*oe,$=GT*Pe;return ve>$||-ve>$?ve:ZT(e,t,i,a,h,d,p,s,Pe)}function Y8(e,t){var i,a,h=0,d,p,s,w,A,z,B,D=e[0],V=e[1],W=t.length;for(i=0;i<W;i++){a=0;var S=t[i],j=S.length-1;if(z=S[0],z[0]!==S[j][0]&&z[1]!==S[j][1])throw new Error("First and last coordinates in a ring must be the same");for(p=z[0]-D,s=z[1]-V,a;a<j;a++){if(B=S[a+1],w=B[0]-D,A=B[1]-V,s===0&&A===0){if(w<=0&&p>=0||p<=0&&w>=0)return 0}else if(A>=0&&s<=0||A<=0&&s>=0){if(d=yo(p,w,s,A,0,0),d===0)return 0;(d>0&&A>0&&s<=0||d<0&&A<=0&&s>0)&&h++}z=B,s=A,p=w}}return h%2!==0}function zx(e,t={}){let i=0,a=0,h=0;return id(e,function(d){i+=d[0],a+=d[1],h++},!0),Qm([i/h,a/h],t.properties)}var _m={exports:{}},Bm={exports:{}},NT=Bm.exports,Fx;function UT(){return Fx||(Fx=1,function(e,t){(function(i,a){e.exports=a()})(NT,function(){function i(te,Q,N,re,oe){(function ve(Pe,$,le,Me,Ve){for(;Me>le;){if(Me-le>600){var Be=Me-le+1,q=$-le+1,me=Math.log(Be),Ee=.5*Math.exp(2*me/3),Ne=.5*Math.sqrt(me*Ee*(Be-Ee)/Be)*(q-Be/2<0?-1:1),$e=Math.max(le,Math.floor($-q*Ee/Be+Ne)),ye=Math.min(Me,Math.floor($+(Be-q)*Ee/Be+Ne));ve(Pe,$,$e,ye,Ve)}var ge=Pe[$],Ye=le,We=Me;for(a(Pe,le,$),Ve(Pe[Me],ge)>0&&a(Pe,le,Me);Ye<We;){for(a(Pe,Ye,We),Ye++,We--;Ve(Pe[Ye],ge)<0;)Ye++;for(;Ve(Pe[We],ge)>0;)We--}Ve(Pe[le],ge)===0?a(Pe,le,We):a(Pe,++We,Me),We<=$&&(le=We+1),$<=We&&(Me=We-1)}})(te,Q,N||0,re||te.length-1,oe||h)}function a(te,Q,N){var re=te[Q];te[Q]=te[N],te[N]=re}function h(te,Q){return te<Q?-1:te>Q?1:0}var d=function(te){te===void 0&&(te=9),this._maxEntries=Math.max(4,te),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function p(te,Q,N){if(!N)return Q.indexOf(te);for(var re=0;re<Q.length;re++)if(N(te,Q[re]))return re;return-1}function s(te,Q){w(te,0,te.children.length,Q,te)}function w(te,Q,N,re,oe){oe||(oe=j(null)),oe.minX=1/0,oe.minY=1/0,oe.maxX=-1/0,oe.maxY=-1/0;for(var ve=Q;ve<N;ve++){var Pe=te.children[ve];A(oe,te.leaf?re(Pe):Pe)}return oe}function A(te,Q){return te.minX=Math.min(te.minX,Q.minX),te.minY=Math.min(te.minY,Q.minY),te.maxX=Math.max(te.maxX,Q.maxX),te.maxY=Math.max(te.maxY,Q.maxY),te}function z(te,Q){return te.minX-Q.minX}function B(te,Q){return te.minY-Q.minY}function D(te){return(te.maxX-te.minX)*(te.maxY-te.minY)}function V(te){return te.maxX-te.minX+(te.maxY-te.minY)}function W(te,Q){return te.minX<=Q.minX&&te.minY<=Q.minY&&Q.maxX<=te.maxX&&Q.maxY<=te.maxY}function S(te,Q){return Q.minX<=te.maxX&&Q.minY<=te.maxY&&Q.maxX>=te.minX&&Q.maxY>=te.minY}function j(te){return{children:te,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ne(te,Q,N,re,oe){for(var ve=[Q,N];ve.length;)if(!((N=ve.pop())-(Q=ve.pop())<=re)){var Pe=Q+Math.ceil((N-Q)/re/2)*re;i(te,Pe,Q,N,oe),ve.push(Q,Pe,Pe,N)}}return d.prototype.all=function(){return this._all(this.data,[])},d.prototype.search=function(te){var Q=this.data,N=[];if(!S(te,Q))return N;for(var re=this.toBBox,oe=[];Q;){for(var ve=0;ve<Q.children.length;ve++){var Pe=Q.children[ve],$=Q.leaf?re(Pe):Pe;S(te,$)&&(Q.leaf?N.push(Pe):W(te,$)?this._all(Pe,N):oe.push(Pe))}Q=oe.pop()}return N},d.prototype.collides=function(te){var Q=this.data;if(!S(te,Q))return!1;for(var N=[];Q;){for(var re=0;re<Q.children.length;re++){var oe=Q.children[re],ve=Q.leaf?this.toBBox(oe):oe;if(S(te,ve)){if(Q.leaf||W(te,ve))return!0;N.push(oe)}}Q=N.pop()}return!1},d.prototype.load=function(te){if(!te||!te.length)return this;if(te.length<this._minEntries){for(var Q=0;Q<te.length;Q++)this.insert(te[Q]);return this}var N=this._build(te.slice(),0,te.length-1,0);if(this.data.children.length)if(this.data.height===N.height)this._splitRoot(this.data,N);else{if(this.data.height<N.height){var re=this.data;this.data=N,N=re}this._insert(N,this.data.height-N.height-1,!0)}else this.data=N;return this},d.prototype.insert=function(te){return te&&this._insert(te,this.data.height-1),this},d.prototype.clear=function(){return this.data=j([]),this},d.prototype.remove=function(te,Q){if(!te)return this;for(var N,re,oe,ve=this.data,Pe=this.toBBox(te),$=[],le=[];ve||$.length;){if(ve||(ve=$.pop(),re=$[$.length-1],N=le.pop(),oe=!0),ve.leaf){var Me=p(te,ve.children,Q);if(Me!==-1)return ve.children.splice(Me,1),$.push(ve),this._condense($),this}oe||ve.leaf||!W(ve,Pe)?re?(N++,ve=re.children[N],oe=!1):ve=null:($.push(ve),le.push(N),N=0,re=ve,ve=ve.children[0])}return this},d.prototype.toBBox=function(te){return te},d.prototype.compareMinX=function(te,Q){return te.minX-Q.minX},d.prototype.compareMinY=function(te,Q){return te.minY-Q.minY},d.prototype.toJSON=function(){return this.data},d.prototype.fromJSON=function(te){return this.data=te,this},d.prototype._all=function(te,Q){for(var N=[];te;)te.leaf?Q.push.apply(Q,te.children):N.push.apply(N,te.children),te=N.pop();return Q},d.prototype._build=function(te,Q,N,re){var oe,ve=N-Q+1,Pe=this._maxEntries;if(ve<=Pe)return s(oe=j(te.slice(Q,N+1)),this.toBBox),oe;re||(re=Math.ceil(Math.log(ve)/Math.log(Pe)),Pe=Math.ceil(ve/Math.pow(Pe,re-1))),(oe=j([])).leaf=!1,oe.height=re;var $=Math.ceil(ve/Pe),le=$*Math.ceil(Math.sqrt(Pe));ne(te,Q,N,le,this.compareMinX);for(var Me=Q;Me<=N;Me+=le){var Ve=Math.min(Me+le-1,N);ne(te,Me,Ve,$,this.compareMinY);for(var Be=Me;Be<=Ve;Be+=$){var q=Math.min(Be+$-1,Ve);oe.children.push(this._build(te,Be,q,re-1))}}return s(oe,this.toBBox),oe},d.prototype._chooseSubtree=function(te,Q,N,re){for(;re.push(Q),!Q.leaf&&re.length-1!==N;){for(var oe=1/0,ve=1/0,Pe=void 0,$=0;$<Q.children.length;$++){var le=Q.children[$],Me=D(le),Ve=(Be=te,q=le,(Math.max(q.maxX,Be.maxX)-Math.min(q.minX,Be.minX))*(Math.max(q.maxY,Be.maxY)-Math.min(q.minY,Be.minY))-Me);Ve<ve?(ve=Ve,oe=Me<oe?Me:oe,Pe=le):Ve===ve&&Me<oe&&(oe=Me,Pe=le)}Q=Pe||Q.children[0]}var Be,q;return Q},d.prototype._insert=function(te,Q,N){var re=N?te:this.toBBox(te),oe=[],ve=this._chooseSubtree(re,this.data,Q,oe);for(ve.children.push(te),A(ve,re);Q>=0&&oe[Q].children.length>this._maxEntries;)this._split(oe,Q),Q--;this._adjustParentBBoxes(re,oe,Q)},d.prototype._split=function(te,Q){var N=te[Q],re=N.children.length,oe=this._minEntries;this._chooseSplitAxis(N,oe,re);var ve=this._chooseSplitIndex(N,oe,re),Pe=j(N.children.splice(ve,N.children.length-ve));Pe.height=N.height,Pe.leaf=N.leaf,s(N,this.toBBox),s(Pe,this.toBBox),Q?te[Q-1].children.push(Pe):this._splitRoot(N,Pe)},d.prototype._splitRoot=function(te,Q){this.data=j([te,Q]),this.data.height=te.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},d.prototype._chooseSplitIndex=function(te,Q,N){for(var re,oe,ve,Pe,$,le,Me,Ve=1/0,Be=1/0,q=Q;q<=N-Q;q++){var me=w(te,0,q,this.toBBox),Ee=w(te,q,N,this.toBBox),Ne=(oe=me,ve=Ee,Pe=void 0,$=void 0,le=void 0,Me=void 0,Pe=Math.max(oe.minX,ve.minX),$=Math.max(oe.minY,ve.minY),le=Math.min(oe.maxX,ve.maxX),Me=Math.min(oe.maxY,ve.maxY),Math.max(0,le-Pe)*Math.max(0,Me-$)),$e=D(me)+D(Ee);Ne<Ve?(Ve=Ne,re=q,Be=$e<Be?$e:Be):Ne===Ve&&$e<Be&&(Be=$e,re=q)}return re||N-Q},d.prototype._chooseSplitAxis=function(te,Q,N){var re=te.leaf?this.compareMinX:z,oe=te.leaf?this.compareMinY:B;this._allDistMargin(te,Q,N,re)<this._allDistMargin(te,Q,N,oe)&&te.children.sort(re)},d.prototype._allDistMargin=function(te,Q,N,re){te.children.sort(re);for(var oe=this.toBBox,ve=w(te,0,Q,oe),Pe=w(te,N-Q,N,oe),$=V(ve)+V(Pe),le=Q;le<N-Q;le++){var Me=te.children[le];A(ve,te.leaf?oe(Me):Me),$+=V(ve)}for(var Ve=N-Q-1;Ve>=Q;Ve--){var Be=te.children[Ve];A(Pe,te.leaf?oe(Be):Be),$+=V(Pe)}return $},d.prototype._adjustParentBBoxes=function(te,Q,N){for(var re=N;re>=0;re--)A(Q[re],te)},d.prototype._condense=function(te){for(var Q=te.length-1,N=void 0;Q>=0;Q--)te[Q].children.length===0?Q>0?(N=te[Q-1].children).splice(N.indexOf(te[Q]),1):this.clear():s(te[Q],this.toBBox)},d})}(Bm)),Bm.exports}class HT{constructor(t=[],i=WT){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:a}=this,h=i[t];for(;t>0;){const d=t-1>>1,p=i[d];if(a(h,p)>=0)break;i[t]=p,t=d}i[t]=h}_down(t){const{data:i,compare:a}=this,h=this.length>>1,d=i[t];for(;t<h;){let p=(t<<1)+1,s=i[p];const w=p+1;if(w<this.length&&a(i[w],s)<0&&(p=w,s=i[w]),a(s,d)>=0)break;i[t]=s,t=p}i[t]=d}}function WT(e,t){return e<t?-1:e>t?1:0}const XT=Object.freeze(Object.defineProperty({__proto__:null,default:HT},Symbol.toStringTag,{value:"Module"})),qT=yy(XT);var yf={exports:{}},z_,Dx;function YT(){return Dx||(Dx=1,z_=function(t,i,a,h){var d=t[0],p=t[1],s=!1;a===void 0&&(a=0),h===void 0&&(h=i.length);for(var w=(h-a)/2,A=0,z=w-1;A<w;z=A++){var B=i[a+A*2+0],D=i[a+A*2+1],V=i[a+z*2+0],W=i[a+z*2+1],S=D>p!=W>p&&d<(V-B)*(p-D)/(W-D)+B;S&&(s=!s)}return s}),z_}var F_,Bx;function KT(){return Bx||(Bx=1,F_=function(t,i,a,h){var d=t[0],p=t[1],s=!1;a===void 0&&(a=0),h===void 0&&(h=i.length);for(var w=h-a,A=0,z=w-1;A<w;z=A++){var B=i[A+a][0],D=i[A+a][1],V=i[z+a][0],W=i[z+a][1],S=D>p!=W>p&&d<(V-B)*(p-D)/(W-D)+B;S&&(s=!s)}return s}),F_}var Gx;function $T(){if(Gx)return yf.exports;Gx=1;var e=YT(),t=KT();return yf.exports=function(a,h,d,p){return h.length>0&&Array.isArray(h[0])?t(a,h,d,p):e(a,h,d,p)},yf.exports.nested=t,yf.exports.flat=e,yf.exports}var Rf={exports:{}},JT=Rf.exports,Vx;function QT(){return Vx||(Vx=1,function(e,t){(function(i,a){a(t)})(JT,function(i){const h=33306690738754706e-32;function d(S,j,ne,te,Q){let N,re,oe,ve,Pe=j[0],$=te[0],le=0,Me=0;$>Pe==$>-Pe?(N=Pe,Pe=j[++le]):(N=$,$=te[++Me]);let Ve=0;if(le<S&&Me<ne)for($>Pe==$>-Pe?(oe=N-((re=Pe+N)-Pe),Pe=j[++le]):(oe=N-((re=$+N)-$),$=te[++Me]),N=re,oe!==0&&(Q[Ve++]=oe);le<S&&Me<ne;)$>Pe==$>-Pe?(oe=N-((re=N+Pe)-(ve=re-N))+(Pe-ve),Pe=j[++le]):(oe=N-((re=N+$)-(ve=re-N))+($-ve),$=te[++Me]),N=re,oe!==0&&(Q[Ve++]=oe);for(;le<S;)oe=N-((re=N+Pe)-(ve=re-N))+(Pe-ve),Pe=j[++le],N=re,oe!==0&&(Q[Ve++]=oe);for(;Me<ne;)oe=N-((re=N+$)-(ve=re-N))+($-ve),$=te[++Me],N=re,oe!==0&&(Q[Ve++]=oe);return N===0&&Ve!==0||(Q[Ve++]=N),Ve}function p(S){return new Float64Array(S)}const s=33306690738754716e-32,w=22204460492503146e-32,A=11093356479670487e-47,z=p(4),B=p(8),D=p(12),V=p(16),W=p(4);i.orient2d=function(S,j,ne,te,Q,N){const re=(j-N)*(ne-Q),oe=(S-Q)*(te-N),ve=re-oe;if(re===0||oe===0||re>0!=oe>0)return ve;const Pe=Math.abs(re+oe);return Math.abs(ve)>=s*Pe?ve:-function($,le,Me,Ve,Be,q,me){let Ee,Ne,$e,ye,ge,Ye,We,ot,Se,Ce,It,Lt,Xt,Jt,dr,zt,Zt,Ot;const Yt=$-Be,Ar=Me-Be,yr=le-q,kr=Ve-q;ge=(dr=(ot=Yt-(We=(Ye=134217729*Yt)-(Ye-Yt)))*(Ce=kr-(Se=(Ye=134217729*kr)-(Ye-kr)))-((Jt=Yt*kr)-We*Se-ot*Se-We*Ce))-(It=dr-(Zt=(ot=yr-(We=(Ye=134217729*yr)-(Ye-yr)))*(Ce=Ar-(Se=(Ye=134217729*Ar)-(Ye-Ar)))-((zt=yr*Ar)-We*Se-ot*Se-We*Ce))),z[0]=dr-(It+ge)+(ge-Zt),ge=(Xt=Jt-((Lt=Jt+It)-(ge=Lt-Jt))+(It-ge))-(It=Xt-zt),z[1]=Xt-(It+ge)+(ge-zt),ge=(Ot=Lt+It)-Lt,z[2]=Lt-(Ot-ge)+(It-ge),z[3]=Ot;let Tr=function(dn,Xi){let fn=Xi[0];for(let Pr=1;Pr<dn;Pr++)fn+=Xi[Pr];return fn}(4,z),Dr=w*me;if(Tr>=Dr||-Tr>=Dr||(Ee=$-(Yt+(ge=$-Yt))+(ge-Be),$e=Me-(Ar+(ge=Me-Ar))+(ge-Be),Ne=le-(yr+(ge=le-yr))+(ge-q),ye=Ve-(kr+(ge=Ve-kr))+(ge-q),Ee===0&&Ne===0&&$e===0&&ye===0)||(Dr=A*me+h*Math.abs(Tr),(Tr+=Yt*ye+kr*Ee-(yr*$e+Ar*Ne))>=Dr||-Tr>=Dr))return Tr;ge=(dr=(ot=Ee-(We=(Ye=134217729*Ee)-(Ye-Ee)))*(Ce=kr-(Se=(Ye=134217729*kr)-(Ye-kr)))-((Jt=Ee*kr)-We*Se-ot*Se-We*Ce))-(It=dr-(Zt=(ot=Ne-(We=(Ye=134217729*Ne)-(Ye-Ne)))*(Ce=Ar-(Se=(Ye=134217729*Ar)-(Ye-Ar)))-((zt=Ne*Ar)-We*Se-ot*Se-We*Ce))),W[0]=dr-(It+ge)+(ge-Zt),ge=(Xt=Jt-((Lt=Jt+It)-(ge=Lt-Jt))+(It-ge))-(It=Xt-zt),W[1]=Xt-(It+ge)+(ge-zt),ge=(Ot=Lt+It)-Lt,W[2]=Lt-(Ot-ge)+(It-ge),W[3]=Ot;const hi=d(4,z,4,W,B);ge=(dr=(ot=Yt-(We=(Ye=134217729*Yt)-(Ye-Yt)))*(Ce=ye-(Se=(Ye=134217729*ye)-(Ye-ye)))-((Jt=Yt*ye)-We*Se-ot*Se-We*Ce))-(It=dr-(Zt=(ot=yr-(We=(Ye=134217729*yr)-(Ye-yr)))*(Ce=$e-(Se=(Ye=134217729*$e)-(Ye-$e)))-((zt=yr*$e)-We*Se-ot*Se-We*Ce))),W[0]=dr-(It+ge)+(ge-Zt),ge=(Xt=Jt-((Lt=Jt+It)-(ge=Lt-Jt))+(It-ge))-(It=Xt-zt),W[1]=Xt-(It+ge)+(ge-zt),ge=(Ot=Lt+It)-Lt,W[2]=Lt-(Ot-ge)+(It-ge),W[3]=Ot;const ni=d(hi,B,4,W,D);ge=(dr=(ot=Ee-(We=(Ye=134217729*Ee)-(Ye-Ee)))*(Ce=ye-(Se=(Ye=134217729*ye)-(Ye-ye)))-((Jt=Ee*ye)-We*Se-ot*Se-We*Ce))-(It=dr-(Zt=(ot=Ne-(We=(Ye=134217729*Ne)-(Ye-Ne)))*(Ce=$e-(Se=(Ye=134217729*$e)-(Ye-$e)))-((zt=Ne*$e)-We*Se-ot*Se-We*Ce))),W[0]=dr-(It+ge)+(ge-Zt),ge=(Xt=Jt-((Lt=Jt+It)-(ge=Lt-Jt))+(It-ge))-(It=Xt-zt),W[1]=Xt-(It+ge)+(ge-zt),ge=(Ot=Lt+It)-Lt,W[2]=Lt-(Ot-ge)+(It-ge),W[3]=Ot;const ui=d(ni,D,4,W,V);return V[ui-1]}(S,j,ne,te,Q,N,Pe)},i.orient2dfast=function(S,j,ne,te,Q,N){return(j-N)*(ne-Q)-(S-Q)*(te-N)},Object.defineProperty(i,"__esModule",{value:!0})})}(Rf,Rf.exports)),Rf.exports}var jx;function eC(){if(jx)return _m.exports;jx=1;var e=UT(),t=qT,i=$T(),a=QT().orient2d;t.default&&(t=t.default),_m.exports=h,_m.exports.default=h;function h(N,re,oe){re=Math.max(0,re===void 0?2:re),oe=oe||0;var ve=V(N),Pe=new e(16);Pe.toBBox=function(We){return{minX:We[0],minY:We[1],maxX:We[0],maxY:We[1]}},Pe.compareMinX=function(We,ot){return We[0]-ot[0]},Pe.compareMinY=function(We,ot){return We[1]-ot[1]},Pe.load(N);for(var $=[],le=0,Me;le<ve.length;le++){var Ve=ve[le];Pe.remove(Ve),Me=W(Ve,Me),$.push(Me)}var Be=new e(16);for(le=0;le<$.length;le++)Be.insert(D($[le]));for(var q=re*re,me=oe*oe;$.length;){var Ee=$.shift(),Ne=Ee.p,$e=Ee.next.p,ye=S(Ne,$e);if(!(ye<me)){var ge=ye/q;Ve=d(Pe,Ee.prev.p,Ne,$e,Ee.next.next.p,ge,Be),Ve&&Math.min(S(Ve,Ne),S(Ve,$e))<=ge&&($.push(Ee),$.push(W(Ve,Ee)),Pe.remove(Ve),Be.remove(Ee),Be.insert(D(Ee)),Be.insert(D(Ee.next)))}}Ee=Me;var Ye=[];do Ye.push(Ee.p),Ee=Ee.next;while(Ee!==Me);return Ye.push(Ee.p),Ye}function d(N,re,oe,ve,Pe,$,le){for(var Me=new t([],p),Ve=N.data;Ve;){for(var Be=0;Be<Ve.children.length;Be++){var q=Ve.children[Be],me=Ve.leaf?j(q,oe,ve):s(oe,ve,q);me>$||Me.push({node:q,dist:me})}for(;Me.length&&!Me.peek().node.children;){var Ee=Me.pop(),Ne=Ee.node,$e=j(Ne,re,oe),ye=j(Ne,ve,Pe);if(Ee.dist<$e&&Ee.dist<ye&&A(oe,Ne,le)&&A(ve,Ne,le))return Ne}Ve=Me.pop(),Ve&&(Ve=Ve.node)}return null}function p(N,re){return N.dist-re.dist}function s(N,re,oe){if(w(N,oe)||w(re,oe))return 0;var ve=ne(N[0],N[1],re[0],re[1],oe.minX,oe.minY,oe.maxX,oe.minY);if(ve===0)return 0;var Pe=ne(N[0],N[1],re[0],re[1],oe.minX,oe.minY,oe.minX,oe.maxY);if(Pe===0)return 0;var $=ne(N[0],N[1],re[0],re[1],oe.maxX,oe.minY,oe.maxX,oe.maxY);if($===0)return 0;var le=ne(N[0],N[1],re[0],re[1],oe.minX,oe.maxY,oe.maxX,oe.maxY);return le===0?0:Math.min(ve,Pe,$,le)}function w(N,re){return N[0]>=re.minX&&N[0]<=re.maxX&&N[1]>=re.minY&&N[1]<=re.maxY}function A(N,re,oe){for(var ve=Math.min(N[0],re[0]),Pe=Math.min(N[1],re[1]),$=Math.max(N[0],re[0]),le=Math.max(N[1],re[1]),Me=oe.search({minX:ve,minY:Pe,maxX:$,maxY:le}),Ve=0;Ve<Me.length;Ve++)if(B(Me[Ve].p,Me[Ve].next.p,N,re))return!1;return!0}function z(N,re,oe){return a(N[0],N[1],re[0],re[1],oe[0],oe[1])}function B(N,re,oe,ve){return N!==ve&&re!==oe&&z(N,re,oe)>0!=z(N,re,ve)>0&&z(oe,ve,N)>0!=z(oe,ve,re)>0}function D(N){var re=N.p,oe=N.next.p;return N.minX=Math.min(re[0],oe[0]),N.minY=Math.min(re[1],oe[1]),N.maxX=Math.max(re[0],oe[0]),N.maxY=Math.max(re[1],oe[1]),N}function V(N){for(var re=N[0],oe=N[0],ve=N[0],Pe=N[0],$=0;$<N.length;$++){var le=N[$];le[0]<re[0]&&(re=le),le[0]>ve[0]&&(ve=le),le[1]<oe[1]&&(oe=le),le[1]>Pe[1]&&(Pe=le)}var Me=[re,oe,ve,Pe],Ve=Me.slice();for($=0;$<N.length;$++)i(N[$],Me)||Ve.push(N[$]);return Q(Ve)}function W(N,re){var oe={p:N,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return re?(oe.next=re.next,oe.prev=re,re.next.prev=oe,re.next=oe):(oe.prev=oe,oe.next=oe),oe}function S(N,re){var oe=N[0]-re[0],ve=N[1]-re[1];return oe*oe+ve*ve}function j(N,re,oe){var ve=re[0],Pe=re[1],$=oe[0]-ve,le=oe[1]-Pe;if($!==0||le!==0){var Me=((N[0]-ve)*$+(N[1]-Pe)*le)/($*$+le*le);Me>1?(ve=oe[0],Pe=oe[1]):Me>0&&(ve+=$*Me,Pe+=le*Me)}return $=N[0]-ve,le=N[1]-Pe,$*$+le*le}function ne(N,re,oe,ve,Pe,$,le,Me){var Ve=oe-N,Be=ve-re,q=le-Pe,me=Me-$,Ee=N-Pe,Ne=re-$,$e=Ve*Ve+Be*Be,ye=Ve*q+Be*me,ge=q*q+me*me,Ye=Ve*Ee+Be*Ne,We=q*Ee+me*Ne,ot=$e*ge-ye*ye,Se,Ce,It,Lt,Xt=ot,Jt=ot;ot===0?(Ce=0,Xt=1,Lt=We,Jt=ge):(Ce=ye*We-ge*Ye,Lt=$e*We-ye*Ye,Ce<0?(Ce=0,Lt=We,Jt=ge):Ce>Xt&&(Ce=Xt,Lt=We+ye,Jt=ge)),Lt<0?(Lt=0,-Ye<0?Ce=0:-Ye>$e?Ce=Xt:(Ce=-Ye,Xt=$e)):Lt>Jt&&(Lt=Jt,-Ye+ye<0?Ce=0:-Ye+ye>$e?Ce=Xt:(Ce=-Ye+ye,Xt=$e)),Se=Ce===0?0:Ce/Xt,It=Lt===0?0:Lt/Jt;var dr=(1-Se)*N+Se*oe,zt=(1-Se)*re+Se*ve,Zt=(1-It)*Pe+It*le,Ot=(1-It)*$+It*Me,Yt=Zt-dr,Ar=Ot-zt;return Yt*Yt+Ar*Ar}function te(N,re){return N[0]===re[0]?N[1]-re[1]:N[0]-re[0]}function Q(N){N.sort(te);for(var re=[],oe=0;oe<N.length;oe++){for(;re.length>=2&&z(re[re.length-2],re[re.length-1],N[oe])<=0;)re.pop();re.push(N[oe])}for(var ve=[],Pe=N.length-1;Pe>=0;Pe--){for(;ve.length>=2&&z(ve[ve.length-2],ve[ve.length-1],N[Pe])<=0;)ve.pop();ve.push(N[Pe])}return ve.pop(),re.pop(),re.concat(ve)}return _m.exports}var tC=eC();const rC=Hg(tC);function iC(e,t={}){t.concavity=t.concavity||1/0;const i=[];if(id(e,h=>{i.push([h[0],h[1]])}),!i.length)return null;const a=rC(i,t.concavity);return a.length>3?TT([a]):null}function by(e,t={}){switch(kT(e)){case"Point":return Qm(Ku(e),t.properties);case"Polygon":var i=[];id(e,function(N){i.push(N)});var a=zx(e,{properties:t.properties}),h=a.geometry.coordinates,d=0,p=0,s=0,w,A,z,B,D,V,W,S,j=i.map(function(N){return[N[0]-h[0],N[1]-h[1]]});for(w=0;w<i.length-1;w++)A=j[w],B=A[0],V=A[1],z=j[w+1],D=z[0],W=z[1],S=B*W-D*V,s+=S,d+=(B+D)*S,p+=(V+W)*S;if(s===0)return a;var ne=s*.5,te=1/(6*ne);return Qm([h[0]+te*d,h[1]+te*p],t.properties);default:var Q=iC(e);return Q?by(Q,{properties:t.properties}):zx(e,{properties:t.properties})}}function K8(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return $8(e);case"FeatureCollection":return nC(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return wy(e);default:throw new Error("unknown GeoJSON type")}}function $8(e){const t={type:"Feature"};return Object.keys(e).forEach(i=>{switch(i){case"type":case"properties":case"geometry":return;default:t[i]=e[i]}}),t.properties=J8(e.properties),e.geometry==null?t.geometry=null:t.geometry=wy(e.geometry),t}function J8(e){const t={};return e&&Object.keys(e).forEach(i=>{const a=e[i];typeof a=="object"?a===null?t[i]=null:Array.isArray(a)?t[i]=a.map(h=>h):t[i]=J8(a):t[i]=a}),t}function nC(e){const t={type:"FeatureCollection"};return Object.keys(e).forEach(i=>{switch(i){case"type":case"features":return;default:t[i]=e[i]}}),t.features=e.features.map(i=>$8(i)),t}function wy(e){const t={type:e.type};return e.bbox&&(t.bbox=e.bbox),e.type==="GeometryCollection"?(t.geometries=e.geometries.map(i=>wy(i)),t):(t.coordinates=Q8(e.coordinates),t)}function Q8(e){const t=e;return typeof t[0]!="object"?t.slice():t.map(i=>Q8(i))}function sC(e,t){const i=N8(e,t),a=O8(e,t);return LT(e,i/2,a)}var eg=sC;function Zx(e,t={}){return aC(e,"mercator",t)}function aC(e,t,i={}){i=i||{};var a=i.mutate;if(!e)throw new Error("geojson is required");return Array.isArray(e)&&wv(e[0])?e=Ox(e):(a!==!0&&(e=K8(e)),id(e,function(h){var d=Ox(h);h[0]=d[0],h[1]=d[1]})),e}function Ox(e){var t=Math.PI/180,i=6378137,a=20037508342789244e-9,h=Math.abs(e[0])<=180?e[0]:e[0]-oC(e[0])*360,d=[i*h*t,i*Math.log(Math.tan(Math.PI*.25+.5*e[1]*t))];return d[0]>a&&(d[0]=a),d[0]<-20037508342789244e-9&&(d[0]=-20037508342789244e-9),d[1]>a&&(d[1]=a),d[1]<-20037508342789244e-9&&(d[1]=-20037508342789244e-9),d}function oC(e){return e<0?-1:e>0?1:0}function lC(e,t={}){var i,a;if(t=t||{},!ET(t))throw new Error("options is invalid");const h=(i=t.mutate)!=null?i:!1,d=(a=t.reverse)!=null?a:!1;if(!e)throw new Error("<geojson> is required");if(typeof d!="boolean")throw new Error("<reverse> must be a boolean");if(typeof h!="boolean")throw new Error("<mutate> must be a boolean");!h&&e.type!=="Point"&&e.type!=="MultiPoint"&&(e=K8(e));const p=[];switch(e.type){case"GeometryCollection":return H8(e,function(s){Gm(s,d)}),e;case"FeatureCollection":return Ex(e,function(s){const w=Gm(s,d);Ex(w,function(A){p.push(A)})}),CT(p)}return Gm(e,d)}function Gm(e,t){switch(e.type==="Feature"?e.geometry.type:e.type){case"GeometryCollection":return H8(e,function(a){Gm(a,t)}),e;case"LineString":return Nx(kf(e),t),e;case"Polygon":return Ux(kf(e),t),e;case"MultiLineString":return kf(e).forEach(function(a){Nx(a,t)}),e;case"MultiPolygon":return kf(e).forEach(function(a){Ux(a,t)}),e;case"Point":case"MultiPoint":return e}}function Nx(e,t){xv(e)===t&&e.reverse()}function Ux(e,t){xv(e[0])!==t&&e[0].reverse();for(let i=1;i<e.length;i++)xv(e[i])===t&&e[i].reverse()}var ca=Uint8Array,Pu=Uint16Array,cC=Int32Array,e6=new ca([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),t6=new ca([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hC=new ca([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),r6=function(e,t){for(var i=new Pu(31),a=0;a<31;++a)i[a]=t+=1<<e[a-1];for(var h=new cC(i[30]),a=1;a<30;++a)for(var d=i[a];d<i[a+1];++d)h[d]=d-i[a]<<5|a;return{b:i,r:h}},i6=r6(e6,2),n6=i6.b,uC=i6.r;n6[28]=258,uC[258]=28;var dC=r6(t6,0),fC=dC.b,Mv=new Pu(32768);for(var vn=0;vn<32768;++vn){var Zl=(vn&43690)>>1|(vn&21845)<<1;Zl=(Zl&52428)>>2|(Zl&13107)<<2,Zl=(Zl&61680)>>4|(Zl&3855)<<4,Mv[vn]=((Zl&65280)>>8|(Zl&255)<<8)>>1}var Hf=function(e,t,i){for(var a=e.length,h=0,d=new Pu(t);h<a;++h)e[h]&&++d[e[h]-1];var p=new Pu(t);for(h=1;h<t;++h)p[h]=p[h-1]+d[h-1]<<1;var s;if(i){s=new Pu(1<<t);var w=15-t;for(h=0;h<a;++h)if(e[h])for(var A=h<<4|e[h],z=t-e[h],B=p[e[h]-1]++<<z,D=B|(1<<z)-1;B<=D;++B)s[Mv[B]>>w]=A}else for(s=new Pu(a),h=0;h<a;++h)e[h]&&(s[h]=Mv[p[e[h]-1]++]>>15-e[h]);return s},Wp=new ca(288);for(var vn=0;vn<144;++vn)Wp[vn]=8;for(var vn=144;vn<256;++vn)Wp[vn]=9;for(var vn=256;vn<280;++vn)Wp[vn]=7;for(var vn=280;vn<288;++vn)Wp[vn]=8;var s6=new ca(32);for(var vn=0;vn<32;++vn)s6[vn]=5;var pC=Hf(Wp,9,1),mC=Hf(s6,5,1),D_=function(e){for(var t=e[0],i=1;i<e.length;++i)e[i]>t&&(t=e[i]);return t},Ga=function(e,t,i){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&i},B_=function(e,t){var i=t/8|0;return(e[i]|e[i+1]<<8|e[i+2]<<16)>>(t&7)},gC=function(e){return(e+7)/8|0},_C=function(e,t,i){return(i==null||i>e.length)&&(i=e.length),new ca(e.subarray(t,i))},vC=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],oa=function(e,t,i){var a=new Error(t||vC[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,oa),!i)throw a;return a},xy=function(e,t,i,a){var h=e.length,d=0;if(!h||t.f&&!t.l)return i||new ca(0);var p=!i,s=p||t.i!=2,w=t.i;p&&(i=new ca(h*3));var A=function(zt){var Zt=i.length;if(zt>Zt){var Ot=new ca(Math.max(Zt*2,zt));Ot.set(i),i=Ot}},z=t.f||0,B=t.p||0,D=t.b||0,V=t.l,W=t.d,S=t.m,j=t.n,ne=h*8;do{if(!V){z=Ga(e,B,1);var te=Ga(e,B+1,3);if(B+=3,te)if(te==1)V=pC,W=mC,S=9,j=5;else if(te==2){var oe=Ga(e,B,31)+257,ve=Ga(e,B+10,15)+4,Pe=oe+Ga(e,B+5,31)+1;B+=14;for(var $=new ca(Pe),le=new ca(19),Me=0;Me<ve;++Me)le[hC[Me]]=Ga(e,B+Me*3,7);B+=ve*3;for(var Ve=D_(le),Be=(1<<Ve)-1,q=Hf(le,Ve,1),Me=0;Me<Pe;){var me=q[Ga(e,B,Be)];B+=me&15;var Q=me>>4;if(Q<16)$[Me++]=Q;else{var Ee=0,Ne=0;for(Q==16?(Ne=3+Ga(e,B,3),B+=2,Ee=$[Me-1]):Q==17?(Ne=3+Ga(e,B,7),B+=3):Q==18&&(Ne=11+Ga(e,B,127),B+=7);Ne--;)$[Me++]=Ee}}var $e=$.subarray(0,oe),ye=$.subarray(oe);S=D_($e),j=D_(ye),V=Hf($e,S,1),W=Hf(ye,j,1)}else oa(1);else{var Q=gC(B)+4,N=e[Q-4]|e[Q-3]<<8,re=Q+N;if(re>h){w&&oa(0);break}s&&A(D+N),i.set(e.subarray(Q,re),D),t.b=D+=N,t.p=B=re*8,t.f=z;continue}if(B>ne){w&&oa(0);break}}s&&A(D+131072);for(var ge=(1<<S)-1,Ye=(1<<j)-1,We=B;;We=B){var Ee=V[B_(e,B)&ge],ot=Ee>>4;if(B+=Ee&15,B>ne){w&&oa(0);break}if(Ee||oa(2),ot<256)i[D++]=ot;else if(ot==256){We=B,V=null;break}else{var Se=ot-254;if(ot>264){var Me=ot-257,Ce=e6[Me];Se=Ga(e,B,(1<<Ce)-1)+n6[Me],B+=Ce}var It=W[B_(e,B)&Ye],Lt=It>>4;It||oa(3),B+=It&15;var ye=fC[Lt];if(Lt>3){var Ce=t6[Lt];ye+=B_(e,B)&(1<<Ce)-1,B+=Ce}if(B>ne){w&&oa(0);break}s&&A(D+131072);var Xt=D+Se;if(D<ye){var Jt=d-ye,dr=Math.min(ye,Xt);for(Jt+D<0&&oa(3);D<dr;++D)i[D]=a[Jt+D]}for(;D<Xt;++D)i[D]=i[D-ye]}}t.l=V,t.p=We,t.b=D,t.f=z,V&&(z=1,t.m=S,t.d=W,t.n=j)}while(!z);return D!=i.length&&p?_C(i,0,D):i.subarray(0,D)},yC=new ca(0),bC=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&oa(6,"invalid gzip data");var t=e[3],i=10;t&4&&(i+=(e[10]|e[11]<<8)+2);for(var a=(t>>3&1)+(t>>4&1);a>0;a-=!e[i++]);return i+(t&2)},wC=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},xC=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&oa(6,"invalid zlib data"),(e[1]>>5&1)==1&&oa(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function MC(e,t){return xy(e,{i:2},t,t)}function IC(e,t){var i=bC(e);return i+8>e.length&&oa(6,"invalid gzip data"),xy(e.subarray(i,-8),{i:2},new ca(wC(e)),t)}function AC(e,t){return xy(e.subarray(xC(e),-4),{i:2},t,t)}function TC(e,t){return e[0]==31&&e[1]==139&&e[2]==8?IC(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?MC(e,t):AC(e,t)}var CC=typeof TextDecoder<"u"&&new TextDecoder,SC=0;try{CC.decode(yC,{stream:!0}),SC=1}catch{}var PC=Object.defineProperty,Wf=Math.pow,nn=(e,t)=>PC(e,"name",{value:t,configurable:!0}),os=(e,t,i)=>new Promise((a,h)=>{var d=w=>{try{s(i.next(w))}catch(A){h(A)}},p=w=>{try{s(i.throw(w))}catch(A){h(A)}},s=w=>w.done?a(w.value):Promise.resolve(w.value).then(d,p);s((i=i.apply(e,t)).next())});nn((e,t)=>{let i=!1,a="",h=L.GridLayer.extend({createTile:nn((d,p)=>{let s=document.createElement("img"),w=new AbortController,A=w.signal;return s.cancel=()=>{w.abort()},i||(e.getHeader().then(z=>{z.tileType===1?console.error("Error: archive contains MVT vector tiles, but leafletRasterLayer is for displaying raster tiles. See https://github.com/protomaps/PMTiles/tree/main/js for details."):z.tileType===2?a="image/png":z.tileType===3?a="image/jpeg":z.tileType===4?a="image/webp":z.tileType===5&&(a="image/avif")}),i=!0),e.getZxy(d.z,d.x,d.y,A).then(z=>{if(z){let B=new Blob([z.data],{type:a}),D=window.URL.createObjectURL(B);s.src=D,s.cancel=void 0,p(void 0,s)}}).catch(z=>{if(z.name!=="AbortError")throw z}),s},"createTile"),_removeTile:nn(function(d){let p=this._tiles[d];p&&(p.el.cancel&&p.el.cancel(),p.el.width=0,p.el.height=0,p.el.deleted=!0,L.DomUtil.remove(p.el),delete this._tiles[d],this.fire("tileunload",{tile:p.el,coords:this._keyToTileCoords(d)}))},"_removeTile")});return new h(t)},"leafletRasterLayer");var EC=nn(e=>(t,i)=>{if(i instanceof AbortController)return e(t,i);let a=new AbortController;return e(t,a).then(h=>i(void 0,h.data,h.cacheControl||"",h.expires||""),h=>i(h)).catch(h=>i(h)),{cancel:nn(()=>a.abort(),"cancel")}},"v3compat"),a6=class{constructor(t){this.tilev4=nn((i,a)=>os(this,null,function*(){if(i.type==="json"){let V=i.url.substr(10),W=this.tiles.get(V);if(W||(W=new Hx(V),this.tiles.set(V,W)),this.metadata)return{data:yield W.getTileJson(i.url)};let S=yield W.getHeader();return(S.minLon>=S.maxLon||S.minLat>=S.maxLat)&&console.error(`Bounds of PMTiles archive ${S.minLon},${S.minLat},${S.maxLon},${S.maxLat} are not valid.`),{data:{tiles:[`${i.url}/{z}/{x}/{y}`],minzoom:S.minZoom,maxzoom:S.maxZoom,bounds:[S.minLon,S.minLat,S.maxLon,S.maxLat]}}}let h=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),d=i.url.match(h);if(!d)throw new Error("Invalid PMTiles protocol URL");let p=d[1],s=this.tiles.get(p);s||(s=new Hx(p),this.tiles.set(p,s));let w=d[2],A=d[3],z=d[4],B=yield s.getHeader(),D=yield s==null?void 0:s.getZxy(+w,+A,+z,a.signal);if(D)return{data:new Uint8Array(D.data),cacheControl:D.cacheControl,expires:D.expires};if(B.tileType===1){if(this.errorOnMissingTile)throw new Error("Tile not found.");return{data:new Uint8Array}}return{data:null}}),"tilev4"),this.tile=EC(this.tilev4),this.tiles=new Map,this.metadata=(t==null?void 0:t.metadata)||!1,this.errorOnMissingTile=(t==null?void 0:t.errorOnMissingTile)||!1}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};nn(a6,"Protocol");var kC=a6;function o6(e,t){return(t>>>0)*4294967296+(e>>>0)}nn(o6,"toNum");function l6(e,t){let i=t.buf,a=i[t.pos++],h=(a&112)>>4;if(a<128||(a=i[t.pos++],h|=(a&127)<<3,a<128)||(a=i[t.pos++],h|=(a&127)<<10,a<128)||(a=i[t.pos++],h|=(a&127)<<17,a<128)||(a=i[t.pos++],h|=(a&127)<<24,a<128)||(a=i[t.pos++],h|=(a&1)<<31,a<128))return o6(e,h);throw new Error("Expected varint not more than 10 bytes")}nn(l6,"readVarintRemainder");function Mu(e){let t=e.buf,i=t[e.pos++],a=i&127;return i<128||(i=t[e.pos++],a|=(i&127)<<7,i<128)||(i=t[e.pos++],a|=(i&127)<<14,i<128)||(i=t[e.pos++],a|=(i&127)<<21,i<128)?a:(i=t[e.pos],a|=(i&15)<<28,l6(a,e))}nn(Mu,"readVarint");function My(e,t,i,a){if(a===0){i===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);let h=t[0];t[0]=t[1],t[1]=h}}nn(My,"rotate");function c6(e,t){let i=Wf(2,e),a=t,h=t,d=t,p=[0,0],s=1;for(;s<i;)a=1&d/2,h=1&(d^a),My(s,p,a,h),p[0]+=s*a,p[1]+=s*h,d=d/4,s*=2;return[e,p[0],p[1]]}nn(c6,"idOnLevel");var RC=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function h6(e,t,i){if(e>26)throw new Error("Tile zoom level exceeds max safe number limit (26)");if(t>Wf(2,e)-1||i>Wf(2,e)-1)throw new Error("tile x/y outside zoom level bounds");let a=RC[e],h=Wf(2,e),d=0,p=0,s=0,w=[t,i],A=h/2;for(;A>0;)d=(w[0]&A)>0?1:0,p=(w[1]&A)>0?1:0,s+=A*A*(3*d^p),My(A,w,d,p),A=A/2;return a+s}nn(h6,"zxyToTileId");function LC(e){let t=0;for(let i=0;i<27;i++){let a=(1<<i)*(1<<i);if(t+a>e)return c6(i,e-t);t+=a}throw new Error("Tile zoom level exceeds max safe number limit (26)")}nn(LC,"tileIdToZxy");var zC=(e=>(e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.Gzip=2]="Gzip",e[e.Brotli=3]="Brotli",e[e.Zstd=4]="Zstd",e))(zC||{});function Wg(e,t){return os(this,null,function*(){if(t===1||t===0)return e;if(t===2){if(typeof globalThis.DecompressionStream>"u")return TC(new Uint8Array(e));let i=new Response(e).body;if(!i)throw new Error("Failed to read response stream");let a=i.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(a).arrayBuffer()}throw new Error("Compression method not supported")})}nn(Wg,"defaultDecompress");var FC=(e=>(e[e.Unknown=0]="Unknown",e[e.Mvt=1]="Mvt",e[e.Png=2]="Png",e[e.Jpeg=3]="Jpeg",e[e.Webp=4]="Webp",e[e.Avif=5]="Avif",e))(FC||{});function u6(e){return e===1?".mvt":e===2?".png":e===3?".jpg":e===4?".webp":e===5?".avif":""}nn(u6,"tileTypeExt");var DC=127;function d6(e,t){let i=0,a=e.length-1;for(;i<=a;){let h=a+i>>1,d=t-e[h].tileId;if(d>0)i=h+1;else if(d<0)a=h-1;else return e[h]}return a>=0&&(e[a].runLength===0||t-e[a].tileId<e[a].runLength)?e[a]:null}nn(d6,"findTile");var BC=class{constructor(t){this.file=t}getKey(){return this.file.name}getBytes(t,i){return os(this,null,function*(){return{data:yield this.file.slice(t,t+i).arrayBuffer()}})}};nn(BC,"FileSource");var f6=class{constructor(t,i=new Headers){this.url=t,this.customHeaders=i,this.mustReload=!1;let a="";"navigator"in globalThis&&(a=globalThis.navigator.userAgent||"");let h=a.indexOf("Windows")>-1,d=/Chrome|Chromium|Edg|OPR|Brave/.test(a);this.chromeWindowsNoCache=!1,h&&d&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(t){this.customHeaders=t}getBytes(t,i,a,h){return os(this,null,function*(){let d,p;a?p=a:(d=new AbortController,p=d.signal);let s=new Headers(this.customHeaders);s.set("range",`bytes=${t}-${t+i-1}`);let w;this.mustReload?w="reload":this.chromeWindowsNoCache&&(w="no-store");let A=yield fetch(this.url,{signal:p,cache:w,headers:s});if(t===0&&A.status===416){let D=A.headers.get("Content-Range");if(!D||!D.startsWith("bytes */"))throw new Error("Missing content-length on 416 response");let V=+D.substr(8);A=yield fetch(this.url,{signal:p,cache:"reload",headers:{range:`bytes=0-${V-1}`}})}let z=A.headers.get("Etag");if(z!=null&&z.startsWith("W/")&&(z=null),A.status===416||h&&z&&z!==h)throw this.mustReload=!0,new Iv(`Server returned non-matching ETag ${h} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(A.status>=300)throw new Error(`Bad response code: ${A.status}`);let B=A.headers.get("Content-Length");if(A.status===200&&(!B||+B>i))throw d&&d.abort(),new Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield A.arrayBuffer(),etag:z||void 0,cacheControl:A.headers.get("Cache-Control")||void 0,expires:A.headers.get("Expires")||void 0}})}};nn(f6,"FetchSource");var GC=f6;function wa(e,t){let i=e.getUint32(t+4,!0),a=e.getUint32(t+0,!0);return i*Wf(2,32)+a}nn(wa,"getUint64");function p6(e,t){let i=new DataView(e),a=i.getUint8(7);if(a>3)throw new Error(`Archive is spec version ${a} but this library supports up to spec version 3`);return{specVersion:a,rootDirectoryOffset:wa(i,8),rootDirectoryLength:wa(i,16),jsonMetadataOffset:wa(i,24),jsonMetadataLength:wa(i,32),leafDirectoryOffset:wa(i,40),leafDirectoryLength:wa(i,48),tileDataOffset:wa(i,56),tileDataLength:wa(i,64),numAddressedTiles:wa(i,72),numTileEntries:wa(i,80),numTileContents:wa(i,88),clustered:i.getUint8(96)===1,internalCompression:i.getUint8(97),tileCompression:i.getUint8(98),tileType:i.getUint8(99),minZoom:i.getUint8(100),maxZoom:i.getUint8(101),minLon:i.getInt32(102,!0)/1e7,minLat:i.getInt32(106,!0)/1e7,maxLon:i.getInt32(110,!0)/1e7,maxLat:i.getInt32(114,!0)/1e7,centerZoom:i.getUint8(118),centerLon:i.getInt32(119,!0)/1e7,centerLat:i.getInt32(123,!0)/1e7,etag:t}}nn(p6,"bytesToHeader");function Iy(e){let t={buf:new Uint8Array(e),pos:0},i=Mu(t),a=[],h=0;for(let d=0;d<i;d++){let p=Mu(t);a.push({tileId:h+p,offset:0,length:0,runLength:1}),h+=p}for(let d=0;d<i;d++)a[d].runLength=Mu(t);for(let d=0;d<i;d++)a[d].length=Mu(t);for(let d=0;d<i;d++){let p=Mu(t);p===0&&d>0?a[d].offset=a[d-1].offset+a[d-1].length:a[d].offset=p-1}return a}nn(Iy,"deserializeIndex");var m6=class extends Error{};nn(m6,"EtagMismatch");var Iv=m6;function Ay(e,t){return os(this,null,function*(){let i=yield e.getBytes(0,16384);if(new DataView(i.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");let a=i.data.slice(0,DC),h=p6(a,i.etag),d=i.data.slice(h.rootDirectoryOffset,h.rootDirectoryOffset+h.rootDirectoryLength),p=`${e.getKey()}|${h.etag||""}|${h.rootDirectoryOffset}|${h.rootDirectoryLength}`,s=Iy(yield t(d,h.internalCompression));return[h,[p,s.length,s]]})}nn(Ay,"getHeaderAndRoot");function Ty(e,t,i,a,h){return os(this,null,function*(){let d=yield e.getBytes(i,a,void 0,h.etag),p=yield t(d.data,h.internalCompression),s=Iy(p);if(s.length===0)throw new Error("Empty directory is invalid");return s})}nn(Ty,"getDirectory");var VC=class{constructor(t=100,i=!0,a=Wg){this.cache=new Map,this.maxCacheEntries=t,this.counter=1,this.decompress=a}getHeader(t){return os(this,null,function*(){let i=t.getKey(),a=this.cache.get(i);if(a)return a.lastUsed=this.counter++,a.data;let h=yield Ay(t,this.decompress);return h[1]&&this.cache.set(h[1][0],{lastUsed:this.counter++,data:h[1][2]}),this.cache.set(i,{lastUsed:this.counter++,data:h[0]}),this.prune(),h[0]})}getDirectory(t,i,a,h){return os(this,null,function*(){let d=`${t.getKey()}|${h.etag||""}|${i}|${a}`,p=this.cache.get(d);if(p)return p.lastUsed=this.counter++,p.data;let s=yield Ty(t,this.decompress,i,a,h);return this.cache.set(d,{lastUsed:this.counter++,data:s}),this.prune(),s})}prune(){if(this.cache.size>this.maxCacheEntries){let t=1/0,i;this.cache.forEach((a,h)=>{a.lastUsed<t&&(t=a.lastUsed,i=h)}),i&&this.cache.delete(i)}}invalidate(t){return os(this,null,function*(){this.cache.delete(t.getKey())})}};nn(VC,"ResolvedValueCache");var g6=class{constructor(t=100,i=!0,a=Wg){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=t,this.counter=1,this.decompress=a}getHeader(t){return os(this,null,function*(){let i=t.getKey(),a=this.cache.get(i);if(a)return a.lastUsed=this.counter++,yield a.data;let h=new Promise((d,p)=>{Ay(t,this.decompress).then(s=>{s[1]&&this.cache.set(s[1][0],{lastUsed:this.counter++,data:Promise.resolve(s[1][2])}),d(s[0]),this.prune()}).catch(s=>{p(s)})});return this.cache.set(i,{lastUsed:this.counter++,data:h}),h})}getDirectory(t,i,a,h){return os(this,null,function*(){let d=`${t.getKey()}|${h.etag||""}|${i}|${a}`,p=this.cache.get(d);if(p)return p.lastUsed=this.counter++,yield p.data;let s=new Promise((w,A)=>{Ty(t,this.decompress,i,a,h).then(z=>{w(z),this.prune()}).catch(z=>{A(z)})});return this.cache.set(d,{lastUsed:this.counter++,data:s}),s})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,i;this.cache.forEach((a,h)=>{a.lastUsed<t&&(t=a.lastUsed,i=h)}),i&&this.cache.delete(i)}}invalidate(t){return os(this,null,function*(){let i=t.getKey();if(this.invalidations.get(i))return yield this.invalidations.get(i);this.cache.delete(t.getKey());let a=new Promise((h,d)=>{this.getHeader(t).then(p=>{h(),this.invalidations.delete(i)}).catch(p=>{d(p)})});this.invalidations.set(i,a)})}};nn(g6,"SharedPromiseCache");var jC=g6,_6=class{constructor(t,i,a){typeof t=="string"?this.source=new GC(t):this.source=t,a?this.decompress=a:this.decompress=Wg,i?this.cache=i:this.cache=new jC}getHeader(){return os(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,i,a,h){return os(this,null,function*(){let d=h6(t,i,a),p=yield this.cache.getHeader(this.source);if(t<p.minZoom||t>p.maxZoom)return;let s=p.rootDirectoryOffset,w=p.rootDirectoryLength;for(let A=0;A<=3;A++){let z=yield this.cache.getDirectory(this.source,s,w,p),B=d6(z,d);if(B){if(B.runLength>0){let D=yield this.source.getBytes(p.tileDataOffset+B.offset,B.length,h,p.etag);return{data:yield this.decompress(D.data,p.tileCompression),cacheControl:D.cacheControl,expires:D.expires}}s=p.leafDirectoryOffset+B.offset,w=B.length}else return}throw new Error("Maximum directory depth exceeded")})}getZxy(t,i,a,h){return os(this,null,function*(){try{return yield this.getZxyAttempt(t,i,a,h)}catch(d){if(d instanceof Iv)return this.cache.invalidate(this.source),yield this.getZxyAttempt(t,i,a,h);throw d}})}getMetadataAttempt(){return os(this,null,function*(){let t=yield this.cache.getHeader(this.source),i=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength,void 0,t.etag),a=yield this.decompress(i.data,t.internalCompression),h=new TextDecoder("utf-8");return JSON.parse(h.decode(a))})}getMetadata(){return os(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof Iv)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw t}})}getTileJson(t){return os(this,null,function*(){let i=yield this.getHeader(),a=yield this.getMetadata(),h=u6(i.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${t}/{z}/{x}/{y}${h}`],vector_layers:a.vector_layers,attribution:a.attribution,description:a.description,name:a.name,version:a.version,bounds:[i.minLon,i.minLat,i.maxLon,i.maxLat],center:[i.centerLon,i.centerLat,i.centerZoom],minzoom:i.minZoom,maxzoom:i.maxZoom}})}};nn(_6,"PMTiles");var Hx=_6,v6=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,ZC=typeof self=="object"&&self&&self.Object===Object&&self,Ya=v6||ZC||Function("return this")(),Xl=Ya.Symbol,y6=Object.prototype,OC=y6.hasOwnProperty,NC=y6.toString,bf=Xl?Xl.toStringTag:void 0;function UC(e){var t=OC.call(e,bf),i=e[bf];try{e[bf]=void 0;var a=!0}catch{}var h=NC.call(e);return a&&(t?e[bf]=i:delete e[bf]),h}var HC=Object.prototype,WC=HC.toString;function XC(e){return WC.call(e)}var qC="[object Null]",YC="[object Undefined]",Wx=Xl?Xl.toStringTag:void 0;function nd(e){return e==null?e===void 0?YC:qC:Wx&&Wx in Object(e)?UC(e):XC(e)}function ql(e){return e!=null&&typeof e=="object"}var KC="[object Symbol]";function $C(e){return typeof e=="symbol"||ql(e)&&nd(e)==KC}var rp=Array.isArray,JC=/\s/;function QC(e){for(var t=e.length;t--&&JC.test(e.charAt(t)););return t}var eS=/^\s+/;function tS(e){return e&&e.slice(0,QC(e)+1).replace(eS,"")}function Yl(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Xx=NaN,rS=/^[-+]0x[0-9a-f]+$/i,iS=/^0b[01]+$/i,nS=/^0o[0-7]+$/i,sS=parseInt;function qx(e){if(typeof e=="number")return e;if($C(e))return Xx;if(Yl(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Yl(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=tS(e);var i=iS.test(e);return i||nS.test(e)?sS(e.slice(2),i?2:8):rS.test(e)?Xx:+e}var aS="[object AsyncFunction]",oS="[object Function]",lS="[object GeneratorFunction]",cS="[object Proxy]";function b6(e){if(!Yl(e))return!1;var t=nd(e);return t==oS||t==lS||t==aS||t==cS}var G_=Ya["__core-js_shared__"],Yx=function(){var e=/[^.]+$/.exec(G_&&G_.keys&&G_.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function hS(e){return!!Yx&&Yx in e}var uS=Function.prototype,dS=uS.toString;function dh(e){if(e!=null){try{return dS.call(e)}catch{}try{return e+""}catch{}}return""}var fS=/[\\^$.*+?()[\]{}|]/g,pS=/^\[object .+?Constructor\]$/,mS=Function.prototype,gS=Object.prototype,_S=mS.toString,vS=gS.hasOwnProperty,yS=RegExp("^"+_S.call(vS).replace(fS,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bS(e){if(!Yl(e)||hS(e))return!1;var t=b6(e)?yS:pS;return t.test(dh(e))}function wS(e,t){return e==null?void 0:e[t]}function fh(e,t){var i=wS(e,t);return bS(i)?i:void 0}var Av=fh(Ya,"WeakMap"),Kx=Object.create,xS=function(){function e(){}return function(t){if(!Yl(t))return{};if(Kx)return Kx(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),$x=function(){try{var e=fh(Object,"defineProperty");return e({},"",{}),e}catch{}}();function MS(e,t){for(var i=-1,a=e==null?0:e.length;++i<a&&t(e[i],i,e)!==!1;);return e}var IS=9007199254740991,AS=/^(?:0|[1-9]\d*)$/;function TS(e,t){var i=typeof e;return t=t??IS,!!t&&(i=="number"||i!="symbol"&&AS.test(e))&&e>-1&&e%1==0&&e<t}function CS(e,t,i){t=="__proto__"&&$x?$x(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function Cy(e,t){return e===t||e!==e&&t!==t}var SS=Object.prototype,PS=SS.hasOwnProperty;function ES(e,t,i){var a=e[t];(!(PS.call(e,t)&&Cy(a,i))||i===void 0&&!(t in e))&&CS(e,t,i)}var kS=9007199254740991;function w6(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=kS}function RS(e){return e!=null&&w6(e.length)&&!b6(e)}var LS=Object.prototype;function x6(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||LS;return e===i}function zS(e,t){for(var i=-1,a=Array(e);++i<e;)a[i]=t(i);return a}var FS="[object Arguments]";function Jx(e){return ql(e)&&nd(e)==FS}var M6=Object.prototype,DS=M6.hasOwnProperty,BS=M6.propertyIsEnumerable,GS=Jx(function(){return arguments}())?Jx:function(e){return ql(e)&&DS.call(e,"callee")&&!BS.call(e,"callee")};function VS(){return!1}var I6=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Qx=I6&&typeof module=="object"&&module&&!module.nodeType&&module,jS=Qx&&Qx.exports===I6,e2=jS?Ya.Buffer:void 0,ZS=e2?e2.isBuffer:void 0,tg=ZS||VS,OS="[object Arguments]",NS="[object Array]",US="[object Boolean]",HS="[object Date]",WS="[object Error]",XS="[object Function]",qS="[object Map]",YS="[object Number]",KS="[object Object]",$S="[object RegExp]",JS="[object Set]",QS="[object String]",eP="[object WeakMap]",tP="[object ArrayBuffer]",rP="[object DataView]",iP="[object Float32Array]",nP="[object Float64Array]",sP="[object Int8Array]",aP="[object Int16Array]",oP="[object Int32Array]",lP="[object Uint8Array]",cP="[object Uint8ClampedArray]",hP="[object Uint16Array]",uP="[object Uint32Array]",_n={};_n[iP]=_n[nP]=_n[sP]=_n[aP]=_n[oP]=_n[lP]=_n[cP]=_n[hP]=_n[uP]=!0;_n[OS]=_n[NS]=_n[tP]=_n[US]=_n[rP]=_n[HS]=_n[WS]=_n[XS]=_n[qS]=_n[YS]=_n[KS]=_n[$S]=_n[JS]=_n[QS]=_n[eP]=!1;function dP(e){return ql(e)&&w6(e.length)&&!!_n[nd(e)]}function Sy(e){return function(t){return e(t)}}var A6=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Xf=A6&&typeof module=="object"&&module&&!module.nodeType&&module,fP=Xf&&Xf.exports===A6,V_=fP&&v6.process,$u=function(){try{var e=Xf&&Xf.require&&Xf.require("util").types;return e||V_&&V_.binding&&V_.binding("util")}catch{}}(),t2=$u&&$u.isTypedArray,T6=t2?Sy(t2):dP,pP=Object.prototype,mP=pP.hasOwnProperty;function gP(e,t){var i=rp(e),a=!i&&GS(e),h=!i&&!a&&tg(e),d=!i&&!a&&!h&&T6(e),p=i||a||h||d,s=p?zS(e.length,String):[],w=s.length;for(var A in e)mP.call(e,A)&&!(p&&(A=="length"||h&&(A=="offset"||A=="parent")||d&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||TS(A,w)))&&s.push(A);return s}function C6(e,t){return function(i){return e(t(i))}}var _P=C6(Object.keys,Object),vP=Object.prototype,yP=vP.hasOwnProperty;function bP(e){if(!x6(e))return _P(e);var t=[];for(var i in Object(e))yP.call(e,i)&&i!="constructor"&&t.push(i);return t}function wP(e){return RS(e)?gP(e):bP(e)}var ip=fh(Object,"create");function xP(){this.__data__=ip?ip(null):{},this.size=0}function MP(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var IP="__lodash_hash_undefined__",AP=Object.prototype,TP=AP.hasOwnProperty;function CP(e){var t=this.__data__;if(ip){var i=t[e];return i===IP?void 0:i}return TP.call(t,e)?t[e]:void 0}var SP=Object.prototype,PP=SP.hasOwnProperty;function EP(e){var t=this.__data__;return ip?t[e]!==void 0:PP.call(t,e)}var kP="__lodash_hash_undefined__";function RP(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=ip&&t===void 0?kP:t,this}function sh(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}sh.prototype.clear=xP;sh.prototype.delete=MP;sh.prototype.get=CP;sh.prototype.has=EP;sh.prototype.set=RP;function LP(){this.__data__=[],this.size=0}function Xg(e,t){for(var i=e.length;i--;)if(Cy(e[i][0],t))return i;return-1}var zP=Array.prototype,FP=zP.splice;function DP(e){var t=this.__data__,i=Xg(t,e);if(i<0)return!1;var a=t.length-1;return i==a?t.pop():FP.call(t,i,1),--this.size,!0}function BP(e){var t=this.__data__,i=Xg(t,e);return i<0?void 0:t[i][1]}function GP(e){return Xg(this.__data__,e)>-1}function VP(e,t){var i=this.__data__,a=Xg(i,e);return a<0?(++this.size,i.push([e,t])):i[a][1]=t,this}function yl(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}yl.prototype.clear=LP;yl.prototype.delete=DP;yl.prototype.get=BP;yl.prototype.has=GP;yl.prototype.set=VP;var np=fh(Ya,"Map");function jP(){this.size=0,this.__data__={hash:new sh,map:new(np||yl),string:new sh}}function ZP(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function qg(e,t){var i=e.__data__;return ZP(t)?i[typeof t=="string"?"string":"hash"]:i.map}function OP(e){var t=qg(this,e).delete(e);return this.size-=t?1:0,t}function NP(e){return qg(this,e).get(e)}function UP(e){return qg(this,e).has(e)}function HP(e,t){var i=qg(this,e),a=i.size;return i.set(e,t),this.size+=i.size==a?0:1,this}function ph(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}ph.prototype.clear=jP;ph.prototype.delete=OP;ph.prototype.get=NP;ph.prototype.has=UP;ph.prototype.set=HP;function WP(e,t){for(var i=-1,a=t.length,h=e.length;++i<a;)e[h+i]=t[i];return e}var XP=C6(Object.getPrototypeOf,Object);function qP(){this.__data__=new yl,this.size=0}function YP(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function KP(e){return this.__data__.get(e)}function $P(e){return this.__data__.has(e)}var JP=200;function QP(e,t){var i=this.__data__;if(i instanceof yl){var a=i.__data__;if(!np||a.length<JP-1)return a.push([e,t]),this.size=++i.size,this;i=this.__data__=new ph(a)}return i.set(e,t),this.size=i.size,this}function gl(e){var t=this.__data__=new yl(e);this.size=t.size}gl.prototype.clear=qP;gl.prototype.delete=YP;gl.prototype.get=KP;gl.prototype.has=$P;gl.prototype.set=QP;var S6=typeof exports=="object"&&exports&&!exports.nodeType&&exports,r2=S6&&typeof module=="object"&&module&&!module.nodeType&&module,eE=r2&&r2.exports===S6,i2=eE?Ya.Buffer:void 0;i2&&i2.allocUnsafe;function tE(e,t){return e.slice()}function rE(e,t){for(var i=-1,a=e==null?0:e.length,h=0,d=[];++i<a;){var p=e[i];t(p,i,e)&&(d[h++]=p)}return d}function iE(){return[]}var nE=Object.prototype,sE=nE.propertyIsEnumerable,n2=Object.getOwnPropertySymbols,aE=n2?function(e){return e==null?[]:(e=Object(e),rE(n2(e),function(t){return sE.call(e,t)}))}:iE;function oE(e,t,i){var a=t(e);return rp(e)?a:WP(a,i(e))}function Tv(e){return oE(e,wP,aE)}var Cv=fh(Ya,"DataView"),Sv=fh(Ya,"Promise"),Pv=fh(Ya,"Set"),s2="[object Map]",lE="[object Object]",a2="[object Promise]",o2="[object Set]",l2="[object WeakMap]",c2="[object DataView]",cE=dh(Cv),hE=dh(np),uE=dh(Sv),dE=dh(Pv),fE=dh(Av),Oa=nd;(Cv&&Oa(new Cv(new ArrayBuffer(1)))!=c2||np&&Oa(new np)!=s2||Sv&&Oa(Sv.resolve())!=a2||Pv&&Oa(new Pv)!=o2||Av&&Oa(new Av)!=l2)&&(Oa=function(e){var t=nd(e),i=t==lE?e.constructor:void 0,a=i?dh(i):"";if(a)switch(a){case cE:return c2;case hE:return s2;case uE:return a2;case dE:return o2;case fE:return l2}return t});var pE=Object.prototype,mE=pE.hasOwnProperty;function gE(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&mE.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var rg=Ya.Uint8Array;function Py(e){var t=new e.constructor(e.byteLength);return new rg(t).set(new rg(e)),t}function _E(e,t){var i=Py(e.buffer);return new e.constructor(i,e.byteOffset,e.byteLength)}var vE=/\w*$/;function yE(e){var t=new e.constructor(e.source,vE.exec(e));return t.lastIndex=e.lastIndex,t}var h2=Xl?Xl.prototype:void 0,u2=h2?h2.valueOf:void 0;function bE(e){return u2?Object(u2.call(e)):{}}function wE(e,t){var i=Py(e.buffer);return new e.constructor(i,e.byteOffset,e.length)}var xE="[object Boolean]",ME="[object Date]",IE="[object Map]",AE="[object Number]",TE="[object RegExp]",CE="[object Set]",SE="[object String]",PE="[object Symbol]",EE="[object ArrayBuffer]",kE="[object DataView]",RE="[object Float32Array]",LE="[object Float64Array]",zE="[object Int8Array]",FE="[object Int16Array]",DE="[object Int32Array]",BE="[object Uint8Array]",GE="[object Uint8ClampedArray]",VE="[object Uint16Array]",jE="[object Uint32Array]";function ZE(e,t,i){var a=e.constructor;switch(t){case EE:return Py(e);case xE:case ME:return new a(+e);case kE:return _E(e);case RE:case LE:case zE:case FE:case DE:case BE:case GE:case VE:case jE:return wE(e);case IE:return new a;case AE:case SE:return new a(e);case TE:return yE(e);case CE:return new a;case PE:return bE(e)}}function OE(e){return typeof e.constructor=="function"&&!x6(e)?xS(XP(e)):{}}var NE="[object Map]";function UE(e){return ql(e)&&Oa(e)==NE}var d2=$u&&$u.isMap,HE=d2?Sy(d2):UE,WE="[object Set]";function XE(e){return ql(e)&&Oa(e)==WE}var f2=$u&&$u.isSet,qE=f2?Sy(f2):XE,P6="[object Arguments]",YE="[object Array]",KE="[object Boolean]",$E="[object Date]",JE="[object Error]",E6="[object Function]",QE="[object GeneratorFunction]",e7="[object Map]",t7="[object Number]",k6="[object Object]",r7="[object RegExp]",i7="[object Set]",n7="[object String]",s7="[object Symbol]",a7="[object WeakMap]",o7="[object ArrayBuffer]",l7="[object DataView]",c7="[object Float32Array]",h7="[object Float64Array]",u7="[object Int8Array]",d7="[object Int16Array]",f7="[object Int32Array]",p7="[object Uint8Array]",m7="[object Uint8ClampedArray]",g7="[object Uint16Array]",_7="[object Uint32Array]",un={};un[P6]=un[YE]=un[o7]=un[l7]=un[KE]=un[$E]=un[c7]=un[h7]=un[u7]=un[d7]=un[f7]=un[e7]=un[t7]=un[k6]=un[r7]=un[i7]=un[n7]=un[s7]=un[p7]=un[m7]=un[g7]=un[_7]=!0;un[JE]=un[E6]=un[a7]=!1;function Vm(e,t,i,a,h,d){var p;if(p!==void 0)return p;if(!Yl(e))return e;var s=rp(e);if(s)p=gE(e);else{var w=Oa(e),A=w==E6||w==QE;if(tg(e))return tE(e);if(w==k6||w==P6||A&&!h)p=A?{}:OE(e);else{if(!un[w])return h?e:{};p=ZE(e,w)}}d||(d=new gl);var z=d.get(e);if(z)return z;d.set(e,p),qE(e)?e.forEach(function(V){p.add(Vm(V,t,i,V,e,d))}):HE(e)&&e.forEach(function(V,W){p.set(W,Vm(V,t,i,W,e,d))});var B=Tv,D=s?void 0:B(e);return MS(D||e,function(V,W){D&&(W=V,V=e[W]),ES(p,W,Vm(V,t,i,W,e,d))}),p}var v7=1,y7=4;function jm(e){return Vm(e,v7|y7)}var b7="__lodash_hash_undefined__";function w7(e){return this.__data__.set(e,b7),this}function x7(e){return this.__data__.has(e)}function ig(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new ph;++t<i;)this.add(e[t])}ig.prototype.add=ig.prototype.push=w7;ig.prototype.has=x7;function M7(e,t){for(var i=-1,a=e==null?0:e.length;++i<a;)if(t(e[i],i,e))return!0;return!1}function I7(e,t){return e.has(t)}var A7=1,T7=2;function R6(e,t,i,a,h,d){var p=i&A7,s=e.length,w=t.length;if(s!=w&&!(p&&w>s))return!1;var A=d.get(e),z=d.get(t);if(A&&z)return A==t&&z==e;var B=-1,D=!0,V=i&T7?new ig:void 0;for(d.set(e,t),d.set(t,e);++B<s;){var W=e[B],S=t[B];if(a)var j=p?a(S,W,B,t,e,d):a(W,S,B,e,t,d);if(j!==void 0){if(j)continue;D=!1;break}if(V){if(!M7(t,function(ne,te){if(!I7(V,te)&&(W===ne||h(W,ne,i,a,d)))return V.push(te)})){D=!1;break}}else if(!(W===S||h(W,S,i,a,d))){D=!1;break}}return d.delete(e),d.delete(t),D}function C7(e){var t=-1,i=Array(e.size);return e.forEach(function(a,h){i[++t]=[h,a]}),i}function S7(e){var t=-1,i=Array(e.size);return e.forEach(function(a){i[++t]=a}),i}var P7=1,E7=2,k7="[object Boolean]",R7="[object Date]",L7="[object Error]",z7="[object Map]",F7="[object Number]",D7="[object RegExp]",B7="[object Set]",G7="[object String]",V7="[object Symbol]",j7="[object ArrayBuffer]",Z7="[object DataView]",p2=Xl?Xl.prototype:void 0,j_=p2?p2.valueOf:void 0;function O7(e,t,i,a,h,d,p){switch(i){case Z7:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case j7:return!(e.byteLength!=t.byteLength||!d(new rg(e),new rg(t)));case k7:case R7:case F7:return Cy(+e,+t);case L7:return e.name==t.name&&e.message==t.message;case D7:case G7:return e==t+"";case z7:var s=C7;case B7:var w=a&P7;if(s||(s=S7),e.size!=t.size&&!w)return!1;var A=p.get(e);if(A)return A==t;a|=E7,p.set(e,t);var z=R6(s(e),s(t),a,h,d,p);return p.delete(e),z;case V7:if(j_)return j_.call(e)==j_.call(t)}return!1}var N7=1,U7=Object.prototype,H7=U7.hasOwnProperty;function W7(e,t,i,a,h,d){var p=i&N7,s=Tv(e),w=s.length,A=Tv(t),z=A.length;if(w!=z&&!p)return!1;for(var B=w;B--;){var D=s[B];if(!(p?D in t:H7.call(t,D)))return!1}var V=d.get(e),W=d.get(t);if(V&&W)return V==t&&W==e;var S=!0;d.set(e,t),d.set(t,e);for(var j=p;++B<w;){D=s[B];var ne=e[D],te=t[D];if(a)var Q=p?a(te,ne,D,t,e,d):a(ne,te,D,e,t,d);if(!(Q===void 0?ne===te||h(ne,te,i,a,d):Q)){S=!1;break}j||(j=D=="constructor")}if(S&&!j){var N=e.constructor,re=t.constructor;N!=re&&"constructor"in e&&"constructor"in t&&!(typeof N=="function"&&N instanceof N&&typeof re=="function"&&re instanceof re)&&(S=!1)}return d.delete(e),d.delete(t),S}var X7=1,m2="[object Arguments]",g2="[object Array]",vm="[object Object]",q7=Object.prototype,_2=q7.hasOwnProperty;function Y7(e,t,i,a,h,d){var p=rp(e),s=rp(t),w=p?g2:Oa(e),A=s?g2:Oa(t);w=w==m2?vm:w,A=A==m2?vm:A;var z=w==vm,B=A==vm,D=w==A;if(D&&tg(e)){if(!tg(t))return!1;p=!0,z=!1}if(D&&!z)return d||(d=new gl),p||T6(e)?R6(e,t,i,a,h,d):O7(e,t,w,i,a,h,d);if(!(i&X7)){var V=z&&_2.call(e,"__wrapped__"),W=B&&_2.call(t,"__wrapped__");if(V||W){var S=V?e.value():e,j=W?t.value():t;return d||(d=new gl),h(S,j,i,a,d)}}return D?(d||(d=new gl),W7(e,t,i,a,h,d)):!1}function L6(e,t,i,a,h){return e===t?!0:e==null||t==null||!ql(e)&&!ql(t)?e!==e&&t!==t:Y7(e,t,i,a,L6,h)}var Z_=function(){return Ya.Date.now()},K7="Expected a function",$7=Math.max,J7=Math.min;function z6(e,t,i){var a,h,d,p,s,w,A=0,z=!1,B=!1,D=!0;if(typeof e!="function")throw new TypeError(K7);t=qx(t)||0,Yl(i)&&(z=!!i.leading,B="maxWait"in i,d=B?$7(qx(i.maxWait)||0,t):d,D="trailing"in i?!!i.trailing:D);function V(oe){var ve=a,Pe=h;return a=h=void 0,A=oe,p=e.apply(Pe,ve),p}function W(oe){return A=oe,s=setTimeout(ne,t),z?V(oe):p}function S(oe){var ve=oe-w,Pe=oe-A,$=t-ve;return B?J7($,d-Pe):$}function j(oe){var ve=oe-w,Pe=oe-A;return w===void 0||ve>=t||ve<0||B&&Pe>=d}function ne(){var oe=Z_();if(j(oe))return te(oe);s=setTimeout(ne,S(oe))}function te(oe){return s=void 0,D&&a?V(oe):(a=h=void 0,p)}function Q(){s!==void 0&&clearTimeout(s),A=0,a=w=h=s=void 0}function N(){return s===void 0?p:te(Z_())}function re(){var oe=Z_(),ve=j(oe);if(a=arguments,h=this,w=oe,ve){if(s===void 0)return W(w);if(B)return clearTimeout(s),s=setTimeout(ne,t),V(w)}return s===void 0&&(s=setTimeout(ne,t)),p}return re.cancel=Q,re.flush=N,re}function Q7(e,t){return L6(e,t)}var e9="Expected a function";function Ev(e,t,i){var a=!0,h=!0;if(typeof e!="function")throw new TypeError(e9);return Yl(i)&&(a="leading"in i?!!i.leading:a,h="trailing"in i?!!i.trailing:h),z6(e,t,{leading:a,maxWait:t,trailing:h})}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const F6=Symbol("Comlink.proxy"),t9=Symbol("Comlink.endpoint"),r9=Symbol("Comlink.releaseProxy"),O_=Symbol("Comlink.finalizer"),Zm=Symbol("Comlink.thrown"),D6=e=>typeof e=="object"&&e!==null||typeof e=="function",i9={canHandle:e=>D6(e)&&e[F6],serialize(e){const{port1:t,port2:i}=new MessageChannel;return G6(e,t),[i,[i]]},deserialize(e){return e.start(),kv(e)}},n9={canHandle:e=>D6(e)&&Zm in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},B6=new Map([["proxy",i9],["throw",n9]]);function s9(e,t){for(const i of e)if(t===i||i==="*"||i instanceof RegExp&&i.test(t))return!0;return!1}function G6(e,t=globalThis,i=["*"]){t.addEventListener("message",function a(h){if(!h||!h.data)return;if(!s9(i,h.origin)){console.warn(`Invalid origin '${h.origin}' for comlink proxy`);return}const{id:d,type:p,path:s}=Object.assign({path:[]},h.data),w=(h.data.argumentList||[]).map(Kc);let A;try{const z=s.slice(0,-1).reduce((D,V)=>D[V],e),B=s.reduce((D,V)=>D[V],e);switch(p){case"GET":A=B;break;case"SET":z[s.slice(-1)[0]]=Kc(h.data.value),A=!0;break;case"APPLY":A=B.apply(z,w);break;case"CONSTRUCT":{const D=new B(...w);A=O6(D)}break;case"ENDPOINT":{const{port1:D,port2:V}=new MessageChannel;G6(e,V),A=h9(D,[D])}break;case"RELEASE":A=void 0;break;default:return}}catch(z){A={value:z,[Zm]:0}}Promise.resolve(A).catch(z=>({value:z,[Zm]:0})).then(z=>{const[B,D]=ag(z);t.postMessage(Object.assign(Object.assign({},B),{id:d}),D),p==="RELEASE"&&(t.removeEventListener("message",a),V6(t),O_ in e&&typeof e[O_]=="function"&&e[O_]())}).catch(z=>{const[B,D]=ag({value:new TypeError("Unserializable return value"),[Zm]:0});t.postMessage(Object.assign(Object.assign({},B),{id:d}),D)})}),t.start&&t.start()}function a9(e){return e.constructor.name==="MessagePort"}function V6(e){a9(e)&&e.close()}function kv(e,t){const i=new Map;return e.addEventListener("message",function(h){const{data:d}=h;if(!d||!d.id)return;const p=i.get(d.id);if(p)try{p(d)}finally{i.delete(d.id)}}),Rv(e,i,[],t)}function ym(e){if(e)throw new Error("Proxy has been released and is not useable")}function j6(e){return Iu(e,new Map,{type:"RELEASE"}).then(()=>{V6(e)})}const ng=new WeakMap,sg="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(ng.get(e)||0)-1;ng.set(e,t),t===0&&j6(e)});function o9(e,t){const i=(ng.get(t)||0)+1;ng.set(t,i),sg&&sg.register(e,t,e)}function l9(e){sg&&sg.unregister(e)}function Rv(e,t,i=[],a=function(){}){let h=!1;const d=new Proxy(a,{get(p,s){if(ym(h),s===r9)return()=>{l9(d),j6(e),t.clear(),h=!0};if(s==="then"){if(i.length===0)return{then:()=>d};const w=Iu(e,t,{type:"GET",path:i.map(A=>A.toString())}).then(Kc);return w.then.bind(w)}return Rv(e,t,[...i,s])},set(p,s,w){ym(h);const[A,z]=ag(w);return Iu(e,t,{type:"SET",path:[...i,s].map(B=>B.toString()),value:A},z).then(Kc)},apply(p,s,w){ym(h);const A=i[i.length-1];if(A===t9)return Iu(e,t,{type:"ENDPOINT"}).then(Kc);if(A==="bind")return Rv(e,t,i.slice(0,-1));const[z,B]=v2(w);return Iu(e,t,{type:"APPLY",path:i.map(D=>D.toString()),argumentList:z},B).then(Kc)},construct(p,s){ym(h);const[w,A]=v2(s);return Iu(e,t,{type:"CONSTRUCT",path:i.map(z=>z.toString()),argumentList:w},A).then(Kc)}});return o9(d,e),d}function c9(e){return Array.prototype.concat.apply([],e)}function v2(e){const t=e.map(ag);return[t.map(i=>i[0]),c9(t.map(i=>i[1]))]}const Z6=new WeakMap;function h9(e,t){return Z6.set(e,t),e}function O6(e){return Object.assign(e,{[F6]:!0})}function ag(e){for(const[t,i]of B6)if(i.canHandle(e)){const[a,h]=i.serialize(e);return[{type:"HANDLER",name:t,value:a},h]}return[{type:"RAW",value:e},Z6.get(e)||[]]}function Kc(e){switch(e.type){case"HANDLER":return B6.get(e.name).deserialize(e.value);case"RAW":return e.value}}function Iu(e,t,i,a){return new Promise(h=>{const d=u9();t.set(d,h),e.start&&e.start(),e.postMessage(Object.assign({id:d},i),a)})}function u9(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}async function d9(e,t,i){let a;if(typeof i=="function"?a=await i(e,t):a=await fetch(e,t),!a.ok){const h=await a.json();throw h&&h.error?new Error(h.error):a.statusText?new Error(a.statusText):a.status===404?new Error(`Not found: ${e} (404)`):a.status===500?new Error("Internal server error (500)"):new Error(`Failed to fetch: ${e} (${a.status})`)}return a}async function f9(e,t,i){return await(await d9(e,t,i)).json()}async function p9(e,t,i){return await f9(`${e}/info.json`,t,i)}function m9(e,t={}){const{sorted:i}=t;i||(e=e.slice().sort(g9));const a=e.length,h=new Array(a*2);let d=0;for(let s=0;s<a;s++){const w=e[s];for(;d>=2&&y2(h[d-2],h[d-1],w)<=0;)d--;h[d++]=w}const p=d+1;for(let s=a-2;s>=0;s--){const w=e[s];for(;d>=p&&y2(h[d-2],h[d-1],w)<=0;)d--;h[d++]=w}return h.slice(0,d-1)}function y2(e,t,i){return(t[1]-e[1])*(i[0]-e[0])-(t[0]-e[0])*(i[1]-e[1])}function g9(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]}function Kl(e){return Array.isArray(e)&&e.length>=2&&typeof e[0]=="number"&&typeof e[1]=="number"}function sp(e){return Array.isArray(e)&&e.every(Kl)}function _9(e){return Array.isArray(e)&&e.every(Kl)}function Ju(e){return Array.isArray(e)&&e.every(_9)}function b2(e){return Array.isArray(e)&&e.every(Kl)}function w2(e){return Array.isArray(e)&&e.every(sp)}function Lv(e){return Array.isArray(e)&&e.every(Ju)}function N6(e){return[...e,e[0]]}function v9(e){return e.splice(-1),e}function Ey(e){return e.map(t=>N6(t))}function ky(e){if(e=e.filter(function(t,i,a){return i===0||!Yg(t,a[i-1])}),e.length<2)throw new Error("LineString should contain at least 2 points");return e}function U6(e){if(e=e.filter(function(t,i,a){return i===0||!Yg(t,a[i-1])}),P9(e)&&v9(e),e.length<3)throw new Error("Ring should contain at least 3 points");return e}function Ry(e){return e.map(t=>U6(t))}function y9(e){return e.map(t=>ky(t))}function b9(e){return e.map(t=>Ry(t))}function w9(e){return{type:"Point",coordinates:e}}function x9(e){return{type:"LineString",coordinates:e}}function M9(e,t=!0){const i={type:"Polygon",coordinates:t?Ey(e):e};return lC(i)}function I9(e,t){{if(Kl(e))return w9(e);if(sp(e))return x9(e);if(Ju(e))return M9(e);throw new Error("Geometry type not supported")}}function A9(e){return{type:"circle",coordinates:e}}function T9(e){return{type:"polyline",coordinates:e}}function C9(e){return{type:"polygon",coordinates:e[0]}}function S9(e){if(Kl(e))return A9(e);if(sp(e))return T9(e);if(Ju(e))return C9(e);throw new Error("Unsupported GeoJSON Geometry")}function P9(e){return Array.isArray(e)&&e.length>=2&&Yg(e[0],e[e.length-1])}function Yg(e,t){return e===t?!0:e===null||t===null?!1:e[0]===t[0]&&e[1]===t[1]}function x2(e,t){if(e.length!==t.length)throw new Error("Point arrays should be of same length");return e.map((i,a)=>[i,t[a]])}function wf(e){return e.reduce((t,i,a)=>[...t,[i,e[(a+1)%e.length]]],[])}function xf(e){return[e[0],-e[1]]}function zv(e,t,i){return e*(1-i)+t*i}function H6(e,t,i){return[zv(e[0],t[0],i),zv(e[1],t[1],i)]}function Fv(e,t,i){return e.map((a,h)=>H6(a,t[h],i))}function og(...e){const t=[0,0];for(let i=0;i<e.length;i++)t[0]+=e[i][0],t[1]+=e[i][1];return t[0]=t[0]/e.length,t[1]=t[1]/e.length,t}function E9(e){return Math.atan2(e[1][1]-e[0][1],e[1][0]-e[0][0])}function k9(e,t,i){return[e[0]+Math.cos(i)*t,e[1]+Math.sin(i)*t]}function bo(e,t){return Math.sqrt(ah(e,t))}function ah(e,t=[0,0]){return(t[0]-e[0])**2+(t[1]-e[1])**2}function R9(e,t){if(e.length!==t.length)throw new Error("Arrays need to be of same length");const i=e.map((d,p)=>ah(d,t[p])),a=i.reduce((d,p)=>d+p,0)/i.length;return Math.sqrt(a)}function Dv(e,t){return t===1?e:[e[0]*t,e[1]*t]}function L9(e,t){return t===1?e:e.map(i=>Dv(i,t))}function Bv(e,t,i="add"){return i==="add"?[e[0]+t[0],e[1]+t[1]]:[e[0]-t[0],e[1]-t[1]]}function M2(e,t,i="add"){return Yg(t,[0,0])?e:e.map(a=>Bv(a,t,i))}function lg(e,t=0,i=void 0,a,h){return t===0||t===void 0?e:i?Bv(lg(Bv(e,i,"substract"),t,void 0,a,h),i):(a=a||Math.cos(t),h=h||Math.sin(t),[e[0]*a-e[1]*h,e[0]*h+e[1]*a])}function N_(e,t=0,i=void 0,a,h){return t===0||t===void 0?e:(a=a||Math.cos(t),h=h||Math.sin(t),e.map(d=>lg(d,t,i,a,h)))}function z9(e){return[U_(e[0],e[1],e[2]),U_(e[1],e[2],e[0]),U_(e[2],e[0],e[1])]}function U_(e,t,i){const a=bo(e,t),h=bo(t,i),d=bo(e,i);return Math.acos((a**2+d**2-h**2)/(2*a*d))}function Kg(e){return Array.isArray(e)&&e.length>=2&&e.every(t=>typeof t=="number")}function W6(e){return Array.isArray(e)&&e.every(Kg)}function F9(e){return Array.isArray(e)&&e.every(Kg)}function X6(e){return Array.isArray(e)&&e.every(F9)}function D9(e){return Array.isArray(e)&&e.every(Kg)}function B9(e){return Array.isArray(e)&&e.every(W6)}function G9(e){return Array.isArray(e)&&e.every(X6)}function V9(e){return typeof e=="object"&&e!==null&&"type"in e&&e.type==="Point"&&"coordinates"in e&&Kg(e.coordinates)}function j9(e){return typeof e=="object"&&e!==null&&"type"in e&&e.type==="LineString"&&"coordinates"in e&&W6(e.coordinates)}function Z9(e){return typeof e=="object"&&e!==null&&"type"in e&&e.type==="Polygon"&&"coordinates"in e&&Array.isArray(e.coordinates)&&X6(e.coordinates)}function O9(e){return typeof e=="object"&&e!==null&&"type"in e&&e.type==="MultiPoint"&&"coordinates"in e&&D9(e.coordinates)}function N9(e){return typeof e=="object"&&e!==null&&"type"in e&&e.type==="MultiLineString"&&"coordinates"in e&&B9(e.coordinates)}function U9(e){return typeof e=="object"&&e!==null&&"type"in e&&e.type==="MultiPolygon"&&"coordinates"in e&&Array.isArray(e.coordinates)&&G9(e.coordinates)}function H9(e){const t=typeof e=="object"&&e!==null,a=t&&"type"in e&&typeof e.type=="string"&&(e.type==="Point"||e.type==="LineString"||e.type==="Polygon"||e.type==="MultiPoint"||e.type==="MultiLineString"||e.type==="MultiPolygon"),h=t&&"coordinates"in e&&Array.isArray(e.coordinates);return a&&h}function sd(e){return e.slice(0,2)}function W9(e){return sd(e.coordinates)}function X9(e){return ky(e.coordinates.map(sd))}function q9(e,t=!1){const i=Ry(e.coordinates.map(a=>a.map(sd)));return t?i.map(a=>[...a,a[0]]):i}function Y9(e){return e.coordinates.map(sd)}function K9(e){return y9(e.coordinates.map(t=>t.map(sd)))}function $9(e,t=!1){const i=b9(e.coordinates.map(a=>a.map(h=>h.map(sd))));return t?i.map(a=>a.map(h=>[...h,h[0]])):i}function q6(e){if(V9(e))return W9(e);if(j9(e))return X9(e);if(Z9(e))return q9(e);if(O9(e))return Y9(e);if(N9(e))return K9(e);if(U9(e))return $9(e);throw new Error("Geometry type not supported")}function J9(e,t){return{type:"Feature",properties:{},geometry:e}}function Q9(e,t){return{type:"FeatureCollection",features:e.map((i,a)=>J9(i))}}function ek(e){return e.geometry}function tk(e){return e.features.map(ek)}const rk=[-2003750834e-2,-200489661e-1],ik=[2003750834e-2,200489661e-1];function I2(e){let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(const a of e)t===void 0?a>=a&&(t=i=a):(t>a&&(t=a),i<a&&(i=a));return[t,i]}function A2(e,t,i){return Math.max(Math.min(e,i),t)}function nk(e,t,i){return[A2(e[0],t[0],i[0]),A2(e[1],t[1],i[1])]}function T2(e){return nk(e,rk,ik)}function Gn(e,t){if(Kl(e)&&(e=[e]),Ju(e)&&(e=e.flat()),Lv(e)&&(e=e.flat()),H9(e))return Gn(q6(e));e=e;const i=[],a=[];for(const w of e)i.push(w[0]),a.push(w[1]);const[h,d]=I2(i),[p,s]=I2(a);return[h,p,d,s]}function sk(e,t){const i=e[2]>=t[0]&&t[2]>=e[0],a=e[3]>=t[1]&&t[3]>=e[1];return i&&a}function ak(e,t){const i=Math.max(e[0],t[0]),a=Math.min(e[2],t[2]),h=Math.max(e[1],t[1]),d=Math.min(e[3],t[3]);if(i<a&&h<d)return[i,h,a,d]}function ok(e,t,i){return i===void 0&&(i=t),[e[0]-t,e[1]-i,e[2]+t,e[3]+i]}function Y6(e,t){if(!t||t===0)return e;const i=Om(e);return ok(e,...i.map(a=>a*t/2))}function wo(e){return[[e[0],e[1]],[e[2],e[1]],[e[2],e[3]],[e[0],e[3]]]}function Gu(e){return[(e[0]+e[2])/2,(e[1]+e[3])/2]}function Om(e){return[e[2]-e[0],e[3]-e[1]]}function Gv(e){return[.5*(bo(e[0],e[1])+bo(e[2],e[3])),.5*(bo(e[1],e[2])+bo(e[3],e[0]))]}function lk(e){if(e.length!==0)return m9(e)}function Ly(e,t,i){return i?i==="contain"?e[0]/e[1]>=t[0]/t[1]?e[0]/t[0]:e[1]/t[1]:e[0]/e[1]>=t[0]/t[1]?e[1]/t[1]:e[0]/t[0]:Math.sqrt(e[0]*e[1]/(t[0]*t[1]))}function H_(e,t){return[e[0]*t,e[1]*t]}function Lf(e){return e[0]*e[1]}function ck(e){return[e[0]/2,e[1]/2]}function Vv(e){return[0,0,...e]}function K6(e){return wo(Vv(e))}function C2(e,t){return Ly(Gv(e),Gv(t))}function hk(e,t,i,a=()=>!0,h=()=>!0){if(e.has(t)&&a(e.get(t)))return e.get(t);{const d=i();return h(d)&&e.set(t,d),d}}function $6(e,t,i,a,h=()=>!0,d=()=>!0){var p,s,w,A;if((p=e.get(t))!=null&&p.has(i)&&h((s=e.get(t))==null?void 0:s.get(i)))return(w=e.get(t))==null?void 0:w.get(i);{const z=a();return d(z)&&(e.get(t)||e.set(t,new Map),(A=e.get(t))==null||A.set(i,z)),z}}function S2(e,t,i,a,h,d,p=()=>!0,s=()=>!0){var w,A,z,B,D,V,W,S,j,ne,te,Q,N,re,oe,ve,Pe,$;if((z=(A=(w=e.get(t))==null?void 0:w.get(i))==null?void 0:A.get(a))!=null&&z.has(h)&&p((V=(D=(B=e.get(t))==null?void 0:B.get(i))==null?void 0:D.get(a))==null?void 0:V.get(h)))return(j=(S=(W=e.get(t))==null?void 0:W.get(i))==null?void 0:S.get(a))==null?void 0:j.get(h);{const le=d();return s(le)&&(e.get(t)||e.set(t,new Map),(ne=e.get(t))!=null&&ne.get(i)||(te=e.get(t))==null||te.set(i,new Map),(N=(Q=e.get(t))==null?void 0:Q.get(i))!=null&&N.get(a)||(oe=(re=e.get(t))==null?void 0:re.get(i))==null||oe.set(a,new Map),($=(Pe=(ve=e.get(t))==null?void 0:ve.get(i))==null?void 0:Pe.get(a))==null||$.set(h,le)),le}}const ap="a-f\\d",uk=`#?[${ap}]{3}[${ap}]?`,dk=`#?[${ap}]{6}([${ap}]{2})?`,fk=new RegExp(`[^#${ap}]`,"gi"),pk=new RegExp(`^${uk}$|^${dk}$`,"i");function J6(e,t={}){if(typeof e!="string"||fk.test(e)||!pk.test(e))throw new TypeError("Expected a valid hex string");e=e.replace(/^#/,"");let i=1;e.length===8&&(i=Number.parseInt(e.slice(6,8),16)/255,e=e.slice(0,6)),e.length===4&&(i=Number.parseInt(e.slice(3,4).repeat(2),16)/255,e=e.slice(0,3)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const a=Number.parseInt(e,16),h=a>>16,d=a>>8&255,p=a&255,s=typeof t.alpha=="number"?t.alpha:i;if(t.format==="array")return[h,d,p,s];if(t.format==="css"){const w=s===1?"":` / ${Number((s*100).toFixed(2))}%`;return`rgb(${h} ${d} ${p}${w})`}return{red:h,green:d,blue:p,alpha:s}}function mk(e){return J6(e,{format:"array"}).slice(0,3)}function gk(e){const t=J6(e,{format:"array"});return t[3]=255,t}function P2(e){return mk(e).map(t=>t/255)}function go(e){return gk(e).map(t=>t/255)}function E2(e,t,i=(a,h)=>a==h){if(e.length!==t.length)return!1;for(let a=0;a<e.length;a++)if(!i(e[a],t[a]))return!1;return!0}function _k(e,t){for(let i=0;i<t.length;i++)if(e.indexOf(t[i])===-1)return!1;return!0}function vk(e,t){return!e||!t||e.size!==t.size?!1:[...e].every(i=>t.has(i))}function yk(e,t,i){const a={};if(i&&i.length===0)return a;const h=new Map;let d=e?Object.keys(e):[];i&&(d=d.filter(s=>i.includes(s)));const p=t?Object.keys(t):[];for(const s of p)Object.prototype.hasOwnProperty.call(t,s)&&h.set(s,t[s]);for(const s of d){if(!Object.prototype.hasOwnProperty.call(e,s))continue;const w=e[s];(!h.has(s)||!Q7(w,h.get(s)))&&(a[s]=w)}return a}function bk(e,t){const i=jm(e);for(const a of t)delete i[a];return i}function xo(e,t,i=0){if(e<=0||t<=0)throw new Error("Empty ArrayMatrix not supported");const a=new Array(e);for(let h=0;h<e;h++){const d=new Array(t);for(let p=0;p<t;p++)d[p]=i;a[h]=d}return a}function $l(e){return[e.length,e[0].length]}function wk(e){const t=e.length,i=new Array(t);for(let a=0;a<t;a++)i[a]=e[a].slice();return i}function op(e,t,i,a){const h=$l(a),d=wk(e);for(let p=0;p<h[0];p++)for(let s=0;s<h[1];s++)d[t+p][i+s]=a[p][s];return d}function Q6(e){const t=e.length,i=e[0].length,a=new Array(i);for(let h=0;h<i;h++){const d=new Array(t);for(let p=0;p<t;p++)d[p]=e[p][h];a[h]=d}return a}function xk(e,t=0){const i=$l(e),a=e.map(W=>W.map(S=>$l(S))),h=a.map(W=>W.map(S=>S[0])),d=Q6(h),p=d[0];if(!d.every(W=>E2(W,d[0])))throw new Error("The blocks, by block column, must have the same sequence of rows.");const s=[];let w=0;p.forEach(W=>{s.push(w),w=w+W});const A=w,z=a.map(W=>W.map(S=>S[1])),B=z[0];if(!z.every(W=>E2(W,B)))throw new Error("The blocks, by block row, must have the same sequence of columns.");w=0,z[0].forEach(W=>{w=w+W});let V=xo(A,w,t);for(let W=0;W<i[0];W++)for(let S=0;S<i[1];S++)V=op(V,s[W],s[S],e[W][S]);return V}function zi(e,...t){return{...e,...ls(...t)}}function ls(...e){const t=e.filter(i=>i!=null);return t.length===0?{}:t.length===1?t[0]:Object.assign({},...t)}function Mk(...e){const t={};for(let i=0;i<e.length;i++){const a=e[i];if(a)for(const h in a){const d=a[h];d!==void 0&&(t[h]=d)}}return t}function Nm(e,...t){return{...e,...Mk(...t)}}function Ik(e,t){if(!t||Object.keys(t).length===0)return e;const i={};for(const a in t)t[a]!==void 0&&(i[a]=t[a]);return{...e,...i}}function zf(e){if(e!==void 0)return e.reduce((t,i)=>(t[i]=void 0,t),{})}function Ak(e){if(e===void 0)return;const t=new Map;for(const i of e.keys()){const a=e.get(i);t.set(i,zf(a))}return t}function Tk(e,t){t===void 0&&(t={});var i=t.offsetLine||0,a=t.offsetColumn||0,h=e.split(`
`),d=0,p=h.map(function(B,D){var V=d+B.length+1,W={start:d,end:V,line:D};return d=V,W}),s=0;function w(B,D){return B.start<=D&&D<B.end}function A(B,D){return{line:i+B.line,column:a+D-B.start,character:D}}function z(B,D){typeof B=="string"&&(B=e.indexOf(B,D||0));for(var V=p[s],W=B>=V.end?1:-1;V;){if(w(V,B))return A(V,B);s+=W,V=p[s]}}return z}function Ck(e,t,i){return Tk(e,i)(t,i)}var k2=/[a-zA-Z0-9:_-]/,R2=/[\s\t\r\n]/,Sk=/['"]/;function Pk(e,t){for(var i="";t--;)i+=e;return i}function Ek(e){var t="",i=[],a=s,h=null,d=null;function p(N){var re=Ck(e,Q),oe=re.line,ve=re.column,Pe=e.slice(0,Q),$=/(^|\n).*$/.exec(Pe)[0].replace(/\t/g,"  "),le=e.slice(Q),Me=/.*(\n|$)/.exec(le)[0],Ve=""+$+Me+`
`+Pk(" ",$.length)+"^";throw new Error(N+" ("+oe+":"+ve+`). If this is valid SVG, it's probably a bug in svg-parser. Please raise an issue at https://github.com/Rich-Harris/svg-parser/issues â thanks!

`+Ve)}function s(){for(;Q<e.length&&e[Q]!=="<"||!k2.test(e[Q+1]);)t+=e[Q++];return w()}function w(){for(var N="";Q<e.length&&e[Q]!=="<";)N+=e[Q++];return/\S/.test(N)&&h.children.push({type:"text",value:N}),e[Q]==="<"?A:w}function A(){var N=e[Q];if(N==="?")return w;if(N==="!"){if(e.slice(Q+1,Q+3)==="--")return z;if(e.slice(Q+1,Q+8)==="[CDATA[")return B;if(/doctype/i.test(e.slice(Q+1,Q+8)))return w}if(N==="/")return D;var re=V(),oe={type:"element",tagName:re,properties:{},children:[]};h?h.children.push(oe):d=oe;for(var ve;Q<e.length&&(ve=W());)oe.properties[ve.name]=ve.value;var Pe=!1;return e[Q]==="/"&&(Q+=1,Pe=!0),e[Q]!==">"&&p("Expected >"),Pe||(h=oe,i.push(oe)),w}function z(){var N=e.indexOf("-->",Q);return~N||p("expected -->"),Q=N+2,w}function B(){var N=e.indexOf("]]>",Q);return~N||p("expected ]]>"),h.children.push(e.slice(Q+7,N)),Q=N+2,w}function D(){var N=V();return N||p("Expected tag name"),N!==h.tagName&&p("Expected closing tag </"+N+"> to match opening tag <"+h.tagName+">"),te(),e[Q]!==">"&&p("Expected >"),i.pop(),h=i[i.length-1],w}function V(){for(var N="";Q<e.length&&k2.test(e[Q]);)N+=e[Q++];return N}function W(){if(!R2.test(e[Q]))return null;te();var N=V();if(!N)return null;var re=!0;return te(),e[Q]==="="&&(Q+=1,te(),re=S(),!isNaN(re)&&re.trim()!==""&&(re=+re)),{name:N,value:re}}function S(){return Sk.test(e[Q])?ne():j()}function j(){var N="";do{var re=e[Q];if(re===" "||re===">"||re==="/")return N;N+=re,Q+=1}while(Q<e.length);return N}function ne(){for(var N=e[Q++],re="",oe=!1;Q<e.length;){var ve=e[Q++];if(ve===N&&!oe)return re;ve==="\\"&&!oe&&(oe=!0),re+=oe?"\\"+ve:ve,oe=!1}}function te(){for(;Q<e.length&&R2.test(e[Q]);)Q+=1}for(var Q=s.length;Q<e.length;)a||p("Unexpected character"),a=a(),Q+=1;return a!==w&&p("Unexpected end of input"),d.tagName==="svg"&&(d.metadata=t),{type:"root",children:[d]}}function kk(e){return e.type==="circle"}function Rk(e){return e.type==="line"}function Lk(e){return e.type==="polyline"}function zk(e){return e.type==="rect"}function Fk(e){return e.type==="polygon"}function*Dk(e){function*t(a){if("children"in a)for(const h of a.children)typeof h!="string"&&(yield*t(h));yield a}const i=Ek(e);for(const a of t(i))if("tagName"in a&&a.tagName!=="svg"&&a.tagName!=="g"){const h=Bk(a);h&&(yield h)}}function Bk(e){var i;const t=(i=e==null?void 0:e.tagName)==null?void 0:i.toLowerCase();if(t==="circle")return{type:"circle",coordinates:[Xn(e,"cx"),Xn(e,"cy")]};if(t==="line")return{type:"line",coordinates:[[Xn(e,"x1"),Xn(e,"y1")],[Xn(e,"x2"),Xn(e,"y2")]]};if(t==="polyline")return{type:"polyline",coordinates:L2(e)};if(t==="polygon")return{type:"polygon",coordinates:L2(e)};if(t==="rect")return{type:"rect",coordinates:[[Xn(e,"x"),Xn(e,"y")],[Xn(e,"x")+Xn(e,"width"),Xn(e,"y")],[Xn(e,"x")+Xn(e,"width"),Xn(e,"y")+Xn(e,"height")],[Xn(e,"x"),Xn(e,"y")+Xn(e,"height")],[Xn(e,"x"),Xn(e,"y")]]};throw new Error(`Unsupported SVG element: ${t}`)}function Xn(e,t){var a;const i=(a=e==null?void 0:e.properties)==null?void 0:a[t];return Number(i)||0}function L2(e){var i;const t=(i=e==null?void 0:e.properties)==null?void 0:i.points;return t?String(t).trim().split(/\s+/).map(a=>{const h=a.split(",").map(d=>Number(d));return[h[0],h[1]]}):[]}function z2(e){return e.map(t=>t.join(",")).join(" ")}function Gk(e){return`<svg xmlns="http://www.w3.org/2000/svg">
  ${e.map(Vk).join(`
`)}
</svg>`}function Vk(e){if(e.type==="circle")return Mf("circle",{...e.attributes,cx:e.coordinates[0],cy:e.coordinates[1]});if(e.type==="line")return Mf("line",{...e.attributes,x1:e.coordinates[0][0],y1:e.coordinates[0][1],x2:e.coordinates[1][0],y2:e.coordinates[1][1]});if(e.type==="polyline")return Mf("polyline",{...e.attributes,points:z2(e.coordinates)});if(e.type==="polygon")return Mf("polygon",{...e.attributes,points:z2(e.coordinates)});if(e.type==="rect")return Mf("rect",{...e.attributes,x:e.coordinates[0][0],y:e.coordinates[0][1],width:e.coordinates[1][0]-e.coordinates[0][0],height:e.coordinates[2][1]-e.coordinates[0][1]});throw new Error("Unknown SVG element")}function Mf(e,t){const i=Object.entries(t).map(([a,h])=>`${a}="${h}"`);return`<${e} ${i.join(" ")} />`}function jk(e){if(kk(e))return e.coordinates;if(Rk(e))return e.coordinates;if(Lk(e))return e.coordinates;if(zk(e))return[e.coordinates];if(Fk(e))return[e.coordinates];throw new Error("Unsupported SVG geometry")}const jv=["log2sigma","twoOmega","airyKavr","signDetJ","thetaa"];function F2(e,t,i,a=1){if(e.length===0)return new Map;if(!t||!i)return new Map(e.map(w=>[w,0]));const{E:h,F:d,a:p,b:s}=Zk(t,i);return new Map(e.map(w=>{if(jv.indexOf(w)===-1)throw new Error("Distortion "+w+" not supported");switch(jv.indexOf(w)){case 0:return[w,Ok(p,s,a)];case 1:return[w,Nk(p,s)];case 2:return[w,Uk(p,s,a)];case 3:return[w,Hk(t,i)];case 4:return[w,Wk(t,p,s,h,d)];default:return[w,0]}}))}function Zk(e,t){const i=e[0]**2+e[1]**2,a=e[0]*t[0]+e[1]*t[1],h=t[0]**2+t[1]**2,d=Math.sqrt(.5*(i+h+Math.sqrt((i-h)**2+4*a**2))),p=Math.sqrt(.5*(i+h-Math.sqrt((i-h)**2+4*a**2)));return{E:i,F:a,G:h,a:d,b:p}}function Ok(e,t,i=1){return(Math.log(e*t)-2*Math.log(i))/Math.log(2)}function Nk(e,t){return 2*Math.asin((e-t)/(e+t))}function Uk(e,t,i=1){return .5*(Math.log(e/i)**2+Math.log(t/i)**2)}function Hk(e,t){return Math.sign(e[0]*t[1]-e[1]*t[0])}function Wk(e,t,i,a,h){const d=Math.atan(e[1]/e[0]),p=Math.sign(-h)*Math.asin(Math.sqrt((1-t**2/a)/(1-(t/i)**2)));return d-p}class zy{constructor(t,i,a,h){Ke(this,"sourcePoints");Ke(this,"destinationPoints");Ke(this,"destinationTransformedSourcePoints");Ke(this,"type");Ke(this,"pointCount");Ke(this,"pointCountMinimum");Ke(this,"errors");Ke(this,"rmse");if(this.sourcePoints=t,this.destinationPoints=i,this.pointCount=this.sourcePoints.length,this.type=a,this.pointCountMinimum=h,this.pointCount<this.pointCountMinimum)throw new Error("Not enough control points. A "+this.type+" transformation requires a minimum of "+this.pointCountMinimum+" points, but "+this.pointCount+" are given.")}setWeightsArrays(t){this.weightsArrays=t,this.processWeightsArrays()}processWeightsArrays(){}getDestinationTransformedSourcePoints(){return this.destinationTransformedSourcePoints||(this.destinationTransformedSourcePoints=this.sourcePoints.map(t=>this.evaluateFunction(t))),this.destinationTransformedSourcePoints}getMeasures(){return{}}getErrors(){if(!this.errors){const t=this.getDestinationTransformedSourcePoints();this.errors=this.destinationPoints.map((i,a)=>bo(i,t[a]))}return this.errors}getRmse(){if(!this.rmse){const t=this.getDestinationTransformedSourcePoints();this.destinationTransformedSourcePoints||this.getDestinationTransformedSourcePoints(),this.rmse=R9(this.destinationPoints,t)}return this.rmse}}class e3 extends zy{constructor(i,a,h,d){super(i,a,h,d);Ke(this,"destinationPointsArrays");this.destinationPointsArrays=this.getDestinationPointsArrays()}}var bi={};const Xk=Object.prototype.toString;function lp(e){const t=Xk.call(e);return t.endsWith("Array]")&&!t.includes("Big")}const qk=Object.freeze(Object.defineProperty({__proto__:null,isAnyArray:lp},Symbol.toStringTag,{value:"Module"})),Yk=yy(qk);function Kk(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!lp(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var i=t.fromIndex,a=i===void 0?0:i,h=t.toIndex,d=h===void 0?e.length:h;if(a<0||a>=e.length||!Number.isInteger(a))throw new Error("fromIndex must be a positive integer smaller than length");if(d<=a||d>e.length||!Number.isInteger(d))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var p=e[a],s=a+1;s<d;s++)e[s]>p&&(p=e[s]);return p}function $k(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!lp(e))throw new TypeError("input must be an array");if(e.length===0)throw new TypeError("input must not be empty");var i=t.fromIndex,a=i===void 0?0:i,h=t.toIndex,d=h===void 0?e.length:h;if(a<0||a>=e.length||!Number.isInteger(a))throw new Error("fromIndex must be a positive integer smaller than length");if(d<=a||d>e.length||!Number.isInteger(d))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var p=e[a],s=a+1;s<d;s++)e[s]<p&&(p=e[s]);return p}function Jk(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(lp(e)){if(e.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var i;if(t.output!==void 0){if(!lp(t.output))throw new TypeError("output option must be an array if specified");i=t.output}else i=new Array(e.length);var a=$k(e),h=Kk(e);if(a===h)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var d=t.min,p=d===void 0?t.autoMinMax?a:0:d,s=t.max,w=s===void 0?t.autoMinMax?h:1:s;if(p>=w)throw new RangeError("min option must be smaller than max option");for(var A=(w-p)/(h-a),z=0;z<e.length;z++)i[z]=(e[z]-a)*A+p;return i}const Qk=Object.freeze(Object.defineProperty({__proto__:null,default:Jk},Symbol.toStringTag,{value:"Module"})),eR=yy(Qk);var D2;function tR(){var st,Zv,wt;if(D2)return bi;D2=1,Object.defineProperty(bi,"__esModule",{value:!0});var e=Yk,t=eR;const i=" ".repeat(2),a=" ".repeat(4);function h(){return d(this)}function d(ie,k={}){const{maxRows:C=15,maxColumns:M=10,maxNumSize:P=8,padMinus:O="auto"}=k;return`${ie.constructor.name} {
${i}[
${a}${p(ie,C,M,P,O)}
${i}]
${i}rows: ${ie.rows}
${i}columns: ${ie.columns}
}`}function p(ie,k,C,M,P){const{rows:O,columns:xe}=ie,he=Math.min(O,k),Y=Math.min(xe,C),U=[];if(P==="auto"){P=!1;e:for(let J=0;J<he;J++)for(let ue=0;ue<Y;ue++)if(ie.get(J,ue)<0){P=!0;break e}}for(let J=0;J<he;J++){let ue=[];for(let pe=0;pe<Y;pe++)ue.push(s(ie.get(J,pe),M,P));U.push(`${ue.join(" ")}`)}return Y!==xe&&(U[U.length-1]+=` ... ${xe-C} more columns`),he!==O&&U.push(`... ${O-k} more rows`),U.join(`
${a}`)}function s(ie,k,C){return(ie>=0&&C?` ${w(ie,k-1)}`:w(ie,k)).padEnd(k)}function w(ie,k){let C=ie.toString();if(C.length<=k)return C;let M=ie.toFixed(k);if(M.length>k&&(M=ie.toFixed(Math.max(0,k-(M.length-k)))),M.length<=k&&!M.startsWith("0.000")&&!M.startsWith("-0.000"))return M;let P=ie.toExponential(k);return P.length>k&&(P=ie.toExponential(Math.max(0,k-(P.length-k)))),P.slice(0)}function A(ie,k){ie.prototype.add=function(M){return typeof M=="number"?this.addS(M):this.addM(M)},ie.prototype.addS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)+M);return this},ie.prototype.addM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)+M.get(P,O));return this},ie.add=function(M,P){return new k(M).add(P)},ie.prototype.sub=function(M){return typeof M=="number"?this.subS(M):this.subM(M)},ie.prototype.subS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)-M);return this},ie.prototype.subM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)-M.get(P,O));return this},ie.sub=function(M,P){return new k(M).sub(P)},ie.prototype.subtract=ie.prototype.sub,ie.prototype.subtractS=ie.prototype.subS,ie.prototype.subtractM=ie.prototype.subM,ie.subtract=ie.sub,ie.prototype.mul=function(M){return typeof M=="number"?this.mulS(M):this.mulM(M)},ie.prototype.mulS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)*M);return this},ie.prototype.mulM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)*M.get(P,O));return this},ie.mul=function(M,P){return new k(M).mul(P)},ie.prototype.multiply=ie.prototype.mul,ie.prototype.multiplyS=ie.prototype.mulS,ie.prototype.multiplyM=ie.prototype.mulM,ie.multiply=ie.mul,ie.prototype.div=function(M){return typeof M=="number"?this.divS(M):this.divM(M)},ie.prototype.divS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)/M);return this},ie.prototype.divM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)/M.get(P,O));return this},ie.div=function(M,P){return new k(M).div(P)},ie.prototype.divide=ie.prototype.div,ie.prototype.divideS=ie.prototype.divS,ie.prototype.divideM=ie.prototype.divM,ie.divide=ie.div,ie.prototype.mod=function(M){return typeof M=="number"?this.modS(M):this.modM(M)},ie.prototype.modS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)%M);return this},ie.prototype.modM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)%M.get(P,O));return this},ie.mod=function(M,P){return new k(M).mod(P)},ie.prototype.modulus=ie.prototype.mod,ie.prototype.modulusS=ie.prototype.modS,ie.prototype.modulusM=ie.prototype.modM,ie.modulus=ie.mod,ie.prototype.and=function(M){return typeof M=="number"?this.andS(M):this.andM(M)},ie.prototype.andS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)&M);return this},ie.prototype.andM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)&M.get(P,O));return this},ie.and=function(M,P){return new k(M).and(P)},ie.prototype.or=function(M){return typeof M=="number"?this.orS(M):this.orM(M)},ie.prototype.orS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)|M);return this},ie.prototype.orM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)|M.get(P,O));return this},ie.or=function(M,P){return new k(M).or(P)},ie.prototype.xor=function(M){return typeof M=="number"?this.xorS(M):this.xorM(M)},ie.prototype.xorS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)^M);return this},ie.prototype.xorM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)^M.get(P,O));return this},ie.xor=function(M,P){return new k(M).xor(P)},ie.prototype.leftShift=function(M){return typeof M=="number"?this.leftShiftS(M):this.leftShiftM(M)},ie.prototype.leftShiftS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)<<M);return this},ie.prototype.leftShiftM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)<<M.get(P,O));return this},ie.leftShift=function(M,P){return new k(M).leftShift(P)},ie.prototype.signPropagatingRightShift=function(M){return typeof M=="number"?this.signPropagatingRightShiftS(M):this.signPropagatingRightShiftM(M)},ie.prototype.signPropagatingRightShiftS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)>>M);return this},ie.prototype.signPropagatingRightShiftM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)>>M.get(P,O));return this},ie.signPropagatingRightShift=function(M,P){return new k(M).signPropagatingRightShift(P)},ie.prototype.rightShift=function(M){return typeof M=="number"?this.rightShiftS(M):this.rightShiftM(M)},ie.prototype.rightShiftS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)>>>M);return this},ie.prototype.rightShiftM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)>>>M.get(P,O));return this},ie.rightShift=function(M,P){return new k(M).rightShift(P)},ie.prototype.zeroFillRightShift=ie.prototype.rightShift,ie.prototype.zeroFillRightShiftS=ie.prototype.rightShiftS,ie.prototype.zeroFillRightShiftM=ie.prototype.rightShiftM,ie.zeroFillRightShift=ie.rightShift,ie.prototype.not=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,~this.get(M,P));return this},ie.not=function(M){return new k(M).not()},ie.prototype.abs=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.abs(this.get(M,P)));return this},ie.abs=function(M){return new k(M).abs()},ie.prototype.acos=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.acos(this.get(M,P)));return this},ie.acos=function(M){return new k(M).acos()},ie.prototype.acosh=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.acosh(this.get(M,P)));return this},ie.acosh=function(M){return new k(M).acosh()},ie.prototype.asin=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.asin(this.get(M,P)));return this},ie.asin=function(M){return new k(M).asin()},ie.prototype.asinh=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.asinh(this.get(M,P)));return this},ie.asinh=function(M){return new k(M).asinh()},ie.prototype.atan=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.atan(this.get(M,P)));return this},ie.atan=function(M){return new k(M).atan()},ie.prototype.atanh=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.atanh(this.get(M,P)));return this},ie.atanh=function(M){return new k(M).atanh()},ie.prototype.cbrt=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.cbrt(this.get(M,P)));return this},ie.cbrt=function(M){return new k(M).cbrt()},ie.prototype.ceil=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.ceil(this.get(M,P)));return this},ie.ceil=function(M){return new k(M).ceil()},ie.prototype.clz32=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.clz32(this.get(M,P)));return this},ie.clz32=function(M){return new k(M).clz32()},ie.prototype.cos=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.cos(this.get(M,P)));return this},ie.cos=function(M){return new k(M).cos()},ie.prototype.cosh=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.cosh(this.get(M,P)));return this},ie.cosh=function(M){return new k(M).cosh()},ie.prototype.exp=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.exp(this.get(M,P)));return this},ie.exp=function(M){return new k(M).exp()},ie.prototype.expm1=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.expm1(this.get(M,P)));return this},ie.expm1=function(M){return new k(M).expm1()},ie.prototype.floor=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.floor(this.get(M,P)));return this},ie.floor=function(M){return new k(M).floor()},ie.prototype.fround=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.fround(this.get(M,P)));return this},ie.fround=function(M){return new k(M).fround()},ie.prototype.log=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.log(this.get(M,P)));return this},ie.log=function(M){return new k(M).log()},ie.prototype.log1p=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.log1p(this.get(M,P)));return this},ie.log1p=function(M){return new k(M).log1p()},ie.prototype.log10=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.log10(this.get(M,P)));return this},ie.log10=function(M){return new k(M).log10()},ie.prototype.log2=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.log2(this.get(M,P)));return this},ie.log2=function(M){return new k(M).log2()},ie.prototype.round=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.round(this.get(M,P)));return this},ie.round=function(M){return new k(M).round()},ie.prototype.sign=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.sign(this.get(M,P)));return this},ie.sign=function(M){return new k(M).sign()},ie.prototype.sin=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.sin(this.get(M,P)));return this},ie.sin=function(M){return new k(M).sin()},ie.prototype.sinh=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.sinh(this.get(M,P)));return this},ie.sinh=function(M){return new k(M).sinh()},ie.prototype.sqrt=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.sqrt(this.get(M,P)));return this},ie.sqrt=function(M){return new k(M).sqrt()},ie.prototype.tan=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.tan(this.get(M,P)));return this},ie.tan=function(M){return new k(M).tan()},ie.prototype.tanh=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.tanh(this.get(M,P)));return this},ie.tanh=function(M){return new k(M).tanh()},ie.prototype.trunc=function(){for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.set(M,P,Math.trunc(this.get(M,P)));return this},ie.trunc=function(M){return new k(M).trunc()},ie.pow=function(M,P){return new k(M).pow(P)},ie.prototype.pow=function(M){return typeof M=="number"?this.powS(M):this.powM(M)},ie.prototype.powS=function(M){for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)**M);return this},ie.prototype.powM=function(M){if(M=k.checkMatrix(M),this.rows!==M.rows||this.columns!==M.columns)throw new RangeError("Matrices dimensions must be equal");for(let P=0;P<this.rows;P++)for(let O=0;O<this.columns;O++)this.set(P,O,this.get(P,O)**M.get(P,O));return this}}function z(ie,k,C){let M=C?ie.rows:ie.rows-1;if(k<0||k>M)throw new RangeError("Row index out of range")}function B(ie,k,C){let M=C?ie.columns:ie.columns-1;if(k<0||k>M)throw new RangeError("Column index out of range")}function D(ie,k){if(k.to1DArray&&(k=k.to1DArray()),k.length!==ie.columns)throw new RangeError("vector size must be the same as the number of columns");return k}function V(ie,k){if(k.to1DArray&&(k=k.to1DArray()),k.length!==ie.rows)throw new RangeError("vector size must be the same as the number of rows");return k}function W(ie,k){if(!e.isAnyArray(k))throw new TypeError("row indices must be an array");for(let C=0;C<k.length;C++)if(k[C]<0||k[C]>=ie.rows)throw new RangeError("row indices are out of range")}function S(ie,k){if(!e.isAnyArray(k))throw new TypeError("column indices must be an array");for(let C=0;C<k.length;C++)if(k[C]<0||k[C]>=ie.columns)throw new RangeError("column indices are out of range")}function j(ie,k,C,M,P){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(te("startRow",k),te("endRow",C),te("startColumn",M),te("endColumn",P),k>C||M>P||k<0||k>=ie.rows||C<0||C>=ie.rows||M<0||M>=ie.columns||P<0||P>=ie.columns)throw new RangeError("Submatrix indices are out of range")}function ne(ie,k=0){let C=[];for(let M=0;M<ie;M++)C.push(k);return C}function te(ie,k){if(typeof k!="number")throw new TypeError(`${ie} must be a number`)}function Q(ie){if(ie.isEmpty())throw new Error("Empty matrix has no elements to index")}function N(ie){let k=ne(ie.rows);for(let C=0;C<ie.rows;++C)for(let M=0;M<ie.columns;++M)k[C]+=ie.get(C,M);return k}function re(ie){let k=ne(ie.columns);for(let C=0;C<ie.rows;++C)for(let M=0;M<ie.columns;++M)k[M]+=ie.get(C,M);return k}function oe(ie){let k=0;for(let C=0;C<ie.rows;C++)for(let M=0;M<ie.columns;M++)k+=ie.get(C,M);return k}function ve(ie){let k=ne(ie.rows,1);for(let C=0;C<ie.rows;++C)for(let M=0;M<ie.columns;++M)k[C]*=ie.get(C,M);return k}function Pe(ie){let k=ne(ie.columns,1);for(let C=0;C<ie.rows;++C)for(let M=0;M<ie.columns;++M)k[M]*=ie.get(C,M);return k}function $(ie){let k=1;for(let C=0;C<ie.rows;C++)for(let M=0;M<ie.columns;M++)k*=ie.get(C,M);return k}function le(ie,k,C){const M=ie.rows,P=ie.columns,O=[];for(let xe=0;xe<M;xe++){let he=0,Y=0,U=0;for(let J=0;J<P;J++)U=ie.get(xe,J)-C[xe],he+=U,Y+=U*U;k?O.push((Y-he*he/P)/(P-1)):O.push((Y-he*he/P)/P)}return O}function Me(ie,k,C){const M=ie.rows,P=ie.columns,O=[];for(let xe=0;xe<P;xe++){let he=0,Y=0,U=0;for(let J=0;J<M;J++)U=ie.get(J,xe)-C[xe],he+=U,Y+=U*U;k?O.push((Y-he*he/M)/(M-1)):O.push((Y-he*he/M)/M)}return O}function Ve(ie,k,C){const M=ie.rows,P=ie.columns,O=M*P;let xe=0,he=0,Y=0;for(let U=0;U<M;U++)for(let J=0;J<P;J++)Y=ie.get(U,J)-C,xe+=Y,he+=Y*Y;return k?(he-xe*xe/O)/(O-1):(he-xe*xe/O)/O}function Be(ie,k){for(let C=0;C<ie.rows;C++)for(let M=0;M<ie.columns;M++)ie.set(C,M,ie.get(C,M)-k[C])}function q(ie,k){for(let C=0;C<ie.rows;C++)for(let M=0;M<ie.columns;M++)ie.set(C,M,ie.get(C,M)-k[M])}function me(ie,k){for(let C=0;C<ie.rows;C++)for(let M=0;M<ie.columns;M++)ie.set(C,M,ie.get(C,M)-k)}function Ee(ie){const k=[];for(let C=0;C<ie.rows;C++){let M=0;for(let P=0;P<ie.columns;P++)M+=ie.get(C,P)**2/(ie.columns-1);k.push(Math.sqrt(M))}return k}function Ne(ie,k){for(let C=0;C<ie.rows;C++)for(let M=0;M<ie.columns;M++)ie.set(C,M,ie.get(C,M)/k[C])}function $e(ie){const k=[];for(let C=0;C<ie.columns;C++){let M=0;for(let P=0;P<ie.rows;P++)M+=ie.get(P,C)**2/(ie.rows-1);k.push(Math.sqrt(M))}return k}function ye(ie,k){for(let C=0;C<ie.rows;C++)for(let M=0;M<ie.columns;M++)ie.set(C,M,ie.get(C,M)/k[M])}function ge(ie){const k=ie.size-1;let C=0;for(let M=0;M<ie.columns;M++)for(let P=0;P<ie.rows;P++)C+=ie.get(P,M)**2/k;return Math.sqrt(C)}function Ye(ie,k){for(let C=0;C<ie.rows;C++)for(let M=0;M<ie.columns;M++)ie.set(C,M,ie.get(C,M)/k)}class We{static from1DArray(k,C,M){if(k*C!==M.length)throw new RangeError("data length does not match given dimensions");let O=new Ce(k,C);for(let xe=0;xe<k;xe++)for(let he=0;he<C;he++)O.set(xe,he,M[xe*C+he]);return O}static rowVector(k){let C=new Ce(1,k.length);for(let M=0;M<k.length;M++)C.set(0,M,k[M]);return C}static columnVector(k){let C=new Ce(k.length,1);for(let M=0;M<k.length;M++)C.set(M,0,k[M]);return C}static zeros(k,C){return new Ce(k,C)}static ones(k,C){return new Ce(k,C).fill(1)}static rand(k,C,M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{random:P=Math.random}=M;let O=new Ce(k,C);for(let xe=0;xe<k;xe++)for(let he=0;he<C;he++)O.set(xe,he,P());return O}static randInt(k,C,M={}){if(typeof M!="object")throw new TypeError("options must be an object");const{min:P=0,max:O=1e3,random:xe=Math.random}=M;if(!Number.isInteger(P))throw new TypeError("min must be an integer");if(!Number.isInteger(O))throw new TypeError("max must be an integer");if(P>=O)throw new RangeError("min must be smaller than max");let he=O-P,Y=new Ce(k,C);for(let U=0;U<k;U++)for(let J=0;J<C;J++){let ue=P+Math.round(xe()*he);Y.set(U,J,ue)}return Y}static eye(k,C,M){C===void 0&&(C=k),M===void 0&&(M=1);let P=Math.min(k,C),O=this.zeros(k,C);for(let xe=0;xe<P;xe++)O.set(xe,xe,M);return O}static diag(k,C,M){let P=k.length;C===void 0&&(C=P),M===void 0&&(M=C);let O=Math.min(P,C,M),xe=this.zeros(C,M);for(let he=0;he<O;he++)xe.set(he,he,k[he]);return xe}static min(k,C){k=this.checkMatrix(k),C=this.checkMatrix(C);let M=k.rows,P=k.columns,O=new Ce(M,P);for(let xe=0;xe<M;xe++)for(let he=0;he<P;he++)O.set(xe,he,Math.min(k.get(xe,he),C.get(xe,he)));return O}static max(k,C){k=this.checkMatrix(k),C=this.checkMatrix(C);let M=k.rows,P=k.columns,O=new this(M,P);for(let xe=0;xe<M;xe++)for(let he=0;he<P;he++)O.set(xe,he,Math.max(k.get(xe,he),C.get(xe,he)));return O}static checkMatrix(k){return We.isMatrix(k)?k:new Ce(k)}static isMatrix(k){return k!=null&&k.klass==="Matrix"}get size(){return this.rows*this.columns}apply(k){if(typeof k!="function")throw new TypeError("callback must be a function");for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)k.call(this,C,M);return this}to1DArray(){let k=[];for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)k.push(this.get(C,M));return k}to2DArray(){let k=[];for(let C=0;C<this.rows;C++){k.push([]);for(let M=0;M<this.columns;M++)k[C].push(this.get(C,M))}return k}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let k=0;k<this.rows;k++)for(let C=0;C<=k;C++)if(this.get(k,C)!==this.get(C,k))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let k=0;k<this.rows;k++)if(this.get(k,k)!==0)return!1;return!0}isEchelonForm(){let k=0,C=0,M=-1,P=!0,O=!1;for(;k<this.rows&&P;){for(C=0,O=!1;C<this.columns&&O===!1;)this.get(k,C)===0?C++:this.get(k,C)===1&&C>M?(O=!0,M=C):(P=!1,O=!0);k++}return P}isReducedEchelonForm(){let k=0,C=0,M=-1,P=!0,O=!1;for(;k<this.rows&&P;){for(C=0,O=!1;C<this.columns&&O===!1;)this.get(k,C)===0?C++:this.get(k,C)===1&&C>M?(O=!0,M=C):(P=!1,O=!0);for(let xe=C+1;xe<this.rows;xe++)this.get(k,xe)!==0&&(P=!1);k++}return P}echelonForm(){let k=this.clone(),C=0,M=0;for(;C<k.rows&&M<k.columns;){let P=C;for(let O=C;O<k.rows;O++)k.get(O,M)>k.get(P,M)&&(P=O);if(k.get(P,M)===0)M++;else{k.swapRows(C,P);let O=k.get(C,M);for(let xe=M;xe<k.columns;xe++)k.set(C,xe,k.get(C,xe)/O);for(let xe=C+1;xe<k.rows;xe++){let he=k.get(xe,M)/k.get(C,M);k.set(xe,M,0);for(let Y=M+1;Y<k.columns;Y++)k.set(xe,Y,k.get(xe,Y)-k.get(C,Y)*he)}C++,M++}}return k}reducedEchelonForm(){let k=this.echelonForm(),C=k.columns,M=k.rows,P=M-1;for(;P>=0;)if(k.maxRow(P)===0)P--;else{let O=0,xe=!1;for(;O<M&&xe===!1;)k.get(P,O)===1?xe=!0:O++;for(let he=0;he<P;he++){let Y=k.get(he,O);for(let U=O;U<C;U++){let J=k.get(he,U)-Y*k.get(P,U);k.set(he,U,J)}}P--}return k}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(k={}){if(typeof k!="object")throw new TypeError("options must be an object");const{rows:C=1,columns:M=1}=k;if(!Number.isInteger(C)||C<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(M)||M<=0)throw new TypeError("columns must be a positive integer");let P=new Ce(this.rows*C,this.columns*M);for(let O=0;O<C;O++)for(let xe=0;xe<M;xe++)P.setSubMatrix(this,this.rows*O,this.columns*xe);return P}fill(k){for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,k);return this}neg(){return this.mulS(-1)}getRow(k){z(this,k);let C=[];for(let M=0;M<this.columns;M++)C.push(this.get(k,M));return C}getRowVector(k){return Ce.rowVector(this.getRow(k))}setRow(k,C){z(this,k),C=D(this,C);for(let M=0;M<this.columns;M++)this.set(k,M,C[M]);return this}swapRows(k,C){z(this,k),z(this,C);for(let M=0;M<this.columns;M++){let P=this.get(k,M);this.set(k,M,this.get(C,M)),this.set(C,M,P)}return this}getColumn(k){B(this,k);let C=[];for(let M=0;M<this.rows;M++)C.push(this.get(M,k));return C}getColumnVector(k){return Ce.columnVector(this.getColumn(k))}setColumn(k,C){B(this,k),C=V(this,C);for(let M=0;M<this.rows;M++)this.set(M,k,C[M]);return this}swapColumns(k,C){B(this,k),B(this,C);for(let M=0;M<this.rows;M++){let P=this.get(M,k);this.set(M,k,this.get(M,C)),this.set(M,C,P)}return this}addRowVector(k){k=D(this,k);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,this.get(C,M)+k[M]);return this}subRowVector(k){k=D(this,k);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,this.get(C,M)-k[M]);return this}mulRowVector(k){k=D(this,k);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,this.get(C,M)*k[M]);return this}divRowVector(k){k=D(this,k);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,this.get(C,M)/k[M]);return this}addColumnVector(k){k=V(this,k);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,this.get(C,M)+k[C]);return this}subColumnVector(k){k=V(this,k);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,this.get(C,M)-k[C]);return this}mulColumnVector(k){k=V(this,k);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,this.get(C,M)*k[C]);return this}divColumnVector(k){k=V(this,k);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)this.set(C,M,this.get(C,M)/k[C]);return this}mulRow(k,C){z(this,k);for(let M=0;M<this.columns;M++)this.set(k,M,this.get(k,M)*C);return this}mulColumn(k,C){B(this,k);for(let M=0;M<this.rows;M++)this.set(M,k,this.get(M,k)*C);return this}max(k){if(this.isEmpty())return NaN;switch(k){case"row":{const C=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.get(M,P)>C[M]&&(C[M]=this.get(M,P));return C}case"column":{const C=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.get(M,P)>C[P]&&(C[P]=this.get(M,P));return C}case void 0:{let C=this.get(0,0);for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.get(M,P)>C&&(C=this.get(M,P));return C}default:throw new Error(`invalid option: ${k}`)}}maxIndex(){Q(this);let k=this.get(0,0),C=[0,0];for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.get(M,P)>k&&(k=this.get(M,P),C[0]=M,C[1]=P);return C}min(k){if(this.isEmpty())return NaN;switch(k){case"row":{const C=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.get(M,P)<C[M]&&(C[M]=this.get(M,P));return C}case"column":{const C=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.get(M,P)<C[P]&&(C[P]=this.get(M,P));return C}case void 0:{let C=this.get(0,0);for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.get(M,P)<C&&(C=this.get(M,P));return C}default:throw new Error(`invalid option: ${k}`)}}minIndex(){Q(this);let k=this.get(0,0),C=[0,0];for(let M=0;M<this.rows;M++)for(let P=0;P<this.columns;P++)this.get(M,P)<k&&(k=this.get(M,P),C[0]=M,C[1]=P);return C}maxRow(k){if(z(this,k),this.isEmpty())return NaN;let C=this.get(k,0);for(let M=1;M<this.columns;M++)this.get(k,M)>C&&(C=this.get(k,M));return C}maxRowIndex(k){z(this,k),Q(this);let C=this.get(k,0),M=[k,0];for(let P=1;P<this.columns;P++)this.get(k,P)>C&&(C=this.get(k,P),M[1]=P);return M}minRow(k){if(z(this,k),this.isEmpty())return NaN;let C=this.get(k,0);for(let M=1;M<this.columns;M++)this.get(k,M)<C&&(C=this.get(k,M));return C}minRowIndex(k){z(this,k),Q(this);let C=this.get(k,0),M=[k,0];for(let P=1;P<this.columns;P++)this.get(k,P)<C&&(C=this.get(k,P),M[1]=P);return M}maxColumn(k){if(B(this,k),this.isEmpty())return NaN;let C=this.get(0,k);for(let M=1;M<this.rows;M++)this.get(M,k)>C&&(C=this.get(M,k));return C}maxColumnIndex(k){B(this,k),Q(this);let C=this.get(0,k),M=[0,k];for(let P=1;P<this.rows;P++)this.get(P,k)>C&&(C=this.get(P,k),M[0]=P);return M}minColumn(k){if(B(this,k),this.isEmpty())return NaN;let C=this.get(0,k);for(let M=1;M<this.rows;M++)this.get(M,k)<C&&(C=this.get(M,k));return C}minColumnIndex(k){B(this,k),Q(this);let C=this.get(0,k),M=[0,k];for(let P=1;P<this.rows;P++)this.get(P,k)<C&&(C=this.get(P,k),M[0]=P);return M}diag(){let k=Math.min(this.rows,this.columns),C=[];for(let M=0;M<k;M++)C.push(this.get(M,M));return C}norm(k="frobenius"){switch(k){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${k}`)}}cumulativeSum(){let k=0;for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)k+=this.get(C,M),this.set(C,M,k);return this}dot(k){We.isMatrix(k)&&(k=k.to1DArray());let C=this.to1DArray();if(C.length!==k.length)throw new RangeError("vectors do not have the same size");let M=0;for(let P=0;P<C.length;P++)M+=C[P]*k[P];return M}mmul(k){k=Ce.checkMatrix(k);let C=this.rows,M=this.columns,P=k.columns,O=new Ce(C,P),xe=new Float64Array(M);for(let he=0;he<P;he++){for(let Y=0;Y<M;Y++)xe[Y]=k.get(Y,he);for(let Y=0;Y<C;Y++){let U=0;for(let J=0;J<M;J++)U+=this.get(Y,J)*xe[J];O.set(Y,he,U)}}return O}mpow(k){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(k)||k<0)throw new RangeError("Exponent must be a non-negative integer");let C=Ce.eye(this.rows),M=this;for(let P=k;P>=1;P/=2)(P&1)!==0&&(C=C.mmul(M)),M=M.mmul(M);return C}strassen2x2(k){k=Ce.checkMatrix(k);let C=new Ce(2,2);const M=this.get(0,0),P=k.get(0,0),O=this.get(0,1),xe=k.get(0,1),he=this.get(1,0),Y=k.get(1,0),U=this.get(1,1),J=k.get(1,1),ue=(M+U)*(P+J),pe=(he+U)*P,Ze=M*(xe-J),ke=U*(Y-P),rt=(M+O)*J,bt=(he-M)*(P+xe),ze=(O-U)*(Y+J),gt=ue+ke-rt+ze,Ut=Ze+rt,$t=pe+ke,Mr=ue-pe+Ze+bt;return C.set(0,0,gt),C.set(0,1,Ut),C.set(1,0,$t),C.set(1,1,Mr),C}strassen3x3(k){k=Ce.checkMatrix(k);let C=new Ce(3,3);const M=this.get(0,0),P=this.get(0,1),O=this.get(0,2),xe=this.get(1,0),he=this.get(1,1),Y=this.get(1,2),U=this.get(2,0),J=this.get(2,1),ue=this.get(2,2),pe=k.get(0,0),Ze=k.get(0,1),ke=k.get(0,2),rt=k.get(1,0),bt=k.get(1,1),ze=k.get(1,2),gt=k.get(2,0),Ut=k.get(2,1),$t=k.get(2,2),Mr=(M+P+O-xe-he-J-ue)*bt,Wr=(M-xe)*(-Ze+bt),gr=he*(-pe+Ze+rt-bt-ze-gt+$t),lr=(-M+xe+he)*(pe-Ze+bt),Xr=(xe+he)*(-pe+Ze),ft=M*pe,Bt=(-M+U+J)*(pe-ke+ze),mr=(-M+U)*(ke-ze),Wt=(U+J)*(-pe+ke),vi=(M+P+O-he-Y-U-J)*ze,Gr=J*(-pe+ke+rt-bt-ze-gt+Ut),mi=(-O+J+ue)*(bt+gt-Ut),gi=(O-ue)*(bt-Ut),Gi=O*gt,Ln=(J+ue)*(-gt+Ut),Ei=(-O+he+Y)*(ze+gt-$t),on=(O-Y)*(ze-$t),zn=(he+Y)*(-gt+$t),ti=P*rt,ln=Y*Ut,pn=xe*ke,Vi=U*Ze,di=ue*$t,fa=ft+Gi+ti,Kn=Mr+lr+Xr+ft+mi+Gi+Ln,ac=ft+Bt+Wt+vi+Gi+Ei+zn,oc=Wr+gr+lr+ft+Gi+Ei+on,ld=Wr+lr+Xr+ft+ln,Ka=Gi+Ei+on+zn+pn,Ro=ft+Bt+mr+Gr+mi+gi+Gi,Ms=mi+gi+Gi+Ln+Vi,ei=ft+Bt+mr+Wt+di;return C.set(0,0,fa),C.set(0,1,Kn),C.set(0,2,ac),C.set(1,0,oc),C.set(1,1,ld),C.set(1,2,Ka),C.set(2,0,Ro),C.set(2,1,Ms),C.set(2,2,ei),C}mmulStrassen(k){k=Ce.checkMatrix(k);let C=this.clone(),M=C.rows,P=C.columns,O=k.rows,xe=k.columns;P!==O&&console.warn(`Multiplying ${M} x ${P} and ${O} x ${xe} matrix: dimensions do not match.`);function he(ue,pe,Ze){let ke=ue.rows,rt=ue.columns;if(ke===pe&&rt===Ze)return ue;{let bt=We.zeros(pe,Ze);return bt=bt.setSubMatrix(ue,0,0),bt}}let Y=Math.max(M,O),U=Math.max(P,xe);C=he(C,Y,U),k=he(k,Y,U);function J(ue,pe,Ze,ke){if(Ze<=512||ke<=512)return ue.mmul(pe);Ze%2===1&&ke%2===1?(ue=he(ue,Ze+1,ke+1),pe=he(pe,Ze+1,ke+1)):Ze%2===1?(ue=he(ue,Ze+1,ke),pe=he(pe,Ze+1,ke)):ke%2===1&&(ue=he(ue,Ze,ke+1),pe=he(pe,Ze,ke+1));let rt=parseInt(ue.rows/2,10),bt=parseInt(ue.columns/2,10),ze=ue.subMatrix(0,rt-1,0,bt-1),gt=pe.subMatrix(0,rt-1,0,bt-1),Ut=ue.subMatrix(0,rt-1,bt,ue.columns-1),$t=pe.subMatrix(0,rt-1,bt,pe.columns-1),Mr=ue.subMatrix(rt,ue.rows-1,0,bt-1),Wr=pe.subMatrix(rt,pe.rows-1,0,bt-1),gr=ue.subMatrix(rt,ue.rows-1,bt,ue.columns-1),lr=pe.subMatrix(rt,pe.rows-1,bt,pe.columns-1),Xr=J(We.add(ze,gr),We.add(gt,lr),rt,bt),ft=J(We.add(Mr,gr),gt,rt,bt),Bt=J(ze,We.sub($t,lr),rt,bt),mr=J(gr,We.sub(Wr,gt),rt,bt),Wt=J(We.add(ze,Ut),lr,rt,bt),vi=J(We.sub(Mr,ze),We.add(gt,$t),rt,bt),Gr=J(We.sub(Ut,gr),We.add(Wr,lr),rt,bt),mi=We.add(Xr,mr);mi.sub(Wt),mi.add(Gr);let gi=We.add(Bt,Wt),Gi=We.add(ft,mr),Ln=We.sub(Xr,ft);Ln.add(Bt),Ln.add(vi);let Ei=We.zeros(2*mi.rows,2*mi.columns);return Ei=Ei.setSubMatrix(mi,0,0),Ei=Ei.setSubMatrix(gi,mi.rows,0),Ei=Ei.setSubMatrix(Gi,0,mi.columns),Ei=Ei.setSubMatrix(Ln,mi.rows,mi.columns),Ei.subMatrix(0,Ze-1,0,ke-1)}return J(C,k,Y,U)}scaleRows(k={}){if(typeof k!="object")throw new TypeError("options must be an object");const{min:C=0,max:M=1}=k;if(!Number.isFinite(C))throw new TypeError("min must be a number");if(!Number.isFinite(M))throw new TypeError("max must be a number");if(C>=M)throw new RangeError("min must be smaller than max");let P=new Ce(this.rows,this.columns);for(let O=0;O<this.rows;O++){const xe=this.getRow(O);xe.length>0&&t(xe,{min:C,max:M,output:xe}),P.setRow(O,xe)}return P}scaleColumns(k={}){if(typeof k!="object")throw new TypeError("options must be an object");const{min:C=0,max:M=1}=k;if(!Number.isFinite(C))throw new TypeError("min must be a number");if(!Number.isFinite(M))throw new TypeError("max must be a number");if(C>=M)throw new RangeError("min must be smaller than max");let P=new Ce(this.rows,this.columns);for(let O=0;O<this.columns;O++){const xe=this.getColumn(O);xe.length&&t(xe,{min:C,max:M,output:xe}),P.setColumn(O,xe)}return P}flipRows(){const k=Math.ceil(this.columns/2);for(let C=0;C<this.rows;C++)for(let M=0;M<k;M++){let P=this.get(C,M),O=this.get(C,this.columns-1-M);this.set(C,M,O),this.set(C,this.columns-1-M,P)}return this}flipColumns(){const k=Math.ceil(this.rows/2);for(let C=0;C<this.columns;C++)for(let M=0;M<k;M++){let P=this.get(M,C),O=this.get(this.rows-1-M,C);this.set(M,C,O),this.set(this.rows-1-M,C,P)}return this}kroneckerProduct(k){k=Ce.checkMatrix(k);let C=this.rows,M=this.columns,P=k.rows,O=k.columns,xe=new Ce(C*P,M*O);for(let he=0;he<C;he++)for(let Y=0;Y<M;Y++)for(let U=0;U<P;U++)for(let J=0;J<O;J++)xe.set(P*he+U,O*Y+J,this.get(he,Y)*k.get(U,J));return xe}kroneckerSum(k){if(k=Ce.checkMatrix(k),!this.isSquare()||!k.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let C=this.rows,M=k.rows,P=this.kroneckerProduct(Ce.eye(M,M)),O=Ce.eye(C,C).kroneckerProduct(k);return P.add(O)}transpose(){let k=new Ce(this.columns,this.rows);for(let C=0;C<this.rows;C++)for(let M=0;M<this.columns;M++)k.set(M,C,this.get(C,M));return k}sortRows(k=ot){for(let C=0;C<this.rows;C++)this.setRow(C,this.getRow(C).sort(k));return this}sortColumns(k=ot){for(let C=0;C<this.columns;C++)this.setColumn(C,this.getColumn(C).sort(k));return this}subMatrix(k,C,M,P){j(this,k,C,M,P);let O=new Ce(C-k+1,P-M+1);for(let xe=k;xe<=C;xe++)for(let he=M;he<=P;he++)O.set(xe-k,he-M,this.get(xe,he));return O}subMatrixRow(k,C,M){if(C===void 0&&(C=0),M===void 0&&(M=this.columns-1),C>M||C<0||C>=this.columns||M<0||M>=this.columns)throw new RangeError("Argument out of range");let P=new Ce(k.length,M-C+1);for(let O=0;O<k.length;O++)for(let xe=C;xe<=M;xe++){if(k[O]<0||k[O]>=this.rows)throw new RangeError(`Row index out of range: ${k[O]}`);P.set(O,xe-C,this.get(k[O],xe))}return P}subMatrixColumn(k,C,M){if(C===void 0&&(C=0),M===void 0&&(M=this.rows-1),C>M||C<0||C>=this.rows||M<0||M>=this.rows)throw new RangeError("Argument out of range");let P=new Ce(M-C+1,k.length);for(let O=0;O<k.length;O++)for(let xe=C;xe<=M;xe++){if(k[O]<0||k[O]>=this.columns)throw new RangeError(`Column index out of range: ${k[O]}`);P.set(xe-C,O,this.get(xe,k[O]))}return P}setSubMatrix(k,C,M){if(k=Ce.checkMatrix(k),k.isEmpty())return this;let P=C+k.rows-1,O=M+k.columns-1;j(this,C,P,M,O);for(let xe=0;xe<k.rows;xe++)for(let he=0;he<k.columns;he++)this.set(C+xe,M+he,k.get(xe,he));return this}selection(k,C){W(this,k),S(this,C);let M=new Ce(k.length,C.length);for(let P=0;P<k.length;P++){let O=k[P];for(let xe=0;xe<C.length;xe++){let he=C[xe];M.set(P,xe,this.get(O,he))}}return M}trace(){let k=Math.min(this.rows,this.columns),C=0;for(let M=0;M<k;M++)C+=this.get(M,M);return C}clone(){return this.constructor.copy(this,new Ce(this.rows,this.columns))}static copy(k,C){for(const[M,P,O]of k.entries())C.set(M,P,O);return C}sum(k){switch(k){case"row":return N(this);case"column":return re(this);case void 0:return oe(this);default:throw new Error(`invalid option: ${k}`)}}product(k){switch(k){case"row":return ve(this);case"column":return Pe(this);case void 0:return $(this);default:throw new Error(`invalid option: ${k}`)}}mean(k){const C=this.sum(k);switch(k){case"row":{for(let M=0;M<this.rows;M++)C[M]/=this.columns;return C}case"column":{for(let M=0;M<this.columns;M++)C[M]/=this.rows;return C}case void 0:return C/this.size;default:throw new Error(`invalid option: ${k}`)}}variance(k,C={}){if(typeof k=="object"&&(C=k,k=void 0),typeof C!="object")throw new TypeError("options must be an object");const{unbiased:M=!0,mean:P=this.mean(k)}=C;if(typeof M!="boolean")throw new TypeError("unbiased must be a boolean");switch(k){case"row":{if(!e.isAnyArray(P))throw new TypeError("mean must be an array");return le(this,M,P)}case"column":{if(!e.isAnyArray(P))throw new TypeError("mean must be an array");return Me(this,M,P)}case void 0:{if(typeof P!="number")throw new TypeError("mean must be a number");return Ve(this,M,P)}default:throw new Error(`invalid option: ${k}`)}}standardDeviation(k,C){typeof k=="object"&&(C=k,k=void 0);const M=this.variance(k,C);if(k===void 0)return Math.sqrt(M);for(let P=0;P<M.length;P++)M[P]=Math.sqrt(M[P]);return M}center(k,C={}){if(typeof k=="object"&&(C=k,k=void 0),typeof C!="object")throw new TypeError("options must be an object");const{center:M=this.mean(k)}=C;switch(k){case"row":{if(!e.isAnyArray(M))throw new TypeError("center must be an array");return Be(this,M),this}case"column":{if(!e.isAnyArray(M))throw new TypeError("center must be an array");return q(this,M),this}case void 0:{if(typeof M!="number")throw new TypeError("center must be a number");return me(this,M),this}default:throw new Error(`invalid option: ${k}`)}}scale(k,C={}){if(typeof k=="object"&&(C=k,k=void 0),typeof C!="object")throw new TypeError("options must be an object");let M=C.scale;switch(k){case"row":{if(M===void 0)M=Ee(this);else if(!e.isAnyArray(M))throw new TypeError("scale must be an array");return Ne(this,M),this}case"column":{if(M===void 0)M=$e(this);else if(!e.isAnyArray(M))throw new TypeError("scale must be an array");return ye(this,M),this}case void 0:{if(M===void 0)M=ge(this);else if(typeof M!="number")throw new TypeError("scale must be a number");return Ye(this,M),this}default:throw new Error(`invalid option: ${k}`)}}toString(k){return d(this,k)}[Symbol.iterator](){return this.entries()}*entries(){for(let k=0;k<this.rows;k++)for(let C=0;C<this.columns;C++)yield[k,C,this.get(k,C)]}*values(){for(let k=0;k<this.rows;k++)for(let C=0;C<this.columns;C++)yield this.get(k,C)}}We.prototype.klass="Matrix",typeof Symbol<"u"&&(We.prototype[Symbol.for("nodejs.util.inspect.custom")]=h);function ot(ie,k){return ie-k}function Se(ie){return ie.every(k=>typeof k=="number")}We.random=We.rand,We.randomInt=We.randInt,We.diagonal=We.diag,We.prototype.diagonal=We.prototype.diag,We.identity=We.eye,We.prototype.negate=We.prototype.neg,We.prototype.tensorProduct=We.prototype.kroneckerProduct;const Ct=class Ct extends We{constructor(C,M){super();ii(this,st);Ke(this,"data");if(Ct.isMatrix(C))Os(this,st,Zv).call(this,C.rows,C.columns),Ct.copy(C,this);else if(Number.isInteger(C)&&C>=0)Os(this,st,Zv).call(this,C,M);else if(e.isAnyArray(C)){const P=C;if(C=P.length,M=C?P[0].length:0,typeof M!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let O=0;O<C;O++){if(P[O].length!==M)throw new RangeError("Inconsistent array dimensions");if(!Se(P[O]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(P[O]))}this.rows=C,this.columns=M}else throw new TypeError("First argument must be a positive number or an array")}set(C,M,P){return this.data[C][M]=P,this}get(C,M){return this.data[C][M]}removeRow(C){return z(this,C),this.data.splice(C,1),this.rows-=1,this}addRow(C,M){return M===void 0&&(M=C,C=this.rows),z(this,C,!0),M=Float64Array.from(D(this,M)),this.data.splice(C,0,M),this.rows+=1,this}removeColumn(C){B(this,C);for(let M=0;M<this.rows;M++){const P=new Float64Array(this.columns-1);for(let O=0;O<C;O++)P[O]=this.data[M][O];for(let O=C+1;O<this.columns;O++)P[O-1]=this.data[M][O];this.data[M]=P}return this.columns-=1,this}addColumn(C,M){typeof M>"u"&&(M=C,C=this.columns),B(this,C,!0),M=V(this,M);for(let P=0;P<this.rows;P++){const O=new Float64Array(this.columns+1);let xe=0;for(;xe<C;xe++)O[xe]=this.data[P][xe];for(O[xe++]=M[P];xe<this.columns+1;xe++)O[xe]=this.data[P][xe-1];this.data[P]=O}return this.columns+=1,this}};st=new WeakSet,Zv=function(C,M){if(this.data=[],Number.isInteger(M)&&M>=0)for(let P=0;P<C;P++)this.data.push(new Float64Array(M));else throw new TypeError("nColumns must be a positive integer");this.rows=C,this.columns=M};let Ce=Ct;A(We,Ce);const jt=class jt extends We{constructor(C){super();ii(this,wt);if(Ce.isMatrix(C)){if(!C.isSymmetric())throw new TypeError("not symmetric data");Zi(this,wt,Ce.copy(C,new Ce(C.rows,C.rows)))}else if(Number.isInteger(C)&&C>=0)Zi(this,wt,new Ce(C,C));else if(Zi(this,wt,new Ce(C)),!this.isSymmetric())throw new TypeError("not symmetric data")}get size(){return Kt(this,wt).size}get rows(){return Kt(this,wt).rows}get columns(){return Kt(this,wt).columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(C){return Ce.isMatrix(C)&&C.klassType==="SymmetricMatrix"}static zeros(C){return new this(C)}static ones(C){return new this(C).fill(1)}clone(){const C=new jt(this.diagonalSize);for(const[M,P,O]of this.upperRightEntries())C.set(M,P,O);return C}toMatrix(){return new Ce(this)}get(C,M){return Kt(this,wt).get(C,M)}set(C,M,P){return Kt(this,wt).set(C,M,P),Kt(this,wt).set(M,C,P),this}removeCross(C){return Kt(this,wt).removeRow(C),Kt(this,wt).removeColumn(C),this}addCross(C,M){M===void 0&&(M=C,C=this.diagonalSize);const P=M.slice();return P.splice(C,1),Kt(this,wt).addRow(C,P),Kt(this,wt).addColumn(C,M),this}applyMask(C){if(C.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const M=[];for(const[P,O]of C.entries())O||M.push(P);M.reverse();for(const P of M)this.removeCross(P);return this}toCompact(){const{diagonalSize:C}=this,M=new Array(C*(C+1)/2);for(let P=0,O=0,xe=0;xe<M.length;xe++)M[xe]=this.get(O,P),++P>=C&&(P=++O);return M}static fromCompact(C){const M=C.length,P=(Math.sqrt(8*M+1)-1)/2;if(!Number.isInteger(P))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(C)}`);const O=new jt(P);for(let xe=0,he=0,Y=0;Y<M;Y++)O.set(xe,he,C[Y]),++xe>=P&&(xe=++he);return O}*upperRightEntries(){for(let C=0,M=0;C<this.diagonalSize;void 0){const P=this.get(C,M);yield[C,M,P],++M>=this.diagonalSize&&(M=++C)}}*upperRightValues(){for(let C=0,M=0;C<this.diagonalSize;void 0)yield this.get(C,M),++M>=this.diagonalSize&&(M=++C)}};wt=new WeakMap;let It=jt;It.prototype.klassType="SymmetricMatrix";class Lt extends It{static isDistanceMatrix(k){return It.isSymmetricMatrix(k)&&k.klassSubType==="DistanceMatrix"}constructor(k){if(super(k),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(k,C,M){return k===C&&(M=0),super.set(k,C,M)}addCross(k,C){return C===void 0&&(C=k,k=this.diagonalSize),C=C.slice(),C[k]=0,super.addCross(k,C)}toSymmetricMatrix(){return new It(this)}clone(){const k=new Lt(this.diagonalSize);for(const[C,M,P]of this.upperRightEntries())C!==M&&k.set(C,M,P);return k}toCompact(){const{diagonalSize:k}=this,C=(k-1)*k/2,M=new Array(C);for(let P=1,O=0,xe=0;xe<M.length;xe++)M[xe]=this.get(O,P),++P>=k&&(P=++O+1);return M}static fromCompact(k){const C=k.length;if(C===0)return new this(0);const M=(Math.sqrt(8*C+1)+1)/2;if(!Number.isInteger(M))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(k)}`);const P=new this(M);for(let O=1,xe=0,he=0;he<C;he++)P.set(O,xe,k[he]),++O>=M&&(O=++xe+1);return P}}Lt.prototype.klassSubType="DistanceMatrix";class Xt extends We{constructor(k,C,M){super(),this.matrix=k,this.rows=C,this.columns=M}}class Jt extends Xt{constructor(k,C){B(k,C),super(k,k.rows,1),this.column=C}set(k,C,M){return this.matrix.set(k,this.column,M),this}get(k){return this.matrix.get(k,this.column)}}class dr extends Xt{constructor(k,C){S(k,C),super(k,k.rows,C.length),this.columnIndices=C}set(k,C,M){return this.matrix.set(k,this.columnIndices[C],M),this}get(k,C){return this.matrix.get(k,this.columnIndices[C])}}class zt extends Xt{constructor(k){super(k,k.rows,k.columns)}set(k,C,M){return this.matrix.set(k,this.columns-C-1,M),this}get(k,C){return this.matrix.get(k,this.columns-C-1)}}class Zt extends Xt{constructor(k){super(k,k.rows,k.columns)}set(k,C,M){return this.matrix.set(this.rows-k-1,C,M),this}get(k,C){return this.matrix.get(this.rows-k-1,C)}}class Ot extends Xt{constructor(k,C){z(k,C),super(k,1,k.columns),this.row=C}set(k,C,M){return this.matrix.set(this.row,C,M),this}get(k,C){return this.matrix.get(this.row,C)}}class Yt extends Xt{constructor(k,C){W(k,C),super(k,C.length,k.columns),this.rowIndices=C}set(k,C,M){return this.matrix.set(this.rowIndices[k],C,M),this}get(k,C){return this.matrix.get(this.rowIndices[k],C)}}class Ar extends Xt{constructor(k,C,M){W(k,C),S(k,M),super(k,C.length,M.length),this.rowIndices=C,this.columnIndices=M}set(k,C,M){return this.matrix.set(this.rowIndices[k],this.columnIndices[C],M),this}get(k,C){return this.matrix.get(this.rowIndices[k],this.columnIndices[C])}}class yr extends Xt{constructor(k,C,M,P,O){j(k,C,M,P,O),super(k,M-C+1,O-P+1),this.startRow=C,this.startColumn=P}set(k,C,M){return this.matrix.set(this.startRow+k,this.startColumn+C,M),this}get(k,C){return this.matrix.get(this.startRow+k,this.startColumn+C)}}class kr extends Xt{constructor(k){super(k,k.columns,k.rows)}set(k,C,M){return this.matrix.set(C,k,M),this}get(k,C){return this.matrix.get(C,k)}}class Tr extends We{constructor(k,C={}){const{rows:M=1}=C;if(k.length%M!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=M,this.columns=k.length/M,this.data=k}set(k,C,M){let P=this._calculateIndex(k,C);return this.data[P]=M,this}get(k,C){let M=this._calculateIndex(k,C);return this.data[M]}_calculateIndex(k,C){return k*this.columns+C}}class Dr extends We{constructor(k){super(),this.data=k,this.rows=k.length,this.columns=k[0].length}set(k,C,M){return this.data[k][C]=M,this}get(k,C){return this.data[k][C]}}function hi(ie,k){if(e.isAnyArray(ie))return ie[0]&&e.isAnyArray(ie[0])?new Dr(ie):new Tr(ie,k);throw new Error("the argument is not an array")}class ni{constructor(k){k=Dr.checkMatrix(k);let C=k.clone(),M=C.rows,P=C.columns,O=new Float64Array(M),xe=1,he,Y,U,J,ue,pe,Ze,ke,rt;for(he=0;he<M;he++)O[he]=he;for(ke=new Float64Array(M),Y=0;Y<P;Y++){for(he=0;he<M;he++)ke[he]=C.get(he,Y);for(he=0;he<M;he++){for(rt=Math.min(he,Y),ue=0,U=0;U<rt;U++)ue+=C.get(he,U)*ke[U];ke[he]-=ue,C.set(he,Y,ke[he])}for(J=Y,he=Y+1;he<M;he++)Math.abs(ke[he])>Math.abs(ke[J])&&(J=he);if(J!==Y){for(U=0;U<P;U++)pe=C.get(J,U),C.set(J,U,C.get(Y,U)),C.set(Y,U,pe);Ze=O[J],O[J]=O[Y],O[Y]=Ze,xe=-xe}if(Y<M&&C.get(Y,Y)!==0)for(he=Y+1;he<M;he++)C.set(he,Y,C.get(he,Y)/C.get(Y,Y))}this.LU=C,this.pivotVector=O,this.pivotSign=xe}isSingular(){let k=this.LU,C=k.columns;for(let M=0;M<C;M++)if(k.get(M,M)===0)return!0;return!1}solve(k){k=Ce.checkMatrix(k);let C=this.LU;if(C.rows!==k.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let P=k.columns,O=k.subMatrixRow(this.pivotVector,0,P-1),xe=C.columns,he,Y,U;for(U=0;U<xe;U++)for(he=U+1;he<xe;he++)for(Y=0;Y<P;Y++)O.set(he,Y,O.get(he,Y)-O.get(U,Y)*C.get(he,U));for(U=xe-1;U>=0;U--){for(Y=0;Y<P;Y++)O.set(U,Y,O.get(U,Y)/C.get(U,U));for(he=0;he<U;he++)for(Y=0;Y<P;Y++)O.set(he,Y,O.get(he,Y)-O.get(U,Y)*C.get(he,U))}return O}get determinant(){let k=this.LU;if(!k.isSquare())throw new Error("Matrix must be square");let C=this.pivotSign,M=k.columns;for(let P=0;P<M;P++)C*=k.get(P,P);return C}get lowerTriangularMatrix(){let k=this.LU,C=k.rows,M=k.columns,P=new Ce(C,M);for(let O=0;O<C;O++)for(let xe=0;xe<M;xe++)O>xe?P.set(O,xe,k.get(O,xe)):O===xe?P.set(O,xe,1):P.set(O,xe,0);return P}get upperTriangularMatrix(){let k=this.LU,C=k.rows,M=k.columns,P=new Ce(C,M);for(let O=0;O<C;O++)for(let xe=0;xe<M;xe++)O<=xe?P.set(O,xe,k.get(O,xe)):P.set(O,xe,0);return P}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function ui(ie,k){let C=0;return Math.abs(ie)>Math.abs(k)?(C=k/ie,Math.abs(ie)*Math.sqrt(1+C*C)):k!==0?(C=ie/k,Math.abs(k)*Math.sqrt(1+C*C)):0}class dn{constructor(k){k=Dr.checkMatrix(k);let C=k.clone(),M=k.rows,P=k.columns,O=new Float64Array(P),xe,he,Y,U;for(Y=0;Y<P;Y++){let J=0;for(xe=Y;xe<M;xe++)J=ui(J,C.get(xe,Y));if(J!==0){for(C.get(Y,Y)<0&&(J=-J),xe=Y;xe<M;xe++)C.set(xe,Y,C.get(xe,Y)/J);for(C.set(Y,Y,C.get(Y,Y)+1),he=Y+1;he<P;he++){for(U=0,xe=Y;xe<M;xe++)U+=C.get(xe,Y)*C.get(xe,he);for(U=-U/C.get(Y,Y),xe=Y;xe<M;xe++)C.set(xe,he,C.get(xe,he)+U*C.get(xe,Y))}}O[Y]=-J}this.QR=C,this.Rdiag=O}solve(k){k=Ce.checkMatrix(k);let C=this.QR,M=C.rows;if(k.rows!==M)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let P=k.columns,O=k.clone(),xe=C.columns,he,Y,U,J;for(U=0;U<xe;U++)for(Y=0;Y<P;Y++){for(J=0,he=U;he<M;he++)J+=C.get(he,U)*O.get(he,Y);for(J=-J/C.get(U,U),he=U;he<M;he++)O.set(he,Y,O.get(he,Y)+J*C.get(he,U))}for(U=xe-1;U>=0;U--){for(Y=0;Y<P;Y++)O.set(U,Y,O.get(U,Y)/this.Rdiag[U]);for(he=0;he<U;he++)for(Y=0;Y<P;Y++)O.set(he,Y,O.get(he,Y)-O.get(U,Y)*C.get(he,U))}return O.subMatrix(0,xe-1,0,P-1)}isFullRank(){let k=this.QR.columns;for(let C=0;C<k;C++)if(this.Rdiag[C]===0)return!1;return!0}get upperTriangularMatrix(){let k=this.QR,C=k.columns,M=new Ce(C,C),P,O;for(P=0;P<C;P++)for(O=0;O<C;O++)P<O?M.set(P,O,k.get(P,O)):P===O?M.set(P,O,this.Rdiag[P]):M.set(P,O,0);return M}get orthogonalMatrix(){let k=this.QR,C=k.rows,M=k.columns,P=new Ce(C,M),O,xe,he,Y;for(he=M-1;he>=0;he--){for(O=0;O<C;O++)P.set(O,he,0);for(P.set(he,he,1),xe=he;xe<M;xe++)if(k.get(he,he)!==0){for(Y=0,O=he;O<C;O++)Y+=k.get(O,he)*P.get(O,xe);for(Y=-Y/k.get(he,he),O=he;O<C;O++)P.set(O,xe,P.get(O,xe)+Y*k.get(O,he))}}return P}}class Xi{constructor(k,C={}){if(k=Dr.checkMatrix(k),k.isEmpty())throw new Error("Matrix must be non-empty");let M=k.rows,P=k.columns;const{computeLeftSingularVectors:O=!0,computeRightSingularVectors:xe=!0,autoTranspose:he=!1}=C;let Y=!!O,U=!!xe,J=!1,ue;if(M<P)if(!he)ue=k.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{ue=k.transpose(),M=ue.rows,P=ue.columns,J=!0;let ft=Y;Y=U,U=ft}else ue=k.clone();let pe=Math.min(M,P),Ze=Math.min(M+1,P),ke=new Float64Array(Ze),rt=new Ce(M,pe),bt=new Ce(P,P),ze=new Float64Array(P),gt=new Float64Array(M),Ut=new Float64Array(Ze);for(let ft=0;ft<Ze;ft++)Ut[ft]=ft;let $t=Math.min(M-1,P),Mr=Math.max(0,Math.min(P-2,M)),Wr=Math.max($t,Mr);for(let ft=0;ft<Wr;ft++){if(ft<$t){ke[ft]=0;for(let Bt=ft;Bt<M;Bt++)ke[ft]=ui(ke[ft],ue.get(Bt,ft));if(ke[ft]!==0){ue.get(ft,ft)<0&&(ke[ft]=-ke[ft]);for(let Bt=ft;Bt<M;Bt++)ue.set(Bt,ft,ue.get(Bt,ft)/ke[ft]);ue.set(ft,ft,ue.get(ft,ft)+1)}ke[ft]=-ke[ft]}for(let Bt=ft+1;Bt<P;Bt++){if(ft<$t&&ke[ft]!==0){let mr=0;for(let Wt=ft;Wt<M;Wt++)mr+=ue.get(Wt,ft)*ue.get(Wt,Bt);mr=-mr/ue.get(ft,ft);for(let Wt=ft;Wt<M;Wt++)ue.set(Wt,Bt,ue.get(Wt,Bt)+mr*ue.get(Wt,ft))}ze[Bt]=ue.get(ft,Bt)}if(Y&&ft<$t)for(let Bt=ft;Bt<M;Bt++)rt.set(Bt,ft,ue.get(Bt,ft));if(ft<Mr){ze[ft]=0;for(let Bt=ft+1;Bt<P;Bt++)ze[ft]=ui(ze[ft],ze[Bt]);if(ze[ft]!==0){ze[ft+1]<0&&(ze[ft]=0-ze[ft]);for(let Bt=ft+1;Bt<P;Bt++)ze[Bt]/=ze[ft];ze[ft+1]+=1}if(ze[ft]=-ze[ft],ft+1<M&&ze[ft]!==0){for(let Bt=ft+1;Bt<M;Bt++)gt[Bt]=0;for(let Bt=ft+1;Bt<M;Bt++)for(let mr=ft+1;mr<P;mr++)gt[Bt]+=ze[mr]*ue.get(Bt,mr);for(let Bt=ft+1;Bt<P;Bt++){let mr=-ze[Bt]/ze[ft+1];for(let Wt=ft+1;Wt<M;Wt++)ue.set(Wt,Bt,ue.get(Wt,Bt)+mr*gt[Wt])}}if(U)for(let Bt=ft+1;Bt<P;Bt++)bt.set(Bt,ft,ze[Bt])}}let gr=Math.min(P,M+1);if($t<P&&(ke[$t]=ue.get($t,$t)),M<gr&&(ke[gr-1]=0),Mr+1<gr&&(ze[Mr]=ue.get(Mr,gr-1)),ze[gr-1]=0,Y){for(let ft=$t;ft<pe;ft++){for(let Bt=0;Bt<M;Bt++)rt.set(Bt,ft,0);rt.set(ft,ft,1)}for(let ft=$t-1;ft>=0;ft--)if(ke[ft]!==0){for(let Bt=ft+1;Bt<pe;Bt++){let mr=0;for(let Wt=ft;Wt<M;Wt++)mr+=rt.get(Wt,ft)*rt.get(Wt,Bt);mr=-mr/rt.get(ft,ft);for(let Wt=ft;Wt<M;Wt++)rt.set(Wt,Bt,rt.get(Wt,Bt)+mr*rt.get(Wt,ft))}for(let Bt=ft;Bt<M;Bt++)rt.set(Bt,ft,-rt.get(Bt,ft));rt.set(ft,ft,1+rt.get(ft,ft));for(let Bt=0;Bt<ft-1;Bt++)rt.set(Bt,ft,0)}else{for(let Bt=0;Bt<M;Bt++)rt.set(Bt,ft,0);rt.set(ft,ft,1)}}if(U)for(let ft=P-1;ft>=0;ft--){if(ft<Mr&&ze[ft]!==0)for(let Bt=ft+1;Bt<P;Bt++){let mr=0;for(let Wt=ft+1;Wt<P;Wt++)mr+=bt.get(Wt,ft)*bt.get(Wt,Bt);mr=-mr/bt.get(ft+1,ft);for(let Wt=ft+1;Wt<P;Wt++)bt.set(Wt,Bt,bt.get(Wt,Bt)+mr*bt.get(Wt,ft))}for(let Bt=0;Bt<P;Bt++)bt.set(Bt,ft,0);bt.set(ft,ft,1)}let lr=gr-1,Xr=Number.EPSILON;for(;gr>0;){let ft,Bt;for(ft=gr-2;ft>=-1&&ft!==-1;ft--){const mr=Number.MIN_VALUE+Xr*Math.abs(ke[ft]+Math.abs(ke[ft+1]));if(Math.abs(ze[ft])<=mr||Number.isNaN(ze[ft])){ze[ft]=0;break}}if(ft===gr-2)Bt=4;else{let mr;for(mr=gr-1;mr>=ft&&mr!==ft;mr--){let Wt=(mr!==gr?Math.abs(ze[mr]):0)+(mr!==ft+1?Math.abs(ze[mr-1]):0);if(Math.abs(ke[mr])<=Xr*Wt){ke[mr]=0;break}}mr===ft?Bt=3:mr===gr-1?Bt=1:(Bt=2,ft=mr)}switch(ft++,Bt){case 1:{let mr=ze[gr-2];ze[gr-2]=0;for(let Wt=gr-2;Wt>=ft;Wt--){let vi=ui(ke[Wt],mr),Gr=ke[Wt]/vi,mi=mr/vi;if(ke[Wt]=vi,Wt!==ft&&(mr=-mi*ze[Wt-1],ze[Wt-1]=Gr*ze[Wt-1]),U)for(let gi=0;gi<P;gi++)vi=Gr*bt.get(gi,Wt)+mi*bt.get(gi,gr-1),bt.set(gi,gr-1,-mi*bt.get(gi,Wt)+Gr*bt.get(gi,gr-1)),bt.set(gi,Wt,vi)}break}case 2:{let mr=ze[ft-1];ze[ft-1]=0;for(let Wt=ft;Wt<gr;Wt++){let vi=ui(ke[Wt],mr),Gr=ke[Wt]/vi,mi=mr/vi;if(ke[Wt]=vi,mr=-mi*ze[Wt],ze[Wt]=Gr*ze[Wt],Y)for(let gi=0;gi<M;gi++)vi=Gr*rt.get(gi,Wt)+mi*rt.get(gi,ft-1),rt.set(gi,ft-1,-mi*rt.get(gi,Wt)+Gr*rt.get(gi,ft-1)),rt.set(gi,Wt,vi)}break}case 3:{const mr=Math.max(Math.abs(ke[gr-1]),Math.abs(ke[gr-2]),Math.abs(ze[gr-2]),Math.abs(ke[ft]),Math.abs(ze[ft])),Wt=ke[gr-1]/mr,vi=ke[gr-2]/mr,Gr=ze[gr-2]/mr,mi=ke[ft]/mr,gi=ze[ft]/mr,Gi=((vi+Wt)*(vi-Wt)+Gr*Gr)/2,Ln=Wt*Gr*(Wt*Gr);let Ei=0;(Gi!==0||Ln!==0)&&(Gi<0?Ei=0-Math.sqrt(Gi*Gi+Ln):Ei=Math.sqrt(Gi*Gi+Ln),Ei=Ln/(Gi+Ei));let on=(mi+Wt)*(mi-Wt)+Ei,zn=mi*gi;for(let ti=ft;ti<gr-1;ti++){let ln=ui(on,zn);ln===0&&(ln=Number.MIN_VALUE);let pn=on/ln,Vi=zn/ln;if(ti!==ft&&(ze[ti-1]=ln),on=pn*ke[ti]+Vi*ze[ti],ze[ti]=pn*ze[ti]-Vi*ke[ti],zn=Vi*ke[ti+1],ke[ti+1]=pn*ke[ti+1],U)for(let di=0;di<P;di++)ln=pn*bt.get(di,ti)+Vi*bt.get(di,ti+1),bt.set(di,ti+1,-Vi*bt.get(di,ti)+pn*bt.get(di,ti+1)),bt.set(di,ti,ln);if(ln=ui(on,zn),ln===0&&(ln=Number.MIN_VALUE),pn=on/ln,Vi=zn/ln,ke[ti]=ln,on=pn*ze[ti]+Vi*ke[ti+1],ke[ti+1]=-Vi*ze[ti]+pn*ke[ti+1],zn=Vi*ze[ti+1],ze[ti+1]=pn*ze[ti+1],Y&&ti<M-1)for(let di=0;di<M;di++)ln=pn*rt.get(di,ti)+Vi*rt.get(di,ti+1),rt.set(di,ti+1,-Vi*rt.get(di,ti)+pn*rt.get(di,ti+1)),rt.set(di,ti,ln)}ze[gr-2]=on;break}case 4:{if(ke[ft]<=0&&(ke[ft]=ke[ft]<0?-ke[ft]:0,U))for(let mr=0;mr<=lr;mr++)bt.set(mr,ft,-bt.get(mr,ft));for(;ft<lr&&!(ke[ft]>=ke[ft+1]);){let mr=ke[ft];if(ke[ft]=ke[ft+1],ke[ft+1]=mr,U&&ft<P-1)for(let Wt=0;Wt<P;Wt++)mr=bt.get(Wt,ft+1),bt.set(Wt,ft+1,bt.get(Wt,ft)),bt.set(Wt,ft,mr);if(Y&&ft<M-1)for(let Wt=0;Wt<M;Wt++)mr=rt.get(Wt,ft+1),rt.set(Wt,ft+1,rt.get(Wt,ft)),rt.set(Wt,ft,mr);ft++}gr--;break}}}if(J){let ft=bt;bt=rt,rt=ft}this.m=M,this.n=P,this.s=ke,this.U=rt,this.V=bt}solve(k){let C=k,M=this.threshold,P=this.s.length,O=Ce.zeros(P,P);for(let pe=0;pe<P;pe++)Math.abs(this.s[pe])<=M?O.set(pe,pe,0):O.set(pe,pe,1/this.s[pe]);let xe=this.U,he=this.rightSingularVectors,Y=he.mmul(O),U=he.rows,J=xe.rows,ue=Ce.zeros(U,J);for(let pe=0;pe<U;pe++)for(let Ze=0;Ze<J;Ze++){let ke=0;for(let rt=0;rt<P;rt++)ke+=Y.get(pe,rt)*xe.get(Ze,rt);ue.set(pe,Ze,ke)}return ue.mmul(C)}solveForDiagonal(k){return this.solve(Ce.diag(k))}inverse(){let k=this.V,C=this.threshold,M=k.rows,P=k.columns,O=new Ce(M,this.s.length);for(let J=0;J<M;J++)for(let ue=0;ue<P;ue++)Math.abs(this.s[ue])>C&&O.set(J,ue,k.get(J,ue)/this.s[ue]);let xe=this.U,he=xe.rows,Y=xe.columns,U=new Ce(M,he);for(let J=0;J<M;J++)for(let ue=0;ue<he;ue++){let pe=0;for(let Ze=0;Ze<Y;Ze++)pe+=O.get(J,Ze)*xe.get(ue,Ze);U.set(J,ue,pe)}return U}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let k=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,C=0,M=this.s;for(let P=0,O=M.length;P<O;P++)M[P]>k&&C++;return C}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Ce.diag(this.s)}}function fn(ie,k=!1){return ie=Dr.checkMatrix(ie),k?new Xi(ie).inverse():Pr(ie,Ce.eye(ie.rows))}function Pr(ie,k,C=!1){return ie=Dr.checkMatrix(ie),k=Dr.checkMatrix(k),C?new Xi(ie).solve(k):ie.isSquare()?new ni(ie).solve(k):new dn(ie).solve(k)}function xi(ie){if(ie=Ce.checkMatrix(ie),ie.isSquare()){if(ie.columns===0)return 1;let k,C,M,P;if(ie.columns===2)return k=ie.get(0,0),C=ie.get(0,1),M=ie.get(1,0),P=ie.get(1,1),k*P-C*M;if(ie.columns===3){let O,xe,he;return O=new Ar(ie,[1,2],[1,2]),xe=new Ar(ie,[1,2],[0,2]),he=new Ar(ie,[1,2],[0,1]),k=ie.get(0,0),C=ie.get(0,1),M=ie.get(0,2),k*xi(O)-C*xi(xe)+M*xi(he)}else return new ni(ie).determinant}else throw Error("determinant can only be calculated for a square matrix")}function Fi(ie,k){let C=[];for(let M=0;M<ie;M++)M!==k&&C.push(M);return C}function ct(ie,k,C,M=1e-9,P=1e-9){if(ie>P)return new Array(k.rows+1).fill(0);{let O=k.addRow(C,[0]);for(let xe=0;xe<O.rows;xe++)Math.abs(O.get(xe,0))<M&&O.set(xe,0,0);return O.to1DArray()}}function be(ie,k={}){const{thresholdValue:C=1e-9,thresholdError:M=1e-9}=k;ie=Ce.checkMatrix(ie);let P=ie.rows,O=new Ce(P,P);for(let xe=0;xe<P;xe++){let he=Ce.columnVector(ie.getRow(xe)),Y=ie.subMatrixRow(Fi(P,xe)).transpose(),J=new Xi(Y).solve(he),ue=Ce.sub(he,Y.mmul(J)).abs().max();O.setRow(xe,ct(ue,J,xe,C,M))}return O}function we(ie,k=Number.EPSILON){if(ie=Ce.checkMatrix(ie),ie.isEmpty())return ie.transpose();let C=new Xi(ie,{autoTranspose:!0}),M=C.leftSingularVectors,P=C.rightSingularVectors,O=C.diagonal;for(let xe=0;xe<O.length;xe++)Math.abs(O[xe])>k?O[xe]=1/O[xe]:O[xe]=0;return P.mmul(Ce.diag(O).mmul(M.transpose()))}function Te(ie,k=ie,C={}){ie=new Ce(ie);let M=!1;if(typeof k=="object"&&!Ce.isMatrix(k)&&!e.isAnyArray(k)?(C=k,k=ie,M=!0):k=new Ce(k),ie.rows!==k.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:P=!0}=C;P&&(ie=ie.center("column"),M||(k=k.center("column")));const O=ie.transpose().mmul(k);for(let xe=0;xe<O.rows;xe++)for(let he=0;he<O.columns;he++)O.set(xe,he,O.get(xe,he)*(1/(ie.rows-1)));return O}function Ge(ie,k=ie,C={}){ie=new Ce(ie);let M=!1;if(typeof k=="object"&&!Ce.isMatrix(k)&&!e.isAnyArray(k)?(C=k,k=ie,M=!0):k=new Ce(k),ie.rows!==k.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:P=!0,scale:O=!0}=C;P&&(ie.center("column"),M||k.center("column")),O&&(ie.scale("column"),M||k.scale("column"));const xe=ie.standardDeviation("column",{unbiased:!0}),he=M?xe:k.standardDeviation("column",{unbiased:!0}),Y=ie.transpose().mmul(k);for(let U=0;U<Y.rows;U++)for(let J=0;J<Y.columns;J++)Y.set(U,J,Y.get(U,J)*(1/(xe[U]*he[J]))*(1/(ie.rows-1)));return Y}class He{constructor(k,C={}){const{assumeSymmetric:M=!1}=C;if(k=Dr.checkMatrix(k),!k.isSquare())throw new Error("Matrix is not a square matrix");if(k.isEmpty())throw new Error("Matrix must be non-empty");let P=k.columns,O=new Ce(P,P),xe=new Float64Array(P),he=new Float64Array(P),Y=k,U,J,ue=!1;if(M?ue=!0:ue=k.isSymmetric(),ue){for(U=0;U<P;U++)for(J=0;J<P;J++)O.set(U,J,Y.get(U,J));nt(P,he,xe,O),yt(P,he,xe,O)}else{let pe=new Ce(P,P),Ze=new Float64Array(P);for(J=0;J<P;J++)for(U=0;U<P;U++)pe.set(U,J,Y.get(U,J));ut(P,pe,Ze,O),St(P,he,xe,O,pe)}this.n=P,this.e=he,this.d=xe,this.V=O}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let k=this.n,C=this.e,M=this.d,P=new Ce(k,k),O,xe;for(O=0;O<k;O++){for(xe=0;xe<k;xe++)P.set(O,xe,0);P.set(O,O,M[O]),C[O]>0?P.set(O,O+1,C[O]):C[O]<0&&P.set(O,O-1,C[O])}return P}}function nt(ie,k,C,M){let P,O,xe,he,Y,U,J,ue;for(Y=0;Y<ie;Y++)C[Y]=M.get(ie-1,Y);for(he=ie-1;he>0;he--){for(ue=0,xe=0,U=0;U<he;U++)ue=ue+Math.abs(C[U]);if(ue===0)for(k[he]=C[he-1],Y=0;Y<he;Y++)C[Y]=M.get(he-1,Y),M.set(he,Y,0),M.set(Y,he,0);else{for(U=0;U<he;U++)C[U]/=ue,xe+=C[U]*C[U];for(P=C[he-1],O=Math.sqrt(xe),P>0&&(O=-O),k[he]=ue*O,xe=xe-P*O,C[he-1]=P-O,Y=0;Y<he;Y++)k[Y]=0;for(Y=0;Y<he;Y++){for(P=C[Y],M.set(Y,he,P),O=k[Y]+M.get(Y,Y)*P,U=Y+1;U<=he-1;U++)O+=M.get(U,Y)*C[U],k[U]+=M.get(U,Y)*P;k[Y]=O}for(P=0,Y=0;Y<he;Y++)k[Y]/=xe,P+=k[Y]*C[Y];for(J=P/(xe+xe),Y=0;Y<he;Y++)k[Y]-=J*C[Y];for(Y=0;Y<he;Y++){for(P=C[Y],O=k[Y],U=Y;U<=he-1;U++)M.set(U,Y,M.get(U,Y)-(P*k[U]+O*C[U]));C[Y]=M.get(he-1,Y),M.set(he,Y,0)}}C[he]=xe}for(he=0;he<ie-1;he++){if(M.set(ie-1,he,M.get(he,he)),M.set(he,he,1),xe=C[he+1],xe!==0){for(U=0;U<=he;U++)C[U]=M.get(U,he+1)/xe;for(Y=0;Y<=he;Y++){for(O=0,U=0;U<=he;U++)O+=M.get(U,he+1)*M.get(U,Y);for(U=0;U<=he;U++)M.set(U,Y,M.get(U,Y)-O*C[U])}}for(U=0;U<=he;U++)M.set(U,he+1,0)}for(Y=0;Y<ie;Y++)C[Y]=M.get(ie-1,Y),M.set(ie-1,Y,0);M.set(ie-1,ie-1,1),k[0]=0}function yt(ie,k,C,M){let P,O,xe,he,Y,U,J,ue,pe,Ze,ke,rt,bt,ze,gt,Ut;for(xe=1;xe<ie;xe++)k[xe-1]=k[xe];k[ie-1]=0;let $t=0,Mr=0,Wr=Number.EPSILON;for(U=0;U<ie;U++){for(Mr=Math.max(Mr,Math.abs(C[U])+Math.abs(k[U])),J=U;J<ie&&!(Math.abs(k[J])<=Wr*Mr);)J++;if(J>U)do{for(P=C[U],ue=(C[U+1]-P)/(2*k[U]),pe=ui(ue,1),ue<0&&(pe=-pe),C[U]=k[U]/(ue+pe),C[U+1]=k[U]*(ue+pe),Ze=C[U+1],O=P-C[U],xe=U+2;xe<ie;xe++)C[xe]-=O;for($t=$t+O,ue=C[J],ke=1,rt=ke,bt=ke,ze=k[U+1],gt=0,Ut=0,xe=J-1;xe>=U;xe--)for(bt=rt,rt=ke,Ut=gt,P=ke*k[xe],O=ke*ue,pe=ui(ue,k[xe]),k[xe+1]=gt*pe,gt=k[xe]/pe,ke=ue/pe,ue=ke*C[xe]-gt*P,C[xe+1]=O+gt*(ke*P+gt*C[xe]),Y=0;Y<ie;Y++)O=M.get(Y,xe+1),M.set(Y,xe+1,gt*M.get(Y,xe)+ke*O),M.set(Y,xe,ke*M.get(Y,xe)-gt*O);ue=-gt*Ut*bt*ze*k[U]/Ze,k[U]=gt*ue,C[U]=ke*ue}while(Math.abs(k[U])>Wr*Mr);C[U]=C[U]+$t,k[U]=0}for(xe=0;xe<ie-1;xe++){for(Y=xe,ue=C[xe],he=xe+1;he<ie;he++)C[he]<ue&&(Y=he,ue=C[he]);if(Y!==xe)for(C[Y]=C[xe],C[xe]=ue,he=0;he<ie;he++)ue=M.get(he,xe),M.set(he,xe,M.get(he,Y)),M.set(he,Y,ue)}}function ut(ie,k,C,M){let P=0,O=ie-1,xe,he,Y,U,J,ue,pe;for(ue=P+1;ue<=O-1;ue++){for(pe=0,U=ue;U<=O;U++)pe=pe+Math.abs(k.get(U,ue-1));if(pe!==0){for(Y=0,U=O;U>=ue;U--)C[U]=k.get(U,ue-1)/pe,Y+=C[U]*C[U];for(he=Math.sqrt(Y),C[ue]>0&&(he=-he),Y=Y-C[ue]*he,C[ue]=C[ue]-he,J=ue;J<ie;J++){for(xe=0,U=O;U>=ue;U--)xe+=C[U]*k.get(U,J);for(xe=xe/Y,U=ue;U<=O;U++)k.set(U,J,k.get(U,J)-xe*C[U])}for(U=0;U<=O;U++){for(xe=0,J=O;J>=ue;J--)xe+=C[J]*k.get(U,J);for(xe=xe/Y,J=ue;J<=O;J++)k.set(U,J,k.get(U,J)-xe*C[J])}C[ue]=pe*C[ue],k.set(ue,ue-1,pe*he)}}for(U=0;U<ie;U++)for(J=0;J<ie;J++)M.set(U,J,U===J?1:0);for(ue=O-1;ue>=P+1;ue--)if(k.get(ue,ue-1)!==0){for(U=ue+1;U<=O;U++)C[U]=k.get(U,ue-1);for(J=ue;J<=O;J++){for(he=0,U=ue;U<=O;U++)he+=C[U]*M.get(U,J);for(he=he/C[ue]/k.get(ue,ue-1),U=ue;U<=O;U++)M.set(U,J,M.get(U,J)+he*C[U])}}}function St(ie,k,C,M,P){let O=ie-1,xe=0,he=ie-1,Y=Number.EPSILON,U=0,J=0,ue=0,pe=0,Ze=0,ke=0,rt=0,bt=0,ze,gt,Ut,$t,Mr,Wr,gr,lr,Xr,ft,Bt,mr,Wt,vi,Gr;for(ze=0;ze<ie;ze++)for((ze<xe||ze>he)&&(C[ze]=P.get(ze,ze),k[ze]=0),gt=Math.max(ze-1,0);gt<ie;gt++)J=J+Math.abs(P.get(ze,gt));for(;O>=xe;){for($t=O;$t>xe&&(ke=Math.abs(P.get($t-1,$t-1))+Math.abs(P.get($t,$t)),ke===0&&(ke=J),!(Math.abs(P.get($t,$t-1))<Y*ke));)$t--;if($t===O)P.set(O,O,P.get(O,O)+U),C[O]=P.get(O,O),k[O]=0,O--,bt=0;else if($t===O-1){if(gr=P.get(O,O-1)*P.get(O-1,O),ue=(P.get(O-1,O-1)-P.get(O,O))/2,pe=ue*ue+gr,rt=Math.sqrt(Math.abs(pe)),P.set(O,O,P.get(O,O)+U),P.set(O-1,O-1,P.get(O-1,O-1)+U),lr=P.get(O,O),pe>=0){for(rt=ue>=0?ue+rt:ue-rt,C[O-1]=lr+rt,C[O]=C[O-1],rt!==0&&(C[O]=lr-gr/rt),k[O-1]=0,k[O]=0,lr=P.get(O,O-1),ke=Math.abs(lr)+Math.abs(rt),ue=lr/ke,pe=rt/ke,Ze=Math.sqrt(ue*ue+pe*pe),ue=ue/Ze,pe=pe/Ze,gt=O-1;gt<ie;gt++)rt=P.get(O-1,gt),P.set(O-1,gt,pe*rt+ue*P.get(O,gt)),P.set(O,gt,pe*P.get(O,gt)-ue*rt);for(ze=0;ze<=O;ze++)rt=P.get(ze,O-1),P.set(ze,O-1,pe*rt+ue*P.get(ze,O)),P.set(ze,O,pe*P.get(ze,O)-ue*rt);for(ze=xe;ze<=he;ze++)rt=M.get(ze,O-1),M.set(ze,O-1,pe*rt+ue*M.get(ze,O)),M.set(ze,O,pe*M.get(ze,O)-ue*rt)}else C[O-1]=lr+ue,C[O]=lr+ue,k[O-1]=rt,k[O]=-rt;O=O-2,bt=0}else{if(lr=P.get(O,O),Xr=0,gr=0,$t<O&&(Xr=P.get(O-1,O-1),gr=P.get(O,O-1)*P.get(O-1,O)),bt===10){for(U+=lr,ze=xe;ze<=O;ze++)P.set(ze,ze,P.get(ze,ze)-lr);ke=Math.abs(P.get(O,O-1))+Math.abs(P.get(O-1,O-2)),lr=Xr=.75*ke,gr=-.4375*ke*ke}if(bt===30&&(ke=(Xr-lr)/2,ke=ke*ke+gr,ke>0)){for(ke=Math.sqrt(ke),Xr<lr&&(ke=-ke),ke=lr-gr/((Xr-lr)/2+ke),ze=xe;ze<=O;ze++)P.set(ze,ze,P.get(ze,ze)-ke);U+=ke,lr=Xr=gr=.964}for(bt=bt+1,Mr=O-2;Mr>=$t&&(rt=P.get(Mr,Mr),Ze=lr-rt,ke=Xr-rt,ue=(Ze*ke-gr)/P.get(Mr+1,Mr)+P.get(Mr,Mr+1),pe=P.get(Mr+1,Mr+1)-rt-Ze-ke,Ze=P.get(Mr+2,Mr+1),ke=Math.abs(ue)+Math.abs(pe)+Math.abs(Ze),ue=ue/ke,pe=pe/ke,Ze=Ze/ke,!(Mr===$t||Math.abs(P.get(Mr,Mr-1))*(Math.abs(pe)+Math.abs(Ze))<Y*(Math.abs(ue)*(Math.abs(P.get(Mr-1,Mr-1))+Math.abs(rt)+Math.abs(P.get(Mr+1,Mr+1))))));)Mr--;for(ze=Mr+2;ze<=O;ze++)P.set(ze,ze-2,0),ze>Mr+2&&P.set(ze,ze-3,0);for(Ut=Mr;Ut<=O-1&&(vi=Ut!==O-1,Ut!==Mr&&(ue=P.get(Ut,Ut-1),pe=P.get(Ut+1,Ut-1),Ze=vi?P.get(Ut+2,Ut-1):0,lr=Math.abs(ue)+Math.abs(pe)+Math.abs(Ze),lr!==0&&(ue=ue/lr,pe=pe/lr,Ze=Ze/lr)),lr!==0);Ut++)if(ke=Math.sqrt(ue*ue+pe*pe+Ze*Ze),ue<0&&(ke=-ke),ke!==0){for(Ut!==Mr?P.set(Ut,Ut-1,-ke*lr):$t!==Mr&&P.set(Ut,Ut-1,-P.get(Ut,Ut-1)),ue=ue+ke,lr=ue/ke,Xr=pe/ke,rt=Ze/ke,pe=pe/ue,Ze=Ze/ue,gt=Ut;gt<ie;gt++)ue=P.get(Ut,gt)+pe*P.get(Ut+1,gt),vi&&(ue=ue+Ze*P.get(Ut+2,gt),P.set(Ut+2,gt,P.get(Ut+2,gt)-ue*rt)),P.set(Ut,gt,P.get(Ut,gt)-ue*lr),P.set(Ut+1,gt,P.get(Ut+1,gt)-ue*Xr);for(ze=0;ze<=Math.min(O,Ut+3);ze++)ue=lr*P.get(ze,Ut)+Xr*P.get(ze,Ut+1),vi&&(ue=ue+rt*P.get(ze,Ut+2),P.set(ze,Ut+2,P.get(ze,Ut+2)-ue*Ze)),P.set(ze,Ut,P.get(ze,Ut)-ue),P.set(ze,Ut+1,P.get(ze,Ut+1)-ue*pe);for(ze=xe;ze<=he;ze++)ue=lr*M.get(ze,Ut)+Xr*M.get(ze,Ut+1),vi&&(ue=ue+rt*M.get(ze,Ut+2),M.set(ze,Ut+2,M.get(ze,Ut+2)-ue*Ze)),M.set(ze,Ut,M.get(ze,Ut)-ue),M.set(ze,Ut+1,M.get(ze,Ut+1)-ue*pe)}}}if(J!==0){for(O=ie-1;O>=0;O--)if(ue=C[O],pe=k[O],pe===0)for($t=O,P.set(O,O,1),ze=O-1;ze>=0;ze--){for(gr=P.get(ze,ze)-ue,Ze=0,gt=$t;gt<=O;gt++)Ze=Ze+P.get(ze,gt)*P.get(gt,O);if(k[ze]<0)rt=gr,ke=Ze;else if($t=ze,k[ze]===0?P.set(ze,O,gr!==0?-Ze/gr:-Ze/(Y*J)):(lr=P.get(ze,ze+1),Xr=P.get(ze+1,ze),pe=(C[ze]-ue)*(C[ze]-ue)+k[ze]*k[ze],Wr=(lr*ke-rt*Ze)/pe,P.set(ze,O,Wr),P.set(ze+1,O,Math.abs(lr)>Math.abs(rt)?(-Ze-gr*Wr)/lr:(-ke-Xr*Wr)/rt)),Wr=Math.abs(P.get(ze,O)),Y*Wr*Wr>1)for(gt=ze;gt<=O;gt++)P.set(gt,O,P.get(gt,O)/Wr)}else if(pe<0)for($t=O-1,Math.abs(P.get(O,O-1))>Math.abs(P.get(O-1,O))?(P.set(O-1,O-1,pe/P.get(O,O-1)),P.set(O-1,O,-(P.get(O,O)-ue)/P.get(O,O-1))):(Gr=Vt(0,-P.get(O-1,O),P.get(O-1,O-1)-ue,pe),P.set(O-1,O-1,Gr[0]),P.set(O-1,O,Gr[1])),P.set(O,O-1,0),P.set(O,O,1),ze=O-2;ze>=0;ze--){for(ft=0,Bt=0,gt=$t;gt<=O;gt++)ft=ft+P.get(ze,gt)*P.get(gt,O-1),Bt=Bt+P.get(ze,gt)*P.get(gt,O);if(gr=P.get(ze,ze)-ue,k[ze]<0)rt=gr,Ze=ft,ke=Bt;else if($t=ze,k[ze]===0?(Gr=Vt(-ft,-Bt,gr,pe),P.set(ze,O-1,Gr[0]),P.set(ze,O,Gr[1])):(lr=P.get(ze,ze+1),Xr=P.get(ze+1,ze),mr=(C[ze]-ue)*(C[ze]-ue)+k[ze]*k[ze]-pe*pe,Wt=(C[ze]-ue)*2*pe,mr===0&&Wt===0&&(mr=Y*J*(Math.abs(gr)+Math.abs(pe)+Math.abs(lr)+Math.abs(Xr)+Math.abs(rt))),Gr=Vt(lr*Ze-rt*ft+pe*Bt,lr*ke-rt*Bt-pe*ft,mr,Wt),P.set(ze,O-1,Gr[0]),P.set(ze,O,Gr[1]),Math.abs(lr)>Math.abs(rt)+Math.abs(pe)?(P.set(ze+1,O-1,(-ft-gr*P.get(ze,O-1)+pe*P.get(ze,O))/lr),P.set(ze+1,O,(-Bt-gr*P.get(ze,O)-pe*P.get(ze,O-1))/lr)):(Gr=Vt(-Ze-Xr*P.get(ze,O-1),-ke-Xr*P.get(ze,O),rt,pe),P.set(ze+1,O-1,Gr[0]),P.set(ze+1,O,Gr[1]))),Wr=Math.max(Math.abs(P.get(ze,O-1)),Math.abs(P.get(ze,O))),Y*Wr*Wr>1)for(gt=ze;gt<=O;gt++)P.set(gt,O-1,P.get(gt,O-1)/Wr),P.set(gt,O,P.get(gt,O)/Wr)}for(ze=0;ze<ie;ze++)if(ze<xe||ze>he)for(gt=ze;gt<ie;gt++)M.set(ze,gt,P.get(ze,gt));for(gt=ie-1;gt>=xe;gt--)for(ze=xe;ze<=he;ze++){for(rt=0,Ut=xe;Ut<=Math.min(gt,he);Ut++)rt=rt+M.get(ze,Ut)*P.get(Ut,gt);M.set(ze,gt,rt)}}}function Vt(ie,k,C,M){let P,O;return Math.abs(C)>Math.abs(M)?(P=M/C,O=C+P*M,[(ie+P*k)/O,(k-P*ie)/O]):(P=C/M,O=M+P*C,[(P*ie+k)/O,(P*k-ie)/O])}class Ft{constructor(k){if(k=Dr.checkMatrix(k),!k.isSymmetric())throw new Error("Matrix is not symmetric");let C=k,M=C.rows,P=new Ce(M,M),O=!0,xe,he,Y;for(he=0;he<M;he++){let U=0;for(Y=0;Y<he;Y++){let J=0;for(xe=0;xe<Y;xe++)J+=P.get(Y,xe)*P.get(he,xe);J=(C.get(he,Y)-J)/P.get(Y,Y),P.set(he,Y,J),U=U+J*J}for(U=C.get(he,he)-U,O&&(O=U>0),P.set(he,he,Math.sqrt(Math.max(U,0))),Y=he+1;Y<M;Y++)P.set(he,Y,0)}this.L=P,this.positiveDefinite=O}isPositiveDefinite(){return this.positiveDefinite}solve(k){k=Dr.checkMatrix(k);let C=this.L,M=C.rows;if(k.rows!==M)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let P=k.columns,O=k.clone(),xe,he,Y;for(Y=0;Y<M;Y++)for(he=0;he<P;he++){for(xe=0;xe<Y;xe++)O.set(Y,he,O.get(Y,he)-O.get(xe,he)*C.get(Y,xe));O.set(Y,he,O.get(Y,he)/C.get(Y,Y))}for(Y=M-1;Y>=0;Y--)for(he=0;he<P;he++){for(xe=Y+1;xe<M;xe++)O.set(Y,he,O.get(Y,he)-O.get(xe,he)*C.get(xe,Y));O.set(Y,he,O.get(Y,he)/C.get(Y,Y))}return O}get lowerTriangularMatrix(){return this.L}}class sr{constructor(k,C={}){k=Dr.checkMatrix(k);let{Y:M}=C;const{scaleScores:P=!1,maxIterations:O=1e3,terminationCriteria:xe=1e-10}=C;let he;if(M){if(e.isAnyArray(M)&&typeof M[0]=="number"?M=Ce.columnVector(M):M=Dr.checkMatrix(M),M.rows!==k.rows)throw new Error("Y should have the same number of rows as X");he=M.getColumnVector(0)}else he=k.getColumnVector(0);let Y=1,U,J,ue,pe;for(let Ze=0;Ze<O&&Y>xe;Ze++)ue=k.transpose().mmul(he).div(he.transpose().mmul(he).get(0,0)),ue=ue.div(ue.norm()),U=k.mmul(ue).div(ue.transpose().mmul(ue).get(0,0)),Ze>0&&(Y=U.clone().sub(pe).pow(2).sum()),pe=U.clone(),M?(J=M.transpose().mmul(U).div(U.transpose().mmul(U).get(0,0)),J=J.div(J.norm()),he=M.mmul(J).div(J.transpose().mmul(J).get(0,0))):he=U;if(M){let Ze=k.transpose().mmul(U).div(U.transpose().mmul(U).get(0,0));Ze=Ze.div(Ze.norm());let ke=k.clone().sub(U.clone().mmul(Ze.transpose())),rt=he.transpose().mmul(U).div(U.transpose().mmul(U).get(0,0)),bt=M.clone().sub(U.clone().mulS(rt.get(0,0)).mmul(J.transpose()));this.t=U,this.p=Ze.transpose(),this.w=ue.transpose(),this.q=J,this.u=he,this.s=U.transpose().mmul(U),this.xResidual=ke,this.yResidual=bt,this.betas=rt}else this.w=ue.transpose(),this.s=U.transpose().mmul(U).sqrt(),P?this.t=U.clone().div(this.s.get(0,0)):this.t=U,this.xResidual=k.sub(U.mmul(ue.transpose()))}}return bi.AbstractMatrix=We,bi.CHO=Ft,bi.CholeskyDecomposition=Ft,bi.DistanceMatrix=Lt,bi.EVD=He,bi.EigenvalueDecomposition=He,bi.LU=ni,bi.LuDecomposition=ni,bi.Matrix=Ce,bi.MatrixColumnSelectionView=dr,bi.MatrixColumnView=Jt,bi.MatrixFlipColumnView=zt,bi.MatrixFlipRowView=Zt,bi.MatrixRowSelectionView=Yt,bi.MatrixRowView=Ot,bi.MatrixSelectionView=Ar,bi.MatrixSubView=yr,bi.MatrixTransposeView=kr,bi.NIPALS=sr,bi.Nipals=sr,bi.QR=dn,bi.QrDecomposition=dn,bi.SVD=Xi,bi.SingularValueDecomposition=Xi,bi.SymmetricMatrix=It,bi.WrapperMatrix1D=Tr,bi.WrapperMatrix2D=Dr,bi.correlation=Ge,bi.covariance=Te,bi.default=Ce,bi.determinant=xi,bi.inverse=fn,bi.linearDependencies=be,bi.pseudoInverse=we,bi.solve=Pr,bi.wrap=hi,bi}var Xp=tR();const B2=Hg(Xp),rR=Xp.SingularValueDecomposition,_l=B2.Matrix?B2.Matrix:Xp.Matrix,iR=Xp.inverse,t3=Xp.pseudoInverse;function nR(e,t){const i=new _l([...e[0],...e[1]]),a=_l.columnVector([...t[0],...t[1]]);return t3(i).mmul(a).to1DArray()}function sR(e,t){const i=new _l(e),a=[_l.columnVector(t[0]),_l.columnVector(t[1])],h=t3(i);return[h.mmul(a[0]),h.mmul(a[1])].map(s=>s.to1DArray())}function aR(e,t){const i=new _l(e),a=[_l.columnVector(t[0]),_l.columnVector(t[1])],h=iR(i);return[h.mmul(a[0]),h.mmul(a[1])].map(s=>s.to1DArray())}function oR(e,t){const i=[];for(let p=0;p<t;p++)i.push(e[0][p]),i.push(e[1][p]);const a=new rR(i);return _l.from1DArray(3,3,a.rightSingularVectors.getColumn(8)).transpose().to2DArray()}class r3 extends e3{constructor(i,a){super(i,a,"helmert",2);Ke(this,"coefsArrayMatrices");Ke(this,"coefsArrayMatricesSize");Ke(this,"weightsArray");Ke(this,"weightsArrays");this.coefsArrayMatrices=this.getCoefsArrayMatrices(),this.coefsArrayMatricesSize=this.coefsArrayMatrices.map(h=>$l(h))}getDestinationPointsArrays(){return[this.destinationPoints.map(i=>i[0]),this.destinationPoints.map(i=>i[1])]}getCoefsArrayMatrices(){let i=xo(this.pointCount,4,0),a=xo(this.pointCount,4,0);for(let h=0;h<this.pointCount;h++){const d=this.getSourcePointCoefsArrays(this.sourcePoints[h]);i=op(i,h,0,[d[0]]),a=op(a,h,0,[d[1]])}return[i,a]}getSourcePointCoefsArrays(i){return[[1,0,i[0],-i[1]],[0,1,i[1],i[0]]]}solve(){this.weightsArray=nR(this.coefsArrayMatrices,this.destinationPointsArrays),this.weightsArrays=[this.weightsArray,this.weightsArray]}getMeasures(){if(this.weightsArrays||this.solve(),!this.weightsArray)throw new Error("Helmert weights not computed");const i={};return i.scale=Math.sqrt(this.weightsArray[2]**2+this.weightsArray[3]**2),i.rotation=Math.atan2(this.weightsArray[3],this.weightsArray[2]),i.translation=[this.weightsArray[0],this.weightsArray[1]],i}evaluateFunction(i){if(this.weightsArrays||this.solve(),!this.weightsArray)throw new Error("Helmert weights not computed");return[this.weightsArray[0]+this.weightsArray[2]*i[0]-this.weightsArray[3]*i[1],this.weightsArray[1]+this.weightsArray[2]*i[1]+this.weightsArray[3]*i[0]]}evaluatePartialDerivativeX(i){if(this.weightsArrays||this.solve(),!this.weightsArray)throw new Error("Helmert weights not computed");return[this.weightsArray[2],this.weightsArray[3]]}evaluatePartialDerivativeY(i){if(this.weightsArrays||this.solve(),!this.weightsArray)throw new Error("Helmert weights not computed");return[-this.weightsArray[3],this.weightsArray[2]]}}class lR extends zy{constructor(i,a){super(i,a,"straight",2);Ke(this,"weightsArrays")}solve(){const a=new r3(this.sourcePoints,this.destinationPoints).getMeasures().scale,h=this.sourcePoints.reduce((s,w)=>[s[0]+w[0],s[1]+w[1]]).map(s=>s/this.pointCount),d=this.destinationPoints.reduce((s,w)=>[s[0]+w[0],s[1]+w[1]]).map(s=>s/this.pointCount),p=d.map((s,w)=>s-h[w]*a);this.weightsArrays={scale:a,sourcePointsCenter:h,destinationPointsCenter:d,translation:p}}evaluateFunction(i){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");return[this.weightsArrays.translation[0]+this.weightsArrays.scale*i[0],this.weightsArrays.translation[1]+this.weightsArrays.scale*i[1]]}evaluatePartialDerivativeX(i){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");return[this.weightsArrays.scale,0]}evaluatePartialDerivativeY(i){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");return[0,this.weightsArrays.scale]}}class i3 extends e3{constructor(t,i,a,h){super(t,i,a,h)}getCoefsArrayMatrices(){const t=this.getCoefsArrayMatrix();return[t,t]}getSourcePointCoefsArrays(t){const i=this.getSourcePointCoefsArray(t);return[i,i]}}class Fy extends i3{constructor(i,a,h){h=h||1;const d=(h+1)*(h+2)/2;super(i,a,"polynomial"+h,d);Ke(this,"coefsArrayMatrices");Ke(this,"coefsArrayMatrix");Ke(this,"coefsArrayMatricesSize");Ke(this,"coefsArrayMatrixSize");Ke(this,"order");Ke(this,"weightsArrays");if(this.order=h,this.order<1||this.order>3)throw new Error("Only polynomial transformations of order 1, 2 or 3 are supported");this.coefsArrayMatrices=this.getCoefsArrayMatrices(),this.coefsArrayMatrix=this.coefsArrayMatrices[0],this.coefsArrayMatricesSize=this.coefsArrayMatrices.map(p=>$l(p)),this.coefsArrayMatrixSize=$l(this.coefsArrayMatrix)}getDestinationPointsArrays(){return[this.destinationPoints.map(i=>i[0]),this.destinationPoints.map(i=>i[1])]}getCoefsArrayMatrix(){let i=xo(this.pointCount,this.pointCountMinimum,0);for(let a=0;a<this.pointCount;a++)i=op(i,a,0,[this.getSourcePointCoefsArray(this.sourcePoints[a])]);return i}solve(){this.weightsArrays=sR(this.coefsArrayMatrix,this.destinationPointsArrays)}}class cp extends Fy{constructor(t,i){super(t,i,1)}getSourcePointCoefsArray(t){return cp.getPolynomial1SourcePointCoefsArray(t)}static getPolynomial1SourcePointCoefsArray(t){return[1,t[0],t[1]]}getHomogeneousTransform(){if(this.weightsArrays)return[this.weightsArrays[0][1],this.weightsArrays[1][1],this.weightsArrays[0][2],this.weightsArrays[1][2],this.weightsArrays[0][0],this.weightsArrays[1][0]]}setWeightsArraysFromHomogeneousTransform(t){this.weightsArrays=[[t[4],t[0],t[2]],[t[5],t[1],t[3]]]}getMeasures(){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const t={};t.translation=[this.weightsArrays[0][0],this.weightsArrays[1][0]];const i=this.weightsArrays[0][1],a=this.weightsArrays[1][1],h=this.weightsArrays[0][2],d=this.weightsArrays[1][2],p=i*d-a*h;if(i!=0||a!=0){const s=Math.sqrt(i*i+a*a);t.rotation=a>0?Math.acos(i/s):-Math.acos(i/s),t.scales=[s,p/s],t.shears=[Math.atan((i*h+a*d)/(s*s)),0]}else if(h!=0||d!=0){const s=Math.sqrt(h*h+d*d);t.rotation=Math.PI/2-(d>0?Math.acos(-h/s):-Math.acos(h/s)),t.scales=[p/s,s],t.shears=[0,Math.atan((i*h+a*d)/(s*s))]}return t}evaluateFunction(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][0]+this.weightsArrays[a][1]*t[0]+this.weightsArrays[a][2]*t[1];return i}evaluatePartialDerivativeX(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][1];return i}evaluatePartialDerivativeY(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][2];return i}}class Dy extends Fy{constructor(t,i){super(t,i,2)}getSourcePointCoefsArray(t){return Dy.getPolynomial2SourcePointCoefsArray(t)}static getPolynomial2SourcePointCoefsArray(t){return[1,t[0],t[1],t[0]**2,t[1]**2,t[0]*t[1]]}evaluateFunction(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][0]+this.weightsArrays[a][1]*t[0]+this.weightsArrays[a][2]*t[1]+this.weightsArrays[a][3]*t[0]**2+this.weightsArrays[a][4]*t[1]**2+this.weightsArrays[a][5]*t[0]*t[1];return i}evaluatePartialDerivativeX(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][1]+2*this.weightsArrays[a][3]*t[0]+this.weightsArrays[a][5]*t[1];return i}evaluatePartialDerivativeY(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][2]+2*this.weightsArrays[a][4]*t[1]+this.weightsArrays[a][5]*t[0];return i}}class By extends Fy{constructor(t,i){super(t,i,3)}getSourcePointCoefsArray(t){return By.getPolynomial3SourcePointCoefsArray(t)}static getPolynomial3SourcePointCoefsArray(t){return[1,t[0],t[1],t[0]**2,t[1]**2,t[0]*t[1],t[0]**3,t[1]**3,t[0]**2*t[1],t[0]*t[1]**2]}evaluateFunction(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][0]+this.weightsArrays[a][1]*t[0]+this.weightsArrays[a][2]*t[1]+this.weightsArrays[a][3]*t[0]**2+this.weightsArrays[a][4]*t[1]**2+this.weightsArrays[a][5]*t[0]*t[1]+this.weightsArrays[a][6]*t[0]**3+this.weightsArrays[a][7]*t[1]**3+this.weightsArrays[a][8]*t[0]**2*t[1]+this.weightsArrays[a][9]*t[0]*t[1]**2;return i}evaluatePartialDerivativeX(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][1]+2*this.weightsArrays[a][3]*t[0]+this.weightsArrays[a][5]*t[1]+3*this.weightsArrays[a][6]*t[0]**2+2*this.weightsArrays[a][8]*t[0]*t[1]+this.weightsArrays[a][9]*t[1]**2;return i}evaluatePartialDerivativeY(t){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const i=[0,0];for(let a=0;a<2;a++)i[a]+=this.weightsArrays[a][2]+2*this.weightsArrays[a][4]*t[1]+this.weightsArrays[a][5]*t[0]+3*this.weightsArrays[a][7]*t[1]**2+this.weightsArrays[a][8]*t[0]**2+2*this.weightsArrays[a][9]*t[0]*t[1];return i}}class cR extends zy{constructor(i,a){super(i,a,"projective",4);Ke(this,"coefsArrayMatrices");Ke(this,"weightsArrays");this.coefsArrayMatrices=[xo(this.pointCount,9,0),xo(this.pointCount,9,0)];for(let h=0;h<this.pointCount;h++)this.coefsArrayMatrices[0][h][0]=-i[h][0],this.coefsArrayMatrices[0][h][1]=-i[h][1],this.coefsArrayMatrices[0][h][2]=-1,this.coefsArrayMatrices[0][h][3]=0,this.coefsArrayMatrices[0][h][4]=0,this.coefsArrayMatrices[0][h][5]=0,this.coefsArrayMatrices[0][h][6]=a[h][0]*i[h][0],this.coefsArrayMatrices[0][h][7]=a[h][0]*i[h][1],this.coefsArrayMatrices[0][h][8]=a[h][0],this.coefsArrayMatrices[1][h][0]=0,this.coefsArrayMatrices[1][h][1]=0,this.coefsArrayMatrices[1][h][2]=0,this.coefsArrayMatrices[1][h][3]=-i[h][0],this.coefsArrayMatrices[1][h][4]=-i[h][1],this.coefsArrayMatrices[1][h][5]=-1,this.coefsArrayMatrices[1][h][6]=a[h][1]*i[h][0],this.coefsArrayMatrices[1][h][7]=a[h][1]*i[h][1],this.coefsArrayMatrices[1][h][8]=a[h][1]}solve(){this.weightsArrays=oR(this.coefsArrayMatrices,this.pointCount)}evaluateFunction(i){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const a=this.weightsArrays[0][2]*i[0]+this.weightsArrays[1][2]*i[1]+this.weightsArrays[2][2],h=this.weightsArrays[0][0]*i[0]+this.weightsArrays[1][0]*i[1]+this.weightsArrays[2][0],d=this.weightsArrays[0][1]*i[0]+this.weightsArrays[1][1]*i[1]+this.weightsArrays[2][1];return[h/a,d/a]}evaluatePartialDerivativeX(i){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const a=this.weightsArrays[0][2]*i[0]+this.weightsArrays[1][2]*i[1]+this.weightsArrays[2][2],h=this.weightsArrays[0][0]*i[0]+this.weightsArrays[1][0]*i[1]+this.weightsArrays[2][0],d=this.weightsArrays[0][1]*i[0]+this.weightsArrays[1][1]*i[1]+this.weightsArrays[2][1];return[(a*this.weightsArrays[0][0]-this.weightsArrays[0][2]*h)/a**2,(a*this.weightsArrays[0][1]-this.weightsArrays[0][2]*d)/a**2]}evaluatePartialDerivativeY(i){if(this.weightsArrays||this.solve(),!this.weightsArrays)throw new Error("Weights not computed");const a=this.weightsArrays[0][2]*i[0]+this.weightsArrays[1][2]*i[1]+this.weightsArrays[2][2],h=this.weightsArrays[0][0]*i[0]+this.weightsArrays[1][0]*i[1]+this.weightsArrays[2][0],d=this.weightsArrays[0][1]*i[0]+this.weightsArrays[1][1]*i[1]+this.weightsArrays[2][1];return[(a*this.weightsArrays[1][0]-this.weightsArrays[1][2]*h)/a**2,(a*this.weightsArrays[1][1]-this.weightsArrays[1][2]*d)/a**2]}}class G2 extends i3{constructor(i,a,h,d,p,s){super(i,a,p,3);Ke(this,"kernelFunction");Ke(this,"normFunction");Ke(this,"epsilon");Ke(this,"coefsArrayMatrices");Ke(this,"coefsArrayMatrix");Ke(this,"coefsArrayMatricesSize");Ke(this,"coefsArrayMatrixSize");Ke(this,"weightsArrays");Ke(this,"rbfWeightsArrays");Ke(this,"affineWeightsArrays");this.kernelFunction=h,this.normFunction=d,this.epsilon=s,this.coefsArrayMatrices=this.getCoefsArrayMatrices(),this.coefsArrayMatrix=this.coefsArrayMatrices[0],this.coefsArrayMatricesSize=this.coefsArrayMatrices.map(w=>$l(w)),this.coefsArrayMatrixSize=$l(this.coefsArrayMatrix)}getDestinationPointsArrays(){return[[...this.destinationPoints,[0,0],[0,0],[0,0]].map(i=>i[0]),[...this.destinationPoints,[0,0],[0,0],[0,0]].map(i=>i[1])]}getCoefsArrayMatrix(){const i=xo(this.pointCount,this.pointCount,0);for(let s=0;s<this.pointCount;s++)for(let w=0;w<this.pointCount;w++)i[s][w]=this.normFunction(this.sourcePoints[s],this.sourcePoints[w]);if(this.epsilon===void 0){const s=i.map(w=>w.reduce((A,z)=>A+z,0)).reduce((w,A)=>w+A,0);this.epsilon=s/(Math.pow(this.pointCount,2)-this.pointCount)}const a=xo(this.pointCount,this.pointCount,0);for(let s=0;s<this.pointCount;s++)for(let w=0;w<this.pointCount;w++)a[s][w]=this.kernelFunction(i[s][w],{epsilon:this.epsilon});let h=xo(this.pointCount,3,0);for(let s=0;s<this.pointCount;s++)h=op(h,s,0,[cp.getPolynomial1SourcePointCoefsArray(this.sourcePoints[s])]);const d=xo(3,3,0);return xk([[a,h],[Q6(h),d]])}getSourcePointCoefsArray(i){return[...this.getRbfKernelSourcePointCoefsArray(i),...cp.getPolynomial1SourcePointCoefsArray(i)]}getRbfKernelSourcePointCoefsArray(i){const a=[];for(let h=0;h<this.pointCount;h++)a.push(this.kernelFunction(this.normFunction(this.sourcePoints[h],i),{epsilon:this.epsilon}));return a}setWeightsArrays(i,a){a&&(this.epsilon=a),super.setWeightsArrays(i)}solve(){this.weightsArrays=aR(this.coefsArrayMatrix,this.destinationPointsArrays),this.processWeightsArrays()}processWeightsArrays(){if(!this.weightsArrays)throw new Error("Weights not computed");this.rbfWeightsArrays=this.weightsArrays.map(i=>i.slice(0,this.pointCount)),this.affineWeightsArrays=this.weightsArrays.map(i=>i.slice(this.pointCount))}evaluateFunction(i){if(this.weightsArrays||this.solve(),!this.rbfWeightsArrays||!this.affineWeightsArrays)throw new Error("RBF weights not computed");const a=this.rbfWeightsArrays,h=this.affineWeightsArrays,d=this.sourcePoints.map(s=>this.normFunction(i,s)),p=[0,0];for(let s=0;s<2;s++)p[s]=d.reduce((w,A,z)=>w+this.kernelFunction(A,{epsilon:this.epsilon})*a[s][z],0),p[s]+=h[s][0]+h[s][1]*i[0]+h[s][2]*i[1];return p}evaluatePartialDerivativeX(i){if(this.weightsArrays||this.solve(),!this.rbfWeightsArrays||!this.affineWeightsArrays)throw new Error("RBF weights not computed");const a=this.rbfWeightsArrays,h=this.affineWeightsArrays,d=this.sourcePoints.map(s=>this.normFunction(i,s)),p=[0,0];for(let s=0;s<2;s++)p[s]=d.reduce((w,A,z)=>w+(A===0?0:this.kernelFunction(A,{derivative:1,epsilon:this.epsilon})*((i[0]-this.sourcePoints[z][0])/A)*a[s][z]),0),p[s]+=h[s][1];return p}evaluatePartialDerivativeY(i){if(this.weightsArrays||this.solve(),!this.rbfWeightsArrays||!this.affineWeightsArrays)throw new Error("RBF weights not computed");const a=this.rbfWeightsArrays,h=this.affineWeightsArrays,d=this.sourcePoints.map(s=>this.normFunction(i,s)),p=[0,0];for(let s=0;s<2;s++)p[s]=d.reduce((w,A,z)=>w+(A===0?0:this.kernelFunction(A,{derivative:1,epsilon:this.epsilon})*((i[1]-this.sourcePoints[z][1])/A)*a[s][z]),0),p[s]+=h[s][2];return p}}function hR(e,t){if(t.derivative){if(t.derivative===1)return 1;throw new Error("Derivate of order "+t.derivative+" not implemented")}else return e}function uR(e,t){if(t.derivative){if(t.derivative===1)return e===0?0:e+2*e*Math.log(e);throw new Error("Derivate of order "+t.derivative+" not implemented")}else return e===0?0:Math.pow(e,2)*Math.log(e)}function V2(e,t){const i=t[0]-e[0],a=t[1]-e[1];return Math.sqrt(i*i+a*a)}const n3={maxDepth:0,minOffsetRatio:0,minOffsetDistance:1/0,minLineDistance:1/0,sourceMidPointFunction:og,destinationMidPointFunction:og,destinationDistanceFunction:bo};function cg(e,t,i){e=ky(e);const a=e.map(p=>({source:p,destination:t(p)})),d=s3(a,!1).map(p=>hg(p,t,i,0)).flat(1);return a3(d,!0)}function j2(e,t,i){e=U6(e);const a=e.map(p=>({source:p,destination:t(p)})),d=s3(a,!0).map(p=>hg(p,t,i,0)).flat(1);return a3(d,!1)}function hg(e,t,i,a){const h=dR(e,t,i,a);return h?[hg([e[0],h],t,i,a+1),hg([h,e[1]],t,i,a+1)].flat(1):[e]}function dR(e,t,i,a){if(a>=i.maxDepth||i.maxDepth<=0)return;const{sourceMidPoint:h,destinationMidPointFromRefinementFunction:d,destinationMidPointsDistance:p,destinationLineDistance:s,destinationRefinedLineDistance:w}=fR(e,t,i);return pR({destinationMidPointsDistance:p,destinationLineDistance:s,destinationRefinedLineDistance:w},i)?{source:h,destination:d}:void 0}function fR(e,t,i){const a=i.sourceMidPointFunction(e[0].source,e[1].source),h=i.destinationMidPointFunction(e[0].destination,e[1].destination),d=t(a),p=i.destinationDistanceFunction(e[0].destination,e[1].destination),s=i.destinationDistanceFunction(t(e[0].source),t(e[1].source)),w=i.destinationDistanceFunction(h,d);return{sourceMidPoint:a,destinationMidPointFromRefinementFunction:d,destinationMidPointsDistance:w,destinationLineDistance:p,destinationRefinedLineDistance:s}}function pR({destinationMidPointsDistance:e,destinationLineDistance:t,destinationRefinedLineDistance:i},a){return e/t>a.minOffsetRatio||e>a.minOffsetDistance||i>a.minLineDistance}function Z2(e,t,i){const a=wo(e),h=a[2],d=a[3],p=a[1],s=a[0],w=i.sourceMidPointFunction(h,p),A=i.sourceMidPointFunction(d,s),z=i.sourceMidPointFunction(h,d),B=i.sourceMidPointFunction(p,s),D=[w,A],V=[z,B],W=cg(D,t,i).map(re=>re.source),S=cg(V,t,i).map(re=>re.source);if(W.length===2&&S.length===2)return;const j=[];for(let re=0;re<W.length-1;re++)j.push(ah(W[re],W[re+1]));const ne=Math.sqrt(Math.min(...j)),te=[];for(let re=0;re<S.length-1;re++)te.push(ah(S[re],S[re+1]));const Q=Math.sqrt(Math.min(...te));return Math.min(ne,Q)}function s3(e,t=!1){const i=e.length-(t?0:1),a=[];for(let h=0;h<i;h++)a.push([e[h],e[(h+1)%e.length]]);return a}function a3(e,t=!1){const i=e.map(a=>a[0]);return t&&i.push(e[e.length-1][1]),i}const o3={maxDepth:0,minOffsetRatio:0,minOffsetDistance:1/0,minLineDistance:1/0,sourceIsGeographic:!1,destinationIsGeographic:!1,isMultiGeometry:!1,distortionMeasures:[],referenceScale:1,preForward:e=>e,postForward:e=>e,preBackward:e=>e,postBackward:e=>e},l3={differentHandedness:!1,...o3};function Ff(e){if(e===void 0)return{};const t=e;return e.geoIsGeographic&&(t.destinationIsGeographic=e.geoIsGeographic),e.postToGeo&&(t.postForward=e.postToGeo),e.preToResource&&(t.preBackward=e.preToResource),t}function O2(e){return e===void 0?{}:Ff(e)}function mR(e){if(e===void 0)return{};const t=e;return e.postForward&&(t.postToGeo=e.postForward),e.preBackward&&(t.preToResource=e.preBackward),t}function gR(e){return e??{}}mR(o3);const c3=gR(l3);function W_(e){const t=zi(n3,{minOffsetRatio:e.minOffsetRatio,minOffsetDistance:e.minOffsetDistance,minLineDistance:e.minLineDistance,maxDepth:e.maxDepth});return e.sourceIsGeographic&&(t.sourceMidPointFunction=(i,a)=>eg(i,a).geometry.coordinates),e.destinationIsGeographic&&(t.destinationMidPointFunction=(i,a)=>eg(i,a).geometry.coordinates,t.destinationDistanceFunction=U8),t}function X_(e){const t=zi(n3,{minOffsetRatio:e.minOffsetRatio,minOffsetDistance:e.minOffsetDistance,minLineDistance:e.minLineDistance,maxDepth:e.maxDepth});return e.destinationIsGeographic&&(t.sourceMidPointFunction=(i,a)=>eg(i,a).geometry.coordinates),e.sourceIsGeographic&&(t.destinationMidPointFunction=(i,a)=>eg(i,a).geometry.coordinates,t.destinationDistanceFunction=U8),t}function N2(e){return{source:e.destination,destination:e.source}}function U2(e){return e.destination}function H2(e){return e.source}function _R(e){return e.geo}function vR(e){return e.resource}function q_(e){return{resource:e.source,geo:e.destination,partialDerivativeX:e.partialDerivativeX,partialDerivativeY:e.partialDerivativeY,distortions:e.distortions,distortion:e.distortion}}function yR(e){return{source:e.resource,destination:e.geo,partialDerivativeX:e.partialDerivativeX,partialDerivativeY:e.partialDerivativeY,distortions:e.distortions,distortion:e.distortion}}class bR{constructor(t,i="polynomial",a){Ke(this,"generalGcpsInternal");Ke(this,"sourcePointsInternal");Ke(this,"destinationPointsInternal");Ke(this,"type");Ke(this,"transformerOptions");Ke(this,"forwardTransformation");Ke(this,"backwardTransformation");if(this.transformerOptions=zi(l3,a),t.length===0)throw new Error("No control points");this.generalGcpsInternal=t,this.sourcePointsInternal=this.generalGcpsInternal.map(h=>{const d=this.transformerOptions.differentHandedness?xf(h.source):h.source;return this.transformerOptions.preForward(d)}),this.destinationPointsInternal=this.generalGcpsInternal.map(h=>this.transformerOptions.preBackward(h.destination)),this.type=i}getForwardTransformationInternal(){return this.forwardTransformation||(this.forwardTransformation=this.createTransformation(this.sourcePointsInternal,this.destinationPointsInternal)),this.forwardTransformation}getBackwardTransformationInternal(){return this.backwardTransformation||(this.backwardTransformation=this.createTransformation(this.destinationPointsInternal,this.sourcePointsInternal)),this.backwardTransformation}createTransformation(t,i){if(this.type==="straight")return new lR(t,i);if(this.type==="helmert")return new r3(t,i);if(this.type==="polynomial1"||this.type==="polynomial")return new cp(t,i);if(this.type==="polynomial2")return new Dy(t,i);if(this.type==="polynomial3")return new By(t,i);if(this.type==="projective")return new cR(t,i);if(this.type==="thinPlateSpline")return new G2(t,i,uR,V2,"thinPlateSpline");if(this.type==="linear")return new G2(t,i,hR,V2,"linear");throw new Error(`Unsupported transformation type: ${this.type}`)}getForwardTransformationResolutionInternal(t,i){const a=zi(this.transformerOptions,i);return Z2(t,h=>this.transformForwardInternal(h,a),W_(a))}getBackwardTransformationResolutionInternal(t,i){const a=zi(this.transformerOptions,i);return Z2(t,h=>this.transformBackwardInternal(h,a),X_(a))}transformForwardInternal(t,i,a=U2){const h=zi(this.transformerOptions,i);if(h.isMultiGeometry){if(i&&(i.isMultiGeometry=!1),b2(t))return t.map(d=>this.transformForwardInternal(d,i,a));if(w2(t))return t.map(d=>this.transformForwardInternal(d,i,a));if(Lv(t))return t.map(d=>this.transformForwardInternal(d,i,a));throw new Error("Geometry type not supported")}else{if(Kl(t))return this.transformPointForwardInternal(t,h,a);if(sp(t))return this.transformLineStringForwardInternal(t,h,a);if(Ju(t))return this.transformPolygonForwardInternal(t,h,a);throw new Error("Geometry type not supported")}}transformBackwardInternal(t,i,a=H2){const h=zi(this.transformerOptions,i);if(h.isMultiGeometry){if(i&&(i.isMultiGeometry=!1),b2(t))return t.map(d=>this.transformBackwardInternal(d,i,a));if(w2(t))return t.map(d=>this.transformBackwardInternal(d,i,a));if(Lv(t))return t.map(d=>this.transformBackwardInternal(d,i,a));throw new Error("Geometry type not supported")}else{if(Kl(t))return this.transformPointBackwardInternal(t,h,a);if(sp(t))return this.transformLineStringBackwardInternal(t,h,a);if(Ju(t))return this.transformPolygonBackwardInternal(t,h,a);throw new Error("Geometry type not supported")}}transformPointForwardInternal(t,i,a=U2){const h=this.getForwardTransformationInternal();let d=this.transformerOptions.differentHandedness?xf(t):t;d=i.preForward(d);let p=h.evaluateFunction(d);p=i.postForward(p);let s,w,A=new Map;return i.distortionMeasures.length>0&&(s=h.evaluatePartialDerivativeX(d),w=h.evaluatePartialDerivativeY(d),A=F2(i.distortionMeasures,s,w,i.referenceScale)),a({source:t,destination:p,partialDerivativeX:s,partialDerivativeY:w,distortions:A})}transformPointBackwardInternal(t,i,a=H2){const h=this.getBackwardTransformationInternal(),d=i.preBackward(t);let p=h.evaluateFunction(d);p=i.postBackward(p),p=this.transformerOptions.differentHandedness?xf(p):p;let s,w,A=new Map;return i.distortionMeasures.length>0&&(s=h.evaluatePartialDerivativeX(d),s=this.transformerOptions.differentHandedness?xf(s):s,w=h.evaluatePartialDerivativeY(d),w=this.transformerOptions.differentHandedness?xf(w):w,A=F2(i.distortionMeasures,s,w,i.referenceScale)),a({source:p,destination:d,partialDerivativeX:s,partialDerivativeY:w,distortions:A})}transformLineStringForwardInternal(t,i,a){return cg(t,h=>this.transformPointForwardInternal(h,i),W_(i)).map(h=>a(h))}transformLineStringBackwardInternal(t,i,a){return cg(t,h=>this.transformPointBackwardInternal(h,i),X_(i)).map(h=>a(N2(h)))}transformRingForwardInternal(t,i,a){return j2(t,h=>this.transformPointForwardInternal(h,i),W_(i)).map(h=>a(h))}transformRingBackwardInternal(t,i,a){return j2(t,h=>this.transformPointBackwardInternal(h,i),X_(i)).map(h=>a(N2(h)))}transformPolygonForwardInternal(t,i,a){return t.map(h=>this.transformRingForwardInternal(h,i,a))}transformPolygonBackwardInternal(t,i,a){return t.map(h=>this.transformRingBackwardInternal(h,i,a))}}class Gy extends bR{constructor(t,i="polynomial",a){const h=t.filter(d=>d.geo&&d.resource).map(yR);a=ls({differentHandedness:!0},a),super(h,i,O2(a))}get gcps(){return this.generalGcpsInternal.map(q_)}getToGeoTransformation(){return super.getForwardTransformationInternal()}getToResourceTransformation(){return super.getBackwardTransformationInternal()}getToGeoTransformationResolution(t,i){const a=Ff(i);return super.getForwardTransformationResolutionInternal(t,a)}getToResourceTransformationResolution(t,i){const a=Ff(i);return super.getBackwardTransformationResolutionInternal(t,a)}getTransformerOptions(){return this.transformerOptions}setTransformerOptionsInternal(t){this.transformerOptions=zi(this.transformerOptions,O2(t))}transformToGeo(t,i,a=_R){const h=p=>a(q_(p)),d=i?Ff(i):void 0;return super.transformForwardInternal(t,d,h)}transformToResource(t,i,a=vR){const h=p=>a(q_(p)),d=i?Ff(i):void 0;return super.transformBackwardInternal(t,d,h)}static transformSvgToGeojson(t,i,a){a=ls({geoIsGeographic:!0},a);const h=t.transformToGeo(jk(i),a);return I9(h)}static transformSvgStringToGeojsonFeatureCollection(t,i,a){const h=[];for(const d of Dk(i)){const p=this.transformSvgToGeojson(t,d,a);h.push(p)}return Q9(h)}static transformGeojsonToSvg(t,i,a){a=ls({geoIsGeographic:!0},a);const h=t.transformToResource(q6(i),a);return S9(h)}static transformGeojsonFeatureCollectionToSvgString(t,i,a){const h=[];for(const d of tk(i)){const p=this.transformGeojsonToSvg(t,d,a);h.push(p)}return Gk(h)}static fromGeoreferencedMap(t,i){var a;return new Gy(t.gcps,(i==null?void 0:i.transformationType)||((a=t.transformation)==null?void 0:a.type),i)}}function wR(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)e("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");e("EPSG:5041","+title=WGS 84 / UPS North (E,N) +proj=stere +lat_0=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),e("EPSG:5042","+title=WGS 84 / UPS South (E,N) +proj=stere +lat_0=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +datum=WGS84 +units=m"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}var oh=1,lh=2,Vu=3,xR=4,Ov=5,W2=6378137,MR=6356752314e-3,X2=.0066943799901413165,qf=484813681109536e-20,rr=Math.PI/2,IR=.16666666666666666,AR=.04722222222222222,TR=.022156084656084655,vr=1e-10,Rn=.017453292519943295,qs=57.29577951308232,Ui=Math.PI/4,hp=Math.PI*2,gs=3.14159265359,Ks={};Ks.greenwich=0;Ks.lisbon=-9.131906111111;Ks.paris=2.337229166667;Ks.bogota=-74.080916666667;Ks.madrid=-3.687938888889;Ks.rome=12.452333333333;Ks.bern=7.439583333333;Ks.jakarta=106.807719444444;Ks.ferro=-17.666666666667;Ks.brussels=4.367975;Ks.stockholm=18.058277777778;Ks.athens=23.7163375;Ks.oslo=10.722916666667;const CR={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var q2=/[\s_\-\/\(\)]/g;function Jl(e,t){if(e[t])return e[t];for(var i=Object.keys(e),a=t.toLowerCase().replace(q2,""),h=-1,d,p;++h<i.length;)if(d=i[h],p=d.toLowerCase().replace(q2,""),p===a)return e[d]}function Nv(e){var t={},i=e.split("+").map(function(s){return s.trim()}).filter(function(s){return s}).reduce(function(s,w){var A=w.split("=");return A.push(!0),s[A[0].toLowerCase()]=A[1],s},{}),a,h,d,p={proj:"projName",datum:"datumCode",rf:function(s){t.rf=parseFloat(s)},lat_0:function(s){t.lat0=s*Rn},lat_1:function(s){t.lat1=s*Rn},lat_2:function(s){t.lat2=s*Rn},lat_ts:function(s){t.lat_ts=s*Rn},lon_0:function(s){t.long0=s*Rn},lon_1:function(s){t.long1=s*Rn},lon_2:function(s){t.long2=s*Rn},alpha:function(s){t.alpha=parseFloat(s)*Rn},gamma:function(s){t.rectified_grid_angle=parseFloat(s)*Rn},lonc:function(s){t.longc=s*Rn},x_0:function(s){t.x0=parseFloat(s)},y_0:function(s){t.y0=parseFloat(s)},k_0:function(s){t.k0=parseFloat(s)},k:function(s){t.k0=parseFloat(s)},a:function(s){t.a=parseFloat(s)},b:function(s){t.b=parseFloat(s)},r:function(s){t.a=t.b=parseFloat(s)},r_a:function(){t.R_A=!0},zone:function(s){t.zone=parseInt(s,10)},south:function(){t.utmSouth=!0},towgs84:function(s){t.datum_params=s.split(",").map(function(w){return parseFloat(w)})},to_meter:function(s){t.to_meter=parseFloat(s)},units:function(s){t.units=s;var w=Jl(CR,s);w&&(t.to_meter=w.to_meter)},from_greenwich:function(s){t.from_greenwich=s*Rn},pm:function(s){var w=Jl(Ks,s);t.from_greenwich=(w||parseFloat(s))*Rn},nadgrids:function(s){s==="@null"?t.datumCode="none":t.nadgrids=s},axis:function(s){var w="ewnsud";s.length===3&&w.indexOf(s.substr(0,1))!==-1&&w.indexOf(s.substr(1,1))!==-1&&w.indexOf(s.substr(2,1))!==-1&&(t.axis=s)},approx:function(){t.approx=!0},over:function(){t.over=!0}};for(a in i)h=i[a],a in p?(d=p[a],typeof d=="function"?d(h):t[d]=h):t[a]=h;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t.projStr=e,t}class h3{static getId(t){const i=t.find(a=>Array.isArray(a)&&a[0]==="ID");return i&&i.length>=3?{authority:i[1],code:parseInt(i[2],10)}:null}static convertUnit(t,i="unit"){if(!t||t.length<3)return{type:i,name:"unknown",conversion_factor:null};const a=t[1],h=parseFloat(t[2])||null,d=t.find(s=>Array.isArray(s)&&s[0]==="ID"),p=d?{authority:d[1],code:parseInt(d[2],10)}:null;return{type:i,name:a,conversion_factor:h,id:p}}static convertAxis(t){const i=t[1]||"Unknown";let a;const h=i.match(/^\((.)\)$/);if(h){const A=h[1].toUpperCase();if(A==="E")a="east";else if(A==="N")a="north";else if(A==="U")a="up";else throw new Error(`Unknown axis abbreviation: ${A}`)}else a=t[2]?t[2].toLowerCase():"unknown";const d=t.find(A=>Array.isArray(A)&&A[0]==="ORDER"),p=d?parseInt(d[1],10):null,s=t.find(A=>Array.isArray(A)&&(A[0]==="LENGTHUNIT"||A[0]==="ANGLEUNIT"||A[0]==="SCALEUNIT")),w=this.convertUnit(s);return{name:i,direction:a,unit:w,order:p}}static extractAxes(t){return t.filter(i=>Array.isArray(i)&&i[0]==="AXIS").map(i=>this.convertAxis(i)).sort((i,a)=>(i.order||0)-(a.order||0))}static convert(t,i={}){switch(t[0]){case"PROJCRS":i.type="ProjectedCRS",i.name=t[1],i.base_crs=t.find(D=>Array.isArray(D)&&D[0]==="BASEGEOGCRS")?this.convert(t.find(D=>Array.isArray(D)&&D[0]==="BASEGEOGCRS")):null,i.conversion=t.find(D=>Array.isArray(D)&&D[0]==="CONVERSION")?this.convert(t.find(D=>Array.isArray(D)&&D[0]==="CONVERSION")):null;const a=t.find(D=>Array.isArray(D)&&D[0]==="CS");a&&(i.coordinate_system={type:a[1],axis:this.extractAxes(t)});const h=t.find(D=>Array.isArray(D)&&D[0]==="LENGTHUNIT");if(h){const D=this.convertUnit(h);i.coordinate_system.unit=D}i.id=this.getId(t);break;case"BASEGEOGCRS":case"GEOGCRS":i.type="GeographicCRS",i.name=t[1];const d=t.find(D=>Array.isArray(D)&&(D[0]==="DATUM"||D[0]==="ENSEMBLE"));if(d){const D=this.convert(d);d[0]==="ENSEMBLE"?i.datum_ensemble=D:i.datum=D;const V=t.find(W=>Array.isArray(W)&&W[0]==="PRIMEM");V&&V[1]!=="Greenwich"&&(D.prime_meridian={name:V[1],longitude:parseFloat(V[2])})}i.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(t)},i.id=this.getId(t);break;case"DATUM":i.type="GeodeticReferenceFrame",i.name=t[1],i.ellipsoid=t.find(D=>Array.isArray(D)&&D[0]==="ELLIPSOID")?this.convert(t.find(D=>Array.isArray(D)&&D[0]==="ELLIPSOID")):null;break;case"ENSEMBLE":i.type="DatumEnsemble",i.name=t[1],i.members=t.filter(D=>Array.isArray(D)&&D[0]==="MEMBER").map(D=>({type:"DatumEnsembleMember",name:D[1],id:this.getId(D)}));const p=t.find(D=>Array.isArray(D)&&D[0]==="ENSEMBLEACCURACY");p&&(i.accuracy=parseFloat(p[1]));const s=t.find(D=>Array.isArray(D)&&D[0]==="ELLIPSOID");s&&(i.ellipsoid=this.convert(s)),i.id=this.getId(t);break;case"ELLIPSOID":i.type="Ellipsoid",i.name=t[1],i.semi_major_axis=parseFloat(t[2]),i.inverse_flattening=parseFloat(t[3]),t.find(D=>Array.isArray(D)&&D[0]==="LENGTHUNIT")&&this.convert(t.find(D=>Array.isArray(D)&&D[0]==="LENGTHUNIT"),i);break;case"CONVERSION":i.type="Conversion",i.name=t[1],i.method=t.find(D=>Array.isArray(D)&&D[0]==="METHOD")?this.convert(t.find(D=>Array.isArray(D)&&D[0]==="METHOD")):null,i.parameters=t.filter(D=>Array.isArray(D)&&D[0]==="PARAMETER").map(D=>this.convert(D));break;case"METHOD":i.type="Method",i.name=t[1],i.id=this.getId(t);break;case"PARAMETER":i.type="Parameter",i.name=t[1],i.value=parseFloat(t[2]),i.unit=this.convertUnit(t.find(D=>Array.isArray(D)&&(D[0]==="LENGTHUNIT"||D[0]==="ANGLEUNIT"||D[0]==="SCALEUNIT"))),i.id=this.getId(t);break;case"BOUNDCRS":i.type="BoundCRS";const w=t.find(D=>Array.isArray(D)&&D[0]==="SOURCECRS");if(w){const D=w.find(V=>Array.isArray(V));i.source_crs=D?this.convert(D):null}const A=t.find(D=>Array.isArray(D)&&D[0]==="TARGETCRS");if(A){const D=A.find(V=>Array.isArray(V));i.target_crs=D?this.convert(D):null}const z=t.find(D=>Array.isArray(D)&&D[0]==="ABRIDGEDTRANSFORMATION");z?i.transformation=this.convert(z):i.transformation=null;break;case"ABRIDGEDTRANSFORMATION":if(i.type="Transformation",i.name=t[1],i.method=t.find(D=>Array.isArray(D)&&D[0]==="METHOD")?this.convert(t.find(D=>Array.isArray(D)&&D[0]==="METHOD")):null,i.parameters=t.filter(D=>Array.isArray(D)&&(D[0]==="PARAMETER"||D[0]==="PARAMETERFILE")).map(D=>{if(D[0]==="PARAMETER")return this.convert(D);if(D[0]==="PARAMETERFILE")return{name:D[1],value:D[2],id:{authority:"EPSG",code:8656}}}),i.parameters.length===7){const D=i.parameters[6];D.name==="Scale difference"&&(D.value=Math.round((D.value-1)*1e12)/1e6)}i.id=this.getId(t);break;case"AXIS":i.coordinate_system||(i.coordinate_system={type:"unspecified",axis:[]}),i.coordinate_system.axis.push(this.convertAxis(t));break;case"LENGTHUNIT":const B=this.convertUnit(t,"LinearUnit");i.coordinate_system&&i.coordinate_system.axis&&i.coordinate_system.axis.forEach(D=>{D.unit||(D.unit=B)}),B.conversion_factor&&B.conversion_factor!==1&&i.semi_major_axis&&(i.semi_major_axis={value:i.semi_major_axis,unit:B});break;default:i.keyword=t[0];break}return i}}class SR extends h3{static convert(t,i={}){return super.convert(t,i),i.coordinate_system&&i.coordinate_system.subtype==="Cartesian"&&delete i.coordinate_system,i.usage&&delete i.usage,i}}class PR extends h3{static convert(t,i={}){super.convert(t,i);const a=t.find(d=>Array.isArray(d)&&d[0]==="CS");a&&(i.coordinate_system={subtype:a[1],axis:this.extractAxes(t)});const h=t.find(d=>Array.isArray(d)&&d[0]==="USAGE");if(h){const d=h.find(w=>Array.isArray(w)&&w[0]==="SCOPE"),p=h.find(w=>Array.isArray(w)&&w[0]==="AREA"),s=h.find(w=>Array.isArray(w)&&w[0]==="BBOX");i.usage={},d&&(i.usage.scope=d[1]),p&&(i.usage.area=p[1]),s&&(i.usage.bbox=s.slice(1))}return i}}function ER(e){return e.find(t=>Array.isArray(t)&&t[0]==="USAGE")?"2019":(e.find(t=>Array.isArray(t)&&t[0]==="CS")||e[0]==="BOUNDCRS"||e[0]==="PROJCRS"||e[0]==="GEOGCRS","2015")}function kR(e){return(ER(e)==="2019"?PR:SR).convert(e)}function RR(e){const t=e.toUpperCase();return t.includes("PROJCRS")||t.includes("GEOGCRS")||t.includes("BOUNDCRS")||t.includes("VERTCRS")||t.includes("LENGTHUNIT")||t.includes("ANGLEUNIT")||t.includes("SCALEUNIT")?"WKT2":(t.includes("PROJCS")||t.includes("GEOGCS")||t.includes("LOCAL_CS")||t.includes("VERT_CS")||t.includes("UNIT"),"WKT1")}var up=1,u3=2,d3=3,ug=4,f3=5,Vy=-1,LR=/\s/,zR=/[A-Za-z]/,FR=/[A-Za-z84_]/,$g=/[,\]]/,p3=/[\d\.E\-\+]/;function bl(e){if(typeof e!="string")throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=up}bl.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==ug)for(;LR.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case up:return this.neutral(e);case u3:return this.keyword(e);case ug:return this.quoted(e);case f3:return this.afterquote(e);case d3:return this.number(e);case Vy:return}};bl.prototype.afterquote=function(e){if(e==='"'){this.word+='"',this.state=ug;return}if($g.test(e)){this.word=this.word.trim(),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in afterquote yet, index '+this.place)};bl.prototype.afterItem=function(e){if(e===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=up;return}if(e==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=up,this.currentObject=this.stack.pop(),this.currentObject||(this.state=Vy);return}};bl.prototype.number=function(e){if(p3.test(e)){this.word+=e;return}if($g.test(e)){this.word=parseFloat(this.word),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in number yet, index '+this.place)};bl.prototype.quoted=function(e){if(e==='"'){this.state=f3;return}this.word+=e};bl.prototype.keyword=function(e){if(FR.test(e)){this.word+=e;return}if(e==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=up;return}if($g.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in keyword yet, index '+this.place)};bl.prototype.neutral=function(e){if(zR.test(e)){this.word=e,this.state=u3;return}if(e==='"'){this.word="",this.state=ug;return}if(p3.test(e)){this.word=e,this.state=d3;return}if($g.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in neutral yet, index '+this.place)};bl.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Vy)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function DR(e){var t=new bl(e);return t.output()}function Y_(e,t,i){Array.isArray(t)&&(i.unshift(t),t=null);var a=t?{}:e,h=i.reduce(function(d,p){return Eu(p,d),d},a);t&&(e[t]=h)}function Eu(e,t){if(!Array.isArray(e)){t[e]=!0;return}var i=e.shift();if(i==="PARAMETER"&&(i=e.shift()),e.length===1){if(Array.isArray(e[0])){t[i]={},Eu(e[0],t[i]);return}t[i]=e[0];return}if(!e.length){t[i]=!0;return}if(i==="TOWGS84"){t[i]=e;return}if(i==="AXIS"){i in t||(t[i]=[]),t[i].push(e);return}Array.isArray(i)||(t[i]={});var a;switch(i){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[i]={name:e[0].toLowerCase(),convert:e[1]},e.length===3&&Eu(e[2],t[i]);return;case"SPHEROID":case"ELLIPSOID":t[i]={name:e[0],a:e[1],rf:e[2]},e.length===4&&Eu(e[3],t[i]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":e[0]=["name",e[0]],Y_(t,i,e);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":e[0]=["name",e[0]],Y_(t,i,e),t[i].type=i;return;default:for(a=-1;++a<e.length;)if(!Array.isArray(e[a]))return Eu(e,t[i]);return Y_(t,i,e)}}var BR=.017453292519943295;function ja(e){return e*BR}function m3(e){const t=(e.projName||"").toLowerCase().replace(/_/g," ");!e.long0&&e.longc&&(t==="albers conic equal area"||t==="lambert azimuthal equal area")&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&(t==="stereographic south pole"||t==="polar stereographic (variant b)")?(e.lat0=ja(e.lat1>0?90:-90),e.lat_ts=e.lat1,delete e.lat1):!e.lat_ts&&e.lat0&&(t==="polar stereographic"||t==="polar stereographic (variant a)")&&(e.lat_ts=e.lat0,e.lat0=ja(e.lat0>0?90:-90),delete e.lat1)}function Y2(e){let t={units:null,to_meter:void 0};return typeof e=="string"?(t.units=e.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.units==="meter"&&(t.to_meter=1)):e&&e.name&&(t.units=e.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.to_meter=e.conversion_factor),t}function K2(e){return typeof e=="object"?e.value*e.unit.conversion_factor:e}function $2(e,t){e.ellipsoid.radius?(t.a=e.ellipsoid.radius,t.rf=0):(t.a=K2(e.ellipsoid.semi_major_axis),e.ellipsoid.inverse_flattening!==void 0?t.rf=e.ellipsoid.inverse_flattening:e.ellipsoid.semi_major_axis!==void 0&&e.ellipsoid.semi_minor_axis!==void 0&&(t.rf=t.a/(t.a-K2(e.ellipsoid.semi_minor_axis))))}function dg(e,t={}){return!e||typeof e!="object"?e:e.type==="BoundCRS"?(dg(e.source_crs,t),e.transformation&&(e.transformation.method&&e.transformation.method.name==="NTv2"?t.nadgrids=e.transformation.parameters[0].value:t.datum_params=e.transformation.parameters.map(i=>i.value)),t):(Object.keys(e).forEach(i=>{const a=e[i];if(a!==null)switch(i){case"name":if(t.srsCode)break;t.name=a,t.srsCode=a;break;case"type":a==="GeographicCRS"?t.projName="longlat":a==="ProjectedCRS"&&e.conversion&&e.conversion.method&&(t.projName=e.conversion.method.name);break;case"datum":case"datum_ensemble":a.ellipsoid&&(t.ellps=a.ellipsoid.name,$2(a,t)),a.prime_meridian&&(t.from_greenwich=a.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":t.ellps=a.name,$2(a,t);break;case"prime_meridian":t.long0=(a.longitude||0)*Math.PI/180;break;case"coordinate_system":if(a.axis){if(t.axis=a.axis.map(h=>{const d=h.direction;if(d==="east")return"e";if(d==="north")return"n";if(d==="west")return"w";if(d==="south")return"s";throw new Error(`Unknown axis direction: ${d}`)}).join("")+"u",a.unit){const{units:h,to_meter:d}=Y2(a.unit);t.units=h,t.to_meter=d}else if(a.axis[0]&&a.axis[0].unit){const{units:h,to_meter:d}=Y2(a.axis[0].unit);t.units=h,t.to_meter=d}}break;case"id":a.authority&&a.code&&(t.title=a.authority+":"+a.code);break;case"conversion":a.method&&a.method.name&&(t.projName=a.method.name),a.parameters&&a.parameters.forEach(h=>{const d=h.name.toLowerCase().replace(/\s+/g,"_"),p=h.value;h.unit&&h.unit.conversion_factor?t[d]=p*h.unit.conversion_factor:h.unit==="degree"?t[d]=p*Math.PI/180:t[d]=p});break;case"unit":a.name&&(t.units=a.name.toLowerCase(),t.units==="metre"&&(t.units="meter")),a.conversion_factor&&(t.to_meter=a.conversion_factor);break;case"base_crs":dg(a,t),t.datumCode=a.id?a.id.authority+"_"+a.id.code:a.name;break}}),t.latitude_of_false_origin!==void 0&&(t.lat0=t.latitude_of_false_origin),t.longitude_of_false_origin!==void 0&&(t.long0=t.longitude_of_false_origin),t.latitude_of_standard_parallel!==void 0&&(t.lat0=t.latitude_of_standard_parallel,t.lat1=t.latitude_of_standard_parallel),t.latitude_of_1st_standard_parallel!==void 0&&(t.lat1=t.latitude_of_1st_standard_parallel),t.latitude_of_2nd_standard_parallel!==void 0&&(t.lat2=t.latitude_of_2nd_standard_parallel),t.latitude_of_projection_centre!==void 0&&(t.lat0=t.latitude_of_projection_centre),t.longitude_of_projection_centre!==void 0&&(t.longc=t.longitude_of_projection_centre),t.easting_at_false_origin!==void 0&&(t.x0=t.easting_at_false_origin),t.northing_at_false_origin!==void 0&&(t.y0=t.northing_at_false_origin),t.latitude_of_natural_origin!==void 0&&(t.lat0=t.latitude_of_natural_origin),t.longitude_of_natural_origin!==void 0&&(t.long0=t.longitude_of_natural_origin),t.longitude_of_origin!==void 0&&(t.long0=t.longitude_of_origin),t.false_easting!==void 0&&(t.x0=t.false_easting),t.easting_at_projection_centre&&(t.x0=t.easting_at_projection_centre),t.false_northing!==void 0&&(t.y0=t.false_northing),t.northing_at_projection_centre&&(t.y0=t.northing_at_projection_centre),t.standard_parallel_1!==void 0&&(t.lat1=t.standard_parallel_1),t.standard_parallel_2!==void 0&&(t.lat2=t.standard_parallel_2),t.scale_factor_at_natural_origin!==void 0&&(t.k0=t.scale_factor_at_natural_origin),t.scale_factor_at_projection_centre!==void 0&&(t.k0=t.scale_factor_at_projection_centre),t.scale_factor_on_pseudo_standard_parallel!==void 0&&(t.k0=t.scale_factor_on_pseudo_standard_parallel),t.azimuth!==void 0&&(t.alpha=t.azimuth),t.azimuth_at_projection_centre!==void 0&&(t.alpha=t.azimuth_at_projection_centre),t.angle_from_rectified_to_skew_grid&&(t.rectified_grid_angle=t.angle_from_rectified_to_skew_grid),m3(t),t)}var GR=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function VR(e,t){var i=t[0],a=t[1];!(i in e)&&a in e&&(e[i]=e[a],t.length===3&&(e[i]=t[2](e[i])))}function g3(e){for(var t=Object.keys(e),i=0,a=t.length;i<a;++i){var h=t[i];GR.indexOf(h)!==-1&&jR(e[h]),typeof e[h]=="object"&&g3(e[h])}}function jR(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if(e.type==="GEOGCS"?e.projName="longlat":e.type==="LOCAL_CS"?(e.projName="identity",e.local=!0):typeof e.PROJECTION=="object"?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var i="",a=0,h=e.AXIS.length;a<h;++a){var d=[e.AXIS[a][0].toLowerCase(),e.AXIS[a][1].toLowerCase()];d[0].indexOf("north")!==-1||(d[0]==="y"||d[0]==="lat")&&d[1]==="north"?i+="n":d[0].indexOf("south")!==-1||(d[0]==="y"||d[0]==="lat")&&d[1]==="south"?i+="s":d[0].indexOf("east")!==-1||(d[0]==="x"||d[0]==="lon")&&d[1]==="east"?i+="e":(d[0].indexOf("west")!==-1||(d[0]==="x"||d[0]==="lon")&&d[1]==="west")&&(i+="w")}i.length===2&&(i+="u"),i.length===3&&(e.axis=i)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.UNIT.convert&&(e.type==="GEOGCS"?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var p=e.GEOGCS;e.type==="GEOGCS"&&(p=e),p&&(p.DATUM?e.datumCode=p.DATUM.name.toLowerCase():e.datumCode=p.name.toLowerCase(),e.datumCode.slice(0,2)==="d_"&&(e.datumCode=e.datumCode.slice(2)),e.datumCode==="new_zealand_1949"&&(e.datumCode="nzgd49"),(e.datumCode==="wgs_1984"||e.datumCode==="world_geodetic_system_1984")&&(e.PROJECTION==="Mercator_Auxiliary_Sphere"&&(e.sphere=!0),e.datumCode="wgs84"),e.datumCode==="belge_1972"&&(e.datumCode="rnb72"),p.DATUM&&p.DATUM.SPHEROID&&(e.ellps=p.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),e.ellps.toLowerCase().slice(0,13)==="international"&&(e.ellps="intl"),e.a=p.DATUM.SPHEROID.a,e.rf=parseFloat(p.DATUM.SPHEROID.rf,10)),p.DATUM&&p.DATUM.TOWGS84&&(e.datum_params=p.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),e.datumCode==="ch1903+"&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),e.rectified_grid_angle&&(e.rectified_grid_angle=ja(e.rectified_grid_angle));function s(z){var B=e.to_meter||1;return z*B}var w=function(z){return VR(e,z)},A=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",ja],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",ja],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",ja],["lat0","latitude_of_origin",ja],["lat0","standard_parallel_1",ja],["lat1","standard_parallel_1",ja],["lat2","standard_parallel_2",ja],["azimuth","Azimuth"],["alpha","azimuth",ja],["srsCode","name"]];A.forEach(w),m3(e)}function fg(e){if(typeof e=="object")return dg(e);const t=RR(e);var i=DR(e);if(t==="WKT2"){const d=kR(i);return dg(d)}var a=i[0],h={};return Eu(i,h),g3(h),h[a]}function ms(e){var t=this;if(arguments.length===2){var i=arguments[1];typeof i=="string"?i.charAt(0)==="+"?ms[e]=Nv(arguments[1]):ms[e]=fg(arguments[1]):i&&typeof i=="object"&&!("projName"in i)?ms[e]=fg(arguments[1]):(ms[e]=i,i||delete ms[e])}else if(arguments.length===1){if(Array.isArray(e))return e.map(function(a){return Array.isArray(a)?ms.apply(t,a):ms(a)});if(typeof e=="string"){if(e in ms)return ms[e]}else"EPSG"in e?ms["EPSG:"+e.EPSG]=e:"ESRI"in e?ms["ESRI:"+e.ESRI]=e:"IAU2000"in e?ms["IAU2000:"+e.IAU2000]=e:console.log(e);return}}wR(ms);function ZR(e){return typeof e=="string"}function OR(e){return e in ms}function NR(e){return e.indexOf("+")!==0&&e.indexOf("[")!==-1||typeof e=="object"&&!("srsCode"in e)}var UR=["3857","900913","3785","102113"];function HR(e){var t=Jl(e,"authority");if(t){var i=Jl(t,"epsg");return i&&UR.indexOf(i)>-1}}function WR(e){var t=Jl(e,"extension");if(t)return Jl(t,"proj4")}function XR(e){return e[0]==="+"}function qR(e){if(ZR(e)){if(OR(e))return ms[e];if(NR(e)){var t=fg(e);if(HR(t))return ms["EPSG:3857"];var i=WR(t);return i?Nv(i):t}if(XR(e))return Nv(e)}else return"projName"in e?e:fg(e)}function J2(e,t){e=e||{};var i,a;if(!t)return e;for(a in t)i=t[a],i!==void 0&&(e[a]=i);return e}function To(e,t,i){var a=e*t;return i/Math.sqrt(1-a*a)}function qp(e){return e<0?-1:1}function wr(e,t){return t||Math.abs(e)<=gs?e:e-qp(e)*hp}function Wa(e,t,i){var a=e*i,h=.5*e;return a=Math.pow((1-a)/(1+a),h),Math.tan(.5*(rr-t))/a}function dp(e,t){for(var i=.5*e,a,h,d=rr-2*Math.atan(t),p=0;p<=15;p++)if(a=e*Math.sin(d),h=rr-2*Math.atan(t*Math.pow((1-a)/(1+a),i))-d,d+=h,Math.abs(h)<=1e-10)return d;return-9999}function YR(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=To(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function KR(e){var t=e.x,i=e.y;if(i*qs>90&&i*qs<-90&&t*qs>180&&t*qs<-180)return null;var a,h;if(Math.abs(Math.abs(i)-rr)<=vr)return null;if(this.sphere)a=this.x0+this.a*this.k0*wr(t-this.long0,this.over),h=this.y0+this.a*this.k0*Math.log(Math.tan(Ui+.5*i));else{var d=Math.sin(i),p=Wa(this.e,i,d);a=this.x0+this.a*this.k0*wr(t-this.long0,this.over),h=this.y0-this.a*this.k0*Math.log(p)}return e.x=a,e.y=h,e}function $R(e){var t=e.x-this.x0,i=e.y-this.y0,a,h;if(this.sphere)h=rr-2*Math.atan(Math.exp(-i/(this.a*this.k0)));else{var d=Math.exp(-i/(this.a*this.k0));if(h=dp(this.e,d),h===-9999)return null}return a=wr(this.long0+t/(this.a*this.k0),this.over),e.x=a,e.y=h,e}var JR=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"];const QR={init:YR,forward:KR,inverse:$R,names:JR};function eL(){}function Q2(e){return e}var _3=["longlat","identity"];const tL={init:eL,forward:Q2,inverse:Q2,names:_3};var rL=[QR,tL],qc={},ku=[];function v3(e,t){var i=ku.length;return e.names?(ku[i]=e,e.names.forEach(function(a){qc[a.toLowerCase()]=i}),this):(console.log(t),!0)}function y3(e){return e.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}function iL(e){if(!e)return!1;var t=e.toLowerCase();if(typeof qc[t]<"u"&&ku[qc[t]]||(t=y3(t),t in qc&&ku[qc[t]]))return ku[qc[t]]}function nL(){rL.forEach(v3)}const sL={start:nL,add:v3,get:iL};var b3={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},andrae:{a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},clrk80:{a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};const aL=b3.WGS84;function oL(e,t,i,a){var h=e*e,d=t*t,p=(h-d)/h,s=0;a?(e*=1-p*(IR+p*(AR+p*TR)),h=e*e,p=0):s=Math.sqrt(p);var w=(h-d)/d;return{es:p,e:s,ep2:w}}function lL(e,t,i,a,h){if(!e){var d=Jl(b3,a);d||(d=aL),e=d.a,t=d.b,i=d.rf}return i&&!t&&(t=(1-1/i)*e),(i===0||Math.abs(e-t)<vr)&&(h=!0,t=e),{a:e,b:t,rf:i,sphere:h}}var Um={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var cL in Um){var K_=Um[cL];K_.datumName&&(Um[K_.datumName]=K_)}function hL(e,t,i,a,h,d,p){var s={};return e===void 0||e==="none"?s.datum_type=Ov:s.datum_type=xR,t&&(s.datum_params=t.map(parseFloat),(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0)&&(s.datum_type=oh),s.datum_params.length>3&&(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0)&&(s.datum_type=lh,s.datum_params[3]*=qf,s.datum_params[4]*=qf,s.datum_params[5]*=qf,s.datum_params[6]=s.datum_params[6]/1e6+1)),p&&(s.datum_type=Vu,s.grids=p),s.a=i,s.b=a,s.es=h,s.ep2=d,s}var jy={};function uL(e,t,i){return t instanceof ArrayBuffer?dL(e,t,i):{ready:fL(e,t)}}function dL(e,t,i){var a=!0;i!==void 0&&i.includeErrorFields===!1&&(a=!1);var h=new DataView(t),d=gL(h),p=_L(h,d),s=vL(h,p,d,a),w={header:p,subgrids:s};return jy[e]=w,w}async function fL(e,t){for(var i=[],a=await t.getImageCount(),h=a-1;h>=0;h--){var d=await t.getImage(h),p=await d.readRasters(),s=p,w=[d.getWidth(),d.getHeight()],A=d.getBoundingBox().map(e4),z=[d.fileDirectory.ModelPixelScale[0],d.fileDirectory.ModelPixelScale[1]].map(e4),B=A[0]+(w[0]-1)*z[0],D=A[3]-(w[1]-1)*z[1],V=s[0],W=s[1],S=[];for(let te=w[1]-1;te>=0;te--)for(let Q=w[0]-1;Q>=0;Q--){var j=te*w[0]+Q;S.push([-Ul(W[j]),Ul(V[j])])}i.push({del:z,lim:w,ll:[-B,D],cvs:S})}var ne={header:{nSubgrids:a},subgrids:i};return jy[e]=ne,ne}function pL(e){if(e===void 0)return null;var t=e.split(",");return t.map(mL)}function mL(e){if(e.length===0)return null;var t=e[0]==="@";return t&&(e=e.slice(1)),e==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:jy[e]||null,isNull:!1}}function e4(e){return e*Math.PI/180}function Ul(e){return e/3600*Math.PI/180}function gL(e){var t=e.getInt32(8,!1);return t===11?!1:(t=e.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function _L(e,t){return{nFields:e.getInt32(8,t),nSubgridFields:e.getInt32(24,t),nSubgrids:e.getInt32(40,t),shiftType:Uv(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,t),fromSemiMinorAxis:e.getFloat64(136,t),toSemiMajorAxis:e.getFloat64(152,t),toSemiMinorAxis:e.getFloat64(168,t)}}function Uv(e,t,i){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,i)))}function vL(e,t,i,a){for(var h=176,d=[],p=0;p<t.nSubgrids;p++){var s=bL(e,h,i),w=wL(e,h,s,i,a),A=Math.round(1+(s.upperLongitude-s.lowerLongitude)/s.longitudeInterval),z=Math.round(1+(s.upperLatitude-s.lowerLatitude)/s.latitudeInterval);d.push({ll:[Ul(s.lowerLongitude),Ul(s.lowerLatitude)],del:[Ul(s.longitudeInterval),Ul(s.latitudeInterval)],lim:[A,z],count:s.gridNodeCount,cvs:yL(w)});var B=16;a===!1&&(B=8),h+=176+s.gridNodeCount*B}return d}function yL(e){return e.map(function(t){return[Ul(t.longitudeShift),Ul(t.latitudeShift)]})}function bL(e,t,i){return{name:Uv(e,t+8,t+16).trim(),parent:Uv(e,t+24,t+24+8).trim(),lowerLatitude:e.getFloat64(t+72,i),upperLatitude:e.getFloat64(t+88,i),lowerLongitude:e.getFloat64(t+104,i),upperLongitude:e.getFloat64(t+120,i),latitudeInterval:e.getFloat64(t+136,i),longitudeInterval:e.getFloat64(t+152,i),gridNodeCount:e.getInt32(t+168,i)}}function wL(e,t,i,a,h){var d=t+176,p=16;h===!1&&(p=8);for(var s=[],w=0;w<i.gridNodeCount;w++){var A={latitudeShift:e.getFloat32(d+w*p,a),longitudeShift:e.getFloat32(d+w*p+4,a)};h!==!1&&(A.latitudeAccuracy=e.getFloat32(d+w*p+8,a),A.longitudeAccuracy=e.getFloat32(d+w*p+12,a)),s.push(A)}return s}function Aa(e,t){if(!(this instanceof Aa))return new Aa(e);this.forward=null,this.inverse=null,this.init=null,this.name,this.names=null,this.title,t=t||function(A){if(A)throw A};var i=qR(e);if(typeof i!="object"){t("Could not parse to valid json: "+e);return}var a=Aa.projections.get(i.projName);if(!a){t("Could not get projection name from: "+e);return}if(i.datumCode&&i.datumCode!=="none"){var h=Jl(Um,i.datumCode);h&&(i.datum_params=i.datum_params||(h.towgs84?h.towgs84.split(","):null),i.ellps=h.ellipse,i.datumName=h.datumName?h.datumName:i.datumCode)}i.k0=i.k0||1,i.axis=i.axis||"enu",i.ellps=i.ellps||"wgs84",i.lat1=i.lat1||i.lat0;var d=lL(i.a,i.b,i.rf,i.ellps,i.sphere),p=oL(d.a,d.b,d.rf,i.R_A),s=pL(i.nadgrids),w=i.datum||hL(i.datumCode,i.datum_params,d.a,d.b,p.es,p.ep2,s);J2(this,i),J2(this,a),this.a=d.a,this.b=d.b,this.rf=d.rf,this.sphere=d.sphere,this.es=p.es,this.e=p.e,this.ep2=p.ep2,this.datum=w,"init"in this&&typeof this.init=="function"&&this.init(),t(null,this)}Aa.projections=sL;Aa.projections.start();function xL(e,t){return e.datum_type!==t.datum_type||e.a!==t.a||Math.abs(e.es-t.es)>5e-11?!1:e.datum_type===oh?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type===lh?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6]:!0}function w3(e,t,i){var a=e.x,h=e.y,d=e.z?e.z:0,p,s,w,A;if(h<-rr&&h>-1.001*rr)h=-rr;else if(h>rr&&h<1.001*rr)h=rr;else{if(h<-rr)return{x:-1/0,y:-1/0,z:e.z};if(h>rr)return{x:1/0,y:1/0,z:e.z}}return a>Math.PI&&(a-=2*Math.PI),s=Math.sin(h),A=Math.cos(h),w=s*s,p=i/Math.sqrt(1-t*w),{x:(p+d)*A*Math.cos(a),y:(p+d)*A*Math.sin(a),z:(p*(1-t)+d)*s}}function x3(e,t,i,a){var h=1e-12,d=h*h,p=30,s,w,A,z,B,D,V,W,S,j,ne,te,Q,N=e.x,re=e.y,oe=e.z?e.z:0,ve,Pe,$;if(s=Math.sqrt(N*N+re*re),w=Math.sqrt(N*N+re*re+oe*oe),s/i<h){if(ve=0,w/i<h)return Pe=rr,$=-a,{x:e.x,y:e.y,z:e.z}}else ve=Math.atan2(re,N);A=oe/w,z=s/w,B=1/Math.sqrt(1-t*(2-t)*z*z),W=z*(1-t)*B,S=A*B,Q=0;do Q++,V=i/Math.sqrt(1-t*S*S),$=s*W+oe*S-V*(1-t*S*S),D=t*V/(V+$),B=1/Math.sqrt(1-D*(2-D)*z*z),j=z*(1-D)*B,ne=A*B,te=ne*W-j*S,W=j,S=ne;while(te*te>d&&Q<p);return Pe=Math.atan(ne/Math.abs(j)),{x:ve,y:Pe,z:$}}function ML(e,t,i){if(t===oh)return{x:e.x+i[0],y:e.y+i[1],z:e.z+i[2]};if(t===lh){var a=i[0],h=i[1],d=i[2],p=i[3],s=i[4],w=i[5],A=i[6];return{x:A*(e.x-w*e.y+s*e.z)+a,y:A*(w*e.x+e.y-p*e.z)+h,z:A*(-s*e.x+p*e.y+e.z)+d}}}function IL(e,t,i){if(t===oh)return{x:e.x-i[0],y:e.y-i[1],z:e.z-i[2]};if(t===lh){var a=i[0],h=i[1],d=i[2],p=i[3],s=i[4],w=i[5],A=i[6],z=(e.x-a)/A,B=(e.y-h)/A,D=(e.z-d)/A;return{x:z+w*B-s*D,y:-w*z+B+p*D,z:s*z-p*B+D}}}function bm(e){return e===oh||e===lh}function AL(e,t,i){if(xL(e,t)||e.datum_type===Ov||t.datum_type===Ov)return i;var a=e.a,h=e.es;if(e.datum_type===Vu){var d=t4(e,!1,i);if(d!==0)return;a=W2,h=X2}var p=t.a,s=t.b,w=t.es;if(t.datum_type===Vu&&(p=W2,s=MR,w=X2),h===w&&a===p&&!bm(e.datum_type)&&!bm(t.datum_type))return i;if(i=w3(i,h,a),bm(e.datum_type)&&(i=ML(i,e.datum_type,e.datum_params)),bm(t.datum_type)&&(i=IL(i,t.datum_type,t.datum_params)),i=x3(i,w,p,s),t.datum_type===Vu){var A=t4(t,!0,i);if(A!==0)return}return i}function t4(e,t,i){if(e.grids===null||e.grids.length===0)return console.log("Grid shift grids not found"),-1;var a={x:-i.x,y:i.y},h={x:Number.NaN,y:Number.NaN},d=[];e:for(var p=0;p<e.grids.length;p++){var s=e.grids[p];if(d.push(s.name),s.isNull){h=a;break}if(s.grid===null){if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1;continue}for(var w=s.grid.subgrids,A=0,z=w.length;A<z;A++){var B=w[A],D=(Math.abs(B.del[1])+Math.abs(B.del[0]))/1e4,V=B.ll[0]-D,W=B.ll[1]-D,S=B.ll[0]+(B.lim[0]-1)*B.del[0]+D,j=B.ll[1]+(B.lim[1]-1)*B.del[1]+D;if(!(W>a.y||V>a.x||j<a.y||S<a.x)&&(h=TL(a,t,B),!isNaN(h.x)))break e}}return isNaN(h.x)?(console.log("Failed to find a grid shift table for location '"+-a.x*qs+" "+a.y*qs+" tried: '"+d+"'"),-1):(i.x=-h.x,i.y=h.y,0)}function TL(e,t,i){var a={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return a;var h={x:e.x,y:e.y};h.x-=i.ll[0],h.y-=i.ll[1],h.x=wr(h.x-Math.PI)+Math.PI;var d=r4(h,i);if(t){if(isNaN(d.x))return a;d.x=h.x-d.x,d.y=h.y-d.y;var p=9,s=1e-12,w,A;do{if(A=r4(d,i),isNaN(A.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}w={x:h.x-(A.x+d.x),y:h.y-(A.y+d.y)},d.x+=w.x,d.y+=w.y}while(p--&&Math.abs(w.x)>s&&Math.abs(w.y)>s);if(p<0)return console.log("Inverse grid shift iterator failed to converge."),a;a.x=wr(d.x+i.ll[0]),a.y=d.y+i.ll[1]}else isNaN(d.x)||(a.x=e.x+d.x,a.y=e.y+d.y);return a}function r4(e,t){var i={x:e.x/t.del[0],y:e.y/t.del[1]},a={x:Math.floor(i.x),y:Math.floor(i.y)},h={x:i.x-1*a.x,y:i.y-1*a.y},d={x:Number.NaN,y:Number.NaN},p;if(a.x<0||a.x>=t.lim[0]||a.y<0||a.y>=t.lim[1])return d;p=a.y*t.lim[0]+a.x;var s={x:t.cvs[p][0],y:t.cvs[p][1]};p++;var w={x:t.cvs[p][0],y:t.cvs[p][1]};p+=t.lim[0];var A={x:t.cvs[p][0],y:t.cvs[p][1]};p--;var z={x:t.cvs[p][0],y:t.cvs[p][1]},B=h.x*h.y,D=h.x*(1-h.y),V=(1-h.x)*(1-h.y),W=(1-h.x)*h.y;return d.x=V*s.x+D*w.x+W*z.x+B*A.x,d.y=V*s.y+D*w.y+W*z.y+B*A.y,d}function i4(e,t,i){var a=i.x,h=i.y,d=i.z||0,p,s,w,A={};for(w=0;w<3;w++)if(!(t&&w===2&&i.z===void 0))switch(w===0?(p=a,"ew".indexOf(e.axis[w])!==-1?s="x":s="y"):w===1?(p=h,"ns".indexOf(e.axis[w])!==-1?s="y":s="x"):(p=d,s="z"),e.axis[w]){case"e":A[s]=p;break;case"w":A[s]=-p;break;case"n":A[s]=p;break;case"s":A[s]=-p;break;case"u":i[s]!==void 0&&(A.z=p);break;case"d":i[s]!==void 0&&(A.z=-p);break;default:return null}return A}function M3(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}function CL(e){n4(e.x),n4(e.y)}function n4(e){if(typeof Number.isFinite=="function"){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if(typeof e!="number"||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function SL(e,t){return(e.datum.datum_type===oh||e.datum.datum_type===lh||e.datum.datum_type===Vu)&&t.datumCode!=="WGS84"||(t.datum.datum_type===oh||t.datum.datum_type===lh||t.datum.datum_type===Vu)&&e.datumCode!=="WGS84"}function pg(e,t,i,a){var h;Array.isArray(i)?i=M3(i):i={x:i.x,y:i.y,z:i.z,m:i.m};var d=i.z!==void 0;if(CL(i),e.datum&&t.datum&&SL(e,t)&&(h=new Aa("WGS84"),i=pg(e,h,i,a),e=h),a&&e.axis!=="enu"&&(i=i4(e,!1,i)),e.projName==="longlat")i={x:i.x*Rn,y:i.y*Rn,z:i.z||0};else if(e.to_meter&&(i={x:i.x*e.to_meter,y:i.y*e.to_meter,z:i.z||0}),i=e.inverse(i),!i)return;if(e.from_greenwich&&(i.x+=e.from_greenwich),i=AL(e.datum,t.datum,i),!!i)return i=i,t.from_greenwich&&(i={x:i.x-t.from_greenwich,y:i.y,z:i.z||0}),t.projName==="longlat"?i={x:i.x*qs,y:i.y*qs,z:i.z||0}:(i=t.forward(i),t.to_meter&&(i={x:i.x/t.to_meter,y:i.y/t.to_meter,z:i.z||0})),a&&t.axis!=="enu"?i4(t,!0,i):(i&&!d&&delete i.z,i)}var s4=Aa("WGS84");function $_(e,t,i,a){var h,d,p;return Array.isArray(i)?(h=pg(e,t,i,a)||{x:NaN,y:NaN},i.length>2?typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof h.z=="number"?[h.x,h.y,h.z].concat(i.slice(3)):[h.x,h.y,i[2]].concat(i.slice(3)):[h.x,h.y].concat(i.slice(2)):[h.x,h.y]):(d=pg(e,t,i,a),p=Object.keys(i),p.length===2||p.forEach(function(s){if(typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(s==="x"||s==="y"||s==="z")return}else if(s==="x"||s==="y")return;d[s]=i[s]}),d)}function wm(e){return e instanceof Aa?e:typeof e=="object"&&"oProj"in e?e.oProj:Aa(e)}function PL(e,t,i){var a,h,d=!1,p;return typeof t>"u"?(h=wm(e),a=s4,d=!0):(typeof t.x<"u"||Array.isArray(t))&&(i=t,h=wm(e),a=s4,d=!0),a||(a=wm(e)),h||(h=wm(t)),i?$_(a,h,i):(p={forward:function(s,w){return $_(a,h,s,w)},inverse:function(s,w){return $_(h,a,s,w)}},d&&(p.oProj=h),p)}var a4=6,I3="AJSAJS",A3="AFAFAF",Ru=65,Hs=73,xa=79,Df=86,Bf=90;const EL={forward:T3,inverse:kL,toPoint:C3};function T3(e,t){return t=t||5,zL(RL({lat:e[1],lon:e[0]}),t)}function kL(e){var t=Zy(P3(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function C3(e){var t=Zy(P3(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function J_(e){return e*(Math.PI/180)}function o4(e){return 180*(e/Math.PI)}function RL(e){var t=e.lat,i=e.lon,a=6378137,h=.00669438,d=.9996,p,s,w,A,z,B,D,V=J_(t),W=J_(i),S,j;j=Math.floor((i+180)/6)+1,i===180&&(j=60),t>=56&&t<64&&i>=3&&i<12&&(j=32),t>=72&&t<84&&(i>=0&&i<9?j=31:i>=9&&i<21?j=33:i>=21&&i<33?j=35:i>=33&&i<42&&(j=37)),p=(j-1)*6-180+3,S=J_(p),s=h/(1-h),w=a/Math.sqrt(1-h*Math.sin(V)*Math.sin(V)),A=Math.tan(V)*Math.tan(V),z=s*Math.cos(V)*Math.cos(V),B=Math.cos(V)*(W-S),D=a*((1-h/4-3*h*h/64-5*h*h*h/256)*V-(3*h/8+3*h*h/32+45*h*h*h/1024)*Math.sin(2*V)+(15*h*h/256+45*h*h*h/1024)*Math.sin(4*V)-35*h*h*h/3072*Math.sin(6*V));var ne=d*w*(B+(1-A+z)*B*B*B/6+(5-18*A+A*A+72*z-58*s)*B*B*B*B*B/120)+5e5,te=d*(D+w*Math.tan(V)*(B*B/2+(5-A+9*z+4*z*z)*B*B*B*B/24+(61-58*A+A*A+600*z-330*s)*B*B*B*B*B*B/720));return t<0&&(te+=1e7),{northing:Math.round(te),easting:Math.round(ne),zoneNumber:j,zoneLetter:LL(t)}}function Zy(e){var t=e.northing,i=e.easting,a=e.zoneLetter,h=e.zoneNumber;if(h<0||h>60)return null;var d=.9996,p=6378137,s=.00669438,w,A=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s)),z,B,D,V,W,S,j,ne,te,Q=i-5e5,N=t;a<"N"&&(N-=1e7),j=(h-1)*6-180+3,w=s/(1-s),S=N/d,ne=S/(p*(1-s/4-3*s*s/64-5*s*s*s/256)),te=ne+(3*A/2-27*A*A*A/32)*Math.sin(2*ne)+(21*A*A/16-55*A*A*A*A/32)*Math.sin(4*ne)+151*A*A*A/96*Math.sin(6*ne),z=p/Math.sqrt(1-s*Math.sin(te)*Math.sin(te)),B=Math.tan(te)*Math.tan(te),D=w*Math.cos(te)*Math.cos(te),V=p*(1-s)/Math.pow(1-s*Math.sin(te)*Math.sin(te),1.5),W=Q/(z*d);var re=te-z*Math.tan(te)/V*(W*W/2-(5+3*B+10*D-4*D*D-9*w)*W*W*W*W/24+(61+90*B+298*D+45*B*B-252*w-3*D*D)*W*W*W*W*W*W/720);re=o4(re);var oe=(W-(1+2*B+D)*W*W*W/6+(5-2*D+28*B-3*D*D+8*w+24*B*B)*W*W*W*W*W/120)/Math.cos(te);oe=j+o4(oe);var ve;if(e.accuracy){var Pe=Zy({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});ve={top:Pe.lat,right:Pe.lon,bottom:re,left:oe}}else ve={lat:re,lon:oe};return ve}function LL(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function zL(e,t){var i="00000"+e.easting,a="00000"+e.northing;return e.zoneNumber+e.zoneLetter+FL(e.easting,e.northing,e.zoneNumber)+i.substr(i.length-5,t)+a.substr(a.length-5,t)}function FL(e,t,i){var a=S3(i),h=Math.floor(e/1e5),d=Math.floor(t/1e5)%20;return DL(h,d,a)}function S3(e){var t=e%a4;return t===0&&(t=a4),t}function DL(e,t,i){var a=i-1,h=I3.charCodeAt(a),d=A3.charCodeAt(a),p=h+e-1,s=d+t,w=!1;p>Bf&&(p=p-Bf+Ru-1,w=!0),(p===Hs||h<Hs&&p>Hs||(p>Hs||h<Hs)&&w)&&p++,(p===xa||h<xa&&p>xa||(p>xa||h<xa)&&w)&&(p++,p===Hs&&p++),p>Bf&&(p=p-Bf+Ru-1),s>Df?(s=s-Df+Ru-1,w=!0):w=!1,(s===Hs||d<Hs&&s>Hs||(s>Hs||d<Hs)&&w)&&s++,(s===xa||d<xa&&s>xa||(s>xa||d<xa)&&w)&&(s++,s===Hs&&s++),s>Df&&(s=s-Df+Ru-1);var A=String.fromCharCode(p)+String.fromCharCode(s);return A}function P3(e){if(e&&e.length===0)throw"MGRSPoint coverting from nothing";for(var t=e.length,i=null,a="",h,d=0;!/[A-Z]/.test(h=e.charAt(d));){if(d>=2)throw"MGRSPoint bad conversion from: "+e;a+=h,d++}var p=parseInt(a,10);if(d===0||d+3>t)throw"MGRSPoint bad conversion from: "+e;var s=e.charAt(d++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O")throw"MGRSPoint zone letter "+s+" not handled: "+e;i=e.substring(d,d+=2);for(var w=S3(p),A=BL(i.charAt(0),w),z=GL(i.charAt(1),w);z<VL(s);)z+=2e6;var B=t-d;if(B%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+e;var D=B/2,V=0,W=0,S,j,ne,te,Q;return D>0&&(S=1e5/Math.pow(10,D),j=e.substring(d,d+D),V=parseFloat(j)*S,ne=e.substring(d+D),W=parseFloat(ne)*S),te=V+A,Q=W+z,{easting:te,northing:Q,zoneLetter:s,zoneNumber:p,accuracy:S}}function BL(e,t){for(var i=I3.charCodeAt(t-1),a=1e5,h=!1;i!==e.charCodeAt(0);){if(i++,i===Hs&&i++,i===xa&&i++,i>Bf){if(h)throw"Bad character: "+e;i=Ru,h=!0}a+=1e5}return a}function GL(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var i=A3.charCodeAt(t-1),a=0,h=!1;i!==e.charCodeAt(0);){if(i++,i===Hs&&i++,i===xa&&i++,i>Df){if(h)throw"Bad character: "+e;i=Ru,h=!0}a+=1e5}return a}function VL(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function Qu(e,t,i){if(!(this instanceof Qu))return new Qu(e,t,i);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if(typeof e=="object")this.x=e.x,this.y=e.y,this.z=e.z||0;else if(typeof e=="string"&&typeof t>"u"){var a=e.split(",");this.x=parseFloat(a[0]),this.y=parseFloat(a[1]),this.z=parseFloat(a[2])||0}else this.x=e,this.y=t,this.z=i||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Qu.fromMGRS=function(e){return new Qu(C3(e))};Qu.prototype.toMGRS=function(e){return T3([this.x,this.y],e)};var jL=1,ZL=.25,l4=.046875,c4=.01953125,h4=.01068115234375,OL=.75,NL=.46875,UL=.013020833333333334,HL=.007120768229166667,WL=.3645833333333333,XL=.005696614583333333,qL=.3076171875;function Oy(e){var t=[];t[0]=jL-e*(ZL+e*(l4+e*(c4+e*h4))),t[1]=e*(OL-e*(l4+e*(c4+e*h4)));var i=e*e;return t[2]=i*(NL-e*(UL+e*HL)),i*=e,t[3]=i*(WL-e*XL),t[4]=i*e*qL,t}function ad(e,t,i,a){return i*=t,t*=t,a[0]*e-i*(a[1]+t*(a[2]+t*(a[3]+t*a[4])))}var YL=20;function Ny(e,t,i){for(var a=1/(1-t),h=e,d=YL;d;--d){var p=Math.sin(h),s=1-t*p*p;if(s=(ad(h,p,Math.cos(h),i)-e)*(s*Math.sqrt(s))*a,h-=s,Math.abs(s)<vr)return h}return h}function KL(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=Oy(this.es),this.ml0=ad(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function $L(e){var t=e.x,i=e.y,a=wr(t-this.long0,this.over),h,d,p,s=Math.sin(i),w=Math.cos(i);if(this.es){var z=w*a,B=Math.pow(z,2),D=this.ep2*Math.pow(w,2),V=Math.pow(D,2),W=Math.abs(w)>vr?Math.tan(i):0,S=Math.pow(W,2),j=Math.pow(S,2);h=1-this.es*Math.pow(s,2),z=z/Math.sqrt(h);var ne=ad(i,s,w,this.en);d=this.a*(this.k0*z*(1+B/6*(1-S+D+B/20*(5-18*S+j+14*D-58*S*D+B/42*(61+179*j-j*S-479*S)))))+this.x0,p=this.a*(this.k0*(ne-this.ml0+s*a*z/2*(1+B/12*(5-S+9*D+4*V+B/30*(61+j-58*S+270*D-330*S*D+B/56*(1385+543*j-j*S-3111*S))))))+this.y0}else{var A=w*Math.sin(a);if(Math.abs(Math.abs(A)-1)<vr)return 93;if(d=.5*this.a*this.k0*Math.log((1+A)/(1-A))+this.x0,p=w*Math.cos(a)/Math.sqrt(1-Math.pow(A,2)),A=Math.abs(p),A>=1){if(A-1>vr)return 93;p=0}else p=Math.acos(p);i<0&&(p=-p),p=this.a*this.k0*(p-this.lat0)+this.y0}return e.x=d,e.y=p,e}function JL(e){var t,i,a,h,d=(e.x-this.x0)*(1/this.a),p=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+p/this.k0,i=Ny(t,this.es,this.en),Math.abs(i)<rr){var B=Math.sin(i),D=Math.cos(i),V=Math.abs(D)>vr?Math.tan(i):0,W=this.ep2*Math.pow(D,2),S=Math.pow(W,2),j=Math.pow(V,2),ne=Math.pow(j,2);t=1-this.es*Math.pow(B,2);var te=d*Math.sqrt(t)/this.k0,Q=Math.pow(te,2);t=t*V,a=i-t*Q/(1-this.es)*.5*(1-Q/12*(5+3*j-9*W*j+W-4*S-Q/30*(61+90*j-252*W*j+45*ne+46*W-Q/56*(1385+3633*j+4095*ne+1574*ne*j)))),h=wr(this.long0+te*(1-Q/6*(1+2*j+W-Q/20*(5+28*j+24*ne+8*W*j+6*W-Q/42*(61+662*j+1320*ne+720*ne*j))))/D,this.over)}else a=rr*qp(p),h=0;else{var s=Math.exp(d/this.k0),w=.5*(s-1/s),A=this.lat0+p/this.k0,z=Math.cos(A);t=Math.sqrt((1-Math.pow(z,2))/(1+Math.pow(w,2))),a=Math.asin(t),p<0&&(a=-a),w===0&&z===0?h=0:h=wr(Math.atan2(w,z)+this.long0,this.over)}return e.x=h,e.y=a,e}var QL=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const Hm={init:KL,forward:$L,inverse:JL,names:QL};function E3(e){var t=Math.exp(e);return t=(t-1/t)/2,t}function Ws(e,t){e=Math.abs(e),t=Math.abs(t);var i=Math.max(e,t),a=Math.min(e,t)/(i||1);return i*Math.sqrt(1+Math.pow(a,2))}function ez(e){var t=1+e,i=t-1;return i===0?e:e*Math.log(t)/i}function tz(e){var t=Math.abs(e);return t=ez(t*(1+t/(Ws(1,t)+1))),e<0?-t:t}function Uy(e,t){for(var i=2*Math.cos(2*t),a=e.length-1,h=e[a],d=0,p;--a>=0;)p=-d+i*h+e[a],d=h,h=p;return t+p*Math.sin(2*t)}function rz(e,t){for(var i=2*Math.cos(t),a=e.length-1,h=e[a],d=0,p;--a>=0;)p=-d+i*h+e[a],d=h,h=p;return Math.sin(t)*p}function iz(e){var t=Math.exp(e);return t=(t+1/t)/2,t}function k3(e,t,i){for(var a=Math.sin(t),h=Math.cos(t),d=E3(i),p=iz(i),s=2*h*p,w=-2*a*d,A=e.length-1,z=e[A],B=0,D=0,V=0,W,S;--A>=0;)W=D,S=B,D=z,B=V,z=-W+s*D-w*B+e[A],V=-S+w*D+s*B;return s=a*p,w=h*d,[s*z-w*V,s*V+w*z]}function nz(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Hm.init.apply(this),this.forward=Hm.forward,this.inverse=Hm.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),i=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),i=i*t,this.cgb[1]=i*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=i*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),i=i*t,this.cgb[2]=i*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=i*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),i=i*t,this.cgb[3]=i*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=i*(1237/630+t*(-12/5+t*(-24832/14175))),i=i*t,this.cgb[4]=i*(4174/315+t*(-144838/6237)),this.cbg[4]=i*(-734/315+t*(109598/31185)),i=i*t,this.cgb[5]=i*(601676/22275),this.cbg[5]=i*(444337/155925),i=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+i*(1/4+i*(1/64+i/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=i*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=i*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),i=i*t,this.utg[2]=i*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=i*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),i=i*t,this.utg[3]=i*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=i*(49561/161280+t*(-179/168+t*(6601661/7257600))),i=i*t,this.utg[4]=i*(-4583/161280+t*(108847/3991680)),this.gtu[4]=i*(34729/80640+t*(-3418889/1995840)),i=i*t,this.utg[5]=i*(-20648693/638668800),this.gtu[5]=i*(212378941/319334400);var a=Uy(this.cbg,this.lat0);this.Zb=-this.Qn*(a+rz(this.gtu,2*a))}function sz(e){var t=wr(e.x-this.long0,this.over),i=e.y;i=Uy(this.cbg,i);var a=Math.sin(i),h=Math.cos(i),d=Math.sin(t),p=Math.cos(t);i=Math.atan2(a,p*h),t=Math.atan2(d*h,Ws(a,h*p)),t=tz(Math.tan(t));var s=k3(this.gtu,2*i,2*t);i=i+s[0],t=t+s[1];var w,A;return Math.abs(t)<=2.623395162778?(w=this.a*(this.Qn*t)+this.x0,A=this.a*(this.Qn*i+this.Zb)+this.y0):(w=1/0,A=1/0),e.x=w,e.y=A,e}function az(e){var t=(e.x-this.x0)*(1/this.a),i=(e.y-this.y0)*(1/this.a);i=(i-this.Zb)/this.Qn,t=t/this.Qn;var a,h;if(Math.abs(t)<=2.623395162778){var d=k3(this.utg,2*i,2*t);i=i+d[0],t=t+d[1],t=Math.atan(E3(t));var p=Math.sin(i),s=Math.cos(i),w=Math.sin(t),A=Math.cos(t);i=Math.atan2(p*A,Ws(w,A*s)),t=Math.atan2(w,A*s),a=wr(t+this.long0,this.over),h=Uy(this.cgb,i)}else a=1/0,h=1/0;return e.x=a,e.y=h,e}var oz=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const Wm={init:nz,forward:sz,inverse:az,names:oz};function lz(e,t){if(e===void 0){if(e=Math.floor((wr(t)+Math.PI)*30/Math.PI)+1,e<0)return 0;if(e>60)return 60}return e}var cz="etmerc";function hz(){var e=lz(this.zone,this.long0);if(e===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*Rn,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Wm.init.apply(this),this.forward=Wm.forward,this.inverse=Wm.inverse}var uz=["Universal Transverse Mercator System","utm"];const dz={init:hz,names:uz,dependsOn:cz};function Hy(e,t){return Math.pow((1-e)/(1+e),t)}var fz=20;function pz(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Ui)/(Math.pow(Math.tan(.5*this.lat0+Ui),this.C)*Hy(this.e*e,this.ratexp))}function mz(e){var t=e.x,i=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+Ui),this.C)*Hy(this.e*Math.sin(i),this.ratexp))-rr,e.x=this.C*t,e}function gz(e){for(var t=1e-14,i=e.x/this.C,a=e.y,h=Math.pow(Math.tan(.5*a+Ui)/this.K,1/this.C),d=fz;d>0&&(a=2*Math.atan(h*Hy(this.e*Math.sin(e.y),-.5*this.e))-rr,!(Math.abs(a-e.y)<t));--d)e.y=a;return d?(e.x=i,e.y=a,e):null}const Wy={init:pz,forward:mz,inverse:gz};function _z(){Wy.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function vz(e){var t,i,a,h;return e.x=wr(e.x-this.long0,this.over),Wy.forward.apply(this,[e]),t=Math.sin(e.y),i=Math.cos(e.y),a=Math.cos(e.x),h=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*i*a),e.x=h*i*Math.sin(e.x),e.y=h*(this.cosc0*t-this.sinc0*i*a),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function yz(e){var t,i,a,h,d;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,d=Ws(e.x,e.y)){var p=2*Math.atan2(d,this.R2);t=Math.sin(p),i=Math.cos(p),h=Math.asin(i*this.sinc0+e.y*t*this.cosc0/d),a=Math.atan2(e.x*t,d*this.cosc0*i-e.y*this.sinc0*t)}else h=this.phic0,a=0;return e.x=a,e.y=h,Wy.inverse.apply(this,[e]),e.x=wr(e.x+this.long0,this.over),e}var bz=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const wz={init:_z,forward:vz,inverse:yz,names:bz};function Xy(e,t,i){return t*=i,Math.tan(.5*(rr+e))*Math.pow((1-t)/(1+t),.5*i)}function xz(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=vr&&(this.k0=.5*(1+qp(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=vr&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=vr&&Math.abs(Math.cos(this.lat_ts))>vr&&(this.k0=.5*this.cons*To(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Wa(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=To(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(Xy(this.lat0,this.sinlat0,this.e))-rr,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Mz(e){var t=e.x,i=e.y,a=Math.sin(i),h=Math.cos(i),d,p,s,w,A,z,B=wr(t-this.long0,this.over);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=vr&&Math.abs(i+this.lat0)<=vr?(e.x=NaN,e.y=NaN,e):this.sphere?(d=2*this.k0/(1+this.sinlat0*a+this.coslat0*h*Math.cos(B)),e.x=this.a*d*h*Math.sin(B)+this.x0,e.y=this.a*d*(this.coslat0*a-this.sinlat0*h*Math.cos(B))+this.y0,e):(p=2*Math.atan(Xy(i,a,this.e))-rr,w=Math.cos(p),s=Math.sin(p),Math.abs(this.coslat0)<=vr?(A=Wa(this.e,i*this.con,this.con*a),z=2*this.a*this.k0*A/this.cons,e.x=this.x0+z*Math.sin(t-this.long0),e.y=this.y0-this.con*z*Math.cos(t-this.long0),e):(Math.abs(this.sinlat0)<vr?(d=2*this.a*this.k0/(1+w*Math.cos(B)),e.y=d*s):(d=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*w*Math.cos(B))),e.y=d*(this.cosX0*s-this.sinX0*w*Math.cos(B))+this.y0),e.x=d*w*Math.sin(B)+this.x0,e))}function Iz(e){e.x-=this.x0,e.y-=this.y0;var t,i,a,h,d,p=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var s=2*Math.atan(p/(2*this.a*this.k0));return t=this.long0,i=this.lat0,p<=vr?(e.x=t,e.y=i,e):(i=Math.asin(Math.cos(s)*this.sinlat0+e.y*Math.sin(s)*this.coslat0/p),Math.abs(this.coslat0)<vr?this.lat0>0?t=wr(this.long0+Math.atan2(e.x,-1*e.y),this.over):t=wr(this.long0+Math.atan2(e.x,e.y),this.over):t=wr(this.long0+Math.atan2(e.x*Math.sin(s),p*this.coslat0*Math.cos(s)-e.y*this.sinlat0*Math.sin(s)),this.over),e.x=t,e.y=i,e)}else if(Math.abs(this.coslat0)<=vr){if(p<=vr)return i=this.lat0,t=this.long0,e.x=t,e.y=i,e;e.x*=this.con,e.y*=this.con,a=p*this.cons/(2*this.a*this.k0),i=this.con*dp(this.e,a),t=this.con*wr(this.con*this.long0+Math.atan2(e.x,-1*e.y),this.over)}else h=2*Math.atan(p*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,p<=vr?d=this.X0:(d=Math.asin(Math.cos(h)*this.sinX0+e.y*Math.sin(h)*this.cosX0/p),t=wr(this.long0+Math.atan2(e.x*Math.sin(h),p*this.cosX0*Math.cos(h)-e.y*this.sinX0*Math.sin(h)),this.over)),i=-1*dp(this.e,Math.tan(.5*(rr+d)));return e.x=t,e.y=i,e}var Az=["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"];const Tz={init:xz,forward:Mz,inverse:Iz,names:Az,ssfn_:Xy};function Cz(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),i=this.a,a=this.rf,h=1/a,d=2*h-Math.pow(h,2),p=this.e=Math.sqrt(d);this.R=this.k0*i*Math.sqrt(1-d)/(1-d*Math.pow(t,2)),this.alpha=Math.sqrt(1+d/(1-d)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),w=Math.log(Math.tan(Math.PI/4+e/2)),A=Math.log((1+p*t)/(1-p*t));this.K=s-this.alpha*w+this.alpha*p/2*A}function Sz(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),a=-this.alpha*(t+i)+this.K,h=2*(Math.atan(Math.exp(a))-Math.PI/4),d=this.alpha*(e.x-this.lambda0),p=Math.atan(Math.sin(d)/(Math.sin(this.b0)*Math.tan(h)+Math.cos(this.b0)*Math.cos(d))),s=Math.asin(Math.cos(this.b0)*Math.sin(h)-Math.sin(this.b0)*Math.cos(h)*Math.cos(d));return e.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,e.x=this.R*p+this.x0,e}function Pz(e){for(var t=e.x-this.x0,i=e.y-this.y0,a=t/this.R,h=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),d=Math.asin(Math.cos(this.b0)*Math.sin(h)+Math.sin(this.b0)*Math.cos(h)*Math.cos(a)),p=Math.atan(Math.sin(a)/(Math.cos(this.b0)*Math.cos(a)-Math.sin(this.b0)*Math.tan(h))),s=this.lambda0+p/this.alpha,w=0,A=d,z=-1e3,B=0;Math.abs(A-z)>1e-7;){if(++B>20)return;w=1/this.alpha*(Math.log(Math.tan(Math.PI/4+d/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(A))/2)),z=A,A=2*Math.atan(Math.exp(w))-Math.PI/2}return e.x=s,e.y=A,e}var Ez=["somerc"];const kz={init:Cz,forward:Sz,inverse:Pz,names:Ez};var Au=1e-7;function Rz(e){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],i=typeof e.projName=="object"?Object.keys(e.projName)[0]:e.projName;return"no_uoff"in e||"no_off"in e||t.indexOf(i)!==-1||t.indexOf(y3(i))!==-1}function Lz(){var e,t,i,a,h,d,p,s,w,A,z=0,B,D=0,V=0,W=0,S=0,j=0,ne=0;this.no_off=Rz(this),this.no_rot="no_rot"in this;var te=!1;"alpha"in this&&(te=!0);var Q=!1;if("rectified_grid_angle"in this&&(Q=!0),te&&(ne=this.alpha),Q&&(z=this.rectified_grid_angle),te||Q)D=this.longc;else if(V=this.long1,S=this.lat1,W=this.long2,j=this.lat2,Math.abs(S-j)<=Au||(e=Math.abs(S))<=Au||Math.abs(e-rr)<=Au||Math.abs(Math.abs(this.lat0)-rr)<=Au||Math.abs(Math.abs(j)-rr)<=Au)throw new Error;var N=1-this.es;t=Math.sqrt(N),Math.abs(this.lat0)>vr?(s=Math.sin(this.lat0),i=Math.cos(this.lat0),e=1-this.es*s*s,this.B=i*i,this.B=Math.sqrt(1+this.es*this.B*this.B/N),this.A=this.B*this.k0*t/e,a=this.B*t/(i*Math.sqrt(e)),h=a*a-1,h<=0?h=0:(h=Math.sqrt(h),this.lat0<0&&(h=-h)),this.E=h+=a,this.E*=Math.pow(Wa(this.e,this.lat0,s),this.B)):(this.B=1/t,this.A=this.k0,this.E=a=h=1),te||Q?(te?(B=Math.asin(Math.sin(ne)/a),Q||(z=ne)):(B=z,ne=Math.asin(a*Math.sin(B))),this.lam0=D-Math.asin(.5*(h-1/h)*Math.tan(B))/this.B):(d=Math.pow(Wa(this.e,S,Math.sin(S)),this.B),p=Math.pow(Wa(this.e,j,Math.sin(j)),this.B),h=this.E/d,w=(p-d)/(p+d),A=this.E*this.E,A=(A-p*d)/(A+p*d),e=V-W,e<-Math.PI?W-=hp:e>Math.PI&&(W+=hp),this.lam0=wr(.5*(V+W)-Math.atan(A*Math.tan(.5*this.B*(V-W))/w)/this.B,this.over),B=Math.atan(2*Math.sin(this.B*wr(V-this.lam0,this.over))/(h-1/h)),z=ne=Math.asin(a*Math.sin(B))),this.singam=Math.sin(B),this.cosgam=Math.cos(B),this.sinrot=Math.sin(z),this.cosrot=Math.cos(z),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(a*a-1)/Math.cos(ne))),this.lat0<0&&(this.u_0=-this.u_0)),h=.5*B,this.v_pole_n=this.ArB*Math.log(Math.tan(Ui-h)),this.v_pole_s=this.ArB*Math.log(Math.tan(Ui+h))}function zz(e){var t={},i,a,h,d,p,s,w,A;if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-rr)>vr){if(p=this.E/Math.pow(Wa(this.e,e.y,Math.sin(e.y)),this.B),s=1/p,i=.5*(p-s),a=.5*(p+s),d=Math.sin(this.B*e.x),h=(i*this.singam-d*this.cosgam)/a,Math.abs(Math.abs(h)-1)<vr)throw new Error;A=.5*this.ArB*Math.log((1-h)/(1+h)),s=Math.cos(this.B*e.x),Math.abs(s)<Au?w=this.A*e.x:w=this.ArB*Math.atan2(i*this.cosgam+d*this.singam,s)}else A=e.y>0?this.v_pole_n:this.v_pole_s,w=this.ArB*e.y;return this.no_rot?(t.x=w,t.y=A):(w-=this.u_0,t.x=A*this.cosrot+w*this.sinrot,t.y=w*this.cosrot-A*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Fz(e){var t,i,a,h,d,p,s,w={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(i=e.y,t=e.x):(i=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),a=Math.exp(-this.BrA*i),h=.5*(a-1/a),d=.5*(a+1/a),p=Math.sin(this.BrA*t),s=(p*this.cosgam+h*this.singam)/d,Math.abs(Math.abs(s)-1)<vr)w.x=0,w.y=s<0?-rr:rr;else{if(w.y=this.E/Math.sqrt((1+s)/(1-s)),w.y=dp(this.e,Math.pow(w.y,1/this.B)),w.y===1/0)throw new Error;w.x=-this.rB*Math.atan2(h*this.cosgam-p*this.singam,Math.cos(this.BrA*t))}return w.x+=this.lam0,w}var Dz=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Bz={init:Lz,forward:zz,inverse:Fz,names:Dz};function Gz(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<vr)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),i=Math.cos(this.lat1),a=To(this.e,t,i),h=Wa(this.e,this.lat1,t),d=Math.sin(this.lat2),p=Math.cos(this.lat2),s=To(this.e,d,p),w=Wa(this.e,this.lat2,d),A=Math.abs(Math.abs(this.lat0)-rr)<vr?0:Wa(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>vr?this.ns=Math.log(a/s)/Math.log(h/w):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=a/(this.ns*Math.pow(h,this.ns)),this.rh=this.a*this.f0*Math.pow(A,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Vz(e){var t=e.x,i=e.y;Math.abs(2*Math.abs(i)-Math.PI)<=vr&&(i=qp(i)*(rr-2*vr));var a=Math.abs(Math.abs(i)-rr),h,d;if(a>vr)h=Wa(this.e,i,Math.sin(i)),d=this.a*this.f0*Math.pow(h,this.ns);else{if(a=i*this.ns,a<=0)return null;d=0}var p=this.ns*wr(t-this.long0,this.over);return e.x=this.k0*(d*Math.sin(p))+this.x0,e.y=this.k0*(this.rh-d*Math.cos(p))+this.y0,e}function jz(e){var t,i,a,h,d,p=(e.x-this.x0)/this.k0,s=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(p*p+s*s),i=1):(t=-Math.sqrt(p*p+s*s),i=-1);var w=0;if(t!==0&&(w=Math.atan2(i*p,i*s)),t!==0||this.ns>0){if(i=1/this.ns,a=Math.pow(t/(this.a*this.f0),i),h=dp(this.e,a),h===-9999)return null}else h=-rr;return d=wr(w/this.ns+this.long0,this.over),e.x=d,e.y=h,e}var Zz=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Oz={init:Gz,forward:Vz,inverse:jz,names:Zz};function Nz(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Uz(e){var t,i,a,h,d,p,s,w=e.x,A=e.y,z=wr(w-this.long0,this.over);return t=Math.pow((1+this.e*Math.sin(A))/(1-this.e*Math.sin(A)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(A/2+this.s45),this.alfa)/t)-this.s45),a=-z*this.alfa,h=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(a)),d=Math.asin(Math.cos(i)*Math.sin(a)/Math.cos(h)),p=this.n*d,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(h/2+this.s45),this.n),e.y=s*Math.cos(p)/1,e.x=s*Math.sin(p)/1,this.czech||(e.y*=-1,e.x*=-1),e}function Hz(e){var t,i,a,h,d,p,s,w,A=e.x;e.x=e.y,e.y=A,this.czech||(e.y*=-1,e.x*=-1),p=Math.sqrt(e.x*e.x+e.y*e.y),d=Math.atan2(e.y,e.x),h=d/Math.sin(this.s0),a=2*(Math.atan(Math.pow(this.ro0/p,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(a)-Math.sin(this.ad)*Math.cos(a)*Math.cos(h)),i=Math.asin(Math.cos(a)*Math.sin(h)/Math.cos(t)),e.x=this.long0-i/this.alfa,s=t,w=0;var z=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-e.y)<1e-10&&(w=1),s=e.y,z+=1;while(w===0&&z<15);return z>=15?null:e}var Wz=["Krovak","krovak"];const Xz={init:Nz,forward:Uz,inverse:Hz,names:Wz};function Fs(e,t,i,a,h){return e*h-t*Math.sin(2*h)+i*Math.sin(4*h)-a*Math.sin(6*h)}function Yp(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function Kp(e){return .375*e*(1+.25*e*(1+.46875*e))}function $p(e){return .05859375*e*e*(1+.75*e)}function Jp(e){return e*e*e*(35/3072)}function qy(e,t,i){var a=t*i;return e/Math.sqrt(1-a*a)}function sc(e){return Math.abs(e)<rr?e:e-qp(e)*Math.PI}function mg(e,t,i,a,h){var d,p;d=e/t;for(var s=0;s<15;s++)if(p=(e-(t*d-i*Math.sin(2*d)+a*Math.sin(4*d)-h*Math.sin(6*d)))/(t-2*i*Math.cos(2*d)+4*a*Math.cos(4*d)-6*h*Math.cos(6*d)),d+=p,Math.abs(p)<=1e-10)return d;return NaN}function qz(){this.sphere||(this.e0=Yp(this.es),this.e1=Kp(this.es),this.e2=$p(this.es),this.e3=Jp(this.es),this.ml0=this.a*Fs(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Yz(e){var t,i,a=e.x,h=e.y;if(a=wr(a-this.long0,this.over),this.sphere)t=this.a*Math.asin(Math.cos(h)*Math.sin(a)),i=this.a*(Math.atan2(Math.tan(h),Math.cos(a))-this.lat0);else{var d=Math.sin(h),p=Math.cos(h),s=qy(this.a,this.e,d),w=Math.tan(h)*Math.tan(h),A=a*Math.cos(h),z=A*A,B=this.es*p*p/(1-this.es),D=this.a*Fs(this.e0,this.e1,this.e2,this.e3,h);t=s*A*(1-z*w*(1/6-(8-w+8*B)*z/120)),i=D-this.ml0+s*d/p*z*(.5+(5-w+6*B)*z/24)}return e.x=t+this.x0,e.y=i+this.y0,e}function Kz(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,i=e.y/this.a,a,h;if(this.sphere){var d=i+this.lat0;a=Math.asin(Math.sin(d)*Math.cos(t)),h=Math.atan2(Math.tan(t),Math.cos(d))}else{var p=this.ml0/this.a+i,s=mg(p,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-rr)<=vr)return e.x=this.long0,e.y=rr,i<0&&(e.y*=-1),e;var w=qy(this.a,this.e,Math.sin(s)),A=w*w*w/this.a/this.a*(1-this.es),z=Math.pow(Math.tan(s),2),B=t*this.a/w,D=B*B;a=s-w*Math.tan(s)/A*B*B*(.5-(1+3*z)*B*B/24),h=B*(1-D*(z/3+(1+3*z)*z*D/15))/Math.cos(s)}return e.x=wr(h+this.long0,this.over),e.y=sc(a),e}var $z=["Cassini","Cassini_Soldner","cass"];const Jz={init:qz,forward:Yz,inverse:Kz,names:$z};function Wl(e,t){var i;return e>1e-7?(i=e*t,(1-e*e)*(t/(1-i*i)-.5/e*Math.log((1-i)/(1+i)))):2*t}var Hv=1,Wv=2,Xv=3,Xm=4;function Qz(){var e=Math.abs(this.lat0);if(Math.abs(e-rr)<vr?this.mode=this.lat0<0?Hv:Wv:Math.abs(e)<vr?this.mode=Xv:this.mode=Xm,this.es>0){var t;switch(this.qp=Wl(this.e,1),this.mmf=.5/(1-this.es),this.apa=lF(this.es),this.mode){case Wv:this.dd=1;break;case Hv:this.dd=1;break;case Xv:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case Xm:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Wl(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===Xm&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function eF(e){var t,i,a,h,d,p,s,w,A,z,B=e.x,D=e.y;if(B=wr(B-this.long0,this.over),this.sphere){if(d=Math.sin(D),z=Math.cos(D),a=Math.cos(B),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i=this.mode===this.EQUIT?1+z*a:1+this.sinph0*d+this.cosph0*z*a,i<=vr)return null;i=Math.sqrt(2/i),t=i*z*Math.sin(B),i*=this.mode===this.EQUIT?d:this.cosph0*d-this.sinph0*z*a}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(a=-a),Math.abs(D+this.lat0)<vr)return null;i=Ui-D*.5,i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)),t=i*Math.sin(B),i*=a}}else{switch(s=0,w=0,A=0,a=Math.cos(B),h=Math.sin(B),d=Math.sin(D),p=Wl(this.e,d),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(s=p/this.qp,w=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:A=1+this.sinb1*s+this.cosb1*w*a;break;case this.EQUIT:A=1+w*a;break;case this.N_POLE:A=rr+D,p=this.qp-p;break;case this.S_POLE:A=D-rr,p=this.qp+p;break}if(Math.abs(A)<vr)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:A=Math.sqrt(2/A),this.mode===this.OBLIQ?i=this.ymf*A*(this.cosb1*s-this.sinb1*w*a):i=(A=Math.sqrt(2/(1+w*a)))*s*this.ymf,t=this.xmf*A*w*h;break;case this.N_POLE:case this.S_POLE:p>=0?(t=(A=Math.sqrt(p))*h,i=a*(this.mode===this.S_POLE?A:-A)):t=i=0;break}}return e.x=this.a*t+this.x0,e.y=this.a*i+this.y0,e}function tF(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,i=e.y/this.a,a,h,d,p,s,w,A;if(this.sphere){var z=0,B,D=0;if(B=Math.sqrt(t*t+i*i),h=B*.5,h>1)return null;switch(h=2*Math.asin(h),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(D=Math.sin(h),z=Math.cos(h)),this.mode){case this.EQUIT:h=Math.abs(B)<=vr?0:Math.asin(i*D/B),t*=D,i=z*B;break;case this.OBLIQ:h=Math.abs(B)<=vr?this.lat0:Math.asin(z*this.sinph0+i*D*this.cosph0/B),t*=D*this.cosph0,i=(z-Math.sin(h)*this.sinph0)*B;break;case this.N_POLE:i=-i,h=rr-h;break;case this.S_POLE:h-=rr;break}a=i===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,i)}else{if(A=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,i*=this.dd,w=Math.sqrt(t*t+i*i),w<vr)return e.x=this.long0,e.y=this.lat0,e;p=2*Math.asin(.5*w/this.rq),d=Math.cos(p),t*=p=Math.sin(p),this.mode===this.OBLIQ?(A=d*this.sinb1+i*p*this.cosb1/w,s=this.qp*A,i=w*this.cosb1*d-i*this.sinb1*p):(A=i*p/w,s=this.qp*A,i=w*d)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),s=t*t+i*i,!s)return e.x=this.long0,e.y=this.lat0,e;A=1-s/this.qp,this.mode===this.S_POLE&&(A=-A)}a=Math.atan2(t,i),h=cF(Math.asin(A),this.apa)}return e.x=wr(this.long0+a,this.over),e.y=h,e}var rF=.3333333333333333,iF=.17222222222222222,nF=.10257936507936508,sF=.06388888888888888,aF=.0664021164021164,oF=.016415012942191543;function lF(e){var t,i=[];return i[0]=e*rF,t=e*e,i[0]+=t*iF,i[1]=t*sF,t*=e,i[0]+=t*nF,i[1]+=t*aF,i[2]=t*oF,i}function cF(e,t){var i=e+e;return e+t[0]*Math.sin(i)+t[1]*Math.sin(i+i)+t[2]*Math.sin(i+i+i)}var hF=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const uF={init:Qz,forward:eF,inverse:tF,names:hF,S_POLE:Hv,N_POLE:Wv,EQUIT:Xv,OBLIQ:Xm};function Ql(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}function dF(){Math.abs(this.lat1+this.lat2)<vr||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=To(this.e3,this.sin_po,this.cos_po),this.qs1=Wl(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=To(this.e3,this.sin_po,this.cos_po),this.qs2=Wl(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Wl(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>vr?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function fF(e){var t=e.x,i=e.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var a=Wl(this.e3,this.sin_phi),h=this.a*Math.sqrt(this.c-this.ns0*a)/this.ns0,d=this.ns0*wr(t-this.long0,this.over),p=h*Math.sin(d)+this.x0,s=this.rh-h*Math.cos(d)+this.y0;return e.x=p,e.y=s,e}function pF(e){var t,i,a,h,d,p;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),a=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),a=-1),h=0,t!==0&&(h=Math.atan2(a*e.x,a*e.y)),a=t*this.ns0/this.a,this.sphere?p=Math.asin((this.c-a*a)/(2*this.ns0)):(i=(this.c-a*a)/this.ns0,p=this.phi1z(this.e3,i)),d=wr(h/this.ns0+this.long0,this.over),e.x=d,e.y=p,e}function mF(e,t){var i,a,h,d,p,s=Ql(.5*t);if(e<vr)return s;for(var w=e*e,A=1;A<=25;A++)if(i=Math.sin(s),a=Math.cos(s),h=e*i,d=1-h*h,p=.5*d*d/a*(t/(1-w)-i/d+.5/e*Math.log((1-h)/(1+h))),s=s+p,Math.abs(p)<=1e-7)return s;return null}var gF=["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"];const _F={init:dF,forward:fF,inverse:pF,names:gF,phi1z:mF};function vF(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function yF(e){var t,i,a,h,d,p,s,w,A=e.x,z=e.y;return a=wr(A-this.long0,this.over),t=Math.sin(z),i=Math.cos(z),h=Math.cos(a),p=this.sin_p14*t+this.cos_p14*i*h,d=1,p>0||Math.abs(p)<=vr?(s=this.x0+this.a*d*i*Math.sin(a)/p,w=this.y0+this.a*d*(this.cos_p14*t-this.sin_p14*i*h)/p):(s=this.x0+this.infinity_dist*i*Math.sin(a),w=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*i*h)),e.x=s,e.y=w,e}function bF(e){var t,i,a,h,d,p;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(h=Math.atan2(t,this.rc),i=Math.sin(h),a=Math.cos(h),p=Ql(a*this.sin_p14+e.y*i*this.cos_p14/t),d=Math.atan2(e.x*i,t*this.cos_p14*a-e.y*this.sin_p14*i),d=wr(this.long0+d,this.over)):(p=this.phic0,d=0),e.x=d,e.y=p,e}var wF=["gnom"];const xF={init:vF,forward:yF,inverse:bF,names:wF};function MF(e,t){var i=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-i)<1e-6)return t<0?-1*rr:rr;for(var a=Math.asin(.5*t),h,d,p,s,w=0;w<30;w++)if(d=Math.sin(a),p=Math.cos(a),s=e*d,h=Math.pow(1-s*s,2)/(2*p)*(t/(1-e*e)-d/(1-s*s)+.5/e*Math.log((1-s)/(1+s))),a+=h,Math.abs(h)<=1e-10)return a;return NaN}function IF(){this.sphere||(this.k0=To(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function AF(e){var t=e.x,i=e.y,a,h,d=wr(t-this.long0,this.over);if(this.sphere)a=this.x0+this.a*d*Math.cos(this.lat_ts),h=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var p=Wl(this.e,Math.sin(i));a=this.x0+this.a*this.k0*d,h=this.y0+this.a*p*.5/this.k0}return e.x=a,e.y=h,e}function TF(e){e.x-=this.x0,e.y-=this.y0;var t,i;return this.sphere?(t=wr(this.long0+e.x/this.a/Math.cos(this.lat_ts),this.over),i=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(i=MF(this.e,2*e.y*this.k0/this.a),t=wr(this.long0+e.x/(this.a*this.k0),this.over)),e.x=t,e.y=i,e}var CF=["cea"];const SF={init:IF,forward:AF,inverse:TF,names:CF};function PF(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function EF(e){var t=e.x,i=e.y,a=wr(t-this.long0,this.over),h=sc(i-this.lat0);return e.x=this.x0+this.a*a*this.rc,e.y=this.y0+this.a*h,e}function kF(e){var t=e.x,i=e.y;return e.x=wr(this.long0+(t-this.x0)/(this.a*this.rc),this.over),e.y=sc(this.lat0+(i-this.y0)/this.a),e}var RF=["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"];const LF={init:PF,forward:EF,inverse:kF,names:RF};var u4=20;function zF(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Yp(this.es),this.e1=Kp(this.es),this.e2=$p(this.es),this.e3=Jp(this.es),this.ml0=this.a*Fs(this.e0,this.e1,this.e2,this.e3,this.lat0)}function FF(e){var t=e.x,i=e.y,a,h,d,p=wr(t-this.long0,this.over);if(d=p*Math.sin(i),this.sphere)Math.abs(i)<=vr?(a=this.a*p,h=-1*this.a*this.lat0):(a=this.a*Math.sin(d)/Math.tan(i),h=this.a*(sc(i-this.lat0)+(1-Math.cos(d))/Math.tan(i)));else if(Math.abs(i)<=vr)a=this.a*p,h=-1*this.ml0;else{var s=qy(this.a,this.e,Math.sin(i))/Math.tan(i);a=s*Math.sin(d),h=this.a*Fs(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+s*(1-Math.cos(d))}return e.x=a+this.x0,e.y=h+this.y0,e}function DF(e){var t,i,a,h,d,p,s,w,A;if(a=e.x-this.x0,h=e.y-this.y0,this.sphere)if(Math.abs(h+this.a*this.lat0)<=vr)t=wr(a/this.a+this.long0,this.over),i=0;else{p=this.lat0+h/this.a,s=a*a/this.a/this.a+p*p,w=p;var z;for(d=u4;d;--d)if(z=Math.tan(w),A=-1*(p*(w*z+1)-w-.5*(w*w+s)*z)/((w-p)/z-1),w+=A,Math.abs(A)<=vr){i=w;break}t=wr(this.long0+Math.asin(a*Math.tan(w)/this.a)/Math.sin(i),this.over)}else if(Math.abs(h+this.ml0)<=vr)i=0,t=wr(this.long0+a/this.a,this.over);else{p=(this.ml0+h)/this.a,s=a*a/this.a/this.a+p*p,w=p;var B,D,V,W,S;for(d=u4;d;--d)if(S=this.e*Math.sin(w),B=Math.sqrt(1-S*S)*Math.tan(w),D=this.a*Fs(this.e0,this.e1,this.e2,this.e3,w),V=this.e0-2*this.e1*Math.cos(2*w)+4*this.e2*Math.cos(4*w)-6*this.e3*Math.cos(6*w),W=D/this.a,A=(p*(B*W+1)-W-.5*B*(W*W+s))/(this.es*Math.sin(2*w)*(W*W+s-2*p*W)/(4*B)+(p-W)*(B*V-2/Math.sin(2*w))-V),w-=A,Math.abs(A)<=vr){i=w;break}B=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),t=wr(this.long0+Math.asin(a*B/this.a)/Math.sin(i),this.over)}return e.x=t,e.y=i,e}var BF=["Polyconic","American_Polyconic","poly"];const GF={init:zF,forward:FF,inverse:DF,names:BF};function VF(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function jF(e){var t,i=e.x,a=e.y,h=a-this.lat0,d=i-this.long0,p=h/qf*1e-5,s=d,w=1,A=0;for(t=1;t<=10;t++)w=w*p,A=A+this.A[t]*w;var z=A,B=s,D=1,V=0,W,S,j=0,ne=0;for(t=1;t<=6;t++)W=D*z-V*B,S=V*z+D*B,D=W,V=S,j=j+this.B_re[t]*D-this.B_im[t]*V,ne=ne+this.B_im[t]*D+this.B_re[t]*V;return e.x=ne*this.a+this.x0,e.y=j*this.a+this.y0,e}function ZF(e){var t,i=e.x,a=e.y,h=i-this.x0,d=a-this.y0,p=d/this.a,s=h/this.a,w=1,A=0,z,B,D=0,V=0;for(t=1;t<=6;t++)z=w*p-A*s,B=A*p+w*s,w=z,A=B,D=D+this.C_re[t]*w-this.C_im[t]*A,V=V+this.C_im[t]*w+this.C_re[t]*A;for(var W=0;W<this.iterations;W++){var S=D,j=V,ne,te,Q=p,N=s;for(t=2;t<=6;t++)ne=S*D-j*V,te=j*D+S*V,S=ne,j=te,Q=Q+(t-1)*(this.B_re[t]*S-this.B_im[t]*j),N=N+(t-1)*(this.B_im[t]*S+this.B_re[t]*j);S=1,j=0;var re=this.B_re[1],oe=this.B_im[1];for(t=2;t<=6;t++)ne=S*D-j*V,te=j*D+S*V,S=ne,j=te,re=re+t*(this.B_re[t]*S-this.B_im[t]*j),oe=oe+t*(this.B_im[t]*S+this.B_re[t]*j);var ve=re*re+oe*oe;D=(Q*re+N*oe)/ve,V=(N*re-Q*oe)/ve}var Pe=D,$=V,le=1,Me=0;for(t=1;t<=9;t++)le=le*Pe,Me=Me+this.D[t]*le;var Ve=this.lat0+Me*qf*1e5,Be=this.long0+$;return e.x=Be,e.y=Ve,e}var OF=["New_Zealand_Map_Grid","nzmg"];const NF={init:VF,forward:jF,inverse:ZF,names:OF};function UF(){}function HF(e){var t=e.x,i=e.y,a=wr(t-this.long0,this.over),h=this.x0+this.a*a,d=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return e.x=h,e.y=d,e}function WF(e){e.x-=this.x0,e.y-=this.y0;var t=wr(this.long0+e.x/this.a,this.over),i=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=i,e}var XF=["Miller_Cylindrical","mill"];const qF={init:UF,forward:HF,inverse:WF,names:XF};var YF=20;function KF(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Oy(this.es)}function $F(e){var t,i,a=e.x,h=e.y;if(a=wr(a-this.long0,this.over),this.sphere){if(!this.m)h=this.n!==1?Math.asin(this.n*Math.sin(h)):h;else for(var d=this.n*Math.sin(h),p=YF;p;--p){var s=(this.m*h+Math.sin(h)-d)/(this.m+Math.cos(h));if(h-=s,Math.abs(s)<vr)break}t=this.a*this.C_x*a*(this.m+Math.cos(h)),i=this.a*this.C_y*h}else{var w=Math.sin(h),A=Math.cos(h);i=this.a*ad(h,w,A,this.en),t=this.a*a*A/Math.sqrt(1-this.es*w*w)}return e.x=t,e.y=i,e}function JF(e){var t,i,a,h;return e.x-=this.x0,a=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,a=a/(this.C_x*(this.m+Math.cos(t))),this.m?t=Ql((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=Ql(Math.sin(t)/this.n)),a=wr(a+this.long0,this.over),t=sc(t)):(t=Ny(e.y/this.a,this.es,this.en),h=Math.abs(t),h<rr?(h=Math.sin(t),i=this.long0+e.x*Math.sqrt(1-this.es*h*h)/(this.a*Math.cos(t)),a=wr(i,this.over)):h-vr<rr&&(a=this.long0)),e.x=a,e.y=t,e}var QF=["Sinusoidal","sinu"];const eD={init:KF,forward:$F,inverse:JF,names:QF};function tD(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0}function rD(e){for(var t=e.x,i=e.y,a=wr(t-this.long0,this.over),h=i,d=Math.PI*Math.sin(i);;){var p=-(h+Math.sin(h)-d)/(1+Math.cos(h));if(h+=p,Math.abs(p)<vr)break}h/=2,Math.PI/2-Math.abs(i)<vr&&(a=0);var s=.900316316158*this.a*a*Math.cos(h)+this.x0,w=1.4142135623731*this.a*Math.sin(h)+this.y0;return e.x=s,e.y=w,e}function iD(e){var t,i;e.x-=this.x0,e.y-=this.y0,i=e.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),t=Math.asin(i);var a=wr(this.long0+e.x/(.900316316158*this.a*Math.cos(t)),this.over);a<-Math.PI&&(a=-Math.PI),a>Math.PI&&(a=Math.PI),i=(2*t+Math.sin(2*t))/Math.PI,Math.abs(i)>1&&(i=1);var h=Math.asin(i);return e.x=a,e.y=h,e}var nD=["Mollweide","moll"];const sD={init:tD,forward:rD,inverse:iD,names:nD};function aD(){Math.abs(this.lat1+this.lat2)<vr||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Yp(this.es),this.e1=Kp(this.es),this.e2=$p(this.es),this.e3=Jp(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=To(this.e,this.sin_phi,this.cos_phi),this.ml1=Fs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<vr?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=To(this.e,this.sin_phi,this.cos_phi),this.ml2=Fs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Fs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function oD(e){var t=e.x,i=e.y,a;if(this.sphere)a=this.a*(this.g-i);else{var h=Fs(this.e0,this.e1,this.e2,this.e3,i);a=this.a*(this.g-h)}var d=this.ns*wr(t-this.long0,this.over),p=this.x0+a*Math.sin(d),s=this.y0+this.rh-a*Math.cos(d);return e.x=p,e.y=s,e}function lD(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,i,a,h;this.ns>=0?(i=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(i=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var d=0;if(i!==0&&(d=Math.atan2(t*e.x,t*e.y)),this.sphere)return h=wr(this.long0+d/this.ns,this.over),a=sc(this.g-i/this.a),e.x=h,e.y=a,e;var p=this.g-i/this.a;return a=mg(p,this.e0,this.e1,this.e2,this.e3),h=wr(this.long0+d/this.ns,this.over),e.x=h,e.y=a,e}var cD=["Equidistant_Conic","eqdc"];const hD={init:aD,forward:oD,inverse:lD,names:cD};function uD(){this.R=this.a}function dD(e){var t=e.x,i=e.y,a=wr(t-this.long0,this.over),h,d;Math.abs(i)<=vr&&(h=this.x0+this.R*a,d=this.y0);var p=Ql(2*Math.abs(i/Math.PI));(Math.abs(a)<=vr||Math.abs(Math.abs(i)-rr)<=vr)&&(h=this.x0,i>=0?d=this.y0+Math.PI*this.R*Math.tan(.5*p):d=this.y0+Math.PI*this.R*-Math.tan(.5*p));var s=.5*Math.abs(Math.PI/a-a/Math.PI),w=s*s,A=Math.sin(p),z=Math.cos(p),B=z/(A+z-1),D=B*B,V=B*(2/A-1),W=V*V,S=Math.PI*this.R*(s*(B-W)+Math.sqrt(w*(B-W)*(B-W)-(W+w)*(D-W)))/(W+w);a<0&&(S=-S),h=this.x0+S;var j=w+B;return S=Math.PI*this.R*(V*j-s*Math.sqrt((W+w)*(w+1)-j*j))/(W+w),i>=0?d=this.y0+S:d=this.y0-S,e.x=h,e.y=d,e}function fD(e){var t,i,a,h,d,p,s,w,A,z,B,D,V;return e.x-=this.x0,e.y-=this.y0,B=Math.PI*this.R,a=e.x/B,h=e.y/B,d=a*a+h*h,p=-Math.abs(h)*(1+d),s=p-2*h*h+a*a,w=-2*p+1+2*h*h+d*d,V=h*h/w+(2*s*s*s/w/w/w-9*p*s/w/w)/27,A=(p-s*s/3/w)/w,z=2*Math.sqrt(-A/3),B=3*V/A/z,Math.abs(B)>1&&(B>=0?B=1:B=-1),D=Math.acos(B)/3,e.y>=0?i=(-z*Math.cos(D+Math.PI/3)-s/3/w)*Math.PI:i=-(-z*Math.cos(D+Math.PI/3)-s/3/w)*Math.PI,Math.abs(a)<vr?t=this.long0:t=wr(this.long0+Math.PI*(d-1+Math.sqrt(1+2*(a*a-h*h)+d*d))/2/a,this.over),e.x=t,e.y=i,e}var pD=["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"];const mD={init:uD,forward:dD,inverse:fD,names:pD};function gD(e,t,i,a,h,d){const p=a-t,s=Math.atan((1-d)*Math.tan(e)),w=Math.atan((1-d)*Math.tan(i)),A=Math.sin(s),z=Math.cos(s),B=Math.sin(w),D=Math.cos(w);let V=p,W,S=100,j,ne,te,Q,N,re,oe,ve,Pe,$,le,Me,Ve,Be;do{if(j=Math.sin(V),ne=Math.cos(V),te=Math.sqrt(D*j*(D*j)+(z*B-A*D*ne)*(z*B-A*D*ne)),te===0)return{azi1:0,s12:0};Q=A*B+z*D*ne,N=Math.atan2(te,Q),re=z*D*j/te,oe=1-re*re,ve=oe!==0?Q-2*A*B/oe:0,Pe=d/16*oe*(4+d*(4-3*oe)),W=V,V=p+(1-Pe)*d*re*(N+Pe*te*(ve+Pe*Q*(-1+2*ve*ve)))}while(Math.abs(V-W)>1e-12&&--S>0);return S===0?{azi1:NaN,s12:NaN}:($=oe*(h*h-h*(1-d)*(h*(1-d)))/(h*(1-d)*(h*(1-d))),le=1+$/16384*(4096+$*(-768+$*(320-175*$))),Me=$/1024*(256+$*(-128+$*(74-47*$))),Ve=Me*te*(ve+Me/4*(Q*(-1+2*ve*ve)-Me/6*ve*(-3+4*te*te)*(-3+4*ve*ve))),Be=h*(1-d)*le*(N-Ve),{azi1:Math.atan2(D*j,z*B-A*D*ne),s12:Be})}function _D(e,t,i,a,h,d){const p=Math.atan((1-d)*Math.tan(e)),s=Math.sin(p),w=Math.cos(p),A=Math.sin(i),z=Math.cos(i),B=Math.atan2(s,w*z),D=w*A,V=1-D*D,W=V*(h*h-h*(1-d)*(h*(1-d)))/(h*(1-d)*(h*(1-d))),S=1+W/16384*(4096+W*(-768+W*(320-175*W))),j=W/1024*(256+W*(-128+W*(74-47*W)));let ne=a/(h*(1-d)*S),te,Q=100,N,re,oe,ve;do N=Math.cos(2*B+ne),re=Math.sin(ne),oe=Math.cos(ne),ve=j*re*(N+j/4*(oe*(-1+2*N*N)-j/6*N*(-3+4*re*re)*(-3+4*N*N))),te=ne,ne=a/(h*(1-d)*S)+ve;while(Math.abs(ne-te)>1e-12&&--Q>0);if(Q===0)return{lat2:NaN,lon2:NaN};const Pe=s*re-w*oe*z,$=Math.atan2(s*oe+w*re*z,(1-d)*Math.sqrt(D*D+Pe*Pe)),le=Math.atan2(re*A,w*oe-s*re*z),Me=d/16*V*(4+d*(4-3*V)),Ve=le-(1-Me)*d*D*(ne+Me*re*(N+Me*oe*(-1+2*N*N))),Be=t+Ve;return{lat2:$,lon2:Be}}function vD(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))}function yD(e){var t=e.x,i=e.y,a=Math.sin(e.y),h=Math.cos(e.y),d=wr(t-this.long0,this.over),p,s,w,A,z,B,D,V,W,S,j;return this.sphere?Math.abs(this.sin_p12-1)<=vr?(e.x=this.x0+this.a*(rr-i)*Math.sin(d),e.y=this.y0-this.a*(rr-i)*Math.cos(d),e):Math.abs(this.sin_p12+1)<=vr?(e.x=this.x0+this.a*(rr+i)*Math.sin(d),e.y=this.y0+this.a*(rr+i)*Math.cos(d),e):(W=this.sin_p12*a+this.cos_p12*h*Math.cos(d),D=Math.acos(W),V=D?D/Math.sin(D):1,e.x=this.x0+this.a*V*h*Math.sin(d),e.y=this.y0+this.a*V*(this.cos_p12*a-this.sin_p12*h*Math.cos(d)),e):(p=Yp(this.es),s=Kp(this.es),w=$p(this.es),A=Jp(this.es),Math.abs(this.sin_p12-1)<=vr?(z=this.a*Fs(p,s,w,A,rr),B=this.a*Fs(p,s,w,A,i),e.x=this.x0+(z-B)*Math.sin(d),e.y=this.y0-(z-B)*Math.cos(d),e):Math.abs(this.sin_p12+1)<=vr?(z=this.a*Fs(p,s,w,A,rr),B=this.a*Fs(p,s,w,A,i),e.x=this.x0+(z+B)*Math.sin(d),e.y=this.y0+(z+B)*Math.cos(d),e):Math.abs(t)<vr&&Math.abs(i-this.lat0)<vr?(e.x=e.y=0,e):(S=gD(this.lat0,this.long0,i,t,this.a,this.f),j=S.azi1,e.x=S.s12*Math.sin(j),e.y=S.s12*Math.cos(j),e))}function bD(e){e.x-=this.x0,e.y-=this.y0;var t,i,a,h,d,p,s,w,A,z,B,D,V,W,S,j;return this.sphere?(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*rr*this.a?void 0:(i=t/this.a,a=Math.sin(i),h=Math.cos(i),d=this.long0,Math.abs(t)<=vr?p=this.lat0:(p=Ql(h*this.sin_p12+e.y*a*this.cos_p12/t),s=Math.abs(this.lat0)-rr,Math.abs(s)<=vr?this.lat0>=0?d=wr(this.long0+Math.atan2(e.x,-e.y),this.over):d=wr(this.long0-Math.atan2(-e.x,e.y),this.over):d=wr(this.long0+Math.atan2(e.x*a,t*this.cos_p12*h-e.y*this.sin_p12*a),this.over)),e.x=d,e.y=p,e)):(w=Yp(this.es),A=Kp(this.es),z=$p(this.es),B=Jp(this.es),Math.abs(this.sin_p12-1)<=vr?(D=this.a*Fs(w,A,z,B,rr),t=Math.sqrt(e.x*e.x+e.y*e.y),V=D-t,p=mg(V/this.a,w,A,z,B),d=wr(this.long0+Math.atan2(e.x,-1*e.y),this.over),e.x=d,e.y=p,e):Math.abs(this.sin_p12+1)<=vr?(D=this.a*Fs(w,A,z,B,rr),t=Math.sqrt(e.x*e.x+e.y*e.y),V=t-D,p=mg(V/this.a,w,A,z,B),d=wr(this.long0+Math.atan2(e.x,e.y),this.over),e.x=d,e.y=p,e):(W=Math.atan2(e.x,e.y),S=Math.sqrt(e.x*e.x+e.y*e.y),j=_D(this.lat0,this.long0,W,S,this.a,this.f),e.x=j.lon2,e.y=j.lat2,e))}var wD=["Azimuthal_Equidistant","aeqd"];const xD={init:vD,forward:yD,inverse:bD,names:wD};function MD(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function ID(e){var t,i,a,h,d,p,s,w,A=e.x,z=e.y;return a=wr(A-this.long0,this.over),t=Math.sin(z),i=Math.cos(z),h=Math.cos(a),p=this.sin_p14*t+this.cos_p14*i*h,d=1,(p>0||Math.abs(p)<=vr)&&(s=this.a*d*i*Math.sin(a),w=this.y0+this.a*d*(this.cos_p14*t-this.sin_p14*i*h)),e.x=s,e.y=w,e}function AD(e){var t,i,a,h,d,p,s;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),i=Ql(t/this.a),a=Math.sin(i),h=Math.cos(i),p=this.long0,Math.abs(t)<=vr?(s=this.lat0,e.x=p,e.y=s,e):(s=Ql(h*this.sin_p14+e.y*a*this.cos_p14/t),d=Math.abs(this.lat0)-rr,Math.abs(d)<=vr?(this.lat0>=0?p=wr(this.long0+Math.atan2(e.x,-e.y),this.over):p=wr(this.long0-Math.atan2(-e.x,e.y),this.over),e.x=p,e.y=s,e):(p=wr(this.long0+Math.atan2(e.x*a,t*this.cos_p14*h-e.y*this.sin_p14*a),this.over),e.x=p,e.y=s,e))}var TD=["ortho"];const CD={init:MD,forward:ID,inverse:AD,names:TD};var An={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Hi={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function SD(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=rr-Ui/2?this.face=An.TOP:this.lat0<=-(rr-Ui/2)?this.face=An.BOTTOM:Math.abs(this.long0)<=Ui?this.face=An.FRONT:Math.abs(this.long0)<=rr+Ui?this.face=this.long0>0?An.RIGHT:An.LEFT:this.face=An.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function PD(e){var t={x:0,y:0},i,a,h,d,p,s,w={value:0};if(e.x-=this.long0,this.es!==0?i=Math.atan(this.one_minus_f_squared*Math.tan(e.y)):i=e.y,a=e.x,this.face===An.TOP)d=rr-i,a>=Ui&&a<=rr+Ui?(w.value=Hi.AREA_0,h=a-rr):a>rr+Ui||a<=-(rr+Ui)?(w.value=Hi.AREA_1,h=a>0?a-gs:a+gs):a>-(rr+Ui)&&a<=-Ui?(w.value=Hi.AREA_2,h=a+rr):(w.value=Hi.AREA_3,h=a);else if(this.face===An.BOTTOM)d=rr+i,a>=Ui&&a<=rr+Ui?(w.value=Hi.AREA_0,h=-a+rr):a<Ui&&a>=-Ui?(w.value=Hi.AREA_1,h=-a):a<-Ui&&a>=-(rr+Ui)?(w.value=Hi.AREA_2,h=-a-rr):(w.value=Hi.AREA_3,h=a>0?-a+gs:-a-gs);else{var A,z,B,D,V,W,S;this.face===An.RIGHT?a=ju(a,+rr):this.face===An.BACK?a=ju(a,3.14159265359):this.face===An.LEFT&&(a=ju(a,-rr)),D=Math.sin(i),V=Math.cos(i),W=Math.sin(a),S=Math.cos(a),A=V*S,z=V*W,B=D,this.face===An.FRONT?(d=Math.acos(A),h=xm(d,B,z,w)):this.face===An.RIGHT?(d=Math.acos(z),h=xm(d,B,-A,w)):this.face===An.BACK?(d=Math.acos(-A),h=xm(d,B,-z,w)):this.face===An.LEFT?(d=Math.acos(-z),h=xm(d,B,A,w)):(d=h=0,w.value=Hi.AREA_0)}return s=Math.atan(12/gs*(h+Math.acos(Math.sin(h)*Math.cos(Ui))-rr)),p=Math.sqrt((1-Math.cos(d))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(h))))),w.value===Hi.AREA_1?s+=rr:w.value===Hi.AREA_2?s+=gs:w.value===Hi.AREA_3&&(s+=1.5*gs),t.x=p*Math.cos(s),t.y=p*Math.sin(s),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,e.x=t.x,e.y=t.y,e}function ED(e){var t={lam:0,phi:0},i,a,h,d,p,s,w,A,z,B={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,a=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),i=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?B.value=Hi.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(B.value=Hi.AREA_1,i-=rr):e.x<0&&-e.x>=Math.abs(e.y)?(B.value=Hi.AREA_2,i=i<0?i+gs:i-gs):(B.value=Hi.AREA_3,i+=rr),z=gs/12*Math.tan(i),p=Math.sin(z)/(Math.cos(z)-1/Math.sqrt(2)),s=Math.atan(p),h=Math.cos(i),d=Math.tan(a),w=1-h*h*d*d*(1-Math.cos(Math.atan(1/Math.cos(s)))),w<-1?w=-1:w>1&&(w=1),this.face===An.TOP)A=Math.acos(w),t.phi=rr-A,B.value===Hi.AREA_0?t.lam=s+rr:B.value===Hi.AREA_1?t.lam=s<0?s+gs:s-gs:B.value===Hi.AREA_2?t.lam=s-rr:t.lam=s;else if(this.face===An.BOTTOM)A=Math.acos(w),t.phi=A-rr,B.value===Hi.AREA_0?t.lam=-s+rr:B.value===Hi.AREA_1?t.lam=-s:B.value===Hi.AREA_2?t.lam=-s-rr:t.lam=s<0?-s-gs:-s+gs;else{var D,V,W;D=w,z=D*D,z>=1?W=0:W=Math.sqrt(1-z)*Math.sin(s),z+=W*W,z>=1?V=0:V=Math.sqrt(1-z),B.value===Hi.AREA_1?(z=V,V=-W,W=z):B.value===Hi.AREA_2?(V=-V,W=-W):B.value===Hi.AREA_3&&(z=V,V=W,W=-z),this.face===An.RIGHT?(z=D,D=-V,V=z):this.face===An.BACK?(D=-D,V=-V):this.face===An.LEFT&&(z=D,D=V,V=-z),t.phi=Math.acos(-W)-rr,t.lam=Math.atan2(V,D),this.face===An.RIGHT?t.lam=ju(t.lam,-rr):this.face===An.BACK?t.lam=ju(t.lam,-3.14159265359):this.face===An.LEFT&&(t.lam=ju(t.lam,+rr))}if(this.es!==0){var S,j,ne;S=t.phi<0?1:0,j=Math.tan(t.phi),ne=this.b/Math.sqrt(j*j+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-ne*ne)/(this.one_minus_f*ne)),S&&(t.phi=-t.phi)}return t.lam+=this.long0,e.x=t.lam,e.y=t.phi,e}function xm(e,t,i,a){var h;return e<vr?(a.value=Hi.AREA_0,h=0):(h=Math.atan2(t,i),Math.abs(h)<=Ui?a.value=Hi.AREA_0:h>Ui&&h<=rr+Ui?(a.value=Hi.AREA_1,h-=rr):h>rr+Ui||h<=-(rr+Ui)?(a.value=Hi.AREA_2,h=h>=0?h-gs:h+gs):(a.value=Hi.AREA_3,h+=rr)),h}function ju(e,t){var i=e+t;return i<-3.14159265359?i+=hp:i>3.14159265359&&(i-=hp),i}var kD=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const RD={init:SD,forward:PD,inverse:ED,names:kD};var qv=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Gf=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],R3=.8487,L3=1.3523,z3=qs/5,LD=1/z3,Lu=18,gg=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},zD=function(e,t){return e[1]+t*(2*e[2]+t*3*e[3])};function FD(e,t,i,a){for(var h=t;a;--a){var d=e(h);if(h-=d,Math.abs(d)<i)break}return h}function DD(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function BD(e){var t=wr(e.x-this.long0,this.over),i=Math.abs(e.y),a=Math.floor(i*z3);a<0?a=0:a>=Lu&&(a=Lu-1),i=qs*(i-LD*a);var h={x:gg(qv[a],i)*t,y:gg(Gf[a],i)};return e.y<0&&(h.y=-h.y),h.x=h.x*this.a*R3+this.x0,h.y=h.y*this.a*L3+this.y0,h}function GD(e){var t={x:(e.x-this.x0)/(this.a*R3),y:Math.abs(e.y-this.y0)/(this.a*L3)};if(t.y>=1)t.x/=qv[Lu][0],t.y=e.y<0?-rr:rr;else{var i=Math.floor(t.y*Lu);for(i<0?i=0:i>=Lu&&(i=Lu-1);;)if(Gf[i][0]>t.y)--i;else if(Gf[i+1][0]<=t.y)++i;else break;var a=Gf[i],h=5*(t.y-a[0])/(Gf[i+1][0]-a[0]);h=FD(function(d){return(gg(a,d)-t.y)/zD(a,d)},h,vr,100),t.x/=gg(qv[i],h),t.y=(5*i+h)*Rn,e.y<0&&(t.y=-t.y)}return t.x=wr(t.x+this.long0,this.over),t}var VD=["Robinson","robin"];const jD={init:DD,forward:BD,inverse:GD,names:VD};function ZD(){this.name="geocent"}function OD(e){var t=w3(e,this.es,this.a);return t}function ND(e){var t=x3(e,this.es,this.a,this.b);return t}var UD=["Geocentric","geocentric","geocent","Geocent"];const HD={init:ZD,forward:OD,inverse:ND,names:UD};var bs={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},If={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function WD(){if(Object.keys(If).forEach((function(i){if(typeof this[i]>"u")this[i]=If[i].def;else{if(If[i].num&&isNaN(this[i]))throw new Error("Invalid parameter value, must be numeric "+i+" = "+this[i]);If[i].num&&(this[i]=parseFloat(this[i]))}If[i].degrees&&(this[i]=this[i]*Rn)}).bind(this)),Math.abs(Math.abs(this.lat0)-rr)<vr?this.mode=this.lat0<0?bs.S_POLE:bs.N_POLE:Math.abs(this.lat0)<vr?this.mode=bs.EQUIT:(this.mode=bs.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)}function XD(e){e.x-=this.long0;var t=Math.sin(e.y),i=Math.cos(e.y),a=Math.cos(e.x),h,d;switch(this.mode){case bs.OBLIQ:d=this.sinph0*t+this.cosph0*i*a;break;case bs.EQUIT:d=i*a;break;case bs.S_POLE:d=-t;break;case bs.N_POLE:d=t;break}switch(d=this.pn1/(this.p-d),h=d*i*Math.sin(e.x),this.mode){case bs.OBLIQ:d*=this.cosph0*t-this.sinph0*i*a;break;case bs.EQUIT:d*=t;break;case bs.N_POLE:d*=-(i*a);break;case bs.S_POLE:d*=i*a;break}var p,s;return p=d*this.cg+h*this.sg,s=1/(p*this.sw*this.h1+this.cw),h=(h*this.cg-d*this.sg)*this.cw*s,d=p*s,e.x=h*this.a,e.y=d*this.a,e}function qD(e){e.x/=this.a,e.y/=this.a;var t={x:e.x,y:e.y},i,a,h;h=1/(this.pn1-e.y*this.sw),i=this.pn1*e.x*h,a=this.pn1*e.y*this.cw*h,e.x=i*this.cg+a*this.sg,e.y=a*this.cg-i*this.sg;var d=Ws(e.x,e.y);if(Math.abs(d)<vr)t.x=0,t.y=e.y;else{var p,s;switch(s=1-d*d*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/d+d/this.pn1),p=Math.sqrt(1-s*s),this.mode){case bs.OBLIQ:t.y=Math.asin(p*this.sinph0+e.y*s*this.cosph0/d),e.y=(p-this.sinph0*Math.sin(t.y))*d,e.x*=s*this.cosph0;break;case bs.EQUIT:t.y=Math.asin(e.y*s/d),e.y=p*d,e.x*=s;break;case bs.N_POLE:t.y=Math.asin(p),e.y=-e.y;break;case bs.S_POLE:t.y=-Math.asin(p);break}t.x=Math.atan2(e.x,e.y)}return e.x=t.x+this.long0,e.y=t.y,e}var YD=["Tilted_Perspective","tpers"];const KD={init:WD,forward:XD,inverse:qD,names:YD};function $D(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var e=1-this.es,t=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function JD(e){var t=e.x,i=e.y,a,h,d,p;if(t=t-this.long0,this.shape==="ellipse"){i=Math.atan(this.radius_p2*Math.tan(i));var s=this.radius_p/Ws(this.radius_p*Math.cos(i),Math.sin(i));if(h=s*Math.cos(t)*Math.cos(i),d=s*Math.sin(t)*Math.cos(i),p=s*Math.sin(i),(this.radius_g-h)*h-d*d-p*p*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;a=this.radius_g-h,this.flip_axis?(e.x=this.radius_g_1*Math.atan(d/Ws(p,a)),e.y=this.radius_g_1*Math.atan(p/a)):(e.x=this.radius_g_1*Math.atan(d/a),e.y=this.radius_g_1*Math.atan(p/Ws(d,a)))}else this.shape==="sphere"&&(a=Math.cos(i),h=Math.cos(t)*a,d=Math.sin(t)*a,p=Math.sin(i),a=this.radius_g-h,this.flip_axis?(e.x=this.radius_g_1*Math.atan(d/Ws(p,a)),e.y=this.radius_g_1*Math.atan(p/a)):(e.x=this.radius_g_1*Math.atan(d/a),e.y=this.radius_g_1*Math.atan(p/Ws(d,a))));return e.x=e.x*this.a,e.y=e.y*this.a,e}function QD(e){var t=-1,i=0,a=0,h,d,p,s;if(e.x=e.x/this.a,e.y=e.y/this.a,this.shape==="ellipse"){this.flip_axis?(a=Math.tan(e.y/this.radius_g_1),i=Math.tan(e.x/this.radius_g_1)*Ws(1,a)):(i=Math.tan(e.x/this.radius_g_1),a=Math.tan(e.y/this.radius_g_1)*Ws(1,i));var w=a/this.radius_p;if(h=i*i+w*w+t*t,d=2*this.radius_g*t,p=d*d-4*h*this.C,p<0)return e.x=Number.NaN,e.y=Number.NaN,e;s=(-d-Math.sqrt(p))/(2*h),t=this.radius_g+s*t,i*=s,a*=s,e.x=Math.atan2(i,t),e.y=Math.atan(a*Math.cos(e.x)/t),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if(this.shape==="sphere"){if(this.flip_axis?(a=Math.tan(e.y/this.radius_g_1),i=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+a*a)):(i=Math.tan(e.x/this.radius_g_1),a=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+i*i)),h=i*i+a*a+t*t,d=2*this.radius_g*t,p=d*d-4*h*this.C,p<0)return e.x=Number.NaN,e.y=Number.NaN,e;s=(-d-Math.sqrt(p))/(2*h),t=this.radius_g+s*t,i*=s,a*=s,e.x=Math.atan2(i,t),e.y=Math.atan(a*Math.cos(e.x)/t)}return e.x=e.x+this.long0,e}var eB=["Geostationary Satellite View","Geostationary_Satellite","geos"];const tB={init:$D,forward:JD,inverse:QD,names:eB};var Yf=1.340264,Kf=-.081106,$f=893e-6,Jf=.003796,_g=Math.sqrt(3)/2;function rB(){this.es=0,this.long0=this.long0!==void 0?this.long0:0,this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0}function iB(e){var t=wr(e.x-this.long0,this.over),i=e.y,a=Math.asin(_g*Math.sin(i)),h=a*a,d=h*h*h;return e.x=t*Math.cos(a)/(_g*(Yf+3*Kf*h+d*(7*$f+9*Jf*h))),e.y=a*(Yf+Kf*h+d*($f+Jf*h)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function nB(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var t=1e-9,i=12,a=e.y,h,d,p,s,w,A;for(A=0;A<i&&(h=a*a,d=h*h*h,p=a*(Yf+Kf*h+d*($f+Jf*h))-e.y,s=Yf+3*Kf*h+d*(7*$f+9*Jf*h),a-=w=p/s,!(Math.abs(w)<t));++A);return h=a*a,d=h*h*h,e.x=_g*e.x*(Yf+3*Kf*h+d*(7*$f+9*Jf*h))/Math.cos(a),e.y=Math.asin(Math.sin(a)/_g),e.x=wr(e.x+this.long0,this.over),e}var sB=["eqearth","Equal Earth","Equal_Earth"];const aB={init:rB,forward:iB,inverse:nB,names:sB};var fp=1e-10;function oB(){var e;if(this.phi1=this.lat1,Math.abs(this.phi1)<fp)throw new Error;this.es?(this.en=Oy(this.es),this.m1=ad(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=cB,this.forward=lB):(Math.abs(this.phi1)+fp>=rr?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=uB,this.forward=hB)}function lB(e){var t=wr(e.x-(this.long0||0),this.over),i=e.y,a,h,d;return a=this.am1+this.m1-ad(i,h=Math.sin(i),d=Math.cos(i),this.en),h=d*t/(a*Math.sqrt(1-this.es*h*h)),e.x=a*Math.sin(h),e.y=this.am1-a*Math.cos(h),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function cB(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,i,a,h;if(i=Ws(e.x,e.y=this.am1-e.y),h=Ny(this.am1+this.m1-i,this.es,this.en),(t=Math.abs(h))<rr)t=Math.sin(h),a=i*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*t*t)/Math.cos(h);else if(Math.abs(t-rr)<=fp)a=0;else throw new Error;return e.x=wr(a+(this.long0||0),this.over),e.y=sc(h),e}function hB(e){var t=wr(e.x-(this.long0||0),this.over),i=e.y,a,h;return h=this.cphi1+this.phi1-i,Math.abs(h)>fp?(e.x=h*Math.sin(a=t*Math.cos(i)/h),e.y=this.cphi1-h*Math.cos(a)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function uB(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,i,a=Ws(e.x,e.y=this.cphi1-e.y);if(i=this.cphi1+this.phi1-a,Math.abs(i)>rr)throw new Error;return Math.abs(Math.abs(i)-rr)<=fp?t=0:t=a*Math.atan2(e.x,e.y)/Math.cos(i),e.x=wr(t+(this.long0||0),this.over),e.y=sc(i),e}var dB=["bonne","Bonne (Werner lat_1=90)"];const fB={init:oB,names:dB},d4={OBLIQUE:{forward:vB,inverse:bB},TRANSVERSE:{forward:yB,inverse:wB}},vg={ROTATE:{o_alpha:"oAlpha",o_lon_c:"oLongC",o_lat_c:"oLatC"},NEW_POLE:{o_lat_p:"oLatP",o_lon_p:"oLongP"},NEW_EQUATOR:{o_lon_1:"oLong1",o_lat_1:"oLat1",o_lon_2:"oLong2",o_lat_2:"oLat2"}};function pB(){if(this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.title=this.title||"General Oblique Transformation",this.isIdentity=_3.includes(this.o_proj),!this.o_proj)throw new Error("Missing parameter: o_proj");if(this.o_proj==="ob_tran")throw new Error("Invalid value for o_proj: "+this.o_proj);const e=this.projStr.replace("+proj=ob_tran","").replace("+o_proj=","+proj=").trim(),t=Aa(e);if(!t)throw new Error("Invalid parameter: o_proj. Unknown projection "+this.o_proj);t.long0=0,this.obliqueProjection=t;let i;const a=Object.keys(vg),h=s=>{if(typeof this[s]>"u")return;const w=parseFloat(this[s])*Rn;if(isNaN(w))throw new Error("Invalid value for "+s+": "+this[s]);return w};for(let s=0;s<a.length;s++){const w=a[s],A=vg[w],z=Object.entries(A);if(z.some(([D])=>typeof this[D]<"u")){i=A;for(let D=0;D<z.length;D++){const[V,W]=z[D],S=h(V);if(typeof S>"u")throw new Error("Missing parameter: "+V+".");this[W]=S}break}}if(!i)throw new Error("No valid parameters provided for ob_tran projection.");const{lamp:d,phip:p}=_B(this,i);this.lamp=d,Math.abs(p)>vr?(this.cphip=Math.cos(p),this.sphip=Math.sin(p),this.projectionType=d4.OBLIQUE):this.projectionType=d4.TRANSVERSE}function mB(e){return this.projectionType.forward(this,e)}function gB(e){return this.projectionType.inverse(this,e)}function _B(e,t){let i,a;if(t===vg.ROTATE){let h=e.oLongC,d=e.oLatC,p=e.oAlpha;if(Math.abs(Math.abs(d)-rr)<=vr)throw new Error("Invalid value for o_lat_c: "+e.o_lat_c+" should be < 90Â°");a=h+Math.atan2(-1*Math.cos(p),-1*Math.sin(p)*Math.sin(d)),i=Math.asin(Math.cos(d)*Math.sin(p))}else if(t===vg.NEW_POLE)a=e.oLongP,i=e.oLatP;else{let h=e.oLong1,d=e.oLat1,p=e.oLong2,s=e.oLat2,w=Math.abs(d);if(Math.abs(d)>rr-vr)throw new Error("Invalid value for o_lat_1: "+e.o_lat_1+" should be < 90Â°");if(Math.abs(s)>rr-vr)throw new Error("Invalid value for o_lat_2: "+e.o_lat_2+" should be < 90Â°");if(Math.abs(d-s)<vr)throw new Error("Invalid value for o_lat_1 and o_lat_2: o_lat_1 should be different from o_lat_2");if(w<vr)throw new Error("Invalid value for o_lat_1: o_lat_1 should be different from zero");a=Math.atan2(Math.cos(d)*Math.sin(s)*Math.cos(h)-Math.sin(d)*Math.cos(s)*Math.cos(p),Math.sin(d)*Math.cos(s)*Math.sin(p)-Math.cos(d)*Math.sin(s)*Math.sin(h)),i=Math.atan(-1*Math.cos(a-h)/Math.tan(d))}return{lamp:a,phip:i}}function vB(e,t){let{x:i,y:a}=t;i+=e.long0;const h=Math.cos(i),d=Math.sin(a),p=Math.cos(a);t.x=wr(Math.atan2(p*Math.sin(i),e.sphip*p*h+e.cphip*d)+e.lamp),t.y=Math.asin(e.sphip*d-e.cphip*p*h);const s=e.obliqueProjection.forward(t);return e.isIdentity&&(s.x*=qs,s.y*=qs),s}function yB(e,t){let{x:i,y:a}=t;i+=e.long0;const h=Math.cos(a),d=Math.cos(i);t.x=wr(Math.atan2(h*Math.sin(i),Math.sin(a))+e.lamp),t.y=Math.asin(-1*h*d);const p=e.obliqueProjection.forward(t);return e.isIdentity&&(p.x*=qs,p.y*=qs),p}function bB(e,t){e.isIdentity&&(t.x*=Rn,t.y*=Rn);const i=e.obliqueProjection.inverse(t);let{x:a,y:h}=i;if(a<Number.MAX_VALUE){a-=e.lamp;const d=Math.cos(a),p=Math.sin(h),s=Math.cos(h);t.x=Math.atan2(s*Math.sin(a),e.sphip*s*d-e.cphip*p),t.y=Math.asin(e.sphip*p+e.cphip*s*d)}return t.x=wr(t.x+e.long0),t}function wB(e,t){e.isIdentity&&(t.x*=Rn,t.y*=Rn);const i=e.obliqueProjection.inverse(t);let{x:a,y:h}=i;if(a<Number.MAX_VALUE){const d=Math.cos(h);a-=e.lamp,t.x=Math.atan2(d*Math.sin(a),-1*Math.sin(h)),t.y=Math.asin(d*Math.cos(a))}return t.x=wr(t.x+e.long0),t}var xB=["General Oblique Transformation","General_Oblique_Transformation","ob_tran"];const MB={init:pB,forward:mB,inverse:gB,names:xB};function IB(e){e.Proj.projections.add(Hm),e.Proj.projections.add(Wm),e.Proj.projections.add(dz),e.Proj.projections.add(wz),e.Proj.projections.add(Tz),e.Proj.projections.add(kz),e.Proj.projections.add(Bz),e.Proj.projections.add(Oz),e.Proj.projections.add(Xz),e.Proj.projections.add(Jz),e.Proj.projections.add(uF),e.Proj.projections.add(_F),e.Proj.projections.add(xF),e.Proj.projections.add(SF),e.Proj.projections.add(LF),e.Proj.projections.add(GF),e.Proj.projections.add(NF),e.Proj.projections.add(qF),e.Proj.projections.add(eD),e.Proj.projections.add(sD),e.Proj.projections.add(hD),e.Proj.projections.add(mD),e.Proj.projections.add(xD),e.Proj.projections.add(CD),e.Proj.projections.add(RD),e.Proj.projections.add(jD),e.Proj.projections.add(HD),e.Proj.projections.add(KD),e.Proj.projections.add(tB),e.Proj.projections.add(aB),e.Proj.projections.add(fB),e.Proj.projections.add(MB)}const la=Object.assign(PL,{defaultDatum:"WGS84",Proj:Aa,WGS84:new Aa("WGS84"),Point:Qu,toPoint:M3,defs:ms,nadgrid:uL,transform:pg,mgrs:EL,version:"__VERSION__"});IB(la);const AB="EPSG:4326",TB="+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees",CB='GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]]',SB='GEOGCRS["WGS 84",ENSEMBLE["World Geodetic System 1984 ensemble",MEMBER["World Geodetic System 1984 (Transit)"],MEMBER["World Geodetic System 1984 (G730)"],MEMBER["World Geodetic System 1984 (G873)"],MEMBER["World Geodetic System 1984 (G1150)"],MEMBER["World Geodetic System 1984 (G1674)"],MEMBER["World Geodetic System 1984 (G1762)"],MEMBER["World Geodetic System 1984 (G2139)"],MEMBER["World Geodetic System 1984 (G2296)"],ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ENSEMBLEACCURACY[2.0]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],CS[ellipsoidal,2],AXIS["geodetic latitude (Lat)",north,ORDER[1],ANGLEUNIT["degree",0.0174532925199433]],AXIS["geodetic longitude (Lon)",east,ORDER[2],ANGLEUNIT["degree",0.0174532925199433]],USAGE[SCOPE["Horizontal component of 3D system."],AREA["World."],BBOX[-90,-180,90,180]],ID["EPSG",4326]]',F3=[AB,TB,CB,SB,"+proj=longlat +datum=WGS84 +no_defs +type=crs","WGS84"],PB="EPSG:3857",EB="+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs +type=crs",kB='PROJCS["WGS 84 / Pseudo-Mercator",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Mercator_1SP"],PARAMETER["central_meridian",0],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs"],AUTHORITY["EPSG","3857"]]',RB='PROJCRS["WGS 84 / Pseudo-Mercator",BASEGEOGCRS["WGS 84",ENSEMBLE["World Geodetic System 1984 ensemble",MEMBER["World Geodetic System 1984 (Transit)"],MEMBER["World Geodetic System 1984 (G730)"],MEMBER["World Geodetic System 1984 (G873)"],MEMBER["World Geodetic System 1984 (G1150)"],MEMBER["World Geodetic System 1984 (G1674)"],MEMBER["World Geodetic System 1984 (G1762)"],MEMBER["World Geodetic System 1984 (G2139)"],MEMBER["World Geodetic System 1984 (G2296)"],ELLIPSOID["WGS 84",6378137,298.257223563,LENGTHUNIT["metre",1]],ENSEMBLEACCURACY[2.0]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433]],ID["EPSG",4326]],CONVERSION["Popular Visualisation Pseudo-Mercator",METHOD["Popular Visualisation Pseudo Mercator",ID["EPSG",1024]],PARAMETER["Latitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8801]],PARAMETER["Longitude of natural origin",0,ANGLEUNIT["degree",0.0174532925199433],ID["EPSG",8802]],PARAMETER["False easting",0,LENGTHUNIT["metre",1],ID["EPSG",8806]],PARAMETER["False northing",0,LENGTHUNIT["metre",1],ID["EPSG",8807]]],CS[Cartesian,2],AXIS["easting (X)",east,ORDER[1],LENGTHUNIT["metre",1]],AXIS["northing (Y)",north,ORDER[2],LENGTHUNIT["metre",1]],USAGE[SCOPE["Web mapping and visualisation."],AREA["World between 85.06Â°S and 85.06Â°N."],BBOX[-85.06,-180,85.06,180]],ID["EPSG",3857]]',D3=[PB,EB,kB,RB,"EPSG:3785","GOOGLE","EPSG:900913","EPSG:102113"],Ia={name:"EPSG:4326 - WGS 84",definition:F3[0]},Ta={name:"EPSG:3857 - WGS 84 / Pseudo-Mercator",definition:D3[0]},LB={internalProjection:Ta,projection:Ta,...c3};({...c3});const B3=la(Ia.definition,Ta.definition),Af=B3.forward;B3.inverse;function f4(e){const t=F3.indexOf(e),i=D3.indexOf(e);return t!=-1?Ia.definition:i!=-1?Ta.definition:e}function yg(e,t){return f4(String(e==null?void 0:e.definition))==f4(String(t==null?void 0:t.definition))}class bg extends Gy{constructor(i,a="polynomial",h){const d=Nm(LB,h),p=la(d.internalProjection.definition,d.projection.definition),s=p.forward,w=p.inverse,A=la(Ia.definition,d.projection.definition),z=A.forward,B=A.inverse,D={...h,postToGeo:s,preToResource:w};i=i.filter(V=>V.geo&&V.resource).map(V=>({resource:V.resource,geo:z(V.geo)}));super(i,a,D);Ke(this,"internalProjection");Ke(this,"projection");Ke(this,"internalProjectionToProjection");Ke(this,"projectionToInternalProjection");Ke(this,"lonLatToProjection");Ke(this,"projectionToLonLat");this.internalProjection=d.internalProjection,this.projection=d.projection,this.internalProjectionToProjection=s,this.projectionToInternalProjection=w,this.lonLatToProjection=z,this.projectionToLonLat=B}get gcps(){return super.gcps}get lonlatGcps(){return this.projectedGcps.map(({resource:i,geo:a})=>({resource:i,geo:this.projectionToLonLat(a)}))}get interalProjectedGcps(){return this.projectedGcps.map(({resource:i,geo:a})=>({resource:i,geo:this.projectionToInternalProjection(a)}))}get projectedGcps(){return this.gcps}transformToGeo(i,a,h){const d=a==null?void 0:a.projection;let p=a;if(d){const s=la(this.internalProjection.definition,d.definition),w=s.forward,A=s.inverse;p=ls(p,{postToGeo:w,preToResource:A})}return super.transformToGeo(i,p,h)}transformToResource(i,a,h){const d=a==null?void 0:a.projection;let p=a;if(d){const s=la(this.internalProjection.definition,d.definition),w=s.forward,A=s.inverse;p=ls(p,{postToGeo:w,preToResource:A})}return super.transformToResource(i,p,h)}static fromGeoreferencedMap(i,a){var d;const h={transformationType:(d=i.transformation)==null?void 0:d.type,internalProjection:i.resourceCrs};return a=zi(h,a),new bg(i.gcps,a.transformationType,a)}static setProjection(i,a){if(yg(a,i.projection))return i;const h=la(i.internalProjection.definition,a.definition),d=h.forward,p=h.inverse,s=la(Ia.definition,a.definition),w=s.forward,A=s.inverse,z={postToGeo:d,preToResource:p};return i.setTransformerOptionsInternal(z),i.projection=a,i.internalProjectionToProjection=d,i.projectionToInternalProjection=p,i.lonLatToProjection=w,i.projectionToLonLat=A,i}}var nr=(e=>(e.IMAGEINFOSADDED="imageinfosadded",e.GEOREFERENCEANNOTATIONADDED="georeferenceannotationadded",e.GEOREFERENCEANNOTATIONREMOVED="georeferenceannotationremoved",e.WARPEDMAPADDED="warpedmapadded",e.WARPEDMAPREMOVED="warpedmapremoved",e.WARPEDMAPENTERED="warpedmapentered",e.WARPEDMAPLEFT="warpedmapleft",e.IMAGELOADED="imageloaded",e.TILEFETCHED="tilefetched",e.TILEFETCHERROR="tilefetcherror",e.TILESFROMSPRITETILE="tilesfromspritetile",e.MAPTILELOADED="maptileloaded",e.MAPTILESLOADEDFROMSPRITES="maptilesloadedfromsprites",e.MAPTILEDELETED="maptiledeleted",e.FIRSTMAPTILELOADED="firstmaptileloaded",e.ALLREQUESTEDTILESLOADED="allrequestedtilesloaded",e.TEXTURESUPDATED="texturesupdated",e.CLEARED="cleared",e.PREPARECHANGE="preparechange",e.IMMEDIATECHANGE="immediatechange",e.ANIMATEDCHANGE="animatedchange",e.CHANGED="changed",e))(nr||{});class ai extends Event{constructor(i,a){super(i);Ke(this,"data");this.data=a}}const zB=4,FB=2;class p4 extends EventTarget{constructor(i,a){super();Ke(this,"cacheableTileFactory");Ke(this,"fetchFn");Ke(this,"tileCacheForTilesFromSprites");Ke(this,"tilesByTileUrl",new Map);Ke(this,"mapIdsByTileUrl",new Map);Ke(this,"tileUrlsByMapId",new Map);Ke(this,"tilesFetchingCount",0);Ke(this,"fetchableTiles",[]);this.setOptions(a),this.cacheableTileFactory=i}getCacheableTiles(){return this.tilesByTileUrl.values()}getCacheableTile(i){return this.tilesByTileUrl.get(i)}getMapCacheableTiles(i){const a=[],h=this.tileUrlsByMapId.get(i);if(h)for(const d of h){const p=this.tilesByTileUrl.get(d);p&&a.push(p)}return a}getCachedTiles(){const i=[];for(const a of this.tilesByTileUrl.values())a.isCachedTile()&&i.push(a);return i}getCachedTile(i){const a=this.tilesByTileUrl.get(i);if(a&&a.isCachedTile())return a}getMapCachedTiles(i){const a=[],h=this.tileUrlsByMapId.get(i);if(h)for(const d of h){const p=this.tilesByTileUrl.get(d);p&&p.isCachedTile()&&a.push(p)}return a}getTileUrls(){return this.tilesByTileUrl.keys()}getMapTileUrls(i){return this.tileUrlsByMapId.get(i)||new Set}setOptions(i){this.fetchFn=i==null?void 0:i.fetchFn,this.tileCacheForTilesFromSprites=i==null?void 0:i.tileCacheForSprites}requestFetchableTiles(i){const a=new Set(this.fetchableTiles.map(d=>d.fetchableTileKey)),h=new Set(i.map(d=>d.fetchableTileKey));if(!vk(a,h)){for(const d of i)this.requestFetchableTile(d);this.fetchableTiles=i}}async allRequestedTilesLoaded(){return new Promise(i=>{if(this.finished)i();else{const a=()=>{this.removeEventListener(nr.ALLREQUESTEDTILESLOADED,a),i()};this.addEventListener(nr.ALLREQUESTEDTILESLOADED,a)}})}prune(i){for(const[a,h]of this.mapIdsByTileUrl.entries())for(const d of h){const p=i.get(d),s=this.tilesByTileUrl.get(a);s&&s.shouldPrune(p,{maxHigherLog2ScaleFactorDiff:zB,maxLowerLog2ScaleFactorDiff:FB})&&this.removeCacheableTileForMapId(a,d)}}clear(){for(const i of this.getCacheableTiles())i.abort(),this.removeEventListenersFromCacheableTile(i);this.tilesByTileUrl=new Map,this.mapIdsByTileUrl=new Map,this.tileUrlsByMapId=new Map,this.tilesFetchingCount=0}destroy(){this.clear()}requestFetchableTile(i){const a=i.mapId,h=i.tileUrl;if(this.tilesByTileUrl.has(h)){const d=this.tilesByTileUrl.get(h);d!=null&&d.isCachedTile()&&this.dispatchEvent(new ai(nr.MAPTILELOADED,{mapIds:[a],tileUrl:h}))}else{const d=this.cacheableTileFactory(i,this.fetchFn);this.addEventListenersToCacheableTile(d),this.addCacheableTile(d)}this.addTileUrlForMapId(h,a),this.addMapIdForTileUrl(a,h)}addCacheableTile(i){this.tilesByTileUrl.set(i.fetchableTile.tileUrl,i),i.fetch(),this.updateTilesFetchingCount(1)}addCachedTile(i){const a=i.fetchableTile.mapId,h=i.fetchableTile.tileUrl;this.tilesByTileUrl.has(h)||(this.tilesByTileUrl.set(h,i),this.addTileUrlForMapId(h,a),this.addMapIdForTileUrl(a,h),this.dispatchEvent(new ai(nr.MAPTILELOADED,{mapIds:[a],tileUrl:h})))}removeCacheableTileForMapId(i,a){const h=this.tilesByTileUrl.get(i);if(!h)return;const d=this.removeMapIdForTileUrl(a,i);this.removeTileUrlForMapId(i,a),d.size||(h.isCachedTile()||(h.abort(),this.updateTilesFetchingCount(-1)),this.tilesByTileUrl.delete(i)),this.dispatchEvent(new ai(nr.MAPTILEDELETED,{mapIds:[a],tileUrl:i}))}tileFetched(i){var a,h;if(i instanceof ai){if(!((a=i.data)!=null&&a.tileUrl))throw new Error("Event data missing");const{tileUrl:d}=i.data;this.updateTilesFetchingCount(-1);for(const p of this.mapIdsByTileUrl.get(d)||[]){this.dispatchEvent(new ai(nr.MAPTILELOADED,{mapIds:[p],tileUrl:d}));const s=this.tileUrlsByMapId.get(p);(s==null?void 0:s.values().next().value)===d&&this.dispatchEvent(new ai(nr.FIRSTMAPTILELOADED,{mapIds:[p],tileUrl:d}))}this.tileCacheForTilesFromSprites&&((h=this.tilesByTileUrl.get(d))==null||h.applySprites())}}tileFetchError(i){var a;if(i instanceof ai){if(!((a=i.data)!=null&&a.tileUrl))throw new Error("Event data missing");const{tileUrl:h}=i.data;this.tilesByTileUrl.has(h)||this.updateTilesFetchingCount(-1)}}tilesFromSpriteTile(i){var a;if(i instanceof ai){if(!((a=i.data)!=null&&a.tileUrl))throw new Error("Event data missing");const{tileUrl:h}=i.data;this.passTilesFromSprites(h)}}passTilesFromSprites(i){var h,d;let a;if(!i)a=Array.from(this.getCacheableTiles());else{const p=this.tilesByTileUrl.get(i);a=p?[p]:[]}for(const p of a){const s=p.getCachedTilesFromSprites();if(!s)throw new Error("Cached tiles from sprites not found");for(const A of s){if(!A.isCachedTile())break;(h=this.tileCacheForTilesFromSprites)==null||h.addCachedTile(A)}const w=s.map(A=>A.fetchableTile.mapId);this.dispatchEvent(new ai(nr.MAPTILESLOADEDFROMSPRITES,{mapIds:w,spritesInfo:(d=p.fetchableTile.options)==null?void 0:d.spritesInfo}))}}addMapIdForTileUrl(i,a){let h=this.mapIdsByTileUrl.get(a);return h?h.add(i):h=new Set([i]),this.mapIdsByTileUrl.set(a,h),h}removeMapIdForTileUrl(i,a){const h=this.mapIdsByTileUrl.get(a);if(h)h.delete(i);else return new Set;return h.size?this.mapIdsByTileUrl.set(a,h):this.mapIdsByTileUrl.delete(a),h}addTileUrlForMapId(i,a){let h=this.tileUrlsByMapId.get(a);return h?h.add(i):h=new Set([i]),this.tileUrlsByMapId.set(a,h),h}removeTileUrlForMapId(i,a){const h=this.tileUrlsByMapId.get(a);return h?(h.delete(i),h.size?this.tileUrlsByMapId.set(a,h):this.tileUrlsByMapId.delete(a),h):new Set}get finished(){return this.tilesFetchingCount===0}updateTilesFetchingCount(i){this.tilesFetchingCount+=i,this.tilesFetchingCount===0&&this.dispatchEvent(new ai(nr.ALLREQUESTEDTILESLOADED))}addEventListenersToCacheableTile(i){i.addEventListener(nr.TILEFETCHED,this.tileFetched.bind(this)),i.addEventListener(nr.TILEFETCHERROR,this.tileFetchError.bind(this)),i.addEventListener(nr.TILESFROMSPRITETILE,this.tilesFromSpriteTile.bind(this))}removeEventListenersFromCacheableTile(i){i.removeEventListener(nr.TILEFETCHED,this.tileFetched.bind(this)),i.removeEventListener(nr.TILEFETCHERROR,this.tileFetchError.bind(this)),i.removeEventListener(nr.TILESFROMSPRITETILE,this.tilesFromSpriteTile.bind(this))}}function Yv(e){return Array.isArray(e)?`[${e.map(t=>Yv(t)).join(",")}]`:typeof e=="number"?`${e}`:typeof e=="string"?`"${e}"`:typeof e=="object"&&e!==null?Object.keys(e).sort().map(t=>`${t}:${Yv(e[t])}`).join("|"):String(e)}const G3=16;async function DB(e){const t=await crypto.subtle.digest("SHA-1",new TextEncoder().encode(e));return Array.from(new Uint8Array(t)).map(h=>h.toString(16).padStart(2,"0")).join("")}async function BB(e,t=G3){return(await DB(String(e))).slice(0,t)}async function GB(e,t=G3){return await BB(Yv(e),t)}var Si;(function(e){e.assertEqual=h=>h;function t(h){}e.assertIs=t;function i(h){throw new Error}e.assertNever=i,e.arrayToEnum=h=>{const d={};for(const p of h)d[p]=p;return d},e.getValidEnumValues=h=>{const d=e.objectKeys(h).filter(s=>typeof h[h[s]]!="number"),p={};for(const s of d)p[s]=h[s];return e.objectValues(p)},e.objectValues=h=>e.objectKeys(h).map(function(d){return h[d]}),e.objectKeys=typeof Object.keys=="function"?h=>Object.keys(h):h=>{const d=[];for(const p in h)Object.prototype.hasOwnProperty.call(h,p)&&d.push(p);return d},e.find=(h,d)=>{for(const p of h)if(d(p))return p},e.isInteger=typeof Number.isInteger=="function"?h=>Number.isInteger(h):h=>typeof h=="number"&&isFinite(h)&&Math.floor(h)===h;function a(h,d=" | "){return h.map(p=>typeof p=="string"?`'${p}'`:p).join(d)}e.joinValues=a,e.jsonStringifyReplacer=(h,d)=>typeof d=="bigint"?d.toString():d})(Si||(Si={}));var Kv;(function(e){e.mergeShapes=(t,i)=>({...t,...i})})(Kv||(Kv={}));const Er=Si.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),hl=e=>{switch(typeof e){case"undefined":return Er.undefined;case"string":return Er.string;case"number":return isNaN(e)?Er.nan:Er.number;case"boolean":return Er.boolean;case"function":return Er.function;case"bigint":return Er.bigint;case"symbol":return Er.symbol;case"object":return Array.isArray(e)?Er.array:e===null?Er.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Er.promise:typeof Map<"u"&&e instanceof Map?Er.map:typeof Set<"u"&&e instanceof Set?Er.set:typeof Date<"u"&&e instanceof Date?Er.date:Er.object;default:return Er.unknown}},ar=Si.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),VB=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ua extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};const i=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,i):this.__proto__=i,this.name="ZodError",this.issues=t}format(t){const i=t||function(d){return d.message},a={_errors:[]},h=d=>{for(const p of d.issues)if(p.code==="invalid_union")p.unionErrors.map(h);else if(p.code==="invalid_return_type")h(p.returnTypeError);else if(p.code==="invalid_arguments")h(p.argumentsError);else if(p.path.length===0)a._errors.push(i(p));else{let s=a,w=0;for(;w<p.path.length;){const A=p.path[w];w===p.path.length-1?(s[A]=s[A]||{_errors:[]},s[A]._errors.push(i(p))):s[A]=s[A]||{_errors:[]},s=s[A],w++}}};return h(this),a}static assert(t){if(!(t instanceof ua))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Si.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=i=>i.message){const i={},a=[];for(const h of this.issues)h.path.length>0?(i[h.path[0]]=i[h.path[0]]||[],i[h.path[0]].push(t(h))):a.push(t(h));return{formErrors:a,fieldErrors:i}}get formErrors(){return this.flatten()}}ua.create=e=>new ua(e);const ed=(e,t)=>{let i;switch(e.code){case ar.invalid_type:e.received===Er.undefined?i="Required":i=`Expected ${e.expected}, received ${e.received}`;break;case ar.invalid_literal:i=`Invalid literal value, expected ${JSON.stringify(e.expected,Si.jsonStringifyReplacer)}`;break;case ar.unrecognized_keys:i=`Unrecognized key(s) in object: ${Si.joinValues(e.keys,", ")}`;break;case ar.invalid_union:i="Invalid input";break;case ar.invalid_union_discriminator:i=`Invalid discriminator value. Expected ${Si.joinValues(e.options)}`;break;case ar.invalid_enum_value:i=`Invalid enum value. Expected ${Si.joinValues(e.options)}, received '${e.received}'`;break;case ar.invalid_arguments:i="Invalid function arguments";break;case ar.invalid_return_type:i="Invalid function return type";break;case ar.invalid_date:i="Invalid date";break;case ar.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(i=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(i=`${i} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?i=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?i=`Invalid input: must end with "${e.validation.endsWith}"`:Si.assertNever(e.validation):e.validation!=="regex"?i=`Invalid ${e.validation}`:i="Invalid";break;case ar.too_small:e.type==="array"?i=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?i=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?i=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?i=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:i="Invalid input";break;case ar.too_big:e.type==="array"?i=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?i=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?i=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?i=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?i=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:i="Invalid input";break;case ar.custom:i="Invalid input";break;case ar.invalid_intersection_types:i="Intersection results could not be merged";break;case ar.not_multiple_of:i=`Number must be a multiple of ${e.multipleOf}`;break;case ar.not_finite:i="Number must be finite";break;default:i=t.defaultError,Si.assertNever(e)}return{message:i}};let V3=ed;function jB(e){V3=e}function wg(){return V3}const xg=e=>{const{data:t,path:i,errorMaps:a,issueData:h}=e,d=[...i,...h.path||[]],p={...h,path:d};if(h.message!==void 0)return{...h,path:d,message:h.message};let s="";const w=a.filter(A=>!!A).slice().reverse();for(const A of w)s=A(p,{data:t,defaultError:s}).message;return{...h,path:d,message:s}},ZB=[];function xr(e,t){const i=wg(),a=xg({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,i,i===ed?void 0:ed].filter(h=>!!h)});e.common.issues.push(a)}class xs{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,i){const a=[];for(const h of i){if(h.status==="aborted")return Jr;h.status==="dirty"&&t.dirty(),a.push(h.value)}return{status:t.value,value:a}}static async mergeObjectAsync(t,i){const a=[];for(const h of i){const d=await h.key,p=await h.value;a.push({key:d,value:p})}return xs.mergeObjectSync(t,a)}static mergeObjectSync(t,i){const a={};for(const h of i){const{key:d,value:p}=h;if(d.status==="aborted"||p.status==="aborted")return Jr;d.status==="dirty"&&t.dirty(),p.status==="dirty"&&t.dirty(),d.value!=="__proto__"&&(typeof p.value<"u"||h.alwaysSet)&&(a[d.value]=p.value)}return{status:t.value,value:a}}}const Jr=Object.freeze({status:"aborted"}),zu=e=>({status:"dirty",value:e}),Ds=e=>({status:"valid",value:e}),$v=e=>e.status==="aborted",Jv=e=>e.status==="dirty",ch=e=>e.status==="valid",pp=e=>typeof Promise<"u"&&e instanceof Promise;function Mg(e,t,i,a){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function j3(e,t,i,a,h){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,i),i}var Vr;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Vr||(Vr={}));var Vf,jf;class Co{constructor(t,i,a,h){this._cachedPath=[],this.parent=t,this.data=i,this._path=a,this._key=h}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const m4=(e,t)=>{if(ch(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const i=new ua(e.common.issues);return this._error=i,this._error}}};function ci(e){if(!e)return{};const{errorMap:t,invalid_type_error:i,required_error:a,description:h}=e;if(t&&(i||a))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:h}:{errorMap:(p,s)=>{var w,A;const{message:z}=e;return p.code==="invalid_enum_value"?{message:z??s.defaultError}:typeof s.data>"u"?{message:(w=z??a)!==null&&w!==void 0?w:s.defaultError}:p.code!=="invalid_type"?{message:s.defaultError}:{message:(A=z??i)!==null&&A!==void 0?A:s.defaultError}},description:h}}class _i{get description(){return this._def.description}_getType(t){return hl(t.data)}_getOrReturnCtx(t,i){return i||{common:t.parent.common,data:t.data,parsedType:hl(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new xs,ctx:{common:t.parent.common,data:t.data,parsedType:hl(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const i=this._parse(t);if(pp(i))throw new Error("Synchronous parse encountered promise.");return i}_parseAsync(t){const i=this._parse(t);return Promise.resolve(i)}parse(t,i){const a=this.safeParse(t,i);if(a.success)return a.data;throw a.error}safeParse(t,i){var a;const h={common:{issues:[],async:(a=i==null?void 0:i.async)!==null&&a!==void 0?a:!1,contextualErrorMap:i==null?void 0:i.errorMap},path:(i==null?void 0:i.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:hl(t)},d=this._parseSync({data:t,path:h.path,parent:h});return m4(h,d)}"~validate"(t){var i,a;const h={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:hl(t)};if(!this["~standard"].async)try{const d=this._parseSync({data:t,path:[],parent:h});return ch(d)?{value:d.value}:{issues:h.common.issues}}catch(d){!((a=(i=d==null?void 0:d.message)===null||i===void 0?void 0:i.toLowerCase())===null||a===void 0)&&a.includes("encountered")&&(this["~standard"].async=!0),h.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:h}).then(d=>ch(d)?{value:d.value}:{issues:h.common.issues})}async parseAsync(t,i){const a=await this.safeParseAsync(t,i);if(a.success)return a.data;throw a.error}async safeParseAsync(t,i){const a={common:{issues:[],contextualErrorMap:i==null?void 0:i.errorMap,async:!0},path:(i==null?void 0:i.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:hl(t)},h=this._parse({data:t,path:a.path,parent:a}),d=await(pp(h)?h:Promise.resolve(h));return m4(a,d)}refine(t,i){const a=h=>typeof i=="string"||typeof i>"u"?{message:i}:typeof i=="function"?i(h):i;return this._refinement((h,d)=>{const p=t(h),s=()=>d.addIssue({code:ar.custom,...a(h)});return typeof Promise<"u"&&p instanceof Promise?p.then(w=>w?!0:(s(),!1)):p?!0:(s(),!1)})}refinement(t,i){return this._refinement((a,h)=>t(a)?!0:(h.addIssue(typeof i=="function"?i(a,h):i),!1))}_refinement(t){return new qa({schema:this,typeName:Kr.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:i=>this["~validate"](i)}}optional(){return Io.create(this,this._def)}nullable(){return ic.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Xa.create(this)}promise(){return rd.create(this,this._def)}or(t){return vp.create([this,t],this._def)}and(t){return yp.create(this,t,this._def)}transform(t){return new qa({...ci(this._def),schema:this,typeName:Kr.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const i=typeof t=="function"?t:()=>t;return new Ip({...ci(this._def),innerType:this,defaultValue:i,typeName:Kr.ZodDefault})}brand(){return new Yy({typeName:Kr.ZodBranded,type:this,...ci(this._def)})}catch(t){const i=typeof t=="function"?t:()=>t;return new Ap({...ci(this._def),innerType:this,catchValue:i,typeName:Kr.ZodCatch})}describe(t){const i=this.constructor;return new i({...this._def,description:t})}pipe(t){return Qp.create(this,t)}readonly(){return Tp.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const OB=/^c[^\s-]{8,}$/i,NB=/^[0-9a-z]+$/,UB=/^[0-9A-HJKMNP-TV-Z]{26}$/i,HB=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,WB=/^[a-z0-9_-]{21}$/i,XB=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,qB=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,YB=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,KB="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Q_;const $B=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,JB=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,QB=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,eG=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,tG=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,rG=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Z3="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",iG=new RegExp(`^${Z3}$`);function O3(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function nG(e){return new RegExp(`^${O3(e)}$`)}function N3(e){let t=`${Z3}T${O3(e)}`;const i=[];return i.push(e.local?"Z?":"Z"),e.offset&&i.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${i.join("|")})`,new RegExp(`^${t}$`)}function sG(e,t){return!!((t==="v4"||!t)&&$B.test(e)||(t==="v6"||!t)&&QB.test(e))}function aG(e,t){if(!XB.test(e))return!1;try{const[i]=e.split("."),a=i.replace(/-/g,"+").replace(/_/g,"/").padEnd(i.length+(4-i.length%4)%4,"="),h=JSON.parse(atob(a));return!(typeof h!="object"||h===null||!h.typ||!h.alg||t&&h.alg!==t)}catch{return!1}}function oG(e,t){return!!((t==="v4"||!t)&&JB.test(e)||(t==="v6"||!t)&&eG.test(e))}class Ua extends _i{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Er.string){const d=this._getOrReturnCtx(t);return xr(d,{code:ar.invalid_type,expected:Er.string,received:d.parsedType}),Jr}const a=new xs;let h;for(const d of this._def.checks)if(d.kind==="min")t.data.length<d.value&&(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),a.dirty());else if(d.kind==="max")t.data.length>d.value&&(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!1,message:d.message}),a.dirty());else if(d.kind==="length"){const p=t.data.length>d.value,s=t.data.length<d.value;(p||s)&&(h=this._getOrReturnCtx(t,h),p?xr(h,{code:ar.too_big,maximum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}):s&&xr(h,{code:ar.too_small,minimum:d.value,type:"string",inclusive:!0,exact:!0,message:d.message}),a.dirty())}else if(d.kind==="email")YB.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"email",code:ar.invalid_string,message:d.message}),a.dirty());else if(d.kind==="emoji")Q_||(Q_=new RegExp(KB,"u")),Q_.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"emoji",code:ar.invalid_string,message:d.message}),a.dirty());else if(d.kind==="uuid")HB.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"uuid",code:ar.invalid_string,message:d.message}),a.dirty());else if(d.kind==="nanoid")WB.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"nanoid",code:ar.invalid_string,message:d.message}),a.dirty());else if(d.kind==="cuid")OB.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"cuid",code:ar.invalid_string,message:d.message}),a.dirty());else if(d.kind==="cuid2")NB.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"cuid2",code:ar.invalid_string,message:d.message}),a.dirty());else if(d.kind==="ulid")UB.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"ulid",code:ar.invalid_string,message:d.message}),a.dirty());else if(d.kind==="url")try{new URL(t.data)}catch{h=this._getOrReturnCtx(t,h),xr(h,{validation:"url",code:ar.invalid_string,message:d.message}),a.dirty()}else d.kind==="regex"?(d.regex.lastIndex=0,d.regex.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"regex",code:ar.invalid_string,message:d.message}),a.dirty())):d.kind==="trim"?t.data=t.data.trim():d.kind==="includes"?t.data.includes(d.value,d.position)||(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.invalid_string,validation:{includes:d.value,position:d.position},message:d.message}),a.dirty()):d.kind==="toLowerCase"?t.data=t.data.toLowerCase():d.kind==="toUpperCase"?t.data=t.data.toUpperCase():d.kind==="startsWith"?t.data.startsWith(d.value)||(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.invalid_string,validation:{startsWith:d.value},message:d.message}),a.dirty()):d.kind==="endsWith"?t.data.endsWith(d.value)||(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.invalid_string,validation:{endsWith:d.value},message:d.message}),a.dirty()):d.kind==="datetime"?N3(d).test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.invalid_string,validation:"datetime",message:d.message}),a.dirty()):d.kind==="date"?iG.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.invalid_string,validation:"date",message:d.message}),a.dirty()):d.kind==="time"?nG(d).test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.invalid_string,validation:"time",message:d.message}),a.dirty()):d.kind==="duration"?qB.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"duration",code:ar.invalid_string,message:d.message}),a.dirty()):d.kind==="ip"?sG(t.data,d.version)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"ip",code:ar.invalid_string,message:d.message}),a.dirty()):d.kind==="jwt"?aG(t.data,d.alg)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"jwt",code:ar.invalid_string,message:d.message}),a.dirty()):d.kind==="cidr"?oG(t.data,d.version)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"cidr",code:ar.invalid_string,message:d.message}),a.dirty()):d.kind==="base64"?tG.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"base64",code:ar.invalid_string,message:d.message}),a.dirty()):d.kind==="base64url"?rG.test(t.data)||(h=this._getOrReturnCtx(t,h),xr(h,{validation:"base64url",code:ar.invalid_string,message:d.message}),a.dirty()):Si.assertNever(d);return{status:a.value,value:t.data}}_regex(t,i,a){return this.refinement(h=>t.test(h),{validation:i,code:ar.invalid_string,...Vr.errToObj(a)})}_addCheck(t){return new Ua({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Vr.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Vr.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Vr.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Vr.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Vr.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Vr.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Vr.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Vr.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Vr.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Vr.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Vr.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Vr.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Vr.errToObj(t)})}datetime(t){var i,a;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(i=t==null?void 0:t.offset)!==null&&i!==void 0?i:!1,local:(a=t==null?void 0:t.local)!==null&&a!==void 0?a:!1,...Vr.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Vr.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Vr.errToObj(t)})}regex(t,i){return this._addCheck({kind:"regex",regex:t,...Vr.errToObj(i)})}includes(t,i){return this._addCheck({kind:"includes",value:t,position:i==null?void 0:i.position,...Vr.errToObj(i==null?void 0:i.message)})}startsWith(t,i){return this._addCheck({kind:"startsWith",value:t,...Vr.errToObj(i)})}endsWith(t,i){return this._addCheck({kind:"endsWith",value:t,...Vr.errToObj(i)})}min(t,i){return this._addCheck({kind:"min",value:t,...Vr.errToObj(i)})}max(t,i){return this._addCheck({kind:"max",value:t,...Vr.errToObj(i)})}length(t,i){return this._addCheck({kind:"length",value:t,...Vr.errToObj(i)})}nonempty(t){return this.min(1,Vr.errToObj(t))}trim(){return new Ua({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ua({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ua({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxLength(){let t=null;for(const i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}}Ua.create=e=>{var t;return new Ua({checks:[],typeName:Kr.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...ci(e)})};function lG(e,t){const i=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,h=i>a?i:a,d=parseInt(e.toFixed(h).replace(".","")),p=parseInt(t.toFixed(h).replace(".",""));return d%p/Math.pow(10,h)}class ec extends _i{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Er.number){const d=this._getOrReturnCtx(t);return xr(d,{code:ar.invalid_type,expected:Er.number,received:d.parsedType}),Jr}let a;const h=new xs;for(const d of this._def.checks)d.kind==="int"?Si.isInteger(t.data)||(a=this._getOrReturnCtx(t,a),xr(a,{code:ar.invalid_type,expected:"integer",received:"float",message:d.message}),h.dirty()):d.kind==="min"?(d.inclusive?t.data<d.value:t.data<=d.value)&&(a=this._getOrReturnCtx(t,a),xr(a,{code:ar.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),h.dirty()):d.kind==="max"?(d.inclusive?t.data>d.value:t.data>=d.value)&&(a=this._getOrReturnCtx(t,a),xr(a,{code:ar.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),h.dirty()):d.kind==="multipleOf"?lG(t.data,d.value)!==0&&(a=this._getOrReturnCtx(t,a),xr(a,{code:ar.not_multiple_of,multipleOf:d.value,message:d.message}),h.dirty()):d.kind==="finite"?Number.isFinite(t.data)||(a=this._getOrReturnCtx(t,a),xr(a,{code:ar.not_finite,message:d.message}),h.dirty()):Si.assertNever(d);return{status:h.value,value:t.data}}gte(t,i){return this.setLimit("min",t,!0,Vr.toString(i))}gt(t,i){return this.setLimit("min",t,!1,Vr.toString(i))}lte(t,i){return this.setLimit("max",t,!0,Vr.toString(i))}lt(t,i){return this.setLimit("max",t,!1,Vr.toString(i))}setLimit(t,i,a,h){return new ec({...this._def,checks:[...this._def.checks,{kind:t,value:i,inclusive:a,message:Vr.toString(h)}]})}_addCheck(t){return new ec({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Vr.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Vr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Vr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Vr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Vr.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:Vr.toString(i)})}finite(t){return this._addCheck({kind:"finite",message:Vr.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Vr.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Vr.toString(t)})}get minValue(){let t=null;for(const i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(const i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Si.isInteger(t.value))}get isFinite(){let t=null,i=null;for(const a of this._def.checks){if(a.kind==="finite"||a.kind==="int"||a.kind==="multipleOf")return!0;a.kind==="min"?(i===null||a.value>i)&&(i=a.value):a.kind==="max"&&(t===null||a.value<t)&&(t=a.value)}return Number.isFinite(i)&&Number.isFinite(t)}}ec.create=e=>new ec({checks:[],typeName:Kr.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...ci(e)});class tc extends _i{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Er.bigint)return this._getInvalidInput(t);let a;const h=new xs;for(const d of this._def.checks)d.kind==="min"?(d.inclusive?t.data<d.value:t.data<=d.value)&&(a=this._getOrReturnCtx(t,a),xr(a,{code:ar.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),h.dirty()):d.kind==="max"?(d.inclusive?t.data>d.value:t.data>=d.value)&&(a=this._getOrReturnCtx(t,a),xr(a,{code:ar.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),h.dirty()):d.kind==="multipleOf"?t.data%d.value!==BigInt(0)&&(a=this._getOrReturnCtx(t,a),xr(a,{code:ar.not_multiple_of,multipleOf:d.value,message:d.message}),h.dirty()):Si.assertNever(d);return{status:h.value,value:t.data}}_getInvalidInput(t){const i=this._getOrReturnCtx(t);return xr(i,{code:ar.invalid_type,expected:Er.bigint,received:i.parsedType}),Jr}gte(t,i){return this.setLimit("min",t,!0,Vr.toString(i))}gt(t,i){return this.setLimit("min",t,!1,Vr.toString(i))}lte(t,i){return this.setLimit("max",t,!0,Vr.toString(i))}lt(t,i){return this.setLimit("max",t,!1,Vr.toString(i))}setLimit(t,i,a,h){return new tc({...this._def,checks:[...this._def.checks,{kind:t,value:i,inclusive:a,message:Vr.toString(h)}]})}_addCheck(t){return new tc({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Vr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Vr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Vr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Vr.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:Vr.toString(i)})}get minValue(){let t=null;for(const i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(const i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t}}tc.create=e=>{var t;return new tc({checks:[],typeName:Kr.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...ci(e)})};class mp extends _i{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Er.boolean){const a=this._getOrReturnCtx(t);return xr(a,{code:ar.invalid_type,expected:Er.boolean,received:a.parsedType}),Jr}return Ds(t.data)}}mp.create=e=>new mp({typeName:Kr.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...ci(e)});class hh extends _i{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Er.date){const d=this._getOrReturnCtx(t);return xr(d,{code:ar.invalid_type,expected:Er.date,received:d.parsedType}),Jr}if(isNaN(t.data.getTime())){const d=this._getOrReturnCtx(t);return xr(d,{code:ar.invalid_date}),Jr}const a=new xs;let h;for(const d of this._def.checks)d.kind==="min"?t.data.getTime()<d.value&&(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),a.dirty()):d.kind==="max"?t.data.getTime()>d.value&&(h=this._getOrReturnCtx(t,h),xr(h,{code:ar.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),a.dirty()):Si.assertNever(d);return{status:a.value,value:new Date(t.data.getTime())}}_addCheck(t){return new hh({...this._def,checks:[...this._def.checks,t]})}min(t,i){return this._addCheck({kind:"min",value:t.getTime(),message:Vr.toString(i)})}max(t,i){return this._addCheck({kind:"max",value:t.getTime(),message:Vr.toString(i)})}get minDate(){let t=null;for(const i of this._def.checks)i.kind==="min"&&(t===null||i.value>t)&&(t=i.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const i of this._def.checks)i.kind==="max"&&(t===null||i.value<t)&&(t=i.value);return t!=null?new Date(t):null}}hh.create=e=>new hh({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Kr.ZodDate,...ci(e)});class Ig extends _i{_parse(t){if(this._getType(t)!==Er.symbol){const a=this._getOrReturnCtx(t);return xr(a,{code:ar.invalid_type,expected:Er.symbol,received:a.parsedType}),Jr}return Ds(t.data)}}Ig.create=e=>new Ig({typeName:Kr.ZodSymbol,...ci(e)});class gp extends _i{_parse(t){if(this._getType(t)!==Er.undefined){const a=this._getOrReturnCtx(t);return xr(a,{code:ar.invalid_type,expected:Er.undefined,received:a.parsedType}),Jr}return Ds(t.data)}}gp.create=e=>new gp({typeName:Kr.ZodUndefined,...ci(e)});class _p extends _i{_parse(t){if(this._getType(t)!==Er.null){const a=this._getOrReturnCtx(t);return xr(a,{code:ar.invalid_type,expected:Er.null,received:a.parsedType}),Jr}return Ds(t.data)}}_p.create=e=>new _p({typeName:Kr.ZodNull,...ci(e)});class td extends _i{constructor(){super(...arguments),this._any=!0}_parse(t){return Ds(t.data)}}td.create=e=>new td({typeName:Kr.ZodAny,...ci(e)});class ih extends _i{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ds(t.data)}}ih.create=e=>new ih({typeName:Kr.ZodUnknown,...ci(e)});class vl extends _i{_parse(t){const i=this._getOrReturnCtx(t);return xr(i,{code:ar.invalid_type,expected:Er.never,received:i.parsedType}),Jr}}vl.create=e=>new vl({typeName:Kr.ZodNever,...ci(e)});class Ag extends _i{_parse(t){if(this._getType(t)!==Er.undefined){const a=this._getOrReturnCtx(t);return xr(a,{code:ar.invalid_type,expected:Er.void,received:a.parsedType}),Jr}return Ds(t.data)}}Ag.create=e=>new Ag({typeName:Kr.ZodVoid,...ci(e)});class Xa extends _i{_parse(t){const{ctx:i,status:a}=this._processInputParams(t),h=this._def;if(i.parsedType!==Er.array)return xr(i,{code:ar.invalid_type,expected:Er.array,received:i.parsedType}),Jr;if(h.exactLength!==null){const p=i.data.length>h.exactLength.value,s=i.data.length<h.exactLength.value;(p||s)&&(xr(i,{code:p?ar.too_big:ar.too_small,minimum:s?h.exactLength.value:void 0,maximum:p?h.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:h.exactLength.message}),a.dirty())}if(h.minLength!==null&&i.data.length<h.minLength.value&&(xr(i,{code:ar.too_small,minimum:h.minLength.value,type:"array",inclusive:!0,exact:!1,message:h.minLength.message}),a.dirty()),h.maxLength!==null&&i.data.length>h.maxLength.value&&(xr(i,{code:ar.too_big,maximum:h.maxLength.value,type:"array",inclusive:!0,exact:!1,message:h.maxLength.message}),a.dirty()),i.common.async)return Promise.all([...i.data].map((p,s)=>h.type._parseAsync(new Co(i,p,i.path,s)))).then(p=>xs.mergeArray(a,p));const d=[...i.data].map((p,s)=>h.type._parseSync(new Co(i,p,i.path,s)));return xs.mergeArray(a,d)}get element(){return this._def.type}min(t,i){return new Xa({...this._def,minLength:{value:t,message:Vr.toString(i)}})}max(t,i){return new Xa({...this._def,maxLength:{value:t,message:Vr.toString(i)}})}length(t,i){return new Xa({...this._def,exactLength:{value:t,message:Vr.toString(i)}})}nonempty(t){return this.min(1,t)}}Xa.create=(e,t)=>new Xa({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Kr.ZodArray,...ci(t)});function Tu(e){if(e instanceof In){const t={};for(const i in e.shape){const a=e.shape[i];t[i]=Io.create(Tu(a))}return new In({...e._def,shape:()=>t})}else return e instanceof Xa?new Xa({...e._def,type:Tu(e.element)}):e instanceof Io?Io.create(Tu(e.unwrap())):e instanceof ic?ic.create(Tu(e.unwrap())):e instanceof So?So.create(e.items.map(t=>Tu(t))):e}class In extends _i{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),i=Si.objectKeys(t);return this._cached={shape:t,keys:i}}_parse(t){if(this._getType(t)!==Er.object){const A=this._getOrReturnCtx(t);return xr(A,{code:ar.invalid_type,expected:Er.object,received:A.parsedType}),Jr}const{status:a,ctx:h}=this._processInputParams(t),{shape:d,keys:p}=this._getCached(),s=[];if(!(this._def.catchall instanceof vl&&this._def.unknownKeys==="strip"))for(const A in h.data)p.includes(A)||s.push(A);const w=[];for(const A of p){const z=d[A],B=h.data[A];w.push({key:{status:"valid",value:A},value:z._parse(new Co(h,B,h.path,A)),alwaysSet:A in h.data})}if(this._def.catchall instanceof vl){const A=this._def.unknownKeys;if(A==="passthrough")for(const z of s)w.push({key:{status:"valid",value:z},value:{status:"valid",value:h.data[z]}});else if(A==="strict")s.length>0&&(xr(h,{code:ar.unrecognized_keys,keys:s}),a.dirty());else if(A!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const A=this._def.catchall;for(const z of s){const B=h.data[z];w.push({key:{status:"valid",value:z},value:A._parse(new Co(h,B,h.path,z)),alwaysSet:z in h.data})}}return h.common.async?Promise.resolve().then(async()=>{const A=[];for(const z of w){const B=await z.key,D=await z.value;A.push({key:B,value:D,alwaysSet:z.alwaysSet})}return A}).then(A=>xs.mergeObjectSync(a,A)):xs.mergeObjectSync(a,w)}get shape(){return this._def.shape()}strict(t){return Vr.errToObj,new In({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(i,a)=>{var h,d,p,s;const w=(p=(d=(h=this._def).errorMap)===null||d===void 0?void 0:d.call(h,i,a).message)!==null&&p!==void 0?p:a.defaultError;return i.code==="unrecognized_keys"?{message:(s=Vr.errToObj(t).message)!==null&&s!==void 0?s:w}:{message:w}}}:{}})}strip(){return new In({...this._def,unknownKeys:"strip"})}passthrough(){return new In({...this._def,unknownKeys:"passthrough"})}extend(t){return new In({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new In({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Kr.ZodObject})}setKey(t,i){return this.augment({[t]:i})}catchall(t){return new In({...this._def,catchall:t})}pick(t){const i={};return Si.objectKeys(t).forEach(a=>{t[a]&&this.shape[a]&&(i[a]=this.shape[a])}),new In({...this._def,shape:()=>i})}omit(t){const i={};return Si.objectKeys(this.shape).forEach(a=>{t[a]||(i[a]=this.shape[a])}),new In({...this._def,shape:()=>i})}deepPartial(){return Tu(this)}partial(t){const i={};return Si.objectKeys(this.shape).forEach(a=>{const h=this.shape[a];t&&!t[a]?i[a]=h:i[a]=h.optional()}),new In({...this._def,shape:()=>i})}required(t){const i={};return Si.objectKeys(this.shape).forEach(a=>{if(t&&!t[a])i[a]=this.shape[a];else{let d=this.shape[a];for(;d instanceof Io;)d=d._def.innerType;i[a]=d}}),new In({...this._def,shape:()=>i})}keyof(){return U3(Si.objectKeys(this.shape))}}In.create=(e,t)=>new In({shape:()=>e,unknownKeys:"strip",catchall:vl.create(),typeName:Kr.ZodObject,...ci(t)});In.strictCreate=(e,t)=>new In({shape:()=>e,unknownKeys:"strict",catchall:vl.create(),typeName:Kr.ZodObject,...ci(t)});In.lazycreate=(e,t)=>new In({shape:e,unknownKeys:"strip",catchall:vl.create(),typeName:Kr.ZodObject,...ci(t)});class vp extends _i{_parse(t){const{ctx:i}=this._processInputParams(t),a=this._def.options;function h(d){for(const s of d)if(s.result.status==="valid")return s.result;for(const s of d)if(s.result.status==="dirty")return i.common.issues.push(...s.ctx.common.issues),s.result;const p=d.map(s=>new ua(s.ctx.common.issues));return xr(i,{code:ar.invalid_union,unionErrors:p}),Jr}if(i.common.async)return Promise.all(a.map(async d=>{const p={...i,common:{...i.common,issues:[]},parent:null};return{result:await d._parseAsync({data:i.data,path:i.path,parent:p}),ctx:p}})).then(h);{let d;const p=[];for(const w of a){const A={...i,common:{...i.common,issues:[]},parent:null},z=w._parseSync({data:i.data,path:i.path,parent:A});if(z.status==="valid")return z;z.status==="dirty"&&!d&&(d={result:z,ctx:A}),A.common.issues.length&&p.push(A.common.issues)}if(d)return i.common.issues.push(...d.ctx.common.issues),d.result;const s=p.map(w=>new ua(w));return xr(i,{code:ar.invalid_union,unionErrors:s}),Jr}}get options(){return this._def.options}}vp.create=(e,t)=>new vp({options:e,typeName:Kr.ZodUnion,...ci(t)});const ll=e=>e instanceof wp?ll(e.schema):e instanceof qa?ll(e.innerType()):e instanceof xp?[e.value]:e instanceof rc?e.options:e instanceof Mp?Si.objectValues(e.enum):e instanceof Ip?ll(e._def.innerType):e instanceof gp?[void 0]:e instanceof _p?[null]:e instanceof Io?[void 0,...ll(e.unwrap())]:e instanceof ic?[null,...ll(e.unwrap())]:e instanceof Yy||e instanceof Tp?ll(e.unwrap()):e instanceof Ap?ll(e._def.innerType):[];class Jg extends _i{_parse(t){const{ctx:i}=this._processInputParams(t);if(i.parsedType!==Er.object)return xr(i,{code:ar.invalid_type,expected:Er.object,received:i.parsedType}),Jr;const a=this.discriminator,h=i.data[a],d=this.optionsMap.get(h);return d?i.common.async?d._parseAsync({data:i.data,path:i.path,parent:i}):d._parseSync({data:i.data,path:i.path,parent:i}):(xr(i,{code:ar.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[a]}),Jr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,i,a){const h=new Map;for(const d of i){const p=ll(d.shape[t]);if(!p.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const s of p){if(h.has(s))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(s)}`);h.set(s,d)}}return new Jg({typeName:Kr.ZodDiscriminatedUnion,discriminator:t,options:i,optionsMap:h,...ci(a)})}}function Qv(e,t){const i=hl(e),a=hl(t);if(e===t)return{valid:!0,data:e};if(i===Er.object&&a===Er.object){const h=Si.objectKeys(t),d=Si.objectKeys(e).filter(s=>h.indexOf(s)!==-1),p={...e,...t};for(const s of d){const w=Qv(e[s],t[s]);if(!w.valid)return{valid:!1};p[s]=w.data}return{valid:!0,data:p}}else if(i===Er.array&&a===Er.array){if(e.length!==t.length)return{valid:!1};const h=[];for(let d=0;d<e.length;d++){const p=e[d],s=t[d],w=Qv(p,s);if(!w.valid)return{valid:!1};h.push(w.data)}return{valid:!0,data:h}}else return i===Er.date&&a===Er.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class yp extends _i{_parse(t){const{status:i,ctx:a}=this._processInputParams(t),h=(d,p)=>{if($v(d)||$v(p))return Jr;const s=Qv(d.value,p.value);return s.valid?((Jv(d)||Jv(p))&&i.dirty(),{status:i.value,value:s.data}):(xr(a,{code:ar.invalid_intersection_types}),Jr)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([d,p])=>h(d,p)):h(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}}yp.create=(e,t,i)=>new yp({left:e,right:t,typeName:Kr.ZodIntersection,...ci(i)});class So extends _i{_parse(t){const{status:i,ctx:a}=this._processInputParams(t);if(a.parsedType!==Er.array)return xr(a,{code:ar.invalid_type,expected:Er.array,received:a.parsedType}),Jr;if(a.data.length<this._def.items.length)return xr(a,{code:ar.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Jr;!this._def.rest&&a.data.length>this._def.items.length&&(xr(a,{code:ar.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),i.dirty());const d=[...a.data].map((p,s)=>{const w=this._def.items[s]||this._def.rest;return w?w._parse(new Co(a,p,a.path,s)):null}).filter(p=>!!p);return a.common.async?Promise.all(d).then(p=>xs.mergeArray(i,p)):xs.mergeArray(i,d)}get items(){return this._def.items}rest(t){return new So({...this._def,rest:t})}}So.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new So({items:e,typeName:Kr.ZodTuple,rest:null,...ci(t)})};class bp extends _i{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:i,ctx:a}=this._processInputParams(t);if(a.parsedType!==Er.object)return xr(a,{code:ar.invalid_type,expected:Er.object,received:a.parsedType}),Jr;const h=[],d=this._def.keyType,p=this._def.valueType;for(const s in a.data)h.push({key:d._parse(new Co(a,s,a.path,s)),value:p._parse(new Co(a,a.data[s],a.path,s)),alwaysSet:s in a.data});return a.common.async?xs.mergeObjectAsync(i,h):xs.mergeObjectSync(i,h)}get element(){return this._def.valueType}static create(t,i,a){return i instanceof _i?new bp({keyType:t,valueType:i,typeName:Kr.ZodRecord,...ci(a)}):new bp({keyType:Ua.create(),valueType:t,typeName:Kr.ZodRecord,...ci(i)})}}class Tg extends _i{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:i,ctx:a}=this._processInputParams(t);if(a.parsedType!==Er.map)return xr(a,{code:ar.invalid_type,expected:Er.map,received:a.parsedType}),Jr;const h=this._def.keyType,d=this._def.valueType,p=[...a.data.entries()].map(([s,w],A)=>({key:h._parse(new Co(a,s,a.path,[A,"key"])),value:d._parse(new Co(a,w,a.path,[A,"value"]))}));if(a.common.async){const s=new Map;return Promise.resolve().then(async()=>{for(const w of p){const A=await w.key,z=await w.value;if(A.status==="aborted"||z.status==="aborted")return Jr;(A.status==="dirty"||z.status==="dirty")&&i.dirty(),s.set(A.value,z.value)}return{status:i.value,value:s}})}else{const s=new Map;for(const w of p){const A=w.key,z=w.value;if(A.status==="aborted"||z.status==="aborted")return Jr;(A.status==="dirty"||z.status==="dirty")&&i.dirty(),s.set(A.value,z.value)}return{status:i.value,value:s}}}}Tg.create=(e,t,i)=>new Tg({valueType:t,keyType:e,typeName:Kr.ZodMap,...ci(i)});class uh extends _i{_parse(t){const{status:i,ctx:a}=this._processInputParams(t);if(a.parsedType!==Er.set)return xr(a,{code:ar.invalid_type,expected:Er.set,received:a.parsedType}),Jr;const h=this._def;h.minSize!==null&&a.data.size<h.minSize.value&&(xr(a,{code:ar.too_small,minimum:h.minSize.value,type:"set",inclusive:!0,exact:!1,message:h.minSize.message}),i.dirty()),h.maxSize!==null&&a.data.size>h.maxSize.value&&(xr(a,{code:ar.too_big,maximum:h.maxSize.value,type:"set",inclusive:!0,exact:!1,message:h.maxSize.message}),i.dirty());const d=this._def.valueType;function p(w){const A=new Set;for(const z of w){if(z.status==="aborted")return Jr;z.status==="dirty"&&i.dirty(),A.add(z.value)}return{status:i.value,value:A}}const s=[...a.data.values()].map((w,A)=>d._parse(new Co(a,w,a.path,A)));return a.common.async?Promise.all(s).then(w=>p(w)):p(s)}min(t,i){return new uh({...this._def,minSize:{value:t,message:Vr.toString(i)}})}max(t,i){return new uh({...this._def,maxSize:{value:t,message:Vr.toString(i)}})}size(t,i){return this.min(t,i).max(t,i)}nonempty(t){return this.min(1,t)}}uh.create=(e,t)=>new uh({valueType:e,minSize:null,maxSize:null,typeName:Kr.ZodSet,...ci(t)});class Zu extends _i{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:i}=this._processInputParams(t);if(i.parsedType!==Er.function)return xr(i,{code:ar.invalid_type,expected:Er.function,received:i.parsedType}),Jr;function a(s,w){return xg({data:s,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,wg(),ed].filter(A=>!!A),issueData:{code:ar.invalid_arguments,argumentsError:w}})}function h(s,w){return xg({data:s,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,wg(),ed].filter(A=>!!A),issueData:{code:ar.invalid_return_type,returnTypeError:w}})}const d={errorMap:i.common.contextualErrorMap},p=i.data;if(this._def.returns instanceof rd){const s=this;return Ds(async function(...w){const A=new ua([]),z=await s._def.args.parseAsync(w,d).catch(V=>{throw A.addIssue(a(w,V)),A}),B=await Reflect.apply(p,this,z);return await s._def.returns._def.type.parseAsync(B,d).catch(V=>{throw A.addIssue(h(B,V)),A})})}else{const s=this;return Ds(function(...w){const A=s._def.args.safeParse(w,d);if(!A.success)throw new ua([a(w,A.error)]);const z=Reflect.apply(p,this,A.data),B=s._def.returns.safeParse(z,d);if(!B.success)throw new ua([h(z,B.error)]);return B.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new Zu({...this._def,args:So.create(t).rest(ih.create())})}returns(t){return new Zu({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,i,a){return new Zu({args:t||So.create([]).rest(ih.create()),returns:i||ih.create(),typeName:Kr.ZodFunction,...ci(a)})}}class wp extends _i{get schema(){return this._def.getter()}_parse(t){const{ctx:i}=this._processInputParams(t);return this._def.getter()._parse({data:i.data,path:i.path,parent:i})}}wp.create=(e,t)=>new wp({getter:e,typeName:Kr.ZodLazy,...ci(t)});class xp extends _i{_parse(t){if(t.data!==this._def.value){const i=this._getOrReturnCtx(t);return xr(i,{received:i.data,code:ar.invalid_literal,expected:this._def.value}),Jr}return{status:"valid",value:t.data}}get value(){return this._def.value}}xp.create=(e,t)=>new xp({value:e,typeName:Kr.ZodLiteral,...ci(t)});function U3(e,t){return new rc({values:e,typeName:Kr.ZodEnum,...ci(t)})}class rc extends _i{constructor(){super(...arguments),Vf.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const i=this._getOrReturnCtx(t),a=this._def.values;return xr(i,{expected:Si.joinValues(a),received:i.parsedType,code:ar.invalid_type}),Jr}if(Mg(this,Vf)||j3(this,Vf,new Set(this._def.values)),!Mg(this,Vf).has(t.data)){const i=this._getOrReturnCtx(t),a=this._def.values;return xr(i,{received:i.data,code:ar.invalid_enum_value,options:a}),Jr}return Ds(t.data)}get options(){return this._def.values}get enum(){const t={};for(const i of this._def.values)t[i]=i;return t}get Values(){const t={};for(const i of this._def.values)t[i]=i;return t}get Enum(){const t={};for(const i of this._def.values)t[i]=i;return t}extract(t,i=this._def){return rc.create(t,{...this._def,...i})}exclude(t,i=this._def){return rc.create(this.options.filter(a=>!t.includes(a)),{...this._def,...i})}}Vf=new WeakMap;rc.create=U3;class Mp extends _i{constructor(){super(...arguments),jf.set(this,void 0)}_parse(t){const i=Si.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(t);if(a.parsedType!==Er.string&&a.parsedType!==Er.number){const h=Si.objectValues(i);return xr(a,{expected:Si.joinValues(h),received:a.parsedType,code:ar.invalid_type}),Jr}if(Mg(this,jf)||j3(this,jf,new Set(Si.getValidEnumValues(this._def.values))),!Mg(this,jf).has(t.data)){const h=Si.objectValues(i);return xr(a,{received:a.data,code:ar.invalid_enum_value,options:h}),Jr}return Ds(t.data)}get enum(){return this._def.values}}jf=new WeakMap;Mp.create=(e,t)=>new Mp({values:e,typeName:Kr.ZodNativeEnum,...ci(t)});class rd extends _i{unwrap(){return this._def.type}_parse(t){const{ctx:i}=this._processInputParams(t);if(i.parsedType!==Er.promise&&i.common.async===!1)return xr(i,{code:ar.invalid_type,expected:Er.promise,received:i.parsedType}),Jr;const a=i.parsedType===Er.promise?i.data:Promise.resolve(i.data);return Ds(a.then(h=>this._def.type.parseAsync(h,{path:i.path,errorMap:i.common.contextualErrorMap})))}}rd.create=(e,t)=>new rd({type:e,typeName:Kr.ZodPromise,...ci(t)});class qa extends _i{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Kr.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:i,ctx:a}=this._processInputParams(t),h=this._def.effect||null,d={addIssue:p=>{xr(a,p),p.fatal?i.abort():i.dirty()},get path(){return a.path}};if(d.addIssue=d.addIssue.bind(d),h.type==="preprocess"){const p=h.transform(a.data,d);if(a.common.async)return Promise.resolve(p).then(async s=>{if(i.value==="aborted")return Jr;const w=await this._def.schema._parseAsync({data:s,path:a.path,parent:a});return w.status==="aborted"?Jr:w.status==="dirty"||i.value==="dirty"?zu(w.value):w});{if(i.value==="aborted")return Jr;const s=this._def.schema._parseSync({data:p,path:a.path,parent:a});return s.status==="aborted"?Jr:s.status==="dirty"||i.value==="dirty"?zu(s.value):s}}if(h.type==="refinement"){const p=s=>{const w=h.refinement(s,d);if(a.common.async)return Promise.resolve(w);if(w instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return s};if(a.common.async===!1){const s=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return s.status==="aborted"?Jr:(s.status==="dirty"&&i.dirty(),p(s.value),{status:i.value,value:s.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(s=>s.status==="aborted"?Jr:(s.status==="dirty"&&i.dirty(),p(s.value).then(()=>({status:i.value,value:s.value}))))}if(h.type==="transform")if(a.common.async===!1){const p=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!ch(p))return p;const s=h.transform(p.value,d);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:i.value,value:s}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(p=>ch(p)?Promise.resolve(h.transform(p.value,d)).then(s=>({status:i.value,value:s})):p);Si.assertNever(h)}}qa.create=(e,t,i)=>new qa({schema:e,typeName:Kr.ZodEffects,effect:t,...ci(i)});qa.createWithPreprocess=(e,t,i)=>new qa({schema:t,effect:{type:"preprocess",transform:e},typeName:Kr.ZodEffects,...ci(i)});class Io extends _i{_parse(t){return this._getType(t)===Er.undefined?Ds(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Io.create=(e,t)=>new Io({innerType:e,typeName:Kr.ZodOptional,...ci(t)});class ic extends _i{_parse(t){return this._getType(t)===Er.null?Ds(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ic.create=(e,t)=>new ic({innerType:e,typeName:Kr.ZodNullable,...ci(t)});class Ip extends _i{_parse(t){const{ctx:i}=this._processInputParams(t);let a=i.data;return i.parsedType===Er.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:i.path,parent:i})}removeDefault(){return this._def.innerType}}Ip.create=(e,t)=>new Ip({innerType:e,typeName:Kr.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ci(t)});class Ap extends _i{_parse(t){const{ctx:i}=this._processInputParams(t),a={...i,common:{...i.common,issues:[]}},h=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return pp(h)?h.then(d=>({status:"valid",value:d.status==="valid"?d.value:this._def.catchValue({get error(){return new ua(a.common.issues)},input:a.data})})):{status:"valid",value:h.status==="valid"?h.value:this._def.catchValue({get error(){return new ua(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}}Ap.create=(e,t)=>new Ap({innerType:e,typeName:Kr.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ci(t)});class Cg extends _i{_parse(t){if(this._getType(t)!==Er.nan){const a=this._getOrReturnCtx(t);return xr(a,{code:ar.invalid_type,expected:Er.nan,received:a.parsedType}),Jr}return{status:"valid",value:t.data}}}Cg.create=e=>new Cg({typeName:Kr.ZodNaN,...ci(e)});const cG=Symbol("zod_brand");class Yy extends _i{_parse(t){const{ctx:i}=this._processInputParams(t),a=i.data;return this._def.type._parse({data:a,path:i.path,parent:i})}unwrap(){return this._def.type}}class Qp extends _i{_parse(t){const{status:i,ctx:a}=this._processInputParams(t);if(a.common.async)return(async()=>{const d=await this._def.in._parseAsync({data:a.data,path:a.path,parent:a});return d.status==="aborted"?Jr:d.status==="dirty"?(i.dirty(),zu(d.value)):this._def.out._parseAsync({data:d.value,path:a.path,parent:a})})();{const h=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return h.status==="aborted"?Jr:h.status==="dirty"?(i.dirty(),{status:"dirty",value:h.value}):this._def.out._parseSync({data:h.value,path:a.path,parent:a})}}static create(t,i){return new Qp({in:t,out:i,typeName:Kr.ZodPipeline})}}class Tp extends _i{_parse(t){const i=this._def.innerType._parse(t),a=h=>(ch(h)&&(h.value=Object.freeze(h.value)),h);return pp(i)?i.then(h=>a(h)):a(i)}unwrap(){return this._def.innerType}}Tp.create=(e,t)=>new Tp({innerType:e,typeName:Kr.ZodReadonly,...ci(t)});function g4(e,t){const i=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof i=="string"?{message:i}:i}function H3(e,t={},i){return e?td.create().superRefine((a,h)=>{var d,p;const s=e(a);if(s instanceof Promise)return s.then(w=>{var A,z;if(!w){const B=g4(t,a),D=(z=(A=B.fatal)!==null&&A!==void 0?A:i)!==null&&z!==void 0?z:!0;h.addIssue({code:"custom",...B,fatal:D})}});if(!s){const w=g4(t,a),A=(p=(d=w.fatal)!==null&&d!==void 0?d:i)!==null&&p!==void 0?p:!0;h.addIssue({code:"custom",...w,fatal:A})}}):td.create()}const hG={object:In.lazycreate};var Kr;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Kr||(Kr={}));const uG=(e,t={message:`Input not instance of ${e.name}`})=>H3(i=>i instanceof e,t),W3=Ua.create,X3=ec.create,dG=Cg.create,fG=tc.create,q3=mp.create,pG=hh.create,mG=Ig.create,gG=gp.create,_G=_p.create,vG=td.create,yG=ih.create,bG=vl.create,wG=Ag.create,xG=Xa.create,MG=In.create,IG=In.strictCreate,AG=vp.create,TG=Jg.create,CG=yp.create,SG=So.create,PG=bp.create,EG=Tg.create,kG=uh.create,RG=Zu.create,LG=wp.create,zG=xp.create,FG=rc.create,DG=Mp.create,BG=rd.create,_4=qa.create,GG=Io.create,VG=ic.create,jG=qa.createWithPreprocess,ZG=Qp.create,OG=()=>W3().optional(),NG=()=>X3().optional(),UG=()=>q3().optional(),HG={string:e=>Ua.create({...e,coerce:!0}),number:e=>ec.create({...e,coerce:!0}),boolean:e=>mp.create({...e,coerce:!0}),bigint:e=>tc.create({...e,coerce:!0}),date:e=>hh.create({...e,coerce:!0})},WG=Jr;var Re=Object.freeze({__proto__:null,defaultErrorMap:ed,setErrorMap:jB,getErrorMap:wg,makeIssue:xg,EMPTY_PATH:ZB,addIssueToContext:xr,ParseStatus:xs,INVALID:Jr,DIRTY:zu,OK:Ds,isAborted:$v,isDirty:Jv,isValid:ch,isAsync:pp,get util(){return Si},get objectUtil(){return Kv},ZodParsedType:Er,getParsedType:hl,ZodType:_i,datetimeRegex:N3,ZodString:Ua,ZodNumber:ec,ZodBigInt:tc,ZodBoolean:mp,ZodDate:hh,ZodSymbol:Ig,ZodUndefined:gp,ZodNull:_p,ZodAny:td,ZodUnknown:ih,ZodNever:vl,ZodVoid:Ag,ZodArray:Xa,ZodObject:In,ZodUnion:vp,ZodDiscriminatedUnion:Jg,ZodIntersection:yp,ZodTuple:So,ZodRecord:bp,ZodMap:Tg,ZodSet:uh,ZodFunction:Zu,ZodLazy:wp,ZodLiteral:xp,ZodEnum:rc,ZodNativeEnum:Mp,ZodPromise:rd,ZodEffects:qa,ZodTransformer:qa,ZodOptional:Io,ZodNullable:ic,ZodDefault:Ip,ZodCatch:Ap,ZodNaN:Cg,BRAND:cG,ZodBranded:Yy,ZodPipeline:Qp,ZodReadonly:Tp,custom:H3,Schema:_i,ZodSchema:_i,late:hG,get ZodFirstPartyTypeKind(){return Kr},coerce:HG,any:vG,array:xG,bigint:fG,boolean:q3,date:pG,discriminatedUnion:TG,effect:_4,enum:FG,function:RG,instanceof:uG,intersection:CG,lazy:LG,literal:zG,map:EG,nan:dG,nativeEnum:DG,never:bG,null:_G,nullable:VG,number:X3,object:MG,oboolean:UG,onumber:NG,optional:GG,ostring:OG,pipeline:ZG,preprocess:jG,promise:BG,record:PG,set:kG,strictObject:IG,string:W3,symbol:mG,transformer:_4,tuple:SG,undefined:gG,union:AG,unknown:yG,void:wG,NEVER:WG,ZodIssueCode:ar,quotelessJson:VB,ZodError:ua});function XG(e){if(e)return Array.isArray(e)?e:[e]}const qG=Re.union([Re.string(),Re.number(),Re.boolean()]),YG=Re.record(Re.string(),qG.array()),nc=Re.tuple([Re.number(),Re.number()]),Y3=Re.object({type:Re.literal("Point"),coordinates:nc}),K3=nc.array().min(3),$3=["ImageService1","ImageService2","ImageService3"],KG=[...$3,"Canvas"],Ky=Re.enum($3),J3=Re.enum(KG),$G=Re.object({id:Re.string().url(),type:Re.string(),label:YG.optional()}),ey=$G.extend({partOf:Re.lazy(()=>ey.array()).optional()}),Qg=Re.union([ey.array(),ey]).transform(XG),v4=Re.object({type:Re.enum(["helmert","polynomial","thinPlateSpline","projective","straight","linear"]),options:Re.object({}).passthrough().optional()});function y4(e){const t=e.toLowerCase();if(t==="thinplatespline"||t==="thin-plate-spline")return{type:"thinPlateSpline"};if(t==="polynomial1")return{type:"polynomial",options:{order:1}};if(t==="polynomial2")return{type:"polynomial",options:{order:2}}}const e1=Re.union([v4,Re.unknown()]).transform(e=>{const{success:t,data:i}=v4.safeParse(e);if(t)return i;if(e==="string")return y4(e);if(e&&typeof e=="object"&&"type"in e&&typeof e.type=="string")return y4(e.type)}),Q3=Re.object({id:Re.string().url().optional(),name:Re.string().optional(),definition:Re.union([Re.string(),Re.unknown()])}),t1=Re.union([Re.string().url().array(),Re.string().url()]),JG=/^<svg\s+width="\d+"\s+height="\d+"\s*>\s*<polygon\s+points="\s*(-?\d+(\.\d+)?,-?\d+(\.\d+)?\s+){2,}-?\d+(\.\d+)?,-?\d+(\.\d+)?\s*"\s*\/>\s*<\/svg>$/,QG=Re.object({type:Re.literal("SvgSelector"),value:Re.string().regex(JG)}),eV=Re.object({source:Re.string().url(),service:Re.array(Re.object({"@id":Re.string().url(),type:J3})).length(1),selector:QG}),e5=Re.object({pixelCoords:nc}),tV=Re.object({type:Re.literal("FeatureCollection"),transformation:e1.optional(),features:Re.array(Re.object({type:Re.literal("Feature"),properties:e5,geometry:Y3}))}),$y=Re.object({id:Re.string().optional(),type:Re.literal("Annotation"),"@context":t1.optional(),motivation:Re.string().default("georeferencing").optional(),target:eV,body:tV}),t5=Re.object({id:Re.string().optional(),type:Re.literal("AnnotationPage"),"@context":t1.optional(),items:Re.array($y)}),Jy=/<polygon\s+points="\s*(-?\d+(\.\d+)?,-?\d+(\.\d+)?\s+){2,}-?\d+(\.\d+)?,-?\d+(\.\d+)?\s*"\s*\/>/,rV=new RegExp(`^<svg\\s+width="\\d+"\\s+height="\\d+"\\s*>\\s*${Jy.source}\\s*</svg>$`),iV=new RegExp(`^<svg\\s+height="\\d+"\\s+width="\\d+"\\s*>\\s*${Jy.source}\\s*</svg>$`),nV=new RegExp(`^<svg\\s*>\\s*${Jy.source}\\s*</svg>$`),sV=Re.string().regex(nV),aV=Re.string().regex(rV),oV=Re.string().regex(iV),lV=Re.object({type:Re.literal("SvgSelector"),value:Re.union([sV,aV,oV])}),cV=Re.object({"@id":Re.string().url(),type:Ky,height:Re.number().positive(),width:Re.number().positive(),partOf:Qg.optional()}),hV=Re.object({id:Re.string().url(),type:Ky,height:Re.number().positive().optional(),width:Re.number().positive().optional(),partOf:Qg.optional()}),uV=Re.object({id:Re.string().url(),type:Re.literal("Canvas"),height:Re.number().positive().optional(),width:Re.number().positive().optional(),partOf:Qg.optional()}),dV=Re.union([cV,hV,uV]),fV=Re.object({type:Re.literal("SpecificResource"),source:dV,selector:lV}),r5=Re.object({resourceCoords:nc}),pV=Re.object({type:Re.literal("FeatureCollection"),transformation:e1.optional(),resourceCrs:Q3.optional(),features:Re.array(Re.object({type:Re.literal("Feature"),properties:r5,geometry:Y3}))}),Qy=Re.object({id:Re.string().optional(),type:Re.literal("Annotation"),"@context":t1.optional(),motivation:Re.string().default("georeferencing").optional(),created:Re.string().datetime().optional(),modified:Re.string().datetime().optional(),target:fV,body:pV}),i5=Re.object({id:Re.string().optional(),type:Re.literal("AnnotationPage"),"@context":t1.optional(),items:Re.array(Qy)});Re.union([$y,Qy]);Re.union([t5,i5]);Re.union([e5,r5]);function n5(e){return Array.isArray(e)}function mV(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="AnnotationPage"&&"items"in e)}function Sg(e){return!!(e&&typeof e=="object"&&"type"in e&&e.type==="GeoreferencedMap")}function b4(e){return!!(e&&typeof e=="object"&&"target"in e&&e.target&&typeof e.target=="object"&&"source"in e.target&&typeof e.target.source=="string")}function r1(e){return"type"in e&&e.type==="GeoreferencedMap"}function i1(e){return"source"in e.target&&typeof e.target.source=="object"}function gV(e){return{id:_V(e),...MV(e),type:vV(e),partOf:yV(e)}}function _V(e){if(i1(e)){const t=e.target.source;return"id"in t?t.id:t["@id"]}else return e.target.service[0]["@id"]}function vV(e){return"service"in e.target?e.target.service[0].type:e.target.source.type}function yV(e){if(i1(e))return e.target.source.partOf}function bV(e){return"pixelCoords"in e?e.pixelCoords:e.resourceCoords}function wV(e){return e.body.features.map(t=>({resource:bV(t.properties),geo:t.geometry.coordinates}))}function xV(e){if(i1(e))return{created:e.created,modified:e.modified}}function MV(e){var s,w;if(i1(e))return{width:e.target.source.width,height:e.target.source.height};const i=e.target.selector.value,a=/width="(?<width>\d+)"/.exec(i),h=/height="(?<height>\d+)"/.exec(i),d=(s=a==null?void 0:a.groups)==null?void 0:s.width,p=(w=h==null?void 0:h.groups)==null?void 0:w.height;if(!d||!p)throw new Error("Could not parse image dimensions");return{width:parseInt(d),height:parseInt(p)}}function IV(e){const i=e.target.selector.value,a=/points="(?<points>.+)"/.exec(i),h=a==null?void 0:a.groups;if(h&&h.points){const d=h.points.trim().split(/\s+/);if(d[0]===d[d.length-1]&&d.splice(-1),d.length>=3)return d.map(p=>{const s=p.split(",");if(s.length===2)return[parseFloat(s[0]),parseFloat(s[1])];throw new Error("Could not parse resource mask")});throw new Error("Could not parse resource mask")}else throw new Error("Could not parse resource mask")}function w4(e){let t;return"resourceCrs"in e.body&&(t=e.body.resourceCrs),{"@context":"https://schemas.allmaps.org/map/2/context.json",type:"GeoreferencedMap",id:e.id,...xV(e),resource:gV(e),gcps:wV(e),resourceMask:IV(e),transformation:e.body.transformation,resourceCrs:t}}function ty(e){if(mV(e)){let t;return"items"in e&&Array.isArray(e.items)&&b4(e.items[0])?t=t5.parse(e):t=i5.parse(e),t.items.map(i=>w4(i))}else{let t;return b4(e)?t=$y.parse(e):t=Qy.parse(e),[w4(t)]}}const s5=Re.object({image:nc,world:nc}),AV=Re.object({uri:Re.string().url(),width:Re.number(),height:Re.number(),type:Ky}),n1=Re.object({id:Re.string().optional(),version:Re.number().min(1).max(1).default(1),image:AV,gcps:s5.array(),pixelMask:K3,transformation:e1.optional()}),eb=Re.array(n1),a5=Re.object({resource:nc,geo:nc}),TV=Re.object({id:Re.string().url(),height:Re.number().positive().optional(),width:Re.number().positive().optional(),type:J3,partOf:Qg.optional()}),s1=Re.object({"@context":Re.literal("https://schemas.allmaps.org/map/2/context.json").optional(),type:Re.literal("GeoreferencedMap"),id:Re.string().optional(),created:Re.string().datetime().optional(),modified:Re.string().datetime().optional(),resource:TV,gcps:a5.array(),resourceMask:K3,transformation:e1.optional(),resourceCrs:Q3.optional()}),tb=Re.array(s1);Re.union([n1,s1]);Re.union([eb,tb]);Re.union([s5,a5]);function CV(e){let t,i,a;r1(e)?(t=e.resource.width,i=e.resource.height,a=e.resourceMask):(t=e.image.width,i=e.image.height,a=e.pixelMask);let h="<svg>";return t&&i&&(h=`<svg width="${t}" height="${i}">`),{type:"SvgSelector",value:`${h}<polygon points="${a.map(d=>d.join(",")).join(" ")}" /></svg>`}}function SV(e){let t,i,a,h,d;if(r1(e)){if(e.resource.type==="Canvas")return{id:e.resource.id,type:e.resource.type,height:e.resource.height,width:e.resource.width,partOf:e.resource.partOf};t=e.resource.id,i=e.resource.type,a=e.resource.width,h=e.resource.height,d=e.resource.partOf}else t=e.image.uri,i=e.image.type,a=e.image.width,h=e.image.height;return{id:t,type:i,height:h,width:a,partOf:d}}function PV(e){if(r1(e))return{created:e.created,modified:e.modified}}function EV(){return["http://iiif.io/api/extension/georef/1/context.json","http://iiif.io/api/presentation/3/context.json"]}function kV(e){let t,i;return"resource"in e?(t=e.resource,i=e.geo):(t=e.image,i=e.world),{type:"Feature",properties:{resourceCoords:t},geometry:{type:"Point",coordinates:i}}}function x4(e){const t={type:"SpecificResource",source:SV(e),selector:CV(e)};let i;"resourceCrs"in e&&(i=e.resourceCrs);const a={type:"FeatureCollection",transformation:e.transformation,resourceCrs:i,features:e.gcps.map(h=>kV(h))};return{id:e.id,type:"Annotation","@context":EV(),...PV(e),motivation:"georeferencing",target:t,body:a}}function RV(e){if(n5(e)){let t;return Sg(e[0])?t=tb.parse(e):t=eb.parse(e),{type:"AnnotationPage","@context":"http://www.w3.org/ns/anno.jsonld",items:t.map(a=>x4(a))}}else{let t;return Sg(e)?t=s1.parse(e):t=n1.parse(e),x4(t)}}function o5(e){return r1(e)?e:ty(RV(e))[0]}function LV(e){return e.map(o5)}function M4(e){if(n5(e)){let t;return Sg(e[0])?t=tb.parse(e):t=eb.parse(e),LV(t)}else{let t;return Sg(e)?t=s1.parse(e):t=n1.parse(e),o5(t)}}const a1=/^https?:\/\/library.stanford.edu\/iiif\/image-api\/1.1\/compliance.html#level(?<level>[012])$/,l5=Re.string().regex(a1),zV=l5,Pg="http://library.stanford.edu/iiif/image-api/1.1/context.json",c5="http://iiif.io/api/image/1/context.json",h5=Re.literal(Pg),rb=Re.object({"@context":h5,"@id":Re.string().url(),profile:l5.optional(),width:Re.number().int(),height:Re.number().int(),scale_factors:Re.number().array().optional(),tile_width:Re.number().optional(),tile_height:Re.number().optional()}),u5=Re.object({width:Re.number().int(),height:Re.number().int()}),d5=Re.object({width:Re.number().int(),height:Re.number().int().optional(),scaleFactors:Re.array(Re.number().int())}),FV=["ImageService1","ImageService2","ImageService3"],f5=Re.enum(FV),I4=Re.coerce.date(),Po=Re.union([I4,Re.any()]).transform(e=>{const{success:t,data:i}=I4.safeParse(e);if(t)return i}),Eo=Re.object({}).passthrough(),o1=/^https?:\/\/iiif.io\/api\/image\/2.*level(?<level>[012])(.json)?$/,p5=Re.string().regex(o1),DV=Re.object({formats:Re.string().array().optional(),maxArea:Re.number().int().optional(),maxHeight:Re.number().int().optional(),maxWidth:Re.number().int().optional(),qualities:Re.string().array().optional(),supports:Re.string().array().optional()}),A4=Re.union([p5,DV]);function BV(e){return e!==void 0}const Eg=Re.union([p5,Re.array(Re.union([A4,Re.unknown()]).transform(e=>{const{success:t,data:i}=A4.safeParse(e);if(t)return i}))]).transform(e=>{if(e&&Array.isArray(e)){const t=e[0];if(typeof t!="string")throw new Error("First profile must be a string");return[t,...e.slice(1).filter(BV)]}return e}),kg="http://iiif.io/api/image/2/context.json",m5=Re.union([Re.literal(kg),Re.literal("https://iiif.io/api/image/2/context.json"),Re.string().url()]),ib=Re.object({"@id":Re.string().url(),"@type":Re.union([Re.literal("iiif:Image"),Re.literal("ImageService2")]).optional(),"@context":m5,protocol:Re.literal("http://iiif.io/api/image"),width:Re.number().int(),height:Re.number().int(),profile:Eg,sizes:u5.array().optional(),tiles:d5.array().optional()}),GV=["level0","level1","level2"],g5=Re.enum(GV),nb=Re.object({id:Re.string().url(),type:Re.literal("ImageService3"),protocol:Re.literal("http://iiif.io/api/image"),profile:g5,width:Re.number().int(),height:Re.number().int(),maxWidth:Re.number().int().optional(),maxHeight:Re.number().int().optional(),maxArea:Re.number().int().optional(),sizes:u5.array().optional(),tiles:d5.array().optional(),extraFeatures:Re.string().array().optional()}),VV=Re.object({"@id":Re.string().url(),"@type":f5.optional(),profile:Re.union([zV,Eg,g5]),width:Re.number().int().optional(),height:Re.number().int().optional(),"@context":Re.union([h5,Re.literal("http://iiif.io/api/image/1/context.json"),m5]).optional()}),jV=["level0","level1","level2"],ZV=Re.union([Re.object({id:Re.string().url(),type:Re.literal("ImageService2"),profile:Eg}),Re.object({"@id":Re.string().url(),"@type":Re.literal("ImageService2"),profile:Eg})]),OV=Re.object({id:Re.string().url(),type:f5,profile:Re.enum(jV).catch("level0")}),NV=Re.union([ZV,OV]),_5=Re.union([VV,NV]),T4=Re.record(Re.string(),Re.string().array());Re.object({label:T4.optional(),value:T4.optional()});function od(e){if(e)return Array.isArray(e)?e:[e]}const Rg=Re.union([Re.string(),Re.number(),Re.boolean()]).transform(e=>String(e)),Cp=Re.union([Rg.array(),Rg]),C4=Re.object({"@id":Re.string().url(),format:Re.string().optional(),label:Cp.optional()}),sb=Re.union([C4,C4.array(),Rg,Rg.array()]),S4=Re.union([Re.string(),Re.object({"@id":Re.string(),"@type":Re.string().optional(),format:Re.string().optional(),height:Re.number().optional(),width:Re.number().optional()})]),e0=Re.union([S4.array(),S4]).transform(od),P4=Re.object({"@id":Re.string().url(),"@type":Re.string().optional(),label:Cp.optional(),format:Re.string().optional()}),ab=Re.union([P4.array(),P4]).transform(od),UV=Re.union([Re.object({"@value":Cp,"@language":Re.string().optional()}),Re.object({value:Cp,language:Re.string().optional()})]).transform(e=>"value"in e?{"@value":e.value,"@language":e.language}:e),E4=UV,da=Re.union([E4.array(),E4,Cp]),ob=Re.union([Re.string(),da]),k4=Re.object({label:da.optional(),value:da.optional()}),HV=Re.union([k4,Re.any()]).transform(e=>{const{success:t,data:i}=k4.safeParse(e);if(t)return i}),t0=HV.array(),WV=Re.object({width:Re.number().int().optional(),height:Re.number().int().optional(),service:_5}),XV=Re.object({resource:WV}),lb=Re.object({"@id":Re.string().url(),"@type":Re.literal("sc:Canvas"),width:Re.number().int(),height:Re.number().int(),images:XV.array().length(1),label:da.optional(),description:da.optional(),related:sb.optional(),attribution:ob.optional(),thumbnail:e0.optional(),rendering:ab.optional(),metadata:t0.optional(),navDate:Po.optional(),navPlace:Eo.optional()}),qV=Re.object({canvases:lb.array().nonempty()}),v5=Re.object({"@id":Re.string().url(),"@type":Re.literal("sc:Manifest"),sequences:qV.array().length(1),label:da.optional(),description:da.optional(),metadata:t0.optional(),related:sb.optional(),attribution:ob.optional(),rendering:ab.optional(),thumbnail:e0.optional(),navDate:Po.optional(),navPlace:Eo.optional()}),YV=Re.lazy(()=>Re.object({"@id":Re.string().url(),"@type":Re.literal("sc:Manifest"),label:da.optional(),description:da.optional(),metadata:t0.optional(),thumbnail:e0.optional(),navDate:Po.optional(),navPlace:Eo.optional()})),cb=Re.lazy(()=>{const e=Re.union([YV,cb,KV]);return Re.object({"@id":Re.string().url(),"@type":Re.literal("sc:Collection"),manifests:e.array().optional(),collections:e.array().optional(),members:e.array().optional(),label:da.optional(),description:da.optional(),metadata:t0.optional(),thumbnail:e0.optional(),navDate:Po.optional(),navPlace:Eo.optional(),related:sb.optional(),attribution:ob.optional(),rendering:ab.optional()})}),KV=Re.object({"@id":Re.string().url(),"@type":Re.literal("sc:Collection"),label:da.optional(),description:da.optional(),metadata:t0.optional(),thumbnail:e0.optional(),navDate:Po.optional(),navPlace:Eo.optional()}),$V=Re.union([Re.string(),Re.number(),Re.boolean()]).transform(e=>String(e)),Bs=Re.record(Re.string(),$V.array()),hb=Bs,R4=Re.object({id:Re.string().url(),type:Re.string().optional(),label:Bs,format:Re.string().optional(),language:Re.union([Re.string(),Re.array(Re.string())]).optional()}),L4=Re.object({id:Re.string().url(),type:Re.string().optional(),label:Bs,format:Re.string().optional()}),ub=Re.union([L4.array(),L4]).transform(od),db=Re.union([R4.array(),R4]).transform(od),z4=Re.object({id:Re.string(),type:Re.string().optional(),format:Re.string().optional(),width:Re.number().int().optional(),height:Re.number().int().optional()}),r0=Re.union([z4.array(),z4]).transform(od),F4=Re.object({id:Re.string().url(),type:Re.string().optional(),format:Re.string().optional(),profile:Re.string().optional()}),fb=Re.union([F4.array(),F4]).transform(od),pb=Re.object({id:Re.string().url(),type:Re.literal("AnnotationPage"),items:Re.object({}).passthrough().array().optional()}).array(),D4=Re.object({label:Bs,value:Bs}),y5=Re.union([D4,Re.any()]).transform(e=>{const{success:t,data:i}=D4.safeParse(e);if(t)return i}),i0=y5.array(),mb=y5,JV=Re.object({type:Re.literal("Image"),width:Re.number().int().optional(),height:Re.number().int().optional(),service:_5.array()}),QV=Re.object({type:Re.literal("Video")}),ej=Re.object({type:Re.literal("Sound")}),ry=Re.union([JV,QV,ej]),tj=Re.object({type:Re.literal("Choice"),items:ry.array()}),rj=Re.object({type:Re.literal("Annotation"),body:Re.union([ry,ry.array().length(1),tj])}),ij=Re.object({type:Re.literal("AnnotationPage"),items:rj.array().length(1)}),gb=Re.object({id:Re.string().url(),type:Re.literal("Canvas"),width:Re.number().int(),height:Re.number().int(),items:ij.array(),label:Bs.optional(),description:Bs.optional(),metadata:i0.optional(),navDate:Po.optional(),navPlace:Eo.optional(),homepage:db.optional(),thumbnail:r0.optional(),rendering:ub.optional(),seeAlso:fb.optional(),summary:hb.optional(),requiredStatement:mb.optional(),annotations:pb.optional()}),b5=Re.object({id:Re.string().url(),type:Re.literal("Manifest"),items:gb.array(),label:Bs.optional(),description:Bs.optional(),metadata:i0.optional(),navDate:Po.optional(),navPlace:Eo.optional(),homepage:db.optional(),thumbnail:r0.optional(),rendering:ub.optional(),seeAlso:fb.optional(),summary:hb.optional(),requiredStatement:mb.optional(),annotations:pb.optional()}),nj=Re.lazy(()=>Re.object({id:Re.string().url(),type:Re.literal("Manifest"),label:Bs.optional(),description:Bs.optional(),metadata:i0.optional(),navDate:Po.optional(),navPlace:Eo.optional(),thumbnail:r0.optional()})),_b=Re.lazy(()=>Re.object({id:Re.string().url(),type:Re.literal("Collection"),items:Re.union([nj,_b,sj]).array(),label:Bs.optional(),description:Bs.optional(),metadata:i0.optional(),navDate:Po.optional(),navPlace:Eo.optional(),thumbnail:r0.optional(),homepage:db.optional(),rendering:ub.optional(),seeAlso:fb.optional(),summary:hb.optional(),requiredStatement:mb.optional(),annotations:pb.optional()})),sj=Re.object({id:Re.string().url(),type:Re.literal("Collection"),label:Bs.optional(),description:Bs.optional(),metadata:i0.optional(),navDate:Po.optional(),navPlace:Eo.optional(),thumbnail:r0.optional()}),aj=Re.union([rb,ib,nb]);Re.union([lb,gb]);Re.union([v5,b5]);Re.union([cb,_b]);const oj=rb,lj=Re.union([cb,v5,lb,ib]),cj=Re.union([_b,b5,gb,nb]);Re.union([oj,lj,cj]);function w5({width:e,height:t},i,a,h){const d=a*i.originalWidth,p=h*i.originalHeight,s=a*i.originalWidth+i.width*i.scaleFactor>e?e-a*i.originalWidth:i.width*i.scaleFactor,w=h*i.originalHeight+i.height*i.scaleFactor>t?t-h*i.originalHeight:i.height*i.scaleFactor;let A=i.width,z=i.height;return d+i.width*i.scaleFactor>e&&(A=Math.floor((e-d+i.scaleFactor-1)/i.scaleFactor)),p+i.height*i.scaleFactor>t&&(z=Math.floor((t-p+i.scaleFactor-1)/i.scaleFactor)),{region:{x:d,y:p,width:s,height:w},size:{width:A,height:z}}}function hj({width:e,height:t},i=768){const a=Math.max(e,t)/i,h=Math.ceil(Math.log(a)/Math.log(2));return{scaleFactors:Array.from({length:h},(d,p)=>2**p),width:i}}function uj({width:e,height:t},i,a){const h=i.height||i.width,d=i.width*a,p=h*a;return{scaleFactor:a,width:i.width,height:h,originalWidth:d,originalHeight:p,columns:Math.ceil(e/d),rows:Math.ceil(t/p)}}function dj(e,t){return t.map(i=>i.scaleFactors.map(a=>uj(e,i,a))).flat()}function fj(e){return!!e.some(t=>t.width&&t.scaleFactors&&t.scaleFactors.length)}function pj(e,t,i){if(!t||!fj(t))if(i)t=[hj(e)];else throw new Error("Image does not support tiles or custom regions and sizes.");return dj(e,t)}function mj(e,t,i="cover"){if(i==="cover"||i==="contain"){const a=t.width/e.width,h=t.height/e.height,d=i==="cover"?Math.max(a,h):Math.min(a,h),p=e.width*d,s=e.height*d;return{width:p,height:s}}else throw new Error('Mode must be either "cover" or "contain"')}const gj=.8,_j=1.5;function x5(e,t,i="cover",{sizes:a,tileZoomLevels:h,supportsAnyRegionAndSize:d,maxWidth:p,maxHeight:s,maxArea:w}){let{width:A,height:z}=mj(e,t,i);if(p&&A>p&&(z=z/A*p,A=p),s&&z>s&&(A=A/z*s,z=s),w&&A*z>w){const D=z/A,W=Math.floor(Math.sqrt(w/D))*D;A=Math.floor(W)/D,z=A*D}const B=e.width/e.height;if(A=Math.floor(A),z=Math.round(A/B),a){let D;for(const V of a){const W=V.width/A;if(W>=gj&&W<=_j){D=V;break}}if(D)return{size:D}}if(d)return{size:{width:Math.round(A),height:Math.round(z)}};if(h){const D=e.width/A,V=h.map(({scaleFactor:te},Q)=>({index:Q,scaleFactor:te,diff:Math.abs(te-D)})).sort((te,Q)=>te.diff-Q.diff),W=h[V[0].index],S=Math.ceil(e.width/(W.scaleFactor*h[0].width)),j=Math.ceil(e.height/(W.scaleFactor*h[0].height)),ne=[];for(let te=0;te<j;te++){const Q=[];for(let N=0;N<S;N++){const re=w5(e,W,N,te);Q.push(re)}ne.push(Q)}return ne}throw new Error("Unable to create thumbnail")}const M5=["regionByPx","sizeByWh"];function vj(e){const t=e.match(a1);if(t&&t.groups)return parseInt(t.groups.level)}function B4(e){const t=e.match(o1);if(t&&t.groups)return parseInt(t.groups.level)}function yj(e){return{maxWidth:e==null?void 0:e.maxWidth,maxHeight:e==null?void 0:e.maxHeight,maxArea:e==null?void 0:e.maxArea,supportsAnyRegionAndSize:M5.every(t=>{var i;return(e==null?void 0:e.supports)&&((i=e==null?void 0:e.supports)==null?void 0:i.includes(t))})}}function bj(e){if("type"in e&&e.type==="ImageService3")return 3;if("type"in e&&e.type==="ImageService2"||"@type"in e&&e["@type"]==="ImageService2"||"@context"in e&&e["@context"]===kg)return 2;if("@context"in e&&(e["@context"]===Pg||e["@context"]===c5))return 1;if("profile"in e){let t;return Array.isArray(e.profile)?t=e.profile[0]:t=e.profile,t.match(a1)?1:t.match(o1)?2:3}else throw new Error("Unsupported IIIF Image Service")}function iy(e){if("type"in e||"@type"in e){const t=e.profile;let i=!1;return t==="level0"||typeof t=="string"&&t.endsWith("level0.json")?"extraFeatures"in e&&(i=M5.every(a=>e.extraFeatures&&e.extraFeatures.includes(a))):i=!0,{maxWidth:"maxWidth"in e?e.maxWidth:void 0,maxHeight:"maxHeight"in e?e.maxHeight:void 0,maxArea:"maxArea"in e?e.maxArea:void 0,supportsAnyRegionAndSize:i}}else if(Array.isArray(e.profile)){let t=!1,i=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;return e.profile.forEach(d=>{if(typeof d=="string"){const p=B4(d);p&&(t=t||p>=1)}else{const{maxWidth:p,maxHeight:s,maxArea:w,supportsAnyRegionAndSize:A}=yj(d);p!==void 0&&(a=Math.max(p,a)),s!==void 0&&(i=Math.max(s,i)),w!==void 0&&(h=Math.max(w,h)),t=t||A}}),{maxWidth:a>=0?a:void 0,maxHeight:i>=0?i:void 0,maxArea:h>=0?h:void 0,supportsAnyRegionAndSize:t}}else if("profile"in e&&e.profile){const t=vj(e.profile),i=B4(e.profile);return t?{supportsAnyRegionAndSize:t>=1}:i?{supportsAnyRegionAndSize:i>=1}:{supportsAnyRegionAndSize:!1}}else throw new Error("Invalid Image")}const wj="image";class xj{constructor(t,i){Ke(this,"embedded",!0);Ke(this,"uri");Ke(this,"type",wj);Ke(this,"maxWidth");Ke(this,"maxHeight");Ke(this,"maxArea");Ke(this,"supportsAnyRegionAndSize");Ke(this,"width");Ke(this,"height");Ke(this,"majorVersion");const{parsedCanvas:a}=i||{};if(a&&"service"in t){const h=t;let d,p;if(Array.isArray(h.service)?h.service.forEach(s=>{try{const w=bj(s);(!p||w>p)&&(p=w,d=s)}catch{}}):d=h.service,!d)throw new Error("Unsupported IIIF Image Service");if("@id"in d)this.uri=d["@id"];else if("id"in d)this.uri=d.id;else throw new Error("Unsupported IIIF Image Service");if("type"in d&&d.type==="ImageService3")this.majorVersion=3;else if("type"in d&&d.type==="ImageService2"||"@type"in d&&d["@type"]==="ImageService2"||"@context"in d&&d["@context"]===kg)this.majorVersion=2;else if("@context"in d&&(d["@context"]===Pg||d["@context"]===c5))this.majorVersion=1;else if("profile"in d){let s;if(Array.isArray(d.profile)&&d.profile.length>0)s=d.profile[0];else if(typeof d.profile=="string")s=d.profile;else throw new Error("Unsupported IIIF Image Service");s.match(a1)?this.majorVersion=1:s.match(o1)?this.majorVersion=2:this.majorVersion=3}else throw new Error("Unsupported IIIF Image Service");if("profile"in d){const s=iy(d);this.supportsAnyRegionAndSize=s.supportsAnyRegionAndSize,this.maxWidth=s.maxWidth,this.maxHeight=s.maxHeight,this.maxArea=s.maxArea}else this.supportsAnyRegionAndSize=!1}else{if("@id"in t)this.uri=t["@id"];else if("id"in t)this.uri=t.id;else throw new Error("Unsupported IIIF Image");if("type"in t&&t.type==="ImageService3")this.majorVersion=3;else if("@type"in t&&t["@type"]==="iiif:Image"||"@context"in t&&t["@context"]===kg)this.majorVersion=2;else if("@context"in t&&t["@context"]===Pg)this.majorVersion=1;else throw new Error("Unsupported IIIF Image");if("profile"in t){const h=iy(t);this.supportsAnyRegionAndSize=h.supportsAnyRegionAndSize,this.maxWidth=h.maxWidth,this.maxHeight=h.maxHeight,this.maxArea=h.maxArea}else this.supportsAnyRegionAndSize=!1}if(t.width!==void 0)this.width=t.width;else if(a)this.width=a.width;else throw new Error("Width not present on either Canvas or Image Resource");if(t.height!==void 0)this.height=t.height;else if(a)this.height=a.height;else throw new Error("Height not present on either Canvas or Image Resource")}getImageUrl(t){const{region:i,size:a}=t;let h,d,p,s,w;i?(w=`${i.x},${i.y},${i.width},${i.height}`,p=i.height,s=i.width):(w="full",p=this.height,s=this.width);let A;if(a){h=Math.round(a.width),d=Math.round(a.height);const D=String(h);let V=String(d);const W=s/p,j=d*W/W;this.majorVersion<=2&&d===Math.round(j)&&(V=""),A=`${D},${V}`}else h=this.width,d=this.height,A=this.majorVersion===2?"full":"max";const z=h*d;if(this.maxWidth!==void 0&&h>this.maxWidth)throw new Error(`Width of requested image is too large: ${h} > ${this.maxWidth}`);if(this.maxHeight!==void 0&&d>this.maxHeight)throw new Error(`Height of requested image is too large: ${d} > ${this.maxHeight}`);if(this.maxArea!==void 0&&z>this.maxArea)throw new Error(`Area of requested image is too large: ${z} > ${this.maxArea}`);const B=this.majorVersion===1?"native":"default";return`${this.uri}/${w}/${A}/0/${B}.jpg`}getImageRequest(t,i="cover"){return x5({width:this.width,height:this.height},t,i,{supportsAnyRegionAndSize:this.supportsAnyRegionAndSize,maxWidth:this.maxWidth,maxHeight:this.maxHeight,maxArea:this.maxArea})}}let I5=class A5 extends xj{constructor(i,a){super(i);Ke(this,"source");Ke(this,"tileZoomLevels");Ke(this,"sizes");Ke(this,"embedded",!1);this.source=a==null?void 0:a.source;const h=iy(i);let d;"tiles"in i&&(d=i.tiles),this.tileZoomLevels=pj({width:this.width,height:this.height},d,h.supportsAnyRegionAndSize),"sizes"in i&&(this.sizes=i.sizes)}static parse(i,a){const{majorVersion:h,keepSource:d}=a||{};let p;return h===1?p=rb.parse(i):h===2?p=ib.parse(i):h===3?p=nb.parse(i):p=aj.parse(i),new A5(p,d?{source:i}:{})}getTileImageRequest(i,a,h){return w5({width:this.width,height:this.height},i,a,h)}getImageRequest(i,a="cover"){return x5({width:this.width,height:this.height},i,a,{supportsAnyRegionAndSize:this.supportsAnyRegionAndSize,sizes:this.sizes,tileZoomLevels:this.tileZoomLevels,maxWidth:this.maxWidth,maxHeight:this.maxHeight,maxArea:this.maxArea})}};function T5(e,t,i=0,a=e.length-1,h=Mj){for(;a>i;){if(a-i>600){const w=a-i+1,A=t-i+1,z=Math.log(w),B=.5*Math.exp(2*z/3),D=.5*Math.sqrt(z*B*(w-B)/w)*(A-w/2<0?-1:1),V=Math.max(i,Math.floor(t-A*B/w+D)),W=Math.min(a,Math.floor(t+(w-A)*B/w+D));T5(e,t,V,W,h)}const d=e[t];let p=i,s=a;for(Tf(e,i,t),h(e[a],d)>0&&Tf(e,i,a);p<s;){for(Tf(e,p,s),p++,s--;h(e[p],d)<0;)p++;for(;h(e[s],d)>0;)s--}h(e[i],d)===0?Tf(e,i,s):(s++,Tf(e,s,a)),s<=t&&(i=s+1),t<=s&&(a=s-1)}}function Tf(e,t,i){const a=e[t];e[t]=e[i],e[i]=a}function Mj(e,t){return e<t?-1:e>t?1:0}class Ij{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let i=this.data;const a=[];if(!Im(t,i))return a;const h=this.toBBox,d=[];for(;i;){for(let p=0;p<i.children.length;p++){const s=i.children[p],w=i.leaf?h(s):s;Im(t,w)&&(i.leaf?a.push(s):tv(t,w)?this._all(s,a):d.push(s))}i=d.pop()}return a}collides(t){let i=this.data;if(!Im(t,i))return!1;const a=[];for(;i;){for(let h=0;h<i.children.length;h++){const d=i.children[h],p=i.leaf?this.toBBox(d):d;if(Im(t,p)){if(i.leaf||tv(t,p))return!0;a.push(d)}}i=a.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let a=0;a<t.length;a++)this.insert(t[a]);return this}let i=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=i;else if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){const a=this.data;this.data=i,i=a}this._insert(i,this.data.height-i.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Cu([]),this}remove(t,i){if(!t)return this;let a=this.data;const h=this.toBBox(t),d=[],p=[];let s,w,A;for(;a||d.length;){if(a||(a=d.pop(),w=d[d.length-1],s=p.pop(),A=!0),a.leaf){const z=Aj(t,a.children,i);if(z!==-1)return a.children.splice(z,1),d.push(a),this._condense(d),this}!A&&!a.leaf&&tv(a,h)?(d.push(a),p.push(s),s=0,w=a,a=a.children[0]):w?(s++,a=w.children[s],A=!1):a=null}return this}toBBox(t){return t}compareMinX(t,i){return t.minX-i.minX}compareMinY(t,i){return t.minY-i.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,i){const a=[];for(;t;)t.leaf?i.push(...t.children):a.push(...t.children),t=a.pop();return i}_build(t,i,a,h){const d=a-i+1;let p=this._maxEntries,s;if(d<=p)return s=Cu(t.slice(i,a+1)),vu(s,this.toBBox),s;h||(h=Math.ceil(Math.log(d)/Math.log(p)),p=Math.ceil(d/Math.pow(p,h-1))),s=Cu([]),s.leaf=!1,s.height=h;const w=Math.ceil(d/p),A=w*Math.ceil(Math.sqrt(p));G4(t,i,a,A,this.compareMinX);for(let z=i;z<=a;z+=A){const B=Math.min(z+A-1,a);G4(t,z,B,w,this.compareMinY);for(let D=z;D<=B;D+=w){const V=Math.min(D+w-1,B);s.children.push(this._build(t,D,V,h-1))}}return vu(s,this.toBBox),s}_chooseSubtree(t,i,a,h){for(;h.push(i),!(i.leaf||h.length-1===a);){let d=1/0,p=1/0,s;for(let w=0;w<i.children.length;w++){const A=i.children[w],z=ev(A),B=Sj(t,A)-z;B<p?(p=B,d=z<d?z:d,s=A):B===p&&z<d&&(d=z,s=A)}i=s||i.children[0]}return i}_insert(t,i,a){const h=a?t:this.toBBox(t),d=[],p=this._chooseSubtree(h,this.data,i,d);for(p.children.push(t),Of(p,h);i>=0&&d[i].children.length>this._maxEntries;)this._split(d,i),i--;this._adjustParentBBoxes(h,d,i)}_split(t,i){const a=t[i],h=a.children.length,d=this._minEntries;this._chooseSplitAxis(a,d,h);const p=this._chooseSplitIndex(a,d,h),s=Cu(a.children.splice(p,a.children.length-p));s.height=a.height,s.leaf=a.leaf,vu(a,this.toBBox),vu(s,this.toBBox),i?t[i-1].children.push(s):this._splitRoot(a,s)}_splitRoot(t,i){this.data=Cu([t,i]),this.data.height=t.height+1,this.data.leaf=!1,vu(this.data,this.toBBox)}_chooseSplitIndex(t,i,a){let h,d=1/0,p=1/0;for(let s=i;s<=a-i;s++){const w=Zf(t,0,s,this.toBBox),A=Zf(t,s,a,this.toBBox),z=Pj(w,A),B=ev(w)+ev(A);z<d?(d=z,h=s,p=B<p?B:p):z===d&&B<p&&(p=B,h=s)}return h||a-i}_chooseSplitAxis(t,i,a){const h=t.leaf?this.compareMinX:Tj,d=t.leaf?this.compareMinY:Cj,p=this._allDistMargin(t,i,a,h),s=this._allDistMargin(t,i,a,d);p<s&&t.children.sort(h)}_allDistMargin(t,i,a,h){t.children.sort(h);const d=this.toBBox,p=Zf(t,0,i,d),s=Zf(t,a-i,a,d);let w=Mm(p)+Mm(s);for(let A=i;A<a-i;A++){const z=t.children[A];Of(p,t.leaf?d(z):z),w+=Mm(p)}for(let A=a-i-1;A>=i;A--){const z=t.children[A];Of(s,t.leaf?d(z):z),w+=Mm(s)}return w}_adjustParentBBoxes(t,i,a){for(let h=a;h>=0;h--)Of(i[h],t)}_condense(t){for(let i=t.length-1,a;i>=0;i--)t[i].children.length===0?i>0?(a=t[i-1].children,a.splice(a.indexOf(t[i]),1)):this.clear():vu(t[i],this.toBBox)}}function Aj(e,t,i){if(!i)return t.indexOf(e);for(let a=0;a<t.length;a++)if(i(e,t[a]))return a;return-1}function vu(e,t){Zf(e,0,e.children.length,t,e)}function Zf(e,t,i,a,h){h||(h=Cu(null)),h.minX=1/0,h.minY=1/0,h.maxX=-1/0,h.maxY=-1/0;for(let d=t;d<i;d++){const p=e.children[d];Of(h,e.leaf?a(p):p)}return h}function Of(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function Tj(e,t){return e.minX-t.minX}function Cj(e,t){return e.minY-t.minY}function ev(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function Mm(e){return e.maxX-e.minX+(e.maxY-e.minY)}function Sj(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function Pj(e,t){const i=Math.max(e.minX,t.minX),a=Math.max(e.minY,t.minY),h=Math.min(e.maxX,t.maxX),d=Math.min(e.maxY,t.maxY);return Math.max(0,h-i)*Math.max(0,d-a)}function tv(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function Im(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function Cu(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function G4(e,t,i,a,h){const d=[t,i];for(;d.length;){if(i=d.pop(),t=d.pop(),i-t<=a)continue;const p=t+Math.ceil((i-t)/a/2)*a;T5(e,p,t,i,h),d.push(t,p,p,i)}}const Ej=!0;class kj{constructor(){Ke(this,"rbush",new Ij);Ke(this,"polygonsById",new Map);Ke(this,"bboxesById",new Map);Ke(this,"itemsById",new Map)}addItem(t,i){this.removeItem(t);const a=Gn(i),h={minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],id:t};this.polygonsById.set(t,i),this.bboxesById.set(t,a),this.itemsById.set(t,h),this.rbush.insert(h)}removeItem(t){const i=this.itemsById.get(t);i&&(this.rbush.remove(i),this.polygonsById.delete(t),this.bboxesById.delete(t),this.itemsById.delete(t))}clear(){this.polygonsById.clear(),this.bboxesById.clear(),this.itemsById.clear(),this.rbush.clear()}search(t,i,a,h){return this.rbush.search({minX:t,minY:i,maxX:a,maxY:h})}getBbox(t){return this.bboxesById.get(t)}getPolygon(t){return this.polygonsById.get(t)}searchFromBbox(t){const[i,a,h,d]=t;return this.search(i,a,h,d).map(p=>p.id)}searchFromPoint(t,i=Ej){const[a,h,d,p]=[t[0],t[1],t[0],t[1]],s=this.search(a,h,d,p);return i?s.filter(w=>{const A=this.polygonsById.get(w.id);return A?Y8(t,Ey(A)):!1}).map(w=>w.id):s.map(w=>w.id)}}const Qf="#222222",C5="#ffffff",wl=4,S5=["#dff7fa","#c0eff5","#a1e7f0","#82dfeb","#63d8e6","#4facb8","#3b818a","#27565c","#132b2d"],P5=["#d7d9ee","#b0b4de","#898ecd","#6269bd","#3b44ad","#2f368a","#232867","#171b45","#0b0d22"],E5=["#f3dcf0","#e7b9e1","#dc97d2","#d074c3","#c552b5","#9d4190","#76316c","#4e2048","#271024"],k5=["#ffddf1","#ffbbe3","#ff99d5","#ff77c7","#ff56ba","#cc4494","#99336f","#66224a","#321125"],R5=["#ffe3d0","#ffc7a1","#ffab72","#ff8f43","#ff7415","#cc5c10","#99450c","#662e08","#321704"],L5=["#fededf","#febebf","#fe9e9f","#fe7e7f","#fe5e60","#cb4b4c","#983839","#652526","#321213"],z5=["#e0f2e8","#c1e6d2","#a2d9bb","#83cda5","#64c18f","#509a72","#3c7355","#284d39","#13261c"],F5=["#fff3d9","#ffe8b3","#ffdd8d","#ffd267","#ffc742","#cc9f34","#997727","#664f1a","#32270d"],D5=["#efefef","#e0e0e0","#d0d0d0","#c1c1c1","#b2b2b2","#8e8e8e","#6a6a6a","#474747","#232323"],sl={blue:S5,darkblue:P5,purple:E5,pink:k5,orange:R5,red:L5,green:z5,yellow:F5,gray:D5},Rj=S5[wl],Lj=P5[wl];E5[wl];const Am=k5[wl];R5[wl];const V4=L5[wl],j4=z5[wl],B5=F5[wl],zj=D5[wl];function al(e,t){return t.reduce((i,a,h)=>{const d=(h+1)*100,p=`${e}-${d}`;return i[p]=a,i},{})}({...al("blue",sl.blue),...al("darkblue",sl.darkblue),...al("purple",sl.purple),...al("pink",sl.pink),...al("orange",sl.orange),...al("red",sl.red),...al("green",sl.green),...al("yellow",sl.yellow),...al("gray",sl.gray)});function Fj(e,t){const i=bo(...e),a=Math.ceil(i/t)-1,h=E9(e);let d=e[0];const p=[d];for(let s=1;s<=a;s++)d=k9(d,t,h),p.push(d);return p}function Dj(e,t){e=N6(e);let i=[];for(let a=0;a<e.length-1;a++)i=i.concat(Fj([e[a],e[a+1]],t));return i}function G5(e,t){return e.map(i=>Dj(i,t))}function Bj(e,t){const i=[];for(let a=e[0]+t,h=0;a<=e[2];h++,a+=t)for(let d=e[1]+t,p=0;d<=e[3];p++,d+=t)i.push([a,d]);return i}function rv(e,t){try{return Y8(e,Ey(t))===!0}catch(i){return console.error("Error determining if point is inside polygon:",i),!1}}const Z4=Math.pow(2,-52),Tm=new Uint32Array(512);class vb{static from(t,i=Oj,a=Nj){const h=t.length,d=new Float64Array(h*2);for(let p=0;p<h;p++){const s=t[p];d[2*p]=i(s),d[2*p+1]=a(s)}return new vb(d)}constructor(t){const i=t.length>>1;if(i>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const a=Math.max(2*i-5,0);this._triangles=new Uint32Array(a*3),this._halfedges=new Int32Array(a*3),this._hashSize=Math.ceil(Math.sqrt(i)),this._hullPrev=new Uint32Array(i),this._hullNext=new Uint32Array(i),this._hullTri=new Uint32Array(i),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(i),this._dists=new Float64Array(i),this.update()}update(){const{coords:t,_hullPrev:i,_hullNext:a,_hullTri:h,_hullHash:d}=this,p=t.length>>1;let s=1/0,w=1/0,A=-1/0,z=-1/0;for(let $=0;$<p;$++){const le=t[2*$],Me=t[2*$+1];le<s&&(s=le),Me<w&&(w=Me),le>A&&(A=le),Me>z&&(z=Me),this._ids[$]=$}const B=(s+A)/2,D=(w+z)/2;let V,W,S;for(let $=0,le=1/0;$<p;$++){const Me=iv(B,D,t[2*$],t[2*$+1]);Me<le&&(V=$,le=Me)}const j=t[2*V],ne=t[2*V+1];for(let $=0,le=1/0;$<p;$++){if($===V)continue;const Me=iv(j,ne,t[2*$],t[2*$+1]);Me<le&&Me>0&&(W=$,le=Me)}let te=t[2*W],Q=t[2*W+1],N=1/0;for(let $=0;$<p;$++){if($===V||$===W)continue;const le=jj(j,ne,te,Q,t[2*$],t[2*$+1]);le<N&&(S=$,N=le)}let re=t[2*S],oe=t[2*S+1];if(N===1/0){for(let Me=0;Me<p;Me++)this._dists[Me]=t[2*Me]-t[0]||t[2*Me+1]-t[1];Fu(this._ids,this._dists,0,p-1);const $=new Uint32Array(p);let le=0;for(let Me=0,Ve=-1/0;Me<p;Me++){const Be=this._ids[Me],q=this._dists[Be];q>Ve&&($[le++]=Be,Ve=q)}this.hull=$.subarray(0,le),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(yo(j,ne,te,Q,re,oe)<0){const $=W,le=te,Me=Q;W=S,te=re,Q=oe,S=$,re=le,oe=Me}const ve=Zj(j,ne,te,Q,re,oe);this._cx=ve.x,this._cy=ve.y;for(let $=0;$<p;$++)this._dists[$]=iv(t[2*$],t[2*$+1],ve.x,ve.y);Fu(this._ids,this._dists,0,p-1),this._hullStart=V;let Pe=3;a[V]=i[S]=W,a[W]=i[V]=S,a[S]=i[W]=V,h[V]=0,h[W]=1,h[S]=2,d.fill(-1),d[this._hashKey(j,ne)]=V,d[this._hashKey(te,Q)]=W,d[this._hashKey(re,oe)]=S,this.trianglesLen=0,this._addTriangle(V,W,S,-1,-1,-1);for(let $=0,le,Me;$<this._ids.length;$++){const Ve=this._ids[$],Be=t[2*Ve],q=t[2*Ve+1];if($>0&&Math.abs(Be-le)<=Z4&&Math.abs(q-Me)<=Z4||(le=Be,Me=q,Ve===V||Ve===W||Ve===S))continue;let me=0;for(let ge=0,Ye=this._hashKey(Be,q);ge<this._hashSize&&(me=d[(Ye+ge)%this._hashSize],!(me!==-1&&me!==a[me]));ge++);me=i[me];let Ee=me,Ne;for(;Ne=a[Ee],yo(Be,q,t[2*Ee],t[2*Ee+1],t[2*Ne],t[2*Ne+1])>=0;)if(Ee=Ne,Ee===me){Ee=-1;break}if(Ee===-1)continue;let $e=this._addTriangle(Ee,Ve,a[Ee],-1,-1,h[Ee]);h[Ve]=this._legalize($e+2),h[Ee]=$e,Pe++;let ye=a[Ee];for(;Ne=a[ye],yo(Be,q,t[2*ye],t[2*ye+1],t[2*Ne],t[2*Ne+1])<0;)$e=this._addTriangle(ye,Ve,Ne,h[Ve],-1,h[ye]),h[Ve]=this._legalize($e+2),a[ye]=ye,Pe--,ye=Ne;if(Ee===me)for(;Ne=i[Ee],yo(Be,q,t[2*Ne],t[2*Ne+1],t[2*Ee],t[2*Ee+1])<0;)$e=this._addTriangle(Ne,Ve,Ee,-1,h[Ee],h[Ne]),this._legalize($e+2),h[Ne]=$e,a[Ee]=Ee,Pe--,Ee=Ne;this._hullStart=i[Ve]=Ee,a[Ee]=i[ye]=Ve,a[Ve]=ye,d[this._hashKey(Be,q)]=Ve,d[this._hashKey(t[2*Ee],t[2*Ee+1])]=Ee}this.hull=new Uint32Array(Pe);for(let $=0,le=this._hullStart;$<Pe;$++)this.hull[$]=le,le=a[le];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,i){return Math.floor(Gj(t-this._cx,i-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:i,_halfedges:a,coords:h}=this;let d=0,p=0;for(;;){const s=a[t],w=t-t%3;if(p=w+(t+2)%3,s===-1){if(d===0)break;t=Tm[--d];continue}const A=s-s%3,z=w+(t+1)%3,B=A+(s+2)%3,D=i[p],V=i[t],W=i[z],S=i[B];if(Vj(h[2*D],h[2*D+1],h[2*V],h[2*V+1],h[2*W],h[2*W+1],h[2*S],h[2*S+1])){i[t]=S,i[s]=D;const ne=a[B];if(ne===-1){let Q=this._hullStart;do{if(this._hullTri[Q]===B){this._hullTri[Q]=t;break}Q=this._hullPrev[Q]}while(Q!==this._hullStart)}this._link(t,ne),this._link(s,a[p]),this._link(p,B);const te=A+(s+1)%3;d<Tm.length&&(Tm[d++]=te)}else{if(d===0)break;t=Tm[--d]}}return p}_link(t,i){this._halfedges[t]=i,i!==-1&&(this._halfedges[i]=t)}_addTriangle(t,i,a,h,d,p){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=i,this._triangles[s+2]=a,this._link(s,h),this._link(s+1,d),this._link(s+2,p),this.trianglesLen+=3,s}}function Gj(e,t){const i=e/(Math.abs(e)+Math.abs(t));return(t>0?3-i:1+i)/4}function iv(e,t,i,a){const h=e-i,d=t-a;return h*h+d*d}function Vj(e,t,i,a,h,d,p,s){const w=e-p,A=t-s,z=i-p,B=a-s,D=h-p,V=d-s,W=w*w+A*A,S=z*z+B*B,j=D*D+V*V;return w*(B*j-S*V)-A*(z*j-S*D)+W*(z*V-B*D)<0}function jj(e,t,i,a,h,d){const p=i-e,s=a-t,w=h-e,A=d-t,z=p*p+s*s,B=w*w+A*A,D=.5/(p*A-s*w),V=(A*z-s*B)*D,W=(p*B-w*z)*D;return V*V+W*W}function Zj(e,t,i,a,h,d){const p=i-e,s=a-t,w=h-e,A=d-t,z=p*p+s*s,B=w*w+A*A,D=.5/(p*A-s*w),V=e+(A*z-s*B)*D,W=t+(p*B-w*z)*D;return{x:V,y:W}}function Fu(e,t,i,a){if(a-i<=20)for(let h=i+1;h<=a;h++){const d=e[h],p=t[d];let s=h-1;for(;s>=i&&t[e[s]]>p;)e[s+1]=e[s--];e[s+1]=d}else{const h=i+a>>1;let d=i+1,p=a;Cf(e,h,d),t[e[i]]>t[e[a]]&&Cf(e,i,a),t[e[d]]>t[e[a]]&&Cf(e,d,a),t[e[i]]>t[e[d]]&&Cf(e,i,d);const s=e[d],w=t[s];for(;;){do d++;while(t[e[d]]<w);do p--;while(t[e[p]]>w);if(p<d)break;Cf(e,d,p)}e[i+1]=e[p],e[p]=s,a-d+1>=p-i?(Fu(e,t,d,a),Fu(e,t,i,p-1)):(Fu(e,t,i,p-1),Fu(e,t,d,a))}}function Cf(e,t,i){const a=e[t];e[t]=e[i],e[i]=a}function Oj(e){return e[0]}function Nj(e){return e[1]}class Uj{constructor(t,i){this.W=t,this.bs=i}add(t){const i=this.W,a=t/i|0,h=t%i;return this.bs[a]|=1<<h,this}delete(t){const i=this.W,a=t/i|0,h=t%i;return this.bs[a]&=~(1<<h),this}set(t,i){const a=this.W,h=t/a|0,d=t%a,p=1<<d;return this.bs[h]^=(-i^this.bs[h])&p,i}has(t){const i=this.W,a=t/i|0,h=t%i;return!!(this.bs[a]&1<<h)}forEach(t){const i=this.W,a=this.bs,h=a.length;for(let d=0;d<h;d++){let p=0;for(;a[d]&&p<i;)a[d]&1<<p&&t(d*i+p),p++}return this}}class O4 extends Uj{constructor(t){const a=new Uint8Array(Math.ceil(t/8)).fill(0);super(8,a)}}function Xc(e){return e%3===2?e-2:e+1}function ol(e){return e%3===0?e+2:e-1}class V5{constructor(t,i){if(!t||typeof t!="object"||!t.triangles||!t.halfedges||!t.coords)throw new Error("Expected an object with Delaunator output");if(t.triangles.length%3||t.halfedges.length!==t.triangles.length||t.coords.length%2)throw new Error("Delaunator output appears inconsistent");if(t.triangles.length<3)throw new Error("No edges in triangulation");this.del=t;const a=2**32-1,h=t.coords.length>>1,d=t.triangles.length;this.vertMap=new Uint32Array(h).fill(a),this.flips=new O4(d),this.consd=new O4(d);for(let p=0;p<d;p++){const s=t.triangles[p];this.vertMap[s]===a&&this.updateVert(p)}i&&this.constrainAll(i)}constrainOne(t,i){const{triangles:a,halfedges:h}=this.del,d=this.vertMap,p=this.consd,s=d[t];let w=s;do{const V=a[w],W=Xc(w);if(V===i)return this.protect(w);const S=ol(w),j=a[S];if(j===i)return this.protect(W),W;if(this.intersectSegments(t,i,j,V)){w=S;break}w=h[W]}while(w!==-1&&w!==s);let A=w,z=-1;for(;w!==-1;){const V=h[w],W=ol(w),S=ol(V),j=Xc(V);if(V===-1)throw new Error("Constraining edge exited the hull");if(p.has(w))throw new Error("Edge intersects already constrained edge");if(this.isCollinear(t,i,a[w])||this.isCollinear(t,i,a[V]))throw new Error("Constraining edge intersects point");if(!this.intersectSegments(a[w],a[V],a[W],a[S])){if(z===-1&&(z=w),a[S]===i){if(w===z)throw new Error("Infinite loop: non-convex quadrilateral");w=z,z=-1;continue}if(this.intersectSegments(t,i,a[S],a[V]))w=S;else if(this.intersectSegments(t,i,a[j],a[S]))w=j;else if(z===w)throw new Error("Infinite loop: no further intersect after non-convex");continue}if(this.flipDiagonal(w),this.intersectSegments(t,i,a[W],a[S])&&(z===-1&&(z=W),z===W))throw new Error("Infinite loop: flipped diagonal still intersects");a[S]===i?(A=S,w=z,z=-1):this.intersectSegments(t,i,a[j],a[S])&&(w=j)}const B=this.flips;this.protect(A);do{var D=0;B.forEach(V=>{B.delete(V);const W=h[V];W!==-1&&(B.delete(W),this.isDelaunay(V)||(this.flipDiagonal(V),D++))})}while(D>0);return this.findEdge(t,i)}delaunify(t=!1){const i=this.del.halfedges,a=this.flips,h=this.consd,d=i.length;do{var p=0;for(let s=0;s<d;s++){if(h.has(s))continue;a.delete(s);const w=i[s];w!==-1&&(a.delete(w),this.isDelaunay(s)||(this.flipDiagonal(s),p++))}}while(t&&p>0);return this}constrainAll(t){const i=t.length;for(let a=0;a<i;a++){const h=t[a];this.constrainOne(h[0],h[1])}return this}isConstrained(t){return this.consd.has(t)}findEdge(t,i){const a=this.vertMap[i],{triangles:h,halfedges:d}=this.del;let p=a,s=-1;do{if(h[p]===t)return p;s=Xc(p),p=d[s]}while(p!==-1&&p!==a);return h[Xc(s)]===t?-s:1/0}protect(t){const i=this.del.halfedges[t],a=this.flips,h=this.consd;return a.delete(t),h.add(t),i!==-1?(a.delete(i),h.add(i),i):-t}markFlip(t){const i=this.del.halfedges,a=this.flips;if(this.consd.has(t))return!1;const d=i[t];return d!==-1&&(a.add(t),a.add(d)),!0}flipDiagonal(t){const{triangles:i,halfedges:a}=this.del,h=this.flips,d=this.consd,p=a[t],s=ol(t),w=Xc(t),A=ol(p),z=Xc(p),B=a[s],D=a[A];if(d.has(t))throw new Error("Trying to flip a constrained edge");return i[t]=i[A],a[t]=D,h.set(t,h.has(A))||d.set(t,d.has(A)),D!==-1&&(a[D]=t),a[s]=A,i[p]=i[s],a[p]=B,h.set(p,h.has(s))||d.set(p,d.has(s)),B!==-1&&(a[B]=p),a[A]=s,this.markFlip(t),this.markFlip(w),this.markFlip(p),this.markFlip(z),h.add(s),d.delete(s),h.add(A),d.delete(A),this.updateVert(t),this.updateVert(w),this.updateVert(p),this.updateVert(z),s}isDelaunay(t){const{triangles:i,halfedges:a}=this.del,h=a[t];if(h===-1)return!0;const d=i[ol(t)],p=i[t],s=i[Xc(t)],w=i[ol(h)];return!this.inCircle(d,p,s,w)}updateVert(t){const{triangles:i,halfedges:a}=this.del,h=this.vertMap,d=i[t];let p=ol(t),s=a[p];for(;s!==-1&&s!==t;)p=ol(s),s=a[p];return h[d]=p,p}intersectSegments(t,i,a,h){const d=this.del.coords;return t===a||t===h||i===a||i===h?!1:j5(d[t*2],d[t*2+1],d[i*2],d[i*2+1],d[a*2],d[a*2+1],d[h*2],d[h*2+1])}inCircle(t,i,a,h){const d=this.del.coords;return OT(d[t*2],d[t*2+1],d[i*2],d[i*2+1],d[a*2],d[a*2+1],d[h*2],d[h*2+1])<0}isCollinear(t,i,a){const h=this.del.coords;return yo(h[t*2],h[t*2+1],h[i*2],h[i*2+1],h[a*2],h[a*2+1])===0}}V5.intersectSegments=j5;function j5(e,t,i,a,h,d,p,s){const w=yo(e,t,h,d,p,s),A=yo(i,a,h,d,p,s);if(w>0&&A>0||w<0&&A<0)return!1;const z=yo(h,d,e,t,i,a),B=yo(p,s,e,t,i,a);return z>0&&B>0||z<0&&B<0?!1:w===0&&A===0&&z===0&&B===0?!(Math.max(h,p)<Math.min(e,i)||Math.max(e,i)<Math.min(h,p)||Math.max(d,s)<Math.min(t,a)||Math.max(t,a)<Math.min(d,s)):!0}const Hj=1e-4,Wj={steinerPoints:[],minimumTriangleAngle:Hj};function Xj(e,t,i){const a=zi(Wj,i),h=a.steinerPoints,d=a.minimumTriangleAngle;e=Ry(e);let p=[],s=[],w=[],A=[];t?(p=G5(e,t),s=p.flat(),w=Bj(Gn(e),t),A=w.filter(oe=>rv(oe,e))):(p=e,s=e.flat());const z=h.filter(oe=>rv(oe,e)),B=[...s,...A,...z],D=new vb(B.flat());let V=0;const W=p.map(oe=>{const ve=oe.map((Pe,$)=>V+$);return V+=oe.length,ve}),S=W.map(oe=>oe.map(ve=>[ve,(ve+1)%oe.length])).flat(),j=new V5(D);j.delaunify(!0),j.constrainAll(S);let ne=[],te=[];const Q=[];for(let oe=0;oe<j.del.triangles.length;oe+=3)ne.push([j.del.triangles[oe],j.del.triangles[oe+1],j.del.triangles[oe+2]]),te.push([B[j.del.triangles[oe]],B[j.del.triangles[oe+1]],B[j.del.triangles[oe+2]]]),Q.push(j.del.triangles[oe]<s.length||j.del.triangles[oe+1]<s.length||j.del.triangles[oe+2]<s.length);const N=te.map((oe,ve)=>Q[ve]?rv(og(...oe),e)&&z9(oe).every(Pe=>Pe>=d):!0);ne=ne.filter((oe,ve)=>N[ve]),te=te.filter((oe,ve)=>N[ve]);const re=[];for(let oe=0;oe<S.length;oe+=1)re.push([B[S[oe][0]],B[S[oe][1]]]);return{interpolatedPolygon:p,interpolatedPolygonPoints:s,gridPoints:w,gridPointsInPolygon:A,uniquePoints:B,triangles:te,uniquePointIndexTriangles:ne,uniquePointIndexInterpolatedPolygon:W,uniquePointIndexEdges:S}}function uo(e,t){const i=t[0],a=t[1];return[e[0]*i+e[2]*a+e[4],e[1]*i+e[3]*a+e[5]]}function qj(){return[1,0,0,1,0,0]}function nv(e,t){const i=e[0],a=e[1],h=e[2],d=e[3],p=e[4],s=e[5],w=t[0],A=t[1],z=t[2],B=t[3],D=t[4],V=t[5];return[i*w+h*A,a*w+d*A,i*z+h*B,a*z+d*B,i*D+h*V+p,a*D+d*V+s]}function Cm(e,t,i,a,h,d,p){const s=Math.sin(h),w=Math.cos(h);return[i*w,a*s,-i*s,a*w,d*i*w-p*i*s+e,d*a*s+p*a*w+t]}function yb(e){const t=Yj(e),i=e[0],a=e[1],h=e[2],d=e[3],p=e[4],s=e[5];return[d/t,-a/t,-h/t,i/t,(h*s-d*p)/t,-(i*s-a*p)/t]}function Yj(e){return e[0]*e[3]-e[1]*e[2]}function Sf(e){const t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}const Z5={gcps:[],resourceMask:[],transformationType:"polynomial",internalProjection:Ta,projection:Ta,visible:!0,applyMask:!0,distortionMeasure:void 0},Kj={minOffsetRatio:.01,maxDepth:5,differentHandedness:!0},sv={...Z5,...Kj};class bb extends EventTarget{constructor(i,a,h={},d={}){var p;super();Ke(this,"mapId");Ke(this,"georeferencedMap");Ke(this,"defaultOptions");Ke(this,"georeferencedMapOptions");Ke(this,"listOptions");Ke(this,"mapOptions");Ke(this,"options");Ke(this,"fetchingImageInfo");Ke(this,"image");Ke(this,"tileSize");Ke(this,"abortController");Ke(this,"mixed",!1);Ke(this,"gcps");Ke(this,"projectedGcps");Ke(this,"resourcePoints");Ke(this,"geoPoints");Ke(this,"projectedGeoPoints");Ke(this,"projectedGeoPreviousTransformedResourcePoints");Ke(this,"projectedGeoTransformedResourcePoints");Ke(this,"resourceFullMask");Ke(this,"resourceFullMaskBbox");Ke(this,"resourceFullMaskRectangle");Ke(this,"resourceAppliableMask");Ke(this,"resourceAppliableMaskBbox");Ke(this,"resourceAppliableMaskRectangle");Ke(this,"resourceMask");Ke(this,"resourceMaskBbox");Ke(this,"resourceMaskRectangle");Ke(this,"previousTransformationType");Ke(this,"transformationType");Ke(this,"previousInternalProjection");Ke(this,"internalProjection");Ke(this,"projection");Ke(this,"projectedPreviousTransformer");Ke(this,"projectedTransformer");Ke(this,"projectedTransformerCache");Ke(this,"projectedTransformerDoubleCache");Ke(this,"geoFullMask");Ke(this,"geoFullMaskBbox");Ke(this,"geoFullMaskRectangle");Ke(this,"geoAppliableMask");Ke(this,"geoAppliableMaskBbox");Ke(this,"geoAppliableMaskRectangle");Ke(this,"geoMask");Ke(this,"geoMaskBbox");Ke(this,"geoMaskRectangle");Ke(this,"projectedGeoFullMask");Ke(this,"projectedGeoFullMaskBbox");Ke(this,"projectedGeoFullMaskRectangle");Ke(this,"projectedGeoAppliableMask");Ke(this,"projectedGeoAppliableMaskBbox");Ke(this,"projectedGeoAppliableMaskRectangle");Ke(this,"projectedGeoMask");Ke(this,"projectedGeoMaskBbox");Ke(this,"projectedGeoMaskRectangle");Ke(this,"resourceToProjectedGeoScale");Ke(this,"previousDistortionMeasure");Ke(this,"distortionMeasure");Ke(this,"tileZoomLevelForViewport");Ke(this,"overviewTileZoomLevelForViewport");Ke(this,"projectedGeoBufferedViewportRectangleForViewport");Ke(this,"projectedGeoBufferedViewportRectangleBboxForViewport");Ke(this,"resourceBufferedViewportRingForViewport");Ke(this,"resourceBufferedViewportRingBboxForViewport");Ke(this,"resourceBufferedViewportRingBboxAndResourceMaskBboxIntersectionForViewport");Ke(this,"fetchableTilesForViewport",[]);Ke(this,"overviewFetchableTilesForViewport",[]);this.mapId=i,this.georeferencedMap=a,this.projectedTransformerCache=new Map,this.projectedTransformerDoubleCache=new Map,this.fetchingImageInfo=!1,this.mapOptions=d,this.listOptions=h,this.georeferencedMapOptions={transformationType:(p=a.transformation)==null?void 0:p.type,internalProjection:a.resourceCrs,gcps:a.gcps,resourceMask:a.resourceMask},this.setDefaultOptions(),this.applyOptions({init:!0})}static getDefaultOptions(){return Z5}getDefaultAndGeoreferencedMapOptions(){return Nm(this.defaultOptions,this.georeferencedMapOptions)}getResourceToViewportScale(i){return C2(this.resourceMaskRectangle,this.projectedGeoMaskRectangle.map(a=>uo(i.projectedGeoToViewportHomogeneousTransform,a)))}getResourceToCanvasScale(i){return this.getResourceToViewportScale(i)/i.devicePixelRatio}getReferenceScale(){return this.getProjectedTransformer("helmert").getToGeoTransformation().getMeasures().scale}getProjectedTransformer(i,a){const h=Nm(sv,{projection:this.projection,internalProjection:this.internalProjection},a);return $6(this.projectedTransformerDoubleCache,i,this.projection.definition,()=>{const d=hk(this.projectedTransformerCache,i,()=>new bg(this.gcps,i,bk(h,["projection"])));return bg.setProjection(jm(d),h.projection)})}setMapOptions(i,a,h){const d=[];return i!==void 0&&Object.keys(i).length>0&&(this.mapOptions=zi(this.mapOptions,i),d.push(...Object.keys(i))),a!==void 0&&Object.keys(a).length>0&&(this.listOptions=zi(this.listOptions,a),d.push(...Object.keys(a))),this.applyOptions(ls(h,{optionKeysPossiblyChanged:d}))}setListOptions(i,a){return this.setMapOptions(void 0,i,a)}setDefaultOptions(){this.defaultOptions=bb.getDefaultOptions()}applyOptions(i){var p;const a=Nm(this.defaultOptions,this.georeferencedMapOptions,this.listOptions,this.mapOptions),h=(p=i==null?void 0:i.optionKeysPossiblyChanged)==null?void 0:p.filter(s=>i.optionKeysToOmit?!i.optionKeysToOmit.includes(s):!0),d=yk(a,this.options,h);if(this.options=Ik(this.options,d),i!=null&&i.init)this.gcps=this.options.gcps,this.resourceFullMask=this.getResourceFullMask(),this.resourceAppliableMask=this.georeferencedMap.resourceMask,this.resourceMask=this.options.applyMask?this.resourceAppliableMask:this.resourceFullMask,this.updateResourceMaskProperties(),this.transformationType=this.options.transformationType,this.previousTransformationType=this.transformationType,this.internalProjection=this.options.internalProjection,this.previousInternalProjection=this.internalProjection,this.projection=this.options.projection,this.updateProjectedTransformerProperties();else{if("gcps"in d&&this.setGcps(this.options.gcps),"resourceMask"in d||"applyMask"in d){const s=this.getResourceFullMask(),w=this.options.resourceMask,A=this.options.applyMask?w:s;this.setResourceMask(s,w,A)}"transformationType"in d&&this.setTransformationType(this.options.transformationType),"internalProjection"in d&&this.setInternalProjection(this.options.internalProjection),"projection"in d&&this.setProjection(this.options.projection),"distortionMeasure"in d&&this.setDistortionMeasure(this.options.distortionMeasure)}return d}shouldRenderMap(){return this.options.visible!==!1}shouldRenderLines(){return this.options.visible!==!1}shouldRenderPoints(){return this.options.visible!==!1}setGcps(i){this.gcps=i,this.clearProjectedTransformerCaches(),this.updateProjectedTransformerProperties()}setResourceMask(i,a,h){this.resourceFullMask=i,this.resourceAppliableMask=a,this.resourceMask=h,this.updateResourceMaskProperties(),this.updateGeoMaskProperties(),this.updateProjectedGeoMaskProperties()}setTransformationType(i){this.transformationType=i,this.previousTransformationType||(this.previousTransformationType=this.transformationType),this.updateProjectedTransformerProperties()}setDistortionMeasure(i){this.distortionMeasure=i}setInternalProjection(i){this.internalProjection=i||sv.internalProjection||Ta,this.previousInternalProjection||(this.previousInternalProjection=this.internalProjection),this.clearProjectedTransformerCaches(),this.updateProjectedTransformerProperties()}setProjection(i){this.projection=i||sv.projection||Ta,this.updateProjectedTransformerProperties()}setTileZoomLevelForViewport(i){this.tileZoomLevelForViewport=i}setOverviewTileZoomLevelForViewport(i){this.overviewTileZoomLevelForViewport=i}setProjectedGeoBufferedViewportRectangleForViewport(i){this.projectedGeoBufferedViewportRectangleForViewport=i,this.projectedGeoBufferedViewportRectangleBboxForViewport=i?Gn(i):void 0}setResourceBufferedViewportRingForViewport(i){this.resourceBufferedViewportRingForViewport=i,this.resourceBufferedViewportRingBboxForViewport=i?Gn(i):void 0}setResourceBufferedViewportRingBboxAndResourceMaskBboxIntersectionForViewport(i){this.resourceBufferedViewportRingBboxAndResourceMaskBboxIntersectionForViewport=i}setFetchableTilesForViewport(i){this.fetchableTilesForViewport=i}setOverviewFetchableTilesForViewport(i){this.overviewFetchableTilesForViewport=i}resetForViewport(){this.setTileZoomLevelForViewport(),this.setOverviewTileZoomLevelForViewport(),this.setProjectedGeoBufferedViewportRectangleForViewport(),this.setResourceBufferedViewportRingForViewport(),this.setFetchableTilesForViewport([]),this.setOverviewFetchableTilesForViewport([])}resetPrevious(){this.mixed=!1,this.previousTransformationType=this.transformationType,this.previousDistortionMeasure=this.distortionMeasure,this.previousInternalProjection=this.internalProjection,this.projectedPreviousTransformer=jm(this.projectedTransformer),this.projectedGeoPreviousTransformedResourcePoints=this.projectedGeoTransformedResourcePoints}mixPreviousAndNew(i){this.mixed=!0,this.previousTransformationType=this.transformationType,this.previousDistortionMeasure=this.distortionMeasure,this.previousInternalProjection=this.internalProjection,this.projectedPreviousTransformer=jm(this.projectedTransformer),this.projectedGeoPreviousTransformedResourcePoints=Fv(this.projectedGeoTransformedResourcePoints,this.projectedGeoPreviousTransformedResourcePoints,i)}hasImage(){return this.image!==void 0}async loadImage(i){try{const a=this.georeferencedMap.resource.id;if(i&&i.has(a))this.image=i.get(a);else{this.fetchingImageInfo=!0,this.abortController=new AbortController;const h=this.abortController.signal,d=await p9(a,{signal:h},this.options.fetchFn);this.abortController=void 0,this.image=I5.parse(d),i&&i.set(a,this.image)}this.tileSize=[Math.max(...this.image.tileZoomLevels.map(h=>h.width)),Math.max(...this.image.tileZoomLevels.map(h=>h.height))],this.dispatchEvent(new ai(nr.IMAGELOADED))}catch(a){throw this.fetchingImageInfo=!1,a}finally{this.fetchingImageInfo=!1}}updateResourceMaskProperties(){this.resourceFullMaskBbox=Gn(this.resourceFullMask),this.resourceFullMaskRectangle=wo(this.resourceFullMaskBbox),this.resourceAppliableMaskBbox=Gn(this.resourceAppliableMask),this.resourceAppliableMaskRectangle=wo(this.resourceAppliableMaskBbox),this.resourceMaskBbox=Gn(this.resourceMask),this.resourceMaskRectangle=wo(this.resourceMaskBbox)}getResourceFullMask(){const i=this.georeferencedMap.resource.width,a=this.georeferencedMap.resource.height;return i&&a?K6([i,a]):wo(this.resourceMaskBbox)}updateGeoMaskProperties(){this.updateFullGeoMask(),this.updateAppliableGeoMask(),this.updateGeoMask()}updateProjectedGeoMaskProperties(){this.updateProjectedFullGeoMask(),this.updateProjectedAppliableGeoMask(),this.updateProjectedGeoMask(),this.updateResourceToProjectedGeoScale()}updateProjectedTransformerProperties(){this.updateProjectedTransformer(),this.updateGeoMaskProperties(),this.updateProjectedGeoMaskProperties(),this.updateGcpsProperties()}updateProjectedTransformer(){this.projectedTransformer=this.getProjectedTransformer(this.transformationType),this.projectedPreviousTransformer||(this.projectedPreviousTransformer=this.projectedTransformer)}updateFullGeoMask(){this.geoFullMask=this.projectedTransformer.transformToGeo([this.resourceFullMask],{projection:Ia})[0],this.geoFullMaskBbox=Gn(this.geoFullMask),this.geoFullMaskRectangle=this.projectedTransformer.transformToGeo([this.resourceFullMaskRectangle],{maxDepth:0,projection:Ia})[0]}updateAppliableGeoMask(){this.geoAppliableMask=this.projectedTransformer.transformToGeo([this.resourceAppliableMask],{projection:Ia})[0],this.geoAppliableMaskBbox=Gn(this.geoAppliableMask),this.geoAppliableMaskRectangle=this.projectedTransformer.transformToGeo([this.resourceAppliableMaskRectangle],{maxDepth:0,projection:Ia})[0]}updateGeoMask(){this.geoMask=this.projectedTransformer.transformToGeo([this.resourceMask],{projection:Ia})[0],this.geoMaskBbox=Gn(this.geoMask),this.geoMaskRectangle=this.projectedTransformer.transformToGeo([this.resourceMaskRectangle],{maxDepth:0,projection:Ia})[0]}updateProjectedFullGeoMask(){this.projectedGeoFullMask=this.projectedTransformer.transformToGeo([this.resourceFullMask])[0],this.projectedGeoFullMaskBbox=Gn(this.projectedGeoFullMask),this.projectedGeoFullMaskRectangle=this.projectedTransformer.transformToGeo([this.resourceFullMaskRectangle],{maxDepth:0})[0]}updateProjectedAppliableGeoMask(){this.projectedGeoAppliableMask=this.projectedTransformer.transformToGeo([this.resourceAppliableMask])[0],this.projectedGeoAppliableMaskBbox=Gn(this.projectedGeoAppliableMask),this.projectedGeoAppliableMaskRectangle=this.projectedTransformer.transformToGeo([this.resourceAppliableMaskRectangle],{maxDepth:0})[0]}updateProjectedGeoMask(){this.projectedGeoMask=this.projectedTransformer.transformToGeo([this.resourceMask])[0],this.projectedGeoMaskBbox=Gn(this.projectedGeoMask),this.projectedGeoMaskRectangle=this.projectedTransformer.transformToGeo([this.resourceMaskRectangle],{maxDepth:0})[0]}updateResourceToProjectedGeoScale(){this.resourceToProjectedGeoScale=C2(this.resourceMaskRectangle,this.projectedGeoMaskRectangle)}updateGcpsProperties(){this.projectedGcps=this.gcps.map(({resource:i,geo:a})=>({resource:i,geo:this.projectedTransformer.lonLatToProjection(a)})),this.resourcePoints=this.gcps.map(i=>i.resource),this.geoPoints=this.gcps.map(i=>i.geo),this.projectedGeoPoints=this.projectedGcps.map(i=>i.geo),this.projectedGeoTransformedResourcePoints=this.gcps.map(i=>this.projectedTransformer.transformToGeo(i.resource)),this.projectedGeoPreviousTransformedResourcePoints||(this.projectedGeoPreviousTransformedResourcePoints=this.projectedGeoTransformedResourcePoints)}clearProjectedTransformerCaches(){this.projectedTransformerCache=new Map,this.projectedTransformerDoubleCache=new Map}destroy(){this.abortController&&this.abortController.abort()}}const $j={distortionMeasures:["log2sigma","twoOmega"]};class wb extends bb{constructor(i,a,h,d){super(i,a,h,d);Ke(this,"previousResourceResolution");Ke(this,"resourceResolution");Ke(this,"triangulateErrorCount",0);Ke(this,"projectedGcpPreviousTriangulation");Ke(this,"projectedGcpTriangulation");Ke(this,"resourceTriangulationCache");Ke(this,"projectedGcpTriangulationCache");Ke(this,"resourceTrianglePoints",[]);Ke(this,"projectedGeoPreviousTrianglePoints",[]);Ke(this,"projectedGeoTrianglePoints",[]);Ke(this,"previousTrianglePointsDistortion",[]);Ke(this,"trianglePointsDistortion",[]);Ke(this,"projectedGeoPreviousTriangulationAppliableMask",[]);Ke(this,"projectedGeoTriangulationAppliableMask",[]);Ke(this,"projectedGeoPreviousTriangulationMask",[]);Ke(this,"projectedGeoTriangulationMask",[]);this.resourceTriangulationCache=new Map,this.projectedGcpTriangulationCache=new Map,this.updateTriangulation()}static getDefaultOptions(){return zi($j,super.getDefaultOptions())}setDefaultOptions(){this.defaultOptions=wb.getDefaultOptions()}setGcps(i){super.setGcps(i),this.clearResourceTriangulationCaches(),this.updateTriangulation()}setResourceMask(i,a,h){super.setResourceMask(i,a,h),this.updateTriangulation()}setDistortionMeasure(i){super.setDistortionMeasure(i),this.updateTrianglePointsDistortion()}setInternalProjection(i){super.setInternalProjection(i),this.updateTriangulation()}setProjection(i){super.setProjection(i),this.clearProjectedTriangulationCaches(),this.updateTriangulation()}resetPrevious(){super.resetPrevious(),this.previousResourceResolution=this.resourceResolution,this.projectedGcpPreviousTriangulation=this.projectedGcpTriangulation,this.projectedGeoPreviousTrianglePoints=this.projectedGeoTrianglePoints,this.previousTrianglePointsDistortion=this.trianglePointsDistortion,this.projectedGeoPreviousTriangulationAppliableMask=this.projectedGeoTriangulationAppliableMask,this.projectedGeoPreviousTriangulationMask=this.projectedGeoTriangulationMask}mixPreviousAndNew(i){if(super.mixPreviousAndNew(i),this.projectedGcpPreviousTriangulation&&this.projectedGcpTriangulation){const a=this.projectedGcpPreviousTriangulation,h=this.projectedGcpTriangulation;this.previousResourceResolution=this.resourceResolution,this.projectedGcpPreviousTriangulation={resourceResolution:a.resourceResolution,gcpUniquePoints:a.gcpUniquePoints.map((d,p)=>({resource:d.resource,geo:H6(h.gcpUniquePoints[p].geo,d.geo,i),distortions:h.gcpUniquePoints[p].distortions,distortion:zv(h.gcpUniquePoints[p].distortion||0,d.distortion||0,i)})),uniquePointIndices:a.uniquePointIndices,uniquePointIndexInterpolatedPolygon:a.uniquePointIndexInterpolatedPolygon},this.projectedGeoPreviousTrianglePoints=a.uniquePointIndices.map(d=>a.gcpUniquePoints[d].geo),this.previousTrianglePointsDistortion=a.uniquePointIndices.map(d=>a.gcpUniquePoints[d].distortion)}this.projectedGeoPreviousTriangulationAppliableMask=Fv(this.projectedGeoTriangulationAppliableMask,this.projectedGeoPreviousTriangulationAppliableMask,i),this.projectedGeoPreviousTriangulationMask=Fv(this.projectedGeoTriangulationMask,this.projectedGeoPreviousTriangulationMask,i)}updateTriangulation(){if(!this.resourceTriangulationCache||!this.projectedGcpTriangulationCache)return;const i=this.options.resourceResolution||this.projectedTransformer.getToGeoTransformationResolution(this.resourceMaskBbox);let a=!1;i&&this.previousResourceResolution&&(a=this.previousResourceResolution<i,this.resourceResolution=Math.min(i,this.previousResourceResolution)),i&&!this.previousResourceResolution&&(a=!0,this.resourceResolution=i),!i&&this.previousResourceResolution?this.resourceResolution=this.previousResourceResolution:!i&&!this.previousResourceResolution&&(this.resourceResolution=void 0),this.projectedGcpTriangulation=S2(this.projectedGcpTriangulationCache,this.resourceResolution,String(this.resourceMask),this.transformationType,this.internalProjection.definition,()=>{const{uniquePoints:h,uniquePointIndexTriangles:d,uniquePointIndexInterpolatedPolygon:p}=$6(this.resourceTriangulationCache,this.resourceResolution,String(this.resourceMask),()=>Xj([this.resourceMask],this.resourceResolution,{steinerPoints:this.gcps.map(B=>B.resource)})),s=this.resourceResolution,A=h.map(B=>this.projectedTransformer.transformToGeo(B,{distortionMeasures:this.options.distortionMeasures,referenceScale:this.getReferenceScale()},D=>D)),z=d.flat();return{resourceResolution:s,gcpUniquePoints:A,uniquePointIndices:z,uniquePointIndexInterpolatedPolygon:p}}),this.projectedGcpPreviousTriangulation||(this.projectedGcpPreviousTriangulation=this.projectedGcpTriangulation),a&&(this.previousResourceResolution=this.resourceResolution,this.projectedGcpPreviousTriangulation=S2(this.projectedGcpTriangulationCache,this.previousResourceResolution,String(this.resourceMask),this.previousTransformationType,this.previousInternalProjection.definition,()=>{if(!this.projectedGcpTriangulation)throw new Error("No projectedGcpTriangulation");const h=this.projectedGcpTriangulation;return{resourceResolution:this.projectedGcpTriangulation.resourceResolution,gcpUniquePoints:this.projectedGcpTriangulation.gcpUniquePoints.map(d=>this.projectedPreviousTransformer.transformToGeo(d.resource,{distortionMeasures:this.options.distortionMeasures,referenceScale:this.getReferenceScale()},p=>p)),uniquePointIndices:this.projectedGcpTriangulation.uniquePointIndices,uniquePointIndexInterpolatedPolygon:h.uniquePointIndexInterpolatedPolygon}},()=>!this.mixed,()=>!this.mixed)),this.updateTrianglePoints()}updateTrianglePoints(){if(!this.projectedGcpPreviousTriangulation||!this.projectedGcpTriangulation)return;const i=this.projectedGcpPreviousTriangulation,a=this.projectedGcpTriangulation;this.resourceTrianglePoints=this.projectedGcpTriangulation.uniquePointIndices.map(h=>a.gcpUniquePoints[h].resource),this.projectedGeoPreviousTrianglePoints=this.projectedGcpPreviousTriangulation.uniquePointIndices.map(h=>i.gcpUniquePoints[h].geo),this.projectedGeoTrianglePoints=this.projectedGcpTriangulation.uniquePointIndices.map(h=>a.gcpUniquePoints[h].geo),this.projectedGeoPreviousTriangulationMask=this.projectedGcpPreviousTriangulation.uniquePointIndexInterpolatedPolygon.map(h=>h.map(d=>i.gcpUniquePoints[d].geo)).flat(),this.projectedGeoTriangulationMask=this.projectedGcpTriangulation.uniquePointIndexInterpolatedPolygon.map(h=>h.map(d=>a.gcpUniquePoints[d].geo)).flat(),this.projectedGeoTriangulationAppliableMask=this.projectedTransformer.transformToGeo(G5([this.resourceAppliableMask],this.resourceResolution)[0],{isMultiGeometry:!0}),this.projectedGeoPreviousTriangulationAppliableMask.length==0&&(this.projectedGeoPreviousTriangulationAppliableMask=this.projectedGeoTriangulationAppliableMask),this.updateTrianglePointsDistortion()}updateTrianglePointsDistortion(){if(!this.projectedGcpPreviousTriangulation||!this.projectedGcpTriangulation)return;const i=this.projectedGcpPreviousTriangulation,a=this.projectedGcpTriangulation;this.previousTrianglePointsDistortion=i.uniquePointIndices.map(h=>{const d=i.gcpUniquePoints[h].distortions;return!this.previousDistortionMeasure||!d?0:d.get(this.previousDistortionMeasure)}),this.trianglePointsDistortion=a.uniquePointIndices.map(h=>{const d=a.gcpUniquePoints[h].distortions;return!this.distortionMeasure||!d?0:d.get(this.distortionMeasure)})}updateProjectedTransformerProperties(){super.updateProjectedTransformerProperties(),this.updateTriangulation()}clearProjectedTransformerCaches(){super.clearProjectedTransformerCaches(),this.clearResourceTriangulationCaches()}clearResourceTriangulationCaches(){this.resourceTriangulationCache=new Map,this.clearProjectedTriangulationCaches()}clearProjectedTriangulationCaches(){this.projectedGcpTriangulationCache=new Map}}function ba(e,t,i){const a=e.createShader(t);if(a){if(e.shaderSource(a,i),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS))return a;{const d=e.getShaderInfoLog(a);throw e.deleteShader(a),new Error("Failed to compile shader: "+d)}}else throw new Error("Failed to create shader")}function yu(e,t,i){const a=e.createProgram();if(a){if(e.attachShader(a,t),e.attachShader(a,i),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS))return a;{const d=e.getProgramInfoLog(a);throw e.deleteProgram(a),new Error("Failed to link program: "+d)}}else throw new Error("Failed to create program")}function kn(e,t,i,a,h){const d=e.createBuffer();if(!d)throw new Error("Failed to create buffer");e.bindBuffer(e.ARRAY_BUFFER,d),e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);const p=e.FLOAT,s=!1,w=0,A=0,z=e.getAttribLocation(t,h);return e.vertexAttribPointer(z,a,p,s,w,A),e.enableVertexAttribArray(z),d}function Jj(e,t,i,a){let h=Number.POSITIVE_INFINITY,d=e.at(-1);for(const p of e){const s=Math.abs(Math.log2(p.scaleFactor)-(Math.log2(t+i)+a));s<h&&(h=s,d=p)}return d}function Qj(e,t,i){const a=eZ(e,t),h=tZ(a);return iZ(h,t,i)}function eZ(e,t){return e.map(i=>[i[0]/t.originalWidth,i[1]/t.originalHeight])}function tZ(e){const t={};for(let i=0;i<e.length;i++){const a=[e[i],e[(i+1)%e.length]];rZ(a).forEach(([d,p])=>{t[d]||(t[d]=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]),p<t[d][0]&&(t[d][0]=p),p>t[d][1]&&(t[d][1]=p)})}return t}function rZ([e,t]){let i=Math.floor(e[0]),a=Math.floor(e[1]);const h=Math.floor(t[0]),d=Math.floor(t[1]),p=[[i,a]];if(i===h&&a===d)return p;const s=Math.sign(t[0]-e[0]),w=Math.sign(t[1]-e[1]),A=Math.abs(e[0]-i-Math.max(0,s)),z=Math.abs(e[1]-a-Math.max(0,w)),B=Math.abs(e[0]-t[0]),D=Math.abs(e[1]-t[1]);let V=A/B,W=z/D;const S=1/B,j=1/D;for(;!(i===h&&a===d);)D===0?i=i+s:B===0?a=a+w:V<W?(V=V+S,i=i+s):(W=W+j,a=a+w),p.push([i,a]);return p}function iZ(e,t,i){const a=[];for(const h in e){const d=parseInt(h);if(d<0||d>=t.columns)break;const p=Math.max(e[d][0],0),s=Math.min(e[d][1],t.rows-1);for(let w=p;w<=s;w++)a.push({column:d,row:w,tileZoomLevel:t,imageSize:i})}return a}function O5(e,t,i,a){let h=Math.floor(e.column*e.tileZoomLevel.scaleFactor/i);h=h>=0?h:0;const d=Math.ceil((e.column+1)*e.tileZoomLevel.scaleFactor/i);let p=Math.floor(e.row*e.tileZoomLevel.scaleFactor/i);p=p>=0?p:0;const s=Math.ceil((e.row+1)*e.tileZoomLevel.scaleFactor/i);return N5(i,t,h,d,p,s,a)}function N5(e,t,i,a,h,d,p=s=>!0){const s=t.tileZoomLevels.find(z=>z.scaleFactor===e),w=[t.width,t.height];if(!s)return[];i=i||0,a=a||s.columns,h=h||0,d=d||s.rows;const A=[];for(let z=i;z<a;z++)for(let B=h;B<d;B++){const D={column:z,row:B,tileZoomLevel:s,imageSize:w};p(D)&&A.push(D)}return A}function N4(e,t){return ah(nZ(e),t)}function nZ(e){const t=U5(e);return[(t[2]-t[0])/2+t[0],(t[3]-t[1])/2+t[1]]}function sZ(e){return[e.column*e.tileZoomLevel.originalWidth,e.row*e.tileZoomLevel.originalHeight]}function U5(e){const t=sZ(e),i=Math.min(t[0]+e.tileZoomLevel.originalWidth,e.imageSize[0]),a=Math.min(t[1]+e.tileZoomLevel.originalHeight,e.imageSize[1]);return[t[0],t[1],i,a]}function aZ(e){return[e.tileZoomLevel.width,e.tileZoomLevel.height]}function U4(e){return Lf(aZ(e))}function oZ(e){return e.rows*e.width*e.columns*e.height}function lZ(e,t,i,a,h,d){const p=[],s=W5(e,t,i,a,d);for(const w of s)w&&p.push(w);if(p.length===0){const w=Math.max(...t.tileZoomLevels.map(z=>z.scaleFactor)),A=H5(e,t,i,h,w,d);A&&p.push(A)}return p}function H5(e,t,i,a,h,d){const p=2**(Math.log2(i)+1);if(p>h||a<=0)return;const s=cZ(e,t,p,d);return s!==void 0?s:H5(e,t,p,a--,h,d)}function W5(e,t,i,a,h){const d=2**(Math.log2(i)-1);if(d<=0||a<=0)return[];const p=H4(e,t,d,h),s=H4(e,t,d,w=>!0);return p.length===s.length?p:[...p,...W5(e,t,d,a--,h)]}function cZ(e,t,i,a){const h=O5(e,t,i,a);if(h.length!==0)return h[0]}function H4(e,t,i,a){return O5(e,t,i,a)}function hZ(e){return uZ(e.mapId,e.tileUrl)}function uZ(e,t){return`${e}:${t}`}function ny(e){return dZ(e.tileZoomLevel.scaleFactor,e.row,e.column)}function dZ(e,t,i){return`${e}:${t}:${i}`}const fZ=200,pZ={leading:!0,trailing:!0},Sm={viewportSize:6,color:Qf,viewportBorderSize:0,borderColor:C5},Pm={viewportSize:16,color:Qf,viewportBorderSize:1,borderColor:C5},mZ={renderGcps:!1,renderGcpsColor:Rj,renderTransformedGcps:!1,renderTransformedGcpsColor:Am,renderVectors:!1,renderVectorsSize:6,renderVectorsColor:Qf,renderFullMask:!1,renderFullMaskSize:8,renderFullMaskColor:j4,renderAppliableMask:!1,renderAppliableMaskSize:8,renderAppliableMaskColor:Am,renderMask:!1,renderMaskSize:8,renderMaskColor:Am,opacity:1,saturation:1,removeColor:!1,removeColorColor:Qf,removeColorThreshold:0,removeColorHardness:.7,colorize:!1,colorizeColor:Am,renderGrid:!1,renderGridColor:Qf,distortionColor00:V4,distortionColor01:Lj,distortionColor1:j4,distortionColor2:B5,distortionColor3:V4,debugTiles:!1,debugTriangles:!1,debugTriangulation:!1},gZ=5,_Z=1;function vZ(e,t,i,a){return(h,d,p,s)=>new l1(h,d,e,t,i,a,p,s)}class l1 extends wb{constructor(i,a,h,d,p,s,w,A){super(i,a,w,A);Ke(this,"gl");Ke(this,"mapProgram");Ke(this,"linesProgram");Ke(this,"pointsProgram");Ke(this,"mapVao",null);Ke(this,"linesVao",null);Ke(this,"pointsVao",null);Ke(this,"lineGroups",[]);Ke(this,"pointGroups",[]);Ke(this,"cachedTilesByTileKey");Ke(this,"cachedTilesByTileUrl");Ke(this,"cachedTilesForTexture",[]);Ke(this,"previousCachedTilesForTexture",[]);Ke(this,"cachedTilesTextureArray",null);Ke(this,"cachedTilesResourceOriginPointsAndSizesTexture",null);Ke(this,"cachedTilesScaleFactorsTexture",null);Ke(this,"invertedRenderHomogeneousTransform");Ke(this,"throttledUpdateTextures");this.cachedTilesByTileKey=new Map,this.cachedTilesByTileUrl=new Map,this.gl=h,this.initializeWebGL(d,p,s),this.invertedRenderHomogeneousTransform=qj(),this.throttledUpdateTextures=Ev(this.updateTextures.bind(this),fZ,pZ)}initializeWebGL(i,a,h){this.mapProgram=i,this.linesProgram=a,this.pointsProgram=h,this.mapVao=this.gl.createVertexArray(),this.linesVao=this.gl.createVertexArray(),this.pointsVao=this.gl.createVertexArray(),this.cachedTilesTextureArray=this.gl.createTexture(),this.cachedTilesScaleFactorsTexture=this.gl.createTexture(),this.cachedTilesResourceOriginPointsAndSizesTexture=this.gl.createTexture()}static getDefaultOptions(){return zi(mZ,super.getDefaultOptions())}setDefaultOptions(){this.defaultOptions=l1.getDefaultOptions()}applyOptions(i){var h,d,p,s;const a=super.applyOptions(i);return this.options.opacity=(((h=this.listOptions)==null?void 0:h.opacity)??this.defaultOptions.opacity)*(((d=this.mapOptions)==null?void 0:d.opacity)??1),this.options.saturation=(((p=this.listOptions)==null?void 0:p.saturation)??this.defaultOptions.saturation)*(((s=this.mapOptions)==null?void 0:s.saturation)??1),a}shouldRenderMap(){return super.shouldRenderMap()&&this.options.renderMaps!==!1&&this.options.opacity!==0}shouldRenderLines(){return super.shouldRenderLines()&&this.options.renderLines!==!1&&(this.options.renderFullMask||this.options.renderAppliableMask||this.options.renderMask||this.options.renderVectors)}shouldRenderPoints(){return super.shouldRenderPoints()&&this.options.renderPoints!==!1&&(this.options.renderGcps||this.options.renderTransformedGcps||this.options.debugTriangulation)}updateVertexBuffers(i){this.invertedRenderHomogeneousTransform=yb(i),this.shouldRenderMap()&&this.updateVertexBuffersMap(i),this.shouldRenderLines()&&this.updateVertexBuffersLines(i),this.shouldRenderPoints()&&this.updateVertexBuffersPoints(i)}clearTextures(){}addCachedTileAndUpdateTextures(i){this.cachedTilesByTileKey.has(i.fetchableTile.tileKey)||(this.cachedTilesByTileKey.set(i.fetchableTile.tileKey,i),this.cachedTilesByTileUrl.set(i.fetchableTile.tileUrl,i),this.throttledUpdateTextures())}removeCachedTileAndUpdateTextures(i){const a=this.cachedTilesByTileUrl.get(i);a&&(this.cachedTilesByTileKey.delete(a.fetchableTile.tileKey),this.cachedTilesByTileUrl.delete(i),this.throttledUpdateTextures())}cancelThrottledFunctions(){this.throttledUpdateTextures.cancel()}destroy(){this.gl.deleteVertexArray(this.mapVao),this.gl.deleteVertexArray(this.linesVao),this.gl.deleteVertexArray(this.pointsVao),this.gl.deleteTexture(this.cachedTilesTextureArray),this.gl.deleteTexture(this.cachedTilesScaleFactorsTexture),this.gl.deleteTexture(this.cachedTilesResourceOriginPointsAndSizesTexture),this.cancelThrottledFunctions(),super.destroy()}setLineGroups(){this.lineGroups=[],this.options.renderVectors&&this.lineGroups.push({projectedGeoLines:x2(this.projectedGeoPoints,this.projectedGeoTransformedResourcePoints),projectedGeoPreviousLines:x2(this.projectedGeoPoints,this.projectedGeoPreviousTransformedResourcePoints),viewportSize:this.options.renderVectorsSize,color:this.options.renderVectorsColor,viewportBorderSize:this.options.renderVectorsBorderSize,borderColor:this.options.renderVectorsBorderColor}),this.options.renderFullMask&&this.lineGroups.push({projectedGeoLines:wf(this.projectedGeoFullMask),viewportSize:this.options.renderFullMaskSize,color:this.options.renderFullMaskColor,viewportBorderSize:this.options.renderFullMaskBorderSize,borderColor:this.options.renderFullMaskBorderColor}),this.options.renderAppliableMask&&this.lineGroups.push({projectedGeoLines:wf(this.projectedGeoTriangulationAppliableMask),projectedGeoPreviousLines:wf(this.projectedGeoPreviousTriangulationAppliableMask),viewportSize:this.options.renderAppliableMaskSize,color:this.options.renderAppliableMaskColor,viewportBorderSize:this.options.renderAppliableMaskBorderSize,borderColor:this.options.renderAppliableMaskBorderColor}),this.options.renderMask&&this.lineGroups.push({projectedGeoLines:wf(this.projectedGeoTriangulationMask),projectedGeoPreviousLines:wf(this.projectedGeoPreviousTriangulationMask),viewportSize:this.options.renderMaskSize,color:this.options.renderMaskColor,viewportBorderSize:this.options.renderMaskBorderSize,borderColor:this.options.renderMaskBorderColor})}setPointGroups(){this.pointGroups=[],this.options.renderGcps&&this.pointGroups.push({projectedGeoPoints:this.projectedGeoPoints,viewportSize:this.options.renderGcpsSize,color:this.options.renderGcpsColor,viewportBorderSize:this.options.renderGcpsBorderSize,borderColor:this.options.renderGcpsBorderColor}),this.options.renderTransformedGcps&&this.pointGroups.push({projectedGeoPoints:this.projectedGeoTransformedResourcePoints,projectedGeoPreviousPoints:this.projectedGeoPreviousTransformedResourcePoints,viewportSize:this.options.renderTransformedGcpsSize,color:this.options.renderTransformedGcpsColor,viewportBorderSize:this.options.renderTransformedGcpsBorderSize,borderColor:this.options.renderTransformedGcpsBorderColor}),this.options.debugTriangulation&&(this.pointGroups.push({projectedGeoPoints:this.projectedGeoPreviousTrianglePoints,color:zj}),this.pointGroups.push({projectedGeoPoints:this.projectedGeoTrianglePoints,color:B5}))}updateVertexBuffersMap(i){if(!this.mapVao)return;const a=this.gl,h=this.mapProgram;a.bindVertexArray(this.mapVao),kn(a,h,new Float32Array(this.resourceTrianglePoints.flat()),2,"a_resourceTrianglePoint");const d=this.projectedGeoPreviousTrianglePoints.map(w=>uo(i,w));kn(a,h,new Float32Array(d.flat()),2,"a_clipPreviousTrianglePoint");const p=this.projectedGeoTrianglePoints.map(w=>uo(i,w));kn(a,h,new Float32Array(p.flat()),2,"a_clipTrianglePoint"),kn(a,h,new Float32Array(this.previousTrianglePointsDistortion),1,"a_previousTrianglePointDistortion"),kn(a,h,new Float32Array(this.trianglePointsDistortion),1,"a_trianglePointDistortion");const s=new Float32Array(this.resourceTrianglePoints.length).map((w,A)=>A);kn(a,h,s,1,"a_trianglePointIndex")}updateVertexBuffersLines(i){if(!this.linesVao)return;const a=this.gl,h=this.linesProgram;a.bindVertexArray(this.linesVao),this.setLineGroups();const d=this.lineGroups.reduce((S,j)=>S.concat(j.projectedGeoLines),[]).map(S=>[S[0],S[0],S[0],S[1],S[1],S[1]]).flat().map(S=>uo(i,S));kn(a,h,new Float32Array(d.flat()),2,"a_clipPoint");const p=this.lineGroups.reduce((S,j)=>S.concat(j.projectedGeoLines),[]).map(S=>[S[1],S[1],S[1],S[0],S[0],S[0]]).flat().map(S=>uo(i,S));kn(a,h,new Float32Array(p.flat()),2,"a_clipOtherPoint");const s=this.lineGroups.reduce((S,j)=>S.concat(j.projectedGeoPreviousLines||j.projectedGeoLines),[]).map(S=>[S[0],S[0],S[0],S[1],S[1],S[1]]).flat().map(S=>uo(i,S));kn(a,h,new Float32Array(s.flat()),2,"a_clipPreviousPoint");const w=this.lineGroups.reduce((S,j)=>S.concat(j.projectedGeoPreviousLines||j.projectedGeoLines),[]).map(S=>[S[1],S[1],S[1],S[0],S[0],S[0]]).flat().map(S=>uo(i,S));kn(a,h,new Float32Array(w.flat()),2,"a_clipPreviousOtherPoint");const A=this.lineGroups.reduce((S,j)=>S.concat(j.projectedGeoLines.flatMap(ne=>[0,0,1,0,0,1])),[]);kn(a,h,new Float32Array(A),1,"a_isOtherPoint");const z=this.lineGroups.reduce((S,j)=>S.concat(j.projectedGeoLines.flatMap(ne=>[1,-1,1,1,-1,1])),[]);kn(a,h,new Float32Array(z),1,"a_normalSign");const B=this.lineGroups.reduce((S,j)=>S.concat(j.projectedGeoLines.flatMap(ne=>Array(6).fill(j.viewportSize??Sm.viewportSize))),[]);kn(a,h,new Float32Array(B),1,"a_viewportSize");const D=this.lineGroups.reduce((S,j)=>{const ne=go(j.color??Sm.color);return S.concat(j.projectedGeoLines.flatMap(te=>Array(6).fill(ne)))},[]);kn(a,h,new Float32Array(D.flat()),4,"a_color");const V=this.lineGroups.reduce((S,j)=>S.concat(j.projectedGeoLines.flatMap(ne=>Array(6).fill(j.viewportBorderSize??Sm.viewportBorderSize))),[]);kn(a,h,new Float32Array(V),1,"a_viewportBorderSize");const W=this.lineGroups.reduce((S,j)=>{const ne=go(j.borderColor??Sm.borderColor);return S.concat(j.projectedGeoLines.flatMap(te=>Array(6).fill(ne)))},[]);kn(a,h,new Float32Array(W.flat()),4,"a_borderColor")}updateVertexBuffersPoints(i){if(!this.pointsVao)return;const a=this.gl,h=this.pointsProgram;a.bindVertexArray(this.pointsVao),this.setPointGroups();const d=this.pointGroups.reduce((B,D)=>B.concat(D.projectedGeoPoints),[]).map(B=>uo(i,B));kn(a,h,new Float32Array(d.flat()),2,"a_clipPoint");const p=this.pointGroups.reduce((B,D)=>B.concat(D.projectedGeoPreviousPoints||D.projectedGeoPoints),[]).map(B=>uo(i,B));kn(a,h,new Float32Array(p.flat()),2,"a_clipPreviousPoint");const s=this.pointGroups.reduce((B,D)=>B.concat(D.projectedGeoPoints.map(V=>D.viewportSize??Pm.viewportSize)),[]);kn(a,h,new Float32Array(s),1,"a_viewportSize");const w=this.pointGroups.reduce((B,D)=>{const V=go(D.color??Pm.color);return B.concat(D.projectedGeoPoints.map(W=>V))},[]);kn(a,h,new Float32Array(w.flat()),4,"a_color");const A=this.pointGroups.reduce((B,D)=>B.concat(D.projectedGeoPoints.map(V=>D.viewportBorderSize??Pm.viewportBorderSize)),[]);kn(a,h,new Float32Array(A),1,"a_viewportBorderSize");const z=this.pointGroups.reduce((B,D)=>{const V=go(D.borderColor??Pm.borderColor);return B.concat(D.projectedGeoPoints.map(W=>V))},[]);kn(a,h,new Float32Array(z.flat()),4,"a_borderColor")}async updateTextures(){const i=this.gl;if(this.updateCachedTilesForTextures(),this.cachedTilesForTexture.length==0||this.cachedTilesForTexture.length!==0&&_k(this.previousCachedTilesForTexture.map(w=>w.fetchableTile.tileUrl),this.cachedTilesForTexture.map(w=>w.fetchableTile.tileUrl))||!this.image)return;const a=this.tileSize[0],h=this.tileSize[1],d=this.cachedTilesForTexture.length;i.pixelStorei(i.UNPACK_ALIGNMENT,4),i.bindTexture(i.TEXTURE_2D_ARRAY,this.cachedTilesTextureArray),i.texImage3D(i.TEXTURE_2D_ARRAY,0,i.RGBA,a,h,d,0,i.RGBA,i.UNSIGNED_BYTE,null);for(let w=0;w<this.cachedTilesForTexture.length;w++){const A=this.cachedTilesForTexture[w].data;if(A.width!==a||A.width!==a)throw new Error("Cached tile doesn't fit in texture");const z=i.createBuffer();i.bindBuffer(i.PIXEL_UNPACK_BUFFER,z),i.bufferData(i.PIXEL_UNPACK_BUFFER,A.data,i.STATIC_DRAW),i.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,w,A.width,A.height,1,i.RGBA,i.UNSIGNED_BYTE,0),i.bindBuffer(i.PIXEL_UNPACK_BUFFER,null)}i.texParameteri(i.TEXTURE_2D_ARRAY,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D_ARRAY,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D_ARRAY,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D_ARRAY,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);const p=this.cachedTilesForTexture.map(w=>{if(w&&w.fetchableTile&&w.fetchableTile.options&&w.fetchableTile.options.imageRequest&&w.fetchableTile.options.imageRequest.region)return[w.fetchableTile.options.imageRequest.region.x,w.fetchableTile.options.imageRequest.region.y,w.fetchableTile.options.imageRequest.region.width,w.fetchableTile.options.imageRequest.region.height];throw new Error("Missing resource origin points and sizes")});i.bindTexture(i.TEXTURE_2D,this.cachedTilesResourceOriginPointsAndSizesTexture),i.texImage2D(i.TEXTURE_2D,0,i.R32I,1,this.cachedTilesForTexture.length*4,0,i.RED_INTEGER,i.INT,new Int32Array(p.flat())),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);const s=this.cachedTilesForTexture.map(w=>w.fetchableTile.tile.tileZoomLevel.scaleFactor);i.bindTexture(i.TEXTURE_2D,this.cachedTilesScaleFactorsTexture),i.texImage2D(i.TEXTURE_2D,0,i.R32I,1,this.cachedTilesForTexture.length,0,i.RED_INTEGER,i.INT,new Int32Array(s)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),this.dispatchEvent(new ai(nr.TEXTURESUPDATED))}updateCachedTilesForTextures(){const i=[],a=[],h=[],d=[];for(const w of this.fetchableTilesForViewport){const A=this.cachedTilesByTileUrl.get(w.tileUrl);if(A)i.push(A);else for(const z of this.getCachedTilesAtOtherScaleFactors(w.tile))a.push(z)}d.push(...Array.from(this.cachedTilesByTileUrl.values()).filter(w=>w.isTileFromSprites()));for(const w of this.overviewFetchableTilesForViewport){const A=this.cachedTilesByTileUrl.get(w.tileUrl);if(A){const z=this.tileZoomLevelForViewport?this.tileZoomLevelForViewport.rows*this.tileZoomLevelForViewport.columns:void 0;(i.length===0||z&&i.length<z)&&h.push(A)}}let p=[...i,...a,...d,...h];const s=new Map;p.forEach(w=>s.set(w.fetchableTile.tileUrl,w)),p=[...s.values()],this.previousCachedTilesForTexture=this.cachedTilesForTexture,this.cachedTilesForTexture=p}getCachedTilesAtOtherScaleFactors(i){if(this.cachedTilesByTileUrl.size===0)return[];if(!this.tileZoomLevelForViewport)return[];const a=[];for(i of lZ(i,this.image,this.tileZoomLevelForViewport.scaleFactor,_Z,gZ,this.tileInCachedTiles.bind(this))){const h=this.tileToCachedTile(i);if(h)a.push(h);else throw new Error("Tile supposed to be in cache isn't.")}return a}tileToCachedTile(i){return this.cachedTilesByTileKey.get(ny(i))}tileInCachedTiles(i){return this.cachedTilesByTileKey.has(ny(i))}}const yZ={},W4={createRTree:!0,rtreeUpdatedOptions:["gcps","resourceMask","transformationType","internalProjection","projection"],animatedOptions:["transformationType","internalProjection","distortionMeasure"],projection:Ta};class bZ extends EventTarget{constructor(i,a){super();Ke(this,"warpedMapFactory");Ke(this,"warpedMapsById");Ke(this,"zIndices");Ke(this,"imagesById");Ke(this,"rtree");Ke(this,"options");this.warpedMapsById=new Map,this.zIndices=new Map,this.imagesById=new Map,this.warpedMapFactory=i,this.options=zi(W4,a),this.options.createRTree&&(this.rtree=new kj)}async addGeoreferencedMap(i,a){const h=M4(i),d=Array.isArray(h)?h[0]:h;return this.addGeoreferencedMapInternal(d,a)}async removeGeoreferencedMap(i){const a=M4(i),h=Array.isArray(a)?a[0]:a;return this.removeGeoreferencedMapInternal(h)}async removeGeoreferencedMapById(i){return this.removeGeoreferencedMapByIdInternal(i)}async addGeoreferenceAnnotation(i,a){const h=[],d=ty(i),p=await Promise.allSettled(d.map(s=>this.addGeoreferencedMapInternal(s,a)));for(const s of p)s.status==="fulfilled"?h.push(s.value):h.push(s.reason);return this.dispatchEvent(new ai(nr.GEOREFERENCEANNOTATIONADDED)),this.dispatchEvent(new ai(nr.CHANGED)),h}async removeGeoreferenceAnnotation(i){const a=[],h=ty(i);for(const d of h){const p=await this.removeGeoreferencedMapInternal(d);a.push(p)}return this.dispatchEvent(new ai(nr.GEOREFERENCEANNOTATIONREMOVED)),a}addImageInfos(i){const a=[];for(const h of i){const d=I5.parse(h);this.imagesById.set(d.uri,d),a.push(d.uri)}return this.dispatchEvent(new ai(nr.IMAGEINFOSADDED)),a}getMapIds(i){return Array.from(this.getWarpedMaps(i)).map(a=>a.mapId)}getWarpedMaps(i){const a=zi(yZ,i);let h;a.mapIds===void 0?this.rtree&&a.geoBbox?h=this.rtree.searchFromBbox(a.geoBbox):this.rtree&&a.geoPoint?h=this.rtree.searchFromPoint(a.geoPoint):h=Array.from(this.warpedMapsById.keys()):h=a.mapIds;const d=[];if(h===void 0)return d;for(const p of h){const s=this.warpedMapsById.get(p);s&&(!a.onlyVisible||s.options.visible)&&d.push(s)}return d.sort((p,s)=>this.orderMapIdsByZIndex(p.mapId,s.mapId)),d}getWarpedMap(i){return this.warpedMapsById.get(i)}getMapsCenter(i){const a=this.getMapsBbox(i);if(a)return Gu(a)}getMapsBbox(i){const a=this.getProjectedGeoMaskPoints(i);if(a.length!==0)return Gn(a)}getMapsConvexHull(i){const a=this.getProjectedGeoMaskPoints(i);return lk(a)}getMapZIndex(i){return this.zIndices.get(i)}getDefaultOptions(){return zi(W4,l1.getDefaultOptions())}getMapDefaultOptions(i){const a=this.getWarpedMap(i);return a==null?void 0:a.getDefaultAndGeoreferencedMapOptions()}getOptions(){return this.options}getMapMapOptions(i){const a=this.getWarpedMaps({mapIds:[i]}),h=Array.from(a)[0];return h==null?void 0:h.mapOptions}getMapOptions(i){const a=this.getWarpedMaps({mapIds:[i]}),h=Array.from(a)[0];return h==null?void 0:h.options}setOptions(i,a){this.options=zi(this.options,i),this.internalSetMapsOptionsByMapId(void 0,i,a)}setMapsOptions(i,a,h,d){const p=new Map;for(const s of i)p.set(s,a);this.internalSetMapsOptionsByMapId(p,h,d)}setMapsOptionsByMapId(i,a,h){this.internalSetMapsOptionsByMapId(i,a,h)}resetOptions(i,a){i&&i.length==0&&(i=Object.keys(this.getDefaultOptions())),this.setOptions(zf(i),a)}resetMapsOptions(i,a,h,d){a&&a.length==0&&(a=Object.keys(this.getDefaultOptions())),h&&h.length==0&&(h=Object.keys(this.getDefaultOptions())),this.setMapsOptions(i,zf(a),zf(h),d)}resetMapsOptionsByMapId(i,a,h){if(i&&i.size==0){const d=this.getMapIds(),p=Object.keys(this.getDefaultOptions());for(const s of d)i.set(s,p)}a&&a.length==0&&(a=Object.keys(this.getDefaultOptions())),this.setMapsOptionsByMapId(Ak(i),zf(a),h)}bringMapsToFront(i){let a=this.warpedMapsById.size;for(const h of i)this.zIndices.has(h)&&(this.zIndices.set(h,a),a++);this.removeZIndexHoles(),this.dispatchEvent(new ai(nr.CHANGED))}sendMapsToBack(i){let a=-Array.from(i).length;for(const h of i)this.zIndices.has(h)&&(this.zIndices.set(h,a),a++);this.removeZIndexHoles(),this.dispatchEvent(new ai(nr.CHANGED))}bringMapsForward(i){for(const[a,h]of this.zIndices.entries())this.zIndices.set(a,h*2);for(const a of i){const h=this.zIndices.get(a);h!==void 0&&this.zIndices.set(a,h+3)}this.removeZIndexHoles(),this.dispatchEvent(new ai(nr.CHANGED))}sendMapsBackward(i){for(const[a,h]of this.zIndices.entries())this.zIndices.set(a,h*2);for(const a of i){const h=this.zIndices.get(a);h!==void 0&&this.zIndices.set(a,h-3)}this.removeZIndexHoles(),this.dispatchEvent(new ai(nr.CHANGED))}orderMapIdsByZIndex(i,a){const h=this.getMapZIndex(i),d=this.getMapZIndex(a);return h!==void 0&&d!==void 0?h-d:0}clear(){var i;this.warpedMapsById=new Map,this.zIndices=new Map,(i=this.rtree)==null||i.clear(),this.dispatchEvent(new ai(nr.CLEARED))}destroy(){for(const i of this.getWarpedMaps())this.removeEventListenersFromWarpedMap(i),i.destroy();this.clear()}async addGeoreferencedMapInternal(i,a){const h=await this.getOrComputeMapId(i),d=this.warpedMapFactory(h,i,this.options,a);return this.warpedMapsById.set(h,d),this.zIndices.set(h,this.warpedMapsById.size-1),this.addToOrUpdateRtree(d),this.addEventListenersToWarpedMap(d),this.dispatchEvent(new ai(nr.WARPEDMAPADDED,{mapIds:[h]})),h}async removeGeoreferencedMapInternal(i){const a=await this.getOrComputeMapId(i);return this.removeGeoreferencedMapByIdInternal(a)}async removeGeoreferencedMapByIdInternal(i){const a=this.warpedMapsById.get(i);if(a)this.warpedMapsById.delete(i),this.zIndices.delete(i),this.removeFromRtree(a),this.dispatchEvent(new ai(nr.WARPEDMAPREMOVED,{mapIds:[i]})),this.removeZIndexHoles(),this.dispatchEvent(new ai(nr.CHANGED)),a.destroy();else throw new Error(`No map found with ID ${i}`);return i}async getOrComputeMapId(i){return i.id||await GB(i)}getProjectedGeoMaskPoints(i){const a=this.getWarpedMaps(i),h=i==null?void 0:i.projection;if(h){const d=[];for(const s of a)d.push(...s.geoMask);return d.map(s=>la(h.definition,s))}else{const d=[];for(const p of a)d.push(...p.projectedGeoMask);return d}}internalSetMapsOptionsByMapId(i,a,h){if(this.warpedMapsById.size===0||(i==null?void 0:i.size)===0)return;(h==null?void 0:h.animate)!==void 0&&this.dispatchEvent(new ai(nr.PREPARECHANGE,{mapIds:this.getMapIds()}));let d=[];const p=[];for(const s of this.getWarpedMaps()){let w;if((h==null?void 0:h.animate)===void 0){const z=i==null?void 0:i.get(s.mapId);w=s.setMapOptions(z,a,{optionKeysToOmit:this.options.animatedOptions})}else{const z=i==null?void 0:i.get(s.mapId);w=s.setMapOptions(z,a)}const A=Object.keys(w);A.length>0&&(d.push(...A),p.push(s.mapId)),this.options.rtreeUpdatedOptions.some(z=>z in w)&&this.addToOrUpdateRtree(s)}d=Array.from(new Set(d)),(h==null?void 0:h.animate)===void 0||(h==null?void 0:h.animate)===!1?(d.length>0&&this.dispatchEvent(new ai(nr.IMMEDIATECHANGE,{mapIds:p,optionKeys:d})),(h==null?void 0:h.animate)===void 0&&this.internalSetMapsOptionsByMapId(i,a,ls(h,{animate:!0}))):d.length>0&&this.dispatchEvent(new ai(nr.ANIMATEDCHANGE,{mapIds:p,optionKeys:d}))}addToOrUpdateRtree(i){this.rtree&&(this.rtree.removeItem(i.mapId),this.rtree.addItem(i.mapId,[i.geoMask]))}removeFromRtree(i){this.rtree&&this.rtree.removeItem(i.mapId)}removeZIndexHoles(){const i=[...this.zIndices.entries()].sort((h,d)=>h[1]-d[1]);let a=0;for(const h of i){const d=h[0];this.zIndices.set(d,a),a++}}imageLoaded(i){this.dispatchEvent(new ai(nr.IMAGELOADED,{mapIds:[i]}))}addEventListenersToWarpedMap(i){i.addEventListener(nr.IMAGELOADED,this.imageLoaded.bind(this,i.mapId))}removeEventListenersFromWarpedMap(i){i.removeEventListener(nr.IMAGELOADED,this.imageLoaded.bind(this,i.mapId))}}class nh{constructor(t,i,a,h){Ke(this,"mapId");Ke(this,"tile");Ke(this,"tileUrl");Ke(this,"tileKey");Ke(this,"fetchableTileKey");Ke(this,"options");this.tile=t,this.mapId=i,this.tileUrl=a,this.options=h,this.tileKey=ny(t),this.fetchableTileKey=hZ(this)}static fromWarpedMap(t,i,a){const h=i.image.getTileImageRequest(t.tileZoomLevel,t.column,t.row);return new nh(t,i.mapId,i.image.getImageUrl(h),ls(a,{imageRequest:h}))}static fromSprite(t,i,a,h){const d=a.tileSize[0],p=a.tileSize[1],s={column:0,row:0,tileZoomLevel:{scaleFactor:t.scaleFactor,width:d,height:p,originalWidth:d*t.scaleFactor,originalHeight:p*t.scaleFactor,columns:1,rows:1},imageSize:i},w=a.image.getTileImageRequest(s.tileZoomLevel,s.column,s.row);return new nh(s,a.mapId,t.imageId,ls(h,{imageRequest:w}))}}const X4={},q4=0,wZ=2,xZ=4,Y4=10,MZ=0,IZ=-.5,AZ=1/0,TZ=2,CZ=1024*1024,SZ=10,PZ=40,EZ=100;class kZ extends EventTarget{constructor(i,a,h){super();Ke(this,"warpedMapList");Ke(this,"tileCache");Ke(this,"spritesTileCache");Ke(this,"mapsInPreviousViewport",new Set);Ke(this,"mapsInViewport",new Set);Ke(this,"mapsWithFetchableTilesForViewport",new Set);Ke(this,"mapsWithRequestedTilesForViewport",new Set);Ke(this,"viewport");Ke(this,"options");this.options=zi(X4,h),this.warpedMapList=new bZ(i,h),this.tileCache=new p4(a,h),this.spritesTileCache=new p4(a,ls(h,{tileCacheForSprites:this.tileCache}))}async addGeoreferenceAnnotation(i,a){return this.warpedMapList.addGeoreferenceAnnotation(i,a)}async addGeoreferencedMap(i,a){return this.warpedMapList.addGeoreferencedMap(i,a)}async addSprites(i,a,h){var B;const d={sprites:i,imageUrl:a,imageSize:h},p=d.imageSize[0],s=d.imageSize[1],w={column:0,row:0,tileZoomLevel:{scaleFactor:1,width:p,height:s,originalWidth:0,originalHeight:0,columns:1,rows:1},imageSize:d.imageSize},A=new Map;for(const D of this.warpedMapList.getWarpedMaps()){if(D.hasImage()||await D.loadImage(this.warpedMapList.imagesById),!D.hasImage())break;const V=D.georeferencedMap.resource.id;A.has(V)||A.set(V,[]),(B=A.get(D.georeferencedMap.resource.id))==null||B.push(D)}const z=new Promise(D=>{this.spritesTileCache.addEventListener(nr.MAPTILESLOADEDFROMSPRITES,D,{once:!0})});return this.spritesTileCache.requestFetchableTiles([new nh(w,d.imageUrl,d.imageUrl,{spritesInfo:d,warpedMapsByResourceId:A})]),z}getDefaultOptions(){return zi(X4,this.warpedMapList.getDefaultOptions())}getMapDefaultOptions(i){return this.warpedMapList.getMapDefaultOptions(i)}getOptions(){return ls(this.options,this.warpedMapList.getOptions())}getMapMapOptions(i){return this.warpedMapList.getMapMapOptions(i)}getMapOptions(i){return this.warpedMapList.getMapOptions(i)}setOptions(i,a){this.options=zi(this.options,i),this.tileCache.setOptions(i),this.warpedMapList.setOptions(i,a)}setMapsOptions(i,a,h,d){h&&(this.options=ls(this.options,h),this.tileCache.setOptions(h)),this.warpedMapList.setMapsOptions(i,a,h,d)}setMapsOptionsByMapId(i,a,h){a&&(this.options=ls(this.options,a),this.tileCache.setOptions(a)),this.warpedMapList.setMapsOptionsByMapId(i,a,h)}resetOptions(i,a){this.warpedMapList.resetOptions(i,a)}resetMapsOptions(i,a,h,d){this.warpedMapList.resetMapsOptions(i,a,h,d)}resetMapsOptionsByMapId(i,a,h){this.warpedMapList.resetMapsOptionsByMapId(i,a,h)}loadMissingImagesInViewport(){if(!this.viewport)return[];const i=Gn(this.viewport.getGeoBufferedRectangle());return Array.from(this.warpedMapList.getWarpedMaps({geoBbox:i})).filter(a=>!a.hasImage()&&!a.fetchingImageInfo).map(a=>a.loadImage(this.warpedMapList.imagesById))}someImagesInViewport(){return this.viewport?Array.from(this.findMapsInViewport(this.shouldAnticipateInteraction()?Y4:0)).map(i=>this.warpedMapList.getWarpedMap(i)).map(i=>i.hasImage()).some(Boolean):!1}shouldRequestFetchableTiles(){return!0}shouldAnticipateInteraction(){return!1}assureProjection(){this.viewport&&(yg(this.warpedMapList.options.projection,this.viewport.projection)||(this.warpedMapList.options.projection=this.viewport.projection,this.warpedMapList.setOptions({projection:this.viewport.projection})))}requestFetchableTiles(){if(!this.shouldRequestFetchableTiles())return;const i=[],a=[],h=this.findMapsInViewport(this.shouldAnticipateInteraction()?q4:0),d=this.findMapsInViewport(this.shouldAnticipateInteraction()?wZ:0),p=this.findMapsInViewport(this.shouldAnticipateInteraction()?xZ:0),s=this.findMapsInViewport(this.shouldAnticipateInteraction()?Y4:0);for(const V of this.warpedMapList.getWarpedMaps())V.resetForViewport();for(const V of p)i.push(...this.getMapFetchableTilesForViewport(V,h));const w=i.map(V=>U4(V.tile)).reduce((V,W)=>V+W,0);let A=0;const z=this.tileCache.getCachedTiles().filter(V=>V.isTileFromSprites()).filter(V=>{var W;return((W=this.warpedMapList.getWarpedMap(V.fetchableTile.mapId))==null?void 0:W.options.visible)!=!1}).map(V=>V.fetchableTile);if(this.shouldAnticipateInteraction())for(const V of s){const W=this.getMapOverviewFetchableTilesForViewport(V,w+A,d,z);A+=W.map(S=>U4(S.tile)).reduce((S,j)=>S+j,0),a.push(...W)}const B=[...i,...z,...a],D=B.filter(V=>{var W;return(W=this.warpedMapList.getWarpedMap(V.mapId))==null?void 0:W.shouldRenderMap()});this.tileCache.requestFetchableTiles(D),this.pruneTileCache(s),this.updateMapsForViewport(B)}findMapsInViewport(i=0){if(!this.viewport)return new Set;const a=this.viewport,h=Gn(this.viewport.getGeoBufferedRectangle(i));return new Set(Array.from(this.warpedMapList.getWarpedMaps({geoBbox:h})).map(p=>({warpedMap:p,projectedGeoSquaredDistanceToViewportCenter:ah(Gu(p.projectedGeoMaskBbox),a.projectedGeoCenter)})).sort((p,s)=>p&&s?p.projectedGeoSquaredDistanceToViewportCenter-s.projectedGeoSquaredDistanceToViewportCenter:0).map(p=>p.warpedMap.mapId))}getMapFetchableTilesForViewport(i,a){if(!this.viewport)return[];const h=this.viewport,d=this.warpedMapList.getWarpedMap(i);if(!d)return[];if(!d.options.visible)return[];if(!d.hasImage())return[];const p=Jj(d.image.tileZoomLevels,d.getResourceToViewportScale(h),MZ,IZ);d.setTileZoomLevelForViewport(p);const s={maxDepth:0,sourceIsGeographic:!1,destinationIsGeographic:!0},w=h.getProjectedGeoBufferedRectangle(this.shouldAnticipateInteraction()?q4:0),z=(d.transformationType==="thinPlateSpline"&&d.gcps.length>EZ?d.getProjectedTransformer("polynomial"):d.projectedTransformer).transformToResource([w],s)[0];if(d.setProjectedGeoBufferedViewportRectangleForViewport(w),d.setResourceBufferedViewportRingForViewport(z),!d.resourceBufferedViewportRingBboxForViewport||!d.resourceBufferedViewportRingBboxForViewport)throw new Error("No resourceBufferedViewportRingBboxForViewport or resourceBufferedViewportRingBboxForViewport");const B=ak(d.resourceBufferedViewportRingBboxForViewport,d.resourceMaskBbox);if(d.setResourceBufferedViewportRingBboxAndResourceMaskBboxIntersectionForViewport(B),!a.has(i))return[];if(!B)return[];let D=Qj(wo(B),p,[d.image.width,d.image.height]);D=this.filterOutTilesCloseToSpriteTiles(D,d);const V=Gu(d.resourceBufferedViewportRingBboxForViewport);D.sort((S,j)=>N4(S,V)-N4(j,V));const W=D.map(S=>nh.fromWarpedMap(S,d));return d.setFetchableTilesForViewport(W),W}getMapOverviewFetchableTilesForViewport(i,a,h,d){if(!this.viewport)return[];const p=this.warpedMapList.getWarpedMap(i);if(!p)return[];if(!p.options.visible)return[];if(!p.hasImage())return[];const s=this.viewport.viewportResolution*SZ;if(a>s||h.size>PZ||d.length>0)return[];const w=p.image.tileZoomLevels.filter(B=>oZ(B)<=CZ).sort((B,D)=>B.scaleFactor-D.scaleFactor).at(-1);if(p.setOverviewTileZoomLevelForViewport(w),!h.has(i))return[];if(!w||p.tileZoomLevelForViewport&&w.scaleFactor<=p.tileZoomLevelForViewport.scaleFactor)return[];let A=N5(w.scaleFactor,p.image);A=this.filterOutTilesCloseToSpriteTiles(A,p);const z=A.map(B=>nh.fromWarpedMap(B,p));return p.setOverviewFetchableTilesForViewport(z),z}updateMapsForViewport(i){this.mapsWithFetchableTilesForViewport=new Set(i.map(s=>s.mapId).sort((s,w)=>this.warpedMapList.orderMapIdsByZIndex(s,w))),this.mapsInPreviousViewport=this.mapsInViewport,this.mapsInViewport=this.findMapsInViewport();const a=Array.from(this.mapsInPreviousViewport),h=Array.from(this.mapsInViewport),d=h.filter(s=>!a.includes(s)),p=a.filter(s=>!h.includes(s));for(const s of d)this.dispatchEvent(new ai(nr.WARPEDMAPENTERED,{mapIds:[s]}));for(const s of p)this.clearMap(s),this.dispatchEvent(new ai(nr.WARPEDMAPLEFT,{mapIds:[s]}));return{mapsEnteringViewport:d,mapsLeavingViewport:p}}pruneTileCache(i){const a=new Map;for(const h of this.warpedMapList.getWarpedMaps({mapIds:i}))a.set(h.mapId,{tileZoomLevelForViewport:h.tileZoomLevelForViewport,overviewTileZoomLevelForViewport:h.overviewTileZoomLevelForViewport,resourceViewportRingBboxForViewport:h.resourceBufferedViewportRingBboxForViewport});this.tileCache.prune(a)}filterOutTilesCloseToSpriteTiles(i,a){const d=this.tileCache.getMapCachedTiles(a.mapId).filter(p=>p.isTileFromSprites()).map(p=>p.fetchableTile.tile.tileZoomLevel.scaleFactor);return i.filter(p=>{for(const s of d){const w=Math.log2(p.tileZoomLevel.scaleFactor)-Math.log2(s),A=w<=AZ,z=-w<=TZ;if(A&&z)return!1}return!0})}destroy(){this.tileCache.destroy(),this.warpedMapList.destroy()}clearMap(i){}mapTileLoaded(i){}mapTileDeleted(i){}imageLoaded(i){}warpedMapAdded(i){}warpedMapRemoved(i){}prepareChange(i){}immediateChange(i){}animatedChange(i){}addEventListeners(){this.tileCache.addEventListener(nr.MAPTILELOADED,this.mapTileLoaded.bind(this)),this.tileCache.addEventListener(nr.MAPTILEDELETED,this.mapTileDeleted.bind(this)),this.warpedMapList.addEventListener(nr.IMAGELOADED,this.imageLoaded.bind(this)),this.warpedMapList.addEventListener(nr.WARPEDMAPADDED,this.warpedMapAdded.bind(this)),this.warpedMapList.addEventListener(nr.WARPEDMAPREMOVED,this.warpedMapRemoved.bind(this)),this.warpedMapList.addEventListener(nr.PREPARECHANGE,this.prepareChange.bind(this)),this.warpedMapList.addEventListener(nr.ANIMATEDCHANGE,this.animatedChange.bind(this)),this.warpedMapList.addEventListener(nr.IMMEDIATECHANGE,this.immediateChange.bind(this))}removeEventListeners(){this.tileCache.removeEventListener(nr.MAPTILELOADED,this.mapTileLoaded.bind(this)),this.tileCache.removeEventListener(nr.MAPTILEDELETED,this.mapTileDeleted.bind(this)),this.warpedMapList.removeEventListener(nr.IMAGELOADED,this.imageLoaded.bind(this)),this.warpedMapList.removeEventListener(nr.WARPEDMAPADDED,this.warpedMapAdded.bind(this)),this.warpedMapList.removeEventListener(nr.WARPEDMAPREMOVED,this.warpedMapRemoved.bind(this)),this.warpedMapList.removeEventListener(nr.PREPARECHANGE,this.prepareChange.bind(this)),this.warpedMapList.removeEventListener(nr.IMMEDIATECHANGE,this.immediateChange.bind(this)),this.warpedMapList.removeEventListener(nr.ANIMATEDCHANGE,this.animatedChange.bind(this))}}class RZ extends EventTarget{constructor(i,a){super();Ke(this,"fetchableTile");Ke(this,"fetchFn");Ke(this,"abortController");Ke(this,"data");Ke(this,"cachedTilesFromSprites");this.fetchableTile=i,this.fetchFn=a,this.abortController=new AbortController}isCachedTile(){return this.data!==void 0}isTileFromSprites(){var i;return((i=this.fetchableTile.options)==null?void 0:i.spritesInfo)!=null}getCachedTilesFromSprites(){return this.cachedTilesFromSprites}abort(){this.abortController.signal.aborted||this.abortController.abort()}shouldPrune(i,a){const h=this.fetchableTile.tile;if(this.isTileFromSprites())return!1;if(!i)return!0;if(i.overviewTileZoomLevelForViewport&&h.tileZoomLevel.scaleFactor==i.overviewTileZoomLevelForViewport.scaleFactor)return!1;if(i.resourceViewportRingBboxForViewport===void 0||i.tileZoomLevelForViewport===void 0)return!0;const d=Math.log2(h.tileZoomLevel.scaleFactor)-Math.log2(i.tileZoomLevelForViewport.scaleFactor);return d>a.maxHigherLog2ScaleFactorDiff||-d>a.maxLowerLog2ScaleFactorDiff||!sk(Y6(U5(h),Math.max(0,d)),i.resourceViewportRingBboxForViewport)}}var Nu,Uu;const Sb=class Sb extends RZ{constructor(i,a,h,d){super(i,d);ii(this,Nu);ii(this,Uu);Zi(this,Nu,a),Zi(this,Uu,h)}async fetch(){try{Kt(this,Nu).getImageData(this.fetchableTile.tileUrl,O6(()=>this.abortController.abort()),this.fetchFn,this.fetchableTile.tile.tileZoomLevel.width,this.fetchableTile.tile.tileZoomLevel.height).then(i=>{this.data=i,this.dispatchEvent(new ai(nr.TILEFETCHED,{tileUrl:this.fetchableTile.tileUrl}))}).catch(i=>{i instanceof Error&&i.name==="AbortError"?console.log("Fetch aborted"):console.error(i)})}catch(i){i instanceof Error&&i.name==="AbortError"||this.dispatchEvent(new ai(nr.TILEFETCHERROR,{tileUrl:this.fetchableTile.tileUrl}))}return this.data}async applySprites(){var p,s;const i=this.data,a=(p=this.fetchableTile.options)==null?void 0:p.spritesInfo,h=(s=this.fetchableTile.options)==null?void 0:s.warpedMapsByResourceId;if(!i||!a||!h)return;const d=new Map(Array.from(h.entries()).map(([w,A])=>[w,A.map(z=>z.tileSize)]));return Kt(this,Uu).applySprites(i,a.sprites,d).then(w=>{this.cachedTilesFromSprites=this.spritesDataToCachedTiles(w,a,h),this.dispatchEvent(new ai(nr.TILESFROMSPRITETILE,{tileUrl:this.fetchableTile.tileUrl}))})}spritesDataToCachedTiles(i,a,h){const d=[];let p=0;for(const s of a.sprites){const w=h.get(s.imageId);if(!w)break;for(const A of w){const z=new LZ(nh.fromSprite(s,a.imageSize,A,{spritesInfo:a}),Kt(this,Nu),Kt(this,Uu),i[p]);d.push(z),p++}}return d}static createFactory(i,a){return(h,d)=>new Sb(h,i,a,d)}};Nu=new WeakMap,Uu=new WeakMap;let Lg=Sb;class LZ extends Lg{constructor(t,i,a,h){super(t,i,a),this.data=h}}const Pf={rotation:0,devicePixelRatio:1,projection:Ta},Em={zoom:1},av={fit:"contain"};class Sp{constructor(t,i,a,h){Ke(this,"geoCenter");Ke(this,"geoRectangle");Ke(this,"geoSize");Ke(this,"geoResolution");Ke(this,"geoRectangleBbox");Ke(this,"projection");Ke(this,"projectedGeoCenter");Ke(this,"projectedGeoRectangle");Ke(this,"projectedGeoSize");Ke(this,"projectedGeoResolution");Ke(this,"projectedGeoRectangleBbox");Ke(this,"rotation");Ke(this,"projectedGeoPerViewportScale");Ke(this,"viewportCenter");Ke(this,"viewportRectangle");Ke(this,"viewportSize");Ke(this,"viewportResolution");Ke(this,"viewportBbox");Ke(this,"devicePixelRatio");Ke(this,"canvasCenter");Ke(this,"canvasRectangle");Ke(this,"canvasSize");Ke(this,"canvasResolution");Ke(this,"canvasBbox");Ke(this,"projectedGeoPerCanvasScale");Ke(this,"projectedGeoToViewportHomogeneousTransform",[1,0,0,1,0,0]);Ke(this,"projectedGeoToCanvasHomogeneousTransform",[1,0,0,1,0,0]);Ke(this,"projectedGeoToClipHomogeneousTransform",[1,0,0,1,0,0]);Ke(this,"viewportToClipHomogeneousTransform",[1,0,0,1,0,0]);const d=zi(Pf,h);this.projectedGeoCenter=i,this.projectedGeoPerViewportScale=a,this.rotation=d.rotation,this.viewportSize=[Math.round(t[0]),Math.round(t[1])],this.devicePixelRatio=d.devicePixelRatio,this.projection=d.projection,this.projectedGeoRectangle=this.computeProjectedGeoRectangle(this.viewportSize,this.projectedGeoPerViewportScale,this.rotation,this.projectedGeoCenter),this.projectedGeoRectangleBbox=Gn(this.projectedGeoRectangle),this.projectedGeoSize=H_(this.viewportSize,a),this.projectedGeoResolution=Lf(this.projectedGeoSize),this.geoRectangle=this.projectedGeoRectangle.map(p=>la(this.projection.definition,Ia.definition,yg(this.projection,Ta)?T2(p):p)),this.geoRectangleBbox=Gn(this.geoRectangle),this.geoCenter=Gu(this.geoRectangleBbox),this.geoSize=Om(this.geoRectangleBbox),this.geoResolution=Lf(this.geoSize),this.viewportResolution=Lf(this.viewportSize),this.viewportCenter=ck(this.viewportSize),this.viewportBbox=Vv(this.viewportSize),this.viewportRectangle=wo(this.viewportBbox),this.canvasCenter=Dv(this.viewportCenter,this.devicePixelRatio),this.canvasSize=H_(this.viewportSize,this.devicePixelRatio),this.canvasResolution=Lf(this.canvasSize),this.canvasBbox=Vv(this.canvasSize),this.canvasRectangle=wo(this.canvasBbox),this.projectedGeoPerCanvasScale=this.projectedGeoPerViewportScale/this.devicePixelRatio,this.projectedGeoToViewportHomogeneousTransform=this.composeProjectedGeoToViewportHomogeneousTransform(),this.projectedGeoToCanvasHomogeneousTransform=this.composeProjectedGeoToCanvasHomogeneousTransform(),this.projectedGeoToClipHomogeneousTransform=this.composeProjectedGeoToClipHomogeneousTransform(),this.viewportToClipHomogeneousTransform=this.composeViewportToClipHomogeneousTransform()}static fromSizeAndMaps(t,i,a){const h=i.getMapsConvexHull(a);if(!h)throw new Error("Maps have no projected convex hull. Possibly because WarpedMapList or Array is empty.");return this.fromSizeAndProjectedGeoPolygon(t,[h],a)}static fromSizeAndGeoPolygon(t,i,a){const h=zi({...Pf,...Em,...av},a),d=i.map(p=>p.map(s=>la(h.projection.definition,s)));return this.fromSizeAndProjectedGeoPolygon(t,d,a)}static fromSizeAndProjectedGeoPolygon(t,i,a){const h=zi({...Pf,...Em,...av},a),d=i[0],p=N_(d,-h.rotation),s=Gn(p),w=Om(s),A=Gu(s),z=Ly(w,t,h.fit),B=lg(A,h.rotation);return new Sp(t,B,z*h.zoom,h)}static fromScaleAndMaps(t,i,a){const h=i.getMapsConvexHull(a);if(!h)throw new Error("Maps have no projected convex hull. Possibly because WarpedMapList or Array is empty.");return this.fromScaleAndProjectedGeoPolygon(t,[h],a)}static fromScaleAndGeoPolygon(t,i,a){const h=zi({...Pf,...Em,...av},a),d=i.map(p=>p.map(s=>la(h.projection.definition,s)));return this.fromScaleAndProjectedGeoPolygon(t,d,a)}static fromScaleAndProjectedGeoPolygon(t,i,a){const h=zi({...Pf,...Em},a),d=i[0],p=L9(N_(d,-h.rotation),1/t),s=Gn(p),w=Om(s),A=Gu(s),z=lg(Dv(A,t),h.rotation);return new Sp(w,z,t*h.zoom,h)}getProjectedGeoBufferedRectangle(t){const i=Y6(this.viewportBbox,t);return wo(i).map(h=>uo(yb(this.projectedGeoToViewportHomogeneousTransform),h))}getGeoBufferedRectangle(t){return this.getProjectedGeoBufferedRectangle(t).map(i=>la(this.projection.definition,Ia.definition,yg(this.projection,Ta)?T2(i):i))}composeProjectedGeoToViewportHomogeneousTransform(){return Cm(this.viewportCenter[0],this.viewportCenter[1],1/this.projectedGeoPerViewportScale,-1/this.projectedGeoPerViewportScale,-this.rotation,-this.projectedGeoCenter[0],-this.projectedGeoCenter[1])}composeProjectedGeoToCanvasHomogeneousTransform(){return Cm(this.canvasCenter[0],this.canvasCenter[1],1/this.projectedGeoPerCanvasScale,-1/this.projectedGeoPerCanvasScale,-this.rotation,-this.projectedGeoCenter[0],-this.projectedGeoCenter[1])}composeProjectedGeoToClipHomogeneousTransform(){return Cm(0,0,2/(this.projectedGeoPerViewportScale*this.viewportSize[0]),2/(this.projectedGeoPerViewportScale*this.viewportSize[1]),-this.rotation,-this.projectedGeoCenter[0],-this.projectedGeoCenter[1])}composeViewportToClipHomogeneousTransform(){return Cm(0,0,2/this.viewportSize[0],-2/this.viewportSize[1],0,-this.viewportCenter[0],-this.viewportCenter[1])}computeProjectedGeoRectangle(t,i,a,h){const d=H_(t,i),p=K6(d),s=M2(p,og(...p),"substract"),w=N_(s,a);return M2(w,h)}}var K4=`#version 300 es

precision highp float;

float easing(float t) {
  return t;

  
  
}

uniform mat4 u_renderHomogeneousTransform;
uniform float u_animationProgress;

in vec2 a_resourceTrianglePoint;
in vec2 a_clipPreviousTrianglePoint;
in vec2 a_clipTrianglePoint;
in float a_previousTrianglePointDistortion;
in float a_trianglePointDistortion;
in float a_trianglePointIndex;

out vec2 v_resourceTrianglePoint;
out float v_trianglePointDistortion;
out float v_trianglePointIndex;
out vec4 v_trianglePointBarycentric;

void main() {
  
  vec2 clipTrianglePoint = mix(a_clipPreviousTrianglePoint, a_clipTrianglePoint, easing(u_animationProgress));
  float trianglePointDistortion = mix(a_previousTrianglePointDistortion, a_trianglePointDistortion, easing(u_animationProgress));

  
  
  

  gl_Position = u_renderHomogeneousTransform * vec4(clipTrianglePoint, 0.0f, 1.0f);

  
  v_resourceTrianglePoint = a_resourceTrianglePoint;
  v_trianglePointDistortion = trianglePointDistortion;
  v_trianglePointIndex = a_trianglePointIndex;

  float trianglePointLocalIndex = mod(a_trianglePointIndex, 3.0f);
  if(trianglePointLocalIndex == 0.0f)
    v_trianglePointBarycentric = vec4(1.0f, 0, 0, 1.0f);
  if(trianglePointLocalIndex == 1.0f)
    v_trianglePointBarycentric = vec4(0.0f, 1.0f, 0, 1.0f);
  if(trianglePointLocalIndex == 2.0f)
    v_trianglePointBarycentric = vec4(0.0f, 0, 1.0f, 1.0f);
}`,$4=`#version 300 es

precision highp float;
precision highp isampler2D;

float easing(float t) {
  return t;

  
  
}

uniform float u_opacity;
uniform float u_saturation;

uniform bool u_removeColor;
uniform vec3 u_removeColorColor;
uniform float u_removeColorThreshold;
uniform float u_removeColorHardness;

uniform bool u_colorize;
uniform vec3 u_colorizeColor;

uniform bool u_renderGrid;
uniform vec4 u_renderGridColor;

uniform bool u_distortion;
uniform int u_distortionMeasure;
uniform vec4 u_distortionColor00;
uniform vec4 u_distortionColor01;
uniform vec4 u_distortionColor1;
uniform vec4 u_distortionColor2;
uniform vec4 u_distortionColor3;

uniform int u_scaleFactorForViewport;

uniform lowp sampler2DArray u_cachedTilesTextureArray;
uniform isampler2D u_cachedTilesResourceOriginPointsAndSizesTexture;
uniform isampler2D u_cachedTilesScaleFactorsTexture;

uniform float u_debugTriangles;
uniform float u_debugTiles;

in vec2 v_resourceTrianglePoint;
in float v_trianglePointDistortion;
in float v_trianglePointIndex;
in vec4 v_trianglePointBarycentric;

out vec4 color;

void main() {
  float resourceTrianglePointX = v_resourceTrianglePoint.x;
  float resourceTrianglePointY = v_resourceTrianglePoint.y;

  
  ivec3 cachedTilesTextureSize = textureSize(u_cachedTilesTextureArray, 0);
  int cachedTilesCount = cachedTilesTextureSize.z;

  
  int smallestScaleFactor;
  bool found = false;
  int foundIndex;

  
  vec3 cachedTilesTexturePoint = vec3(0.0f, 0.0f, 0.0f);

  
  color = vec4(0.0f, 0.0f, 0.0f, 0.0f);

  
  for(int index = 0; index < cachedTilesCount; index += 1) {

    
    float cachedTileResourceOriginPointX = float(texelFetch(u_cachedTilesResourceOriginPointsAndSizesTexture, ivec2(0, (index * 4)), 0));
    float cachedTileResourceOriginPointY = float(texelFetch(u_cachedTilesResourceOriginPointsAndSizesTexture, ivec2(0, (index * 4) + 1), 0));
    float cachedTileDimensionWidth = float(texelFetch(u_cachedTilesResourceOriginPointsAndSizesTexture, ivec2(0, (index * 4) + 2), 0));
    float cachedTileDimensionHeight = float(texelFetch(u_cachedTilesResourceOriginPointsAndSizesTexture, ivec2(0, (index * 4) + 3), 0));

    int cachedTileScaleFactor = texelFetch(u_cachedTilesScaleFactorsTexture, ivec2(0, index), 0).r;

    
    if(resourceTrianglePointX >= cachedTileResourceOriginPointX &&
      resourceTrianglePointX < cachedTileResourceOriginPointX + cachedTileDimensionWidth &&
      resourceTrianglePointY >= cachedTileResourceOriginPointY &&
      resourceTrianglePointY < cachedTileResourceOriginPointY + cachedTileDimensionHeight) {

      
      
      
      
      
      if(!(smallestScaleFactor > 0) || cachedTileScaleFactor <= smallestScaleFactor) {
        smallestScaleFactor = cachedTileScaleFactor;
        found = true;
        foundIndex = index;

        float cachedTilePointX = (resourceTrianglePointX - cachedTileResourceOriginPointX) / float(cachedTileScaleFactor);
        float cachedTilePointY = (resourceTrianglePointY - cachedTileResourceOriginPointY) / float(cachedTileScaleFactor);

        float cachedTilesTexturePointX = cachedTilePointX / float(cachedTilesTextureSize.x);
        float cachedTilesTexturePointY = cachedTilePointY / float(cachedTilesTextureSize.y);

        cachedTilesTexturePoint = vec3(cachedTilesTexturePointX, cachedTilesTexturePointY, index);
      }
    }
  }

  if(found == true) {
    
    color = texture(u_cachedTilesTextureArray, cachedTilesTexturePoint);

    if(u_removeColorThreshold > 0.0f) {
  vec3 backgroundColorDiff = color.rgb - u_removeColorColor.rgb;
  float backgroundColorDistance = length(backgroundColorDiff);
  if(u_removeColor && backgroundColorDistance < u_removeColorThreshold) {
    float amount = smoothstep(u_removeColorThreshold - u_removeColorThreshold * (1.0f - u_removeColorHardness), u_removeColorThreshold, backgroundColorDistance);
    color = vec4(color.rgb * amount, amount);
  }
}

float gray = 0.21f * color.r + 0.71f * color.g + 0.07f * color.b;
color = vec4(color.rgb * (u_saturation) + (gray * (1.0f - u_saturation)), color.a);

if(u_colorize) {
  color = vec4((u_colorizeColor + color.rgb) * color.a, color.a);
}

color = vec4(color.rgb * u_opacity, color.a * u_opacity);
    if(u_distortion) {
  
  

  float trianglePointDistortion = v_trianglePointDistortion;

  
  
  trianglePointDistortion = floor(trianglePointDistortion * 10.0f) / 10.0f;

  
  float trianglePointDistortionMix = clamp(trianglePointDistortion, -1.0f, 1.0f);

  switch(u_distortionMeasure) {
    case 0:
      if(trianglePointDistortion > 0.0f) {
        color = mix(color, u_distortionColor00, trianglePointDistortionMix);
      } else {
        color = mix(color, u_distortionColor01, abs(trianglePointDistortionMix));
      }
      break;
    case 1:
      color = mix(color, u_distortionColor1, trianglePointDistortionMix);
      break;
    case 2:
      color = mix(color, u_distortionColor2, trianglePointDistortionMix);
      break;
    case 3:
      color = trianglePointDistortion == -1.0f ? u_distortionColor3 : color;
      break;
    default:
      color = color;
  }
}

if(u_renderGrid) {
  float gridSize = 20.0f * float(u_scaleFactorForViewport);
  float gridWidth = 2.0f * float(u_scaleFactorForViewport);
  if(mod(float(resourceTrianglePointX) + gridWidth / 2.0f, gridSize) < gridWidth || mod(float(resourceTrianglePointY) + gridWidth / 2.0f, gridSize) < gridWidth) {
    color = u_renderGridColor;
  }
}
    float viewportWidth = 4.0;

if(bool(u_debugTriangles)) {
  
  
  

  float barycentricTriangleDist = min(min(v_trianglePointBarycentric.x, v_trianglePointBarycentric.y), v_trianglePointBarycentric.z);
  
  
  float barycentricTriangleDistPixelSize = length(vec2(dFdx(barycentricTriangleDist), dFdy(barycentricTriangleDist)));
  
  float TriangleDistThreshold = viewportWidth * barycentricTriangleDistPixelSize / 2.0;

  if(barycentricTriangleDist < TriangleDistThreshold) {
    color = vec4(0.0, 0.0, 0.0, 1.0);
  }
}

if(bool(u_debugTiles)) {
  float resourceDist = min(cachedTilesTexturePoint.x, cachedTilesTexturePoint.y);
  
  
  float resourceDistPixelSize = length(vec2(dFdx(resourceDist), dFdy(resourceDist)));
  float resourceDistThreshold = viewportWidth * resourceDistPixelSize;

  if(resourceDist < resourceDistThreshold) {
    color = vec4(0.0, 0.0, 1.0, 1.0);
  }
}
  }
}`,J4=`#version 300 es

precision highp float;

float easing(float t) {
  return t;

  
  
}

uniform mat4 u_renderHomogeneousTransform;
uniform mat4 u_viewportToClipHomogeneousTransform;
uniform mat4 u_clipToViewportHomogeneousTransform;
uniform float u_animationProgress;

in vec2 a_clipPoint;
in vec2 a_clipOtherPoint;
in vec2 a_clipPreviousPoint;
in vec2 a_clipPreviousOtherPoint;
in float a_isOtherPoint;
in float a_normalSign;
in float a_viewportSize;
in vec4 a_color;
in float a_viewportBorderSize;
in vec4 a_borderColor;

out float v_viewportLineLength;
out vec2 v_linePoint;
out float v_viewportSize;
out vec4 v_color;
out float v_viewportBorderSize;
out vec4 v_borderColor;
out float v_viewportFeatherSize;
out float v_viewportTotalSize;

void main() {
  vec2 clipPoint = mix(a_clipPreviousPoint, a_clipPoint, easing(u_animationProgress));
  vec2 clipOtherPoint = mix(a_clipPreviousOtherPoint, a_clipOtherPoint, easing(u_animationProgress));

  vec2 viewportPoint = (u_clipToViewportHomogeneousTransform * u_renderHomogeneousTransform * vec4(clipPoint, 0.0f, 1.0f)).xy;
  vec2 viewportOtherPoint = (u_clipToViewportHomogeneousTransform * u_renderHomogeneousTransform * vec4(clipOtherPoint, 0.0f, 1.0f)).xy;

  vec2 viewportLine = vec2(viewportOtherPoint.x-viewportPoint.x, viewportOtherPoint.y-viewportPoint.y);
  vec2 viewportNormalizedLine = normalize(viewportLine);
  vec2 viewportNormalizedLineNormal = vec2(viewportNormalizedLine.y, -viewportNormalizedLine.x);
  v_viewportLineLength = length(viewportLine);

  v_viewportFeatherSize = 1.0;

  v_viewportTotalSize = a_viewportSize + a_viewportBorderSize + v_viewportFeatherSize;
  float lineX = -1.0 * v_viewportTotalSize / 2.0 + a_isOtherPoint * (v_viewportLineLength + 2.0 * (v_viewportTotalSize / 2.0));
  float lineY = a_normalSign * v_viewportTotalSize / 2.0;
  v_linePoint = vec2(lineX, lineY);
  
  
  
  
  
  

  v_viewportSize = a_viewportSize;
  v_color = a_color;
  v_viewportBorderSize = a_viewportBorderSize;
  v_borderColor = a_borderColor;

  gl_Position =  u_viewportToClipHomogeneousTransform * vec4(viewportPoint + lineX * viewportNormalizedLine + lineY * viewportNormalizedLineNormal, 0, 1);
}`,Q4=`#version 300 es

precision highp float;
precision highp isampler2D;

in float v_viewportLineLength;
in vec2 v_linePoint;
in float v_viewportSize;
in vec4 v_color;
in float v_viewportBorderSize;
in vec4 v_borderColor;
in float v_viewportFeatherSize;
in float v_viewportTotalSize;

out vec4 color;

void main() {
  float distance;
  if (v_linePoint.x < 0.0) {
    distance = length(v_linePoint - vec2(0.0,0.0)) / (v_viewportTotalSize / 2.0);
  } else if (v_linePoint.x > v_viewportLineLength) {
    distance = length(v_linePoint - vec2(v_viewportLineLength,0.0)) / (v_viewportTotalSize / 2.0);
  } else {
    distance = abs(v_linePoint.y) / (v_viewportTotalSize / 2.0);
  }
  if (distance > 1.0) {
    discard;
  }
  float viewportDistance = distance * v_viewportTotalSize / 2.0;

  
  color = vec4(0, 0, 0, 0);
  if (v_viewportSize >= v_viewportFeatherSize) {
    color = v_color;
  }

  
  
  
  float borderSmoothStep;
  if(v_viewportBorderSize >= v_viewportFeatherSize) {
    borderSmoothStep = smoothstep(
      v_viewportSize / 2.0 - v_viewportBorderSize / 2.0 - v_viewportFeatherSize / 2.0,
      v_viewportSize / 2.0 - v_viewportBorderSize / 2.0 + v_viewportFeatherSize / 2.0,
      viewportDistance
    );
    color = ((1.0 - borderSmoothStep) * color) + (borderSmoothStep * v_borderColor);
  }

  
  
  
  borderSmoothStep = smoothstep(
      v_viewportSize / 2.0 + v_viewportBorderSize / 2.0 - v_viewportFeatherSize / 2.0,
      v_viewportSize / 2.0 + v_viewportBorderSize / 2.0 + v_viewportFeatherSize / 2.0,
      viewportDistance
  );
  color = ((1.0 - borderSmoothStep) * color) + (borderSmoothStep * vec4(0, 0, 0, 0));
}`,e8=`#version 300 es

precision highp float;

float easing(float t) {
  return t;

  
  
}

uniform mat4 u_renderHomogeneousTransform;
uniform float u_animationProgress;
uniform float u_devicePixelRatio;

in float a_viewportSize;
in vec4 a_color;
in float a_viewportBorderSize;
in vec4 a_borderColor;

in vec2 a_clipPoint;
in vec2 a_clipPreviousPoint;

out float v_viewportSize;
out vec4 v_color;
out float v_viewportBorderSize;
out vec4 v_borderColor;
out float v_viewportFeatherSize;
out float v_viewportTotalSize;

void main() {
  vec2 clipPoint = mix(a_clipPreviousPoint, a_clipPoint, easing(u_animationProgress));

  gl_Position = u_renderHomogeneousTransform * vec4(clipPoint, 0.0f, 1.0f);

  v_viewportFeatherSize = 1.0;

  v_viewportTotalSize = a_viewportSize + a_viewportBorderSize + v_viewportFeatherSize;
  gl_PointSize = v_viewportTotalSize * u_devicePixelRatio;
  
  
  
  
  
  
  

  v_viewportSize = a_viewportSize;
  v_color = a_color;
  v_viewportBorderSize = a_viewportBorderSize;
  v_borderColor = a_borderColor;
}`,t8=`#version 300 es

precision highp float;
precision highp isampler2D;

in float v_viewportSize;
in vec4 v_color;
in float v_viewportBorderSize;
in vec4 v_borderColor;
in float v_viewportFeatherSize;
in float v_viewportTotalSize;

out vec4 color;

void main() {
  
  float distance = length(2.0 * gl_PointCoord - 1.0);
  if (distance > 1.0) {
    discard;
  }
  float viewportDistance = distance * v_viewportTotalSize / 2.0;

  
  color = vec4(0, 0, 0, 0);
  if (v_viewportSize >= v_viewportFeatherSize) {
    color = v_color;
  }

  
  
  
  float borderSmoothStep;
  if(v_viewportBorderSize >= v_viewportFeatherSize) {
    borderSmoothStep = smoothstep(
      v_viewportSize / 2.0 - v_viewportBorderSize / 2.0 - v_viewportFeatherSize / 2.0,
      v_viewportSize / 2.0 - v_viewportBorderSize / 2.0 + v_viewportFeatherSize / 2.0,
      viewportDistance
    );
    color = ((1.0 - borderSmoothStep) * color) + (borderSmoothStep * v_borderColor);
  }

  
  
  
  borderSmoothStep = smoothstep(
      v_viewportSize / 2.0 + v_viewportBorderSize / 2.0 - v_viewportFeatherSize / 2.0,
      v_viewportSize / 2.0 + v_viewportBorderSize / 2.0 + v_viewportFeatherSize / 2.0,
      viewportDistance
  );
  color = ((1.0 - borderSmoothStep) * color) + (borderSmoothStep * vec4(0, 0, 0, 0));
}`;const X5="LyoqCiAqIEBsaWNlbnNlCiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTEMKICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjAKICovCmNvbnN0IHByb3h5TWFya2VyID0gU3ltYm9sKCJDb21saW5rLnByb3h5Iik7CmNvbnN0IGNyZWF0ZUVuZHBvaW50ID0gU3ltYm9sKCJDb21saW5rLmVuZHBvaW50Iik7CmNvbnN0IHJlbGVhc2VQcm94eSA9IFN5bWJvbCgiQ29tbGluay5yZWxlYXNlUHJveHkiKTsKY29uc3QgZmluYWxpemVyID0gU3ltYm9sKCJDb21saW5rLmZpbmFsaXplciIpOwpjb25zdCB0aHJvd01hcmtlciA9IFN5bWJvbCgiQ29tbGluay50aHJvd24iKTsKY29uc3QgaXNPYmplY3QgPSAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAib2JqZWN0IiAmJiB2YWwgIT09IG51bGwgfHwgdHlwZW9mIHZhbCA9PT0gImZ1bmN0aW9uIjsKY29uc3QgcHJveHlUcmFuc2ZlckhhbmRsZXIgPSB7CiAgY2FuSGFuZGxlOiAodmFsKSA9PiBpc09iamVjdCh2YWwpICYmIHZhbFtwcm94eU1hcmtlcl0sCiAgc2VyaWFsaXplKG9iaikgewogICAgY29uc3QgeyBwb3J0MSwgcG9ydDIgfSA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpOwogICAgZXhwb3NlKG9iaiwgcG9ydDEpOwogICAgcmV0dXJuIFtwb3J0MiwgW3BvcnQyXV07CiAgfSwKICBkZXNlcmlhbGl6ZShwb3J0KSB7CiAgICBwb3J0LnN0YXJ0KCk7CiAgICByZXR1cm4gd3JhcChwb3J0KTsKICB9Cn07CmNvbnN0IHRocm93VHJhbnNmZXJIYW5kbGVyID0gewogIGNhbkhhbmRsZTogKHZhbHVlKSA9PiBpc09iamVjdCh2YWx1ZSkgJiYgdGhyb3dNYXJrZXIgaW4gdmFsdWUsCiAgc2VyaWFsaXplKHsgdmFsdWUgfSkgewogICAgbGV0IHNlcmlhbGl6ZWQ7CiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBFcnJvcikgewogICAgICBzZXJpYWxpemVkID0gewogICAgICAgIGlzRXJyb3I6IHRydWUsCiAgICAgICAgdmFsdWU6IHsKICAgICAgICAgIG1lc3NhZ2U6IHZhbHVlLm1lc3NhZ2UsCiAgICAgICAgICBuYW1lOiB2YWx1ZS5uYW1lLAogICAgICAgICAgc3RhY2s6IHZhbHVlLnN0YWNrCiAgICAgICAgfQogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgc2VyaWFsaXplZCA9IHsgaXNFcnJvcjogZmFsc2UsIHZhbHVlIH07CiAgICB9CiAgICByZXR1cm4gW3NlcmlhbGl6ZWQsIFtdXTsKICB9LAogIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWQpIHsKICAgIGlmIChzZXJpYWxpemVkLmlzRXJyb3IpIHsKICAgICAgdGhyb3cgT2JqZWN0LmFzc2lnbihuZXcgRXJyb3Ioc2VyaWFsaXplZC52YWx1ZS5tZXNzYWdlKSwgc2VyaWFsaXplZC52YWx1ZSk7CiAgICB9CiAgICB0aHJvdyBzZXJpYWxpemVkLnZhbHVlOwogIH0KfTsKY29uc3QgdHJhbnNmZXJIYW5kbGVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKFsKICBbInByb3h5IiwgcHJveHlUcmFuc2ZlckhhbmRsZXJdLAogIFsidGhyb3ciLCB0aHJvd1RyYW5zZmVySGFuZGxlcl0KXSk7CmZ1bmN0aW9uIGlzQWxsb3dlZE9yaWdpbihhbGxvd2VkT3JpZ2lucywgb3JpZ2luKSB7CiAgZm9yIChjb25zdCBhbGxvd2VkT3JpZ2luIG9mIGFsbG93ZWRPcmlnaW5zKSB7CiAgICBpZiAob3JpZ2luID09PSBhbGxvd2VkT3JpZ2luIHx8IGFsbG93ZWRPcmlnaW4gPT09ICIqIikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGlmIChhbGxvd2VkT3JpZ2luIGluc3RhbmNlb2YgUmVnRXhwICYmIGFsbG93ZWRPcmlnaW4udGVzdChvcmlnaW4pKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gZXhwb3NlKG9iaiwgZXAgPSBnbG9iYWxUaGlzLCBhbGxvd2VkT3JpZ2lucyA9IFsiKiJdKSB7CiAgZXAuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uIGNhbGxiYWNrKGV2KSB7CiAgICBpZiAoIWV2IHx8ICFldi5kYXRhKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICghaXNBbGxvd2VkT3JpZ2luKGFsbG93ZWRPcmlnaW5zLCBldi5vcmlnaW4pKSB7CiAgICAgIGNvbnNvbGUud2FybihgSW52YWxpZCBvcmlnaW4gJyR7ZXYub3JpZ2lufScgZm9yIGNvbWxpbmsgcHJveHlgKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgeyBpZCwgdHlwZSwgcGF0aCB9ID0gT2JqZWN0LmFzc2lnbih7IHBhdGg6IFtdIH0sIGV2LmRhdGEpOwogICAgY29uc3QgYXJndW1lbnRMaXN0ID0gKGV2LmRhdGEuYXJndW1lbnRMaXN0IHx8IFtdKS5tYXAoZnJvbVdpcmVWYWx1ZSk7CiAgICBsZXQgcmV0dXJuVmFsdWU7CiAgICB0cnkgewogICAgICBjb25zdCBwYXJlbnQgPSBwYXRoLnNsaWNlKDAsIC0xKS5yZWR1Y2UoKG9iajIsIHByb3ApID0+IG9iajJbcHJvcF0sIG9iaik7CiAgICAgIGNvbnN0IHJhd1ZhbHVlID0gcGF0aC5yZWR1Y2UoKG9iajIsIHByb3ApID0+IG9iajJbcHJvcF0sIG9iaik7CiAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgIGNhc2UgIkdFVCI6CiAgICAgICAgICB7CiAgICAgICAgICAgIHJldHVyblZhbHVlID0gcmF3VmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJTRVQiOgogICAgICAgICAgewogICAgICAgICAgICBwYXJlbnRbcGF0aC5zbGljZSgtMSlbMF1dID0gZnJvbVdpcmVWYWx1ZShldi5kYXRhLnZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiQVBQTFkiOgogICAgICAgICAgewogICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHJhd1ZhbHVlLmFwcGx5KHBhcmVudCwgYXJndW1lbnRMaXN0KTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgIkNPTlNUUlVDVCI6CiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV3IHJhd1ZhbHVlKC4uLmFyZ3VtZW50TGlzdCk7CiAgICAgICAgICAgIHJldHVyblZhbHVlID0gcHJveHkodmFsdWUpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiRU5EUE9JTlQiOgogICAgICAgICAgewogICAgICAgICAgICBjb25zdCB7IHBvcnQxLCBwb3J0MiB9ID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7CiAgICAgICAgICAgIGV4cG9zZShvYmosIHBvcnQyKTsKICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSB0cmFuc2Zlcihwb3J0MSwgW3BvcnQxXSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJSRUxFQVNFIjoKICAgICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSB2b2lkIDA7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9IGNhdGNoICh2YWx1ZSkgewogICAgICByZXR1cm5WYWx1ZSA9IHsgdmFsdWUsIFt0aHJvd01hcmtlcl06IDAgfTsKICAgIH0KICAgIFByb21pc2UucmVzb2x2ZShyZXR1cm5WYWx1ZSkuY2F0Y2goKHZhbHVlKSA9PiB7CiAgICAgIHJldHVybiB7IHZhbHVlLCBbdGhyb3dNYXJrZXJdOiAwIH07CiAgICB9KS50aGVuKChyZXR1cm5WYWx1ZTIpID0+IHsKICAgICAgY29uc3QgW3dpcmVWYWx1ZSwgdHJhbnNmZXJhYmxlc10gPSB0b1dpcmVWYWx1ZShyZXR1cm5WYWx1ZTIpOwogICAgICBlcC5wb3N0TWVzc2FnZShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHdpcmVWYWx1ZSksIHsgaWQgfSksIHRyYW5zZmVyYWJsZXMpOwogICAgICBpZiAodHlwZSA9PT0gIlJFTEVBU0UiKSB7CiAgICAgICAgZXAucmVtb3ZlRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGNhbGxiYWNrKTsKICAgICAgICBjbG9zZUVuZFBvaW50KGVwKTsKICAgICAgICBpZiAoZmluYWxpemVyIGluIG9iaiAmJiB0eXBlb2Ygb2JqW2ZpbmFsaXplcl0gPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgIG9ialtmaW5hbGl6ZXJdKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgY29uc3QgW3dpcmVWYWx1ZSwgdHJhbnNmZXJhYmxlc10gPSB0b1dpcmVWYWx1ZSh7CiAgICAgICAgdmFsdWU6IG5ldyBUeXBlRXJyb3IoIlVuc2VyaWFsaXphYmxlIHJldHVybiB2YWx1ZSIpLAogICAgICAgIFt0aHJvd01hcmtlcl06IDAKICAgICAgfSk7CiAgICAgIGVwLnBvc3RNZXNzYWdlKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgd2lyZVZhbHVlKSwgeyBpZCB9KSwgdHJhbnNmZXJhYmxlcyk7CiAgICB9KTsKICB9KTsKICBpZiAoZXAuc3RhcnQpIHsKICAgIGVwLnN0YXJ0KCk7CiAgfQp9CmZ1bmN0aW9uIGlzTWVzc2FnZVBvcnQoZW5kcG9pbnQpIHsKICByZXR1cm4gZW5kcG9pbnQuY29uc3RydWN0b3IubmFtZSA9PT0gIk1lc3NhZ2VQb3J0IjsKfQpmdW5jdGlvbiBjbG9zZUVuZFBvaW50KGVuZHBvaW50KSB7CiAgaWYgKGlzTWVzc2FnZVBvcnQoZW5kcG9pbnQpKQogICAgZW5kcG9pbnQuY2xvc2UoKTsKfQpmdW5jdGlvbiB3cmFwKGVwLCB0YXJnZXQpIHsKICBjb25zdCBwZW5kaW5nTGlzdGVuZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBlcC5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgZnVuY3Rpb24gaGFuZGxlTWVzc2FnZShldikgewogICAgY29uc3QgeyBkYXRhIH0gPSBldjsKICAgIGlmICghZGF0YSB8fCAhZGF0YS5pZCkgewogICAgICByZXR1cm47CiAgICB9CiAgICBjb25zdCByZXNvbHZlciA9IHBlbmRpbmdMaXN0ZW5lcnMuZ2V0KGRhdGEuaWQpOwogICAgaWYgKCFyZXNvbHZlcikgewogICAgICByZXR1cm47CiAgICB9CiAgICB0cnkgewogICAgICByZXNvbHZlcihkYXRhKTsKICAgIH0gZmluYWxseSB7CiAgICAgIHBlbmRpbmdMaXN0ZW5lcnMuZGVsZXRlKGRhdGEuaWQpOwogICAgfQogIH0pOwogIHJldHVybiBjcmVhdGVQcm94eShlcCwgcGVuZGluZ0xpc3RlbmVycywgW10sIHRhcmdldCk7Cn0KZnVuY3Rpb24gdGhyb3dJZlByb3h5UmVsZWFzZWQoaXNSZWxlYXNlZCkgewogIGlmIChpc1JlbGVhc2VkKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3h5IGhhcyBiZWVuIHJlbGVhc2VkIGFuZCBpcyBub3QgdXNlYWJsZSIpOwogIH0KfQpmdW5jdGlvbiByZWxlYXNlRW5kcG9pbnQoZXApIHsKICByZXR1cm4gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwgLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSwgewogICAgdHlwZTogIlJFTEVBU0UiCiAgfSkudGhlbigoKSA9PiB7CiAgICBjbG9zZUVuZFBvaW50KGVwKTsKICB9KTsKfQpjb25zdCBwcm94eUNvdW50ZXIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKY29uc3QgcHJveHlGaW5hbGl6ZXJzID0gIkZpbmFsaXphdGlvblJlZ2lzdHJ5IiBpbiBnbG9iYWxUaGlzICYmIG5ldyBGaW5hbGl6YXRpb25SZWdpc3RyeSgoZXApID0+IHsKICBjb25zdCBuZXdDb3VudCA9IChwcm94eUNvdW50ZXIuZ2V0KGVwKSB8fCAwKSAtIDE7CiAgcHJveHlDb3VudGVyLnNldChlcCwgbmV3Q291bnQpOwogIGlmIChuZXdDb3VudCA9PT0gMCkgewogICAgcmVsZWFzZUVuZHBvaW50KGVwKTsKICB9Cn0pOwpmdW5jdGlvbiByZWdpc3RlclByb3h5KHByb3h5MiwgZXApIHsKICBjb25zdCBuZXdDb3VudCA9IChwcm94eUNvdW50ZXIuZ2V0KGVwKSB8fCAwKSArIDE7CiAgcHJveHlDb3VudGVyLnNldChlcCwgbmV3Q291bnQpOwogIGlmIChwcm94eUZpbmFsaXplcnMpIHsKICAgIHByb3h5RmluYWxpemVycy5yZWdpc3Rlcihwcm94eTIsIGVwLCBwcm94eTIpOwogIH0KfQpmdW5jdGlvbiB1bnJlZ2lzdGVyUHJveHkocHJveHkyKSB7CiAgaWYgKHByb3h5RmluYWxpemVycykgewogICAgcHJveHlGaW5hbGl6ZXJzLnVucmVnaXN0ZXIocHJveHkyKTsKICB9Cn0KZnVuY3Rpb24gY3JlYXRlUHJveHkoZXAsIHBlbmRpbmdMaXN0ZW5lcnMsIHBhdGggPSBbXSwgdGFyZ2V0ID0gZnVuY3Rpb24oKSB7Cn0pIHsKICBsZXQgaXNQcm94eVJlbGVhc2VkID0gZmFsc2U7CiAgY29uc3QgcHJveHkyID0gbmV3IFByb3h5KHRhcmdldCwgewogICAgZ2V0KF90YXJnZXQsIHByb3ApIHsKICAgICAgdGhyb3dJZlByb3h5UmVsZWFzZWQoaXNQcm94eVJlbGVhc2VkKTsKICAgICAgaWYgKHByb3AgPT09IHJlbGVhc2VQcm94eSkgewogICAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgICB1bnJlZ2lzdGVyUHJveHkocHJveHkyKTsKICAgICAgICAgIHJlbGVhc2VFbmRwb2ludChlcCk7CiAgICAgICAgICBwZW5kaW5nTGlzdGVuZXJzLmNsZWFyKCk7CiAgICAgICAgICBpc1Byb3h5UmVsZWFzZWQgPSB0cnVlOwogICAgICAgIH07CiAgICAgIH0KICAgICAgaWYgKHByb3AgPT09ICJ0aGVuIikgewogICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIHsgdGhlbjogKCkgPT4gcHJveHkyIH07CiAgICAgICAgfQogICAgICAgIGNvbnN0IHIgPSByZXF1ZXN0UmVzcG9uc2VNZXNzYWdlKGVwLCBwZW5kaW5nTGlzdGVuZXJzLCB7CiAgICAgICAgICB0eXBlOiAiR0VUIiwKICAgICAgICAgIHBhdGg6IHBhdGgubWFwKChwKSA9PiBwLnRvU3RyaW5nKCkpCiAgICAgICAgfSkudGhlbihmcm9tV2lyZVZhbHVlKTsKICAgICAgICByZXR1cm4gci50aGVuLmJpbmQocik7CiAgICAgIH0KICAgICAgcmV0dXJuIGNyZWF0ZVByb3h5KGVwLCBwZW5kaW5nTGlzdGVuZXJzLCBbLi4ucGF0aCwgcHJvcF0pOwogICAgfSwKICAgIHNldChfdGFyZ2V0LCBwcm9wLCByYXdWYWx1ZSkgewogICAgICB0aHJvd0lmUHJveHlSZWxlYXNlZChpc1Byb3h5UmVsZWFzZWQpOwogICAgICBjb25zdCBbdmFsdWUsIHRyYW5zZmVyYWJsZXNdID0gdG9XaXJlVmFsdWUocmF3VmFsdWUpOwogICAgICByZXR1cm4gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwgcGVuZGluZ0xpc3RlbmVycywgewogICAgICAgIHR5cGU6ICJTRVQiLAogICAgICAgIHBhdGg6IFsuLi5wYXRoLCBwcm9wXS5tYXAoKHApID0+IHAudG9TdHJpbmcoKSksCiAgICAgICAgdmFsdWUKICAgICAgfSwgdHJhbnNmZXJhYmxlcykudGhlbihmcm9tV2lyZVZhbHVlKTsKICAgIH0sCiAgICBhcHBseShfdGFyZ2V0LCBfdGhpc0FyZywgcmF3QXJndW1lbnRMaXN0KSB7CiAgICAgIHRocm93SWZQcm94eVJlbGVhc2VkKGlzUHJveHlSZWxlYXNlZCk7CiAgICAgIGNvbnN0IGxhc3QgPSBwYXRoW3BhdGgubGVuZ3RoIC0gMV07CiAgICAgIGlmIChsYXN0ID09PSBjcmVhdGVFbmRwb2ludCkgewogICAgICAgIHJldHVybiByZXF1ZXN0UmVzcG9uc2VNZXNzYWdlKGVwLCBwZW5kaW5nTGlzdGVuZXJzLCB7CiAgICAgICAgICB0eXBlOiAiRU5EUE9JTlQiCiAgICAgICAgfSkudGhlbihmcm9tV2lyZVZhbHVlKTsKICAgICAgfQogICAgICBpZiAobGFzdCA9PT0gImJpbmQiKSB7CiAgICAgICAgcmV0dXJuIGNyZWF0ZVByb3h5KGVwLCBwZW5kaW5nTGlzdGVuZXJzLCBwYXRoLnNsaWNlKDAsIC0xKSk7CiAgICAgIH0KICAgICAgY29uc3QgW2FyZ3VtZW50TGlzdCwgdHJhbnNmZXJhYmxlc10gPSBwcm9jZXNzQXJndW1lbnRzKHJhd0FyZ3VtZW50TGlzdCk7CiAgICAgIHJldHVybiByZXF1ZXN0UmVzcG9uc2VNZXNzYWdlKGVwLCBwZW5kaW5nTGlzdGVuZXJzLCB7CiAgICAgICAgdHlwZTogIkFQUExZIiwKICAgICAgICBwYXRoOiBwYXRoLm1hcCgocCkgPT4gcC50b1N0cmluZygpKSwKICAgICAgICBhcmd1bWVudExpc3QKICAgICAgfSwgdHJhbnNmZXJhYmxlcykudGhlbihmcm9tV2lyZVZhbHVlKTsKICAgIH0sCiAgICBjb25zdHJ1Y3QoX3RhcmdldCwgcmF3QXJndW1lbnRMaXN0KSB7CiAgICAgIHRocm93SWZQcm94eVJlbGVhc2VkKGlzUHJveHlSZWxlYXNlZCk7CiAgICAgIGNvbnN0IFthcmd1bWVudExpc3QsIHRyYW5zZmVyYWJsZXNdID0gcHJvY2Vzc0FyZ3VtZW50cyhyYXdBcmd1bWVudExpc3QpOwogICAgICByZXR1cm4gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwgcGVuZGluZ0xpc3RlbmVycywgewogICAgICAgIHR5cGU6ICJDT05TVFJVQ1QiLAogICAgICAgIHBhdGg6IHBhdGgubWFwKChwKSA9PiBwLnRvU3RyaW5nKCkpLAogICAgICAgIGFyZ3VtZW50TGlzdAogICAgICB9LCB0cmFuc2ZlcmFibGVzKS50aGVuKGZyb21XaXJlVmFsdWUpOwogICAgfQogIH0pOwogIHJlZ2lzdGVyUHJveHkocHJveHkyLCBlcCk7CiAgcmV0dXJuIHByb3h5MjsKfQpmdW5jdGlvbiBteUZsYXQoYXJyKSB7CiAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sIGFycik7Cn0KZnVuY3Rpb24gcHJvY2Vzc0FyZ3VtZW50cyhhcmd1bWVudExpc3QpIHsKICBjb25zdCBwcm9jZXNzZWQgPSBhcmd1bWVudExpc3QubWFwKHRvV2lyZVZhbHVlKTsKICByZXR1cm4gW3Byb2Nlc3NlZC5tYXAoKHYpID0+IHZbMF0pLCBteUZsYXQocHJvY2Vzc2VkLm1hcCgodikgPT4gdlsxXSkpXTsKfQpjb25zdCB0cmFuc2ZlckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CmZ1bmN0aW9uIHRyYW5zZmVyKG9iaiwgdHJhbnNmZXJzKSB7CiAgdHJhbnNmZXJDYWNoZS5zZXQob2JqLCB0cmFuc2ZlcnMpOwogIHJldHVybiBvYmo7Cn0KZnVuY3Rpb24gcHJveHkob2JqKSB7CiAgcmV0dXJuIE9iamVjdC5hc3NpZ24ob2JqLCB7IFtwcm94eU1hcmtlcl06IHRydWUgfSk7Cn0KZnVuY3Rpb24gdG9XaXJlVmFsdWUodmFsdWUpIHsKICBmb3IgKGNvbnN0IFtuYW1lLCBoYW5kbGVyXSBvZiB0cmFuc2ZlckhhbmRsZXJzKSB7CiAgICBpZiAoaGFuZGxlci5jYW5IYW5kbGUodmFsdWUpKSB7CiAgICAgIGNvbnN0IFtzZXJpYWxpemVkVmFsdWUsIHRyYW5zZmVyYWJsZXNdID0gaGFuZGxlci5zZXJpYWxpemUodmFsdWUpOwogICAgICByZXR1cm4gWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJIQU5ETEVSIiwKICAgICAgICAgIG5hbWUsCiAgICAgICAgICB2YWx1ZTogc2VyaWFsaXplZFZhbHVlCiAgICAgICAgfSwKICAgICAgICB0cmFuc2ZlcmFibGVzCiAgICAgIF07CiAgICB9CiAgfQogIHJldHVybiBbCiAgICB7CiAgICAgIHR5cGU6ICJSQVciLAogICAgICB2YWx1ZQogICAgfSwKICAgIHRyYW5zZmVyQ2FjaGUuZ2V0KHZhbHVlKSB8fCBbXQogIF07Cn0KZnVuY3Rpb24gZnJvbVdpcmVWYWx1ZSh2YWx1ZSkgewogIHN3aXRjaCAodmFsdWUudHlwZSkgewogICAgY2FzZSAiSEFORExFUiI6CiAgICAgIHJldHVybiB0cmFuc2ZlckhhbmRsZXJzLmdldCh2YWx1ZS5uYW1lKS5kZXNlcmlhbGl6ZSh2YWx1ZS52YWx1ZSk7CiAgICBjYXNlICJSQVciOgogICAgICByZXR1cm4gdmFsdWUudmFsdWU7CiAgfQp9CmZ1bmN0aW9uIHJlcXVlc3RSZXNwb25zZU1lc3NhZ2UoZXAsIHBlbmRpbmdMaXN0ZW5lcnMsIG1zZywgdHJhbnNmZXJzKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICBjb25zdCBpZCA9IGdlbmVyYXRlVVVJRCgpOwogICAgcGVuZGluZ0xpc3RlbmVycy5zZXQoaWQsIHJlc29sdmUpOwogICAgaWYgKGVwLnN0YXJ0KSB7CiAgICAgIGVwLnN0YXJ0KCk7CiAgICB9CiAgICBlcC5wb3N0TWVzc2FnZShPYmplY3QuYXNzaWduKHsgaWQgfSwgbXNnKSwgdHJhbnNmZXJzKTsKICB9KTsKfQpmdW5jdGlvbiBnZW5lcmF0ZVVVSUQoKSB7CiAgcmV0dXJuIG5ldyBBcnJheSg0KS5maWxsKDApLm1hcCgoKSA9PiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikudG9TdHJpbmcoMTYpKS5qb2luKCItIik7Cn0KYXN5bmMgZnVuY3Rpb24gZmV0Y2hVcmwoaW5wdXQsIGluaXQsIGZldGNoRm4pIHsKICBsZXQgcmVzcG9uc2U7CiAgaWYgKHR5cGVvZiBmZXRjaEZuID09PSAiZnVuY3Rpb24iKSB7CiAgICByZXNwb25zZSA9IGF3YWl0IGZldGNoRm4oaW5wdXQsIGluaXQpOwogIH0gZWxzZSB7CiAgICByZXNwb25zZSA9IGF3YWl0IGZldGNoKGlucHV0LCBpbml0KTsKICB9CiAgaWYgKCFyZXNwb25zZS5vaykgewogICAgY29uc3QganNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgIGlmIChqc29uICYmIGpzb24uZXJyb3IpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGpzb24uZXJyb3IpOwogICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXNUZXh0KSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihyZXNwb25zZS5zdGF0dXNUZXh0KTsKICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGBOb3QgZm91bmQ6ICR7aW5wdXR9ICg0MDQpYCk7CiAgICB9IGVsc2UgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNTAwKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiSW50ZXJuYWwgc2VydmVyIGVycm9yICg1MDApIik7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaDogJHtpbnB1dH0gKCR7cmVzcG9uc2Uuc3RhdHVzfSlgKTsKICAgIH0KICB9CiAgcmV0dXJuIHJlc3BvbnNlOwp9CmNvbnN0IGZldGNoQW5kR2V0SW1hZ2VEYXRhV29ya2VyID0gewogIGFzeW5jIGdldEltYWdlRGF0YSh0aWxlVXJsLCBvbkFib3J0LCBmZXRjaEZuLCB3aWR0aCwgaGVpZ2h0KSB7CiAgICBjb25zdCB3b3JrZXJBYm9ydENvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7CiAgICBvbkFib3J0KCk7CiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoVXJsKAogICAgICB0aWxlVXJsLAogICAgICB7CiAgICAgICAgc2lnbmFsOiB3b3JrZXJBYm9ydENvbnRyb2xsZXIuc2lnbmFsCiAgICAgIH0sCiAgICAgIGZldGNoRm4KICAgICk7CiAgICBjb25zdCBibG9iID0gYXdhaXQgcmVzcG9uc2UuYmxvYigpOwogICAgY29uc3QgaW1hZ2VCaXRtYXAgPSBhd2FpdCBjcmVhdGVJbWFnZUJpdG1hcChibG9iLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgIGNvbnN0IGNhbnZhcyA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7CiAgICBjb25zdCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICBpZiAoIWNvbnRleHQpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJDb3VsZCBub3QgY3JlYXRlIE9mZnNjcmVlbkNhbnZhcyBjb250ZXh0Iik7CiAgICB9CiAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZUJpdG1hcCwgMCwgMCk7CiAgICBjb25zdCBpbWFnZURhdGEgPSBjb250ZXh0LmdldEltYWdlRGF0YSgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgIHJldHVybiB0cmFuc2ZlcihpbWFnZURhdGEsIFtpbWFnZURhdGEuZGF0YS5idWZmZXJdKTsKICB9Cn07CmV4cG9zZShmZXRjaEFuZEdldEltYWdlRGF0YVdvcmtlcik7Ci8vIyBzb3VyY2VNYXBwaW5nVVJMPWZldGNoLWFuZC1nZXQtaW1hZ2UtZGF0YS1CQzRZc0lHNy5qcy5tYXAK",zZ=e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0)),r8=typeof self<"u"&&self.Blob&&new Blob(["URL.revokeObjectURL(import.meta.url);",zZ(X5)],{type:"text/javascript;charset=utf-8"});function FZ(e){let t;try{if(t=r8&&(self.URL||self.webkitURL).createObjectURL(r8),!t)throw"";const i=new Worker(t,{type:"module",name:e==null?void 0:e.name});return i.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),i}catch{return new Worker("data:text/javascript;base64,"+X5,{type:"module",name:e==null?void 0:e.name})}}const q5="LyoqCiAqIEBsaWNlbnNlCiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTEMKICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEFwYWNoZS0yLjAKICovCmNvbnN0IHByb3h5TWFya2VyID0gU3ltYm9sKCJDb21saW5rLnByb3h5Iik7CmNvbnN0IGNyZWF0ZUVuZHBvaW50ID0gU3ltYm9sKCJDb21saW5rLmVuZHBvaW50Iik7CmNvbnN0IHJlbGVhc2VQcm94eSA9IFN5bWJvbCgiQ29tbGluay5yZWxlYXNlUHJveHkiKTsKY29uc3QgZmluYWxpemVyID0gU3ltYm9sKCJDb21saW5rLmZpbmFsaXplciIpOwpjb25zdCB0aHJvd01hcmtlciA9IFN5bWJvbCgiQ29tbGluay50aHJvd24iKTsKY29uc3QgaXNPYmplY3QgPSAodmFsKSA9PiB0eXBlb2YgdmFsID09PSAib2JqZWN0IiAmJiB2YWwgIT09IG51bGwgfHwgdHlwZW9mIHZhbCA9PT0gImZ1bmN0aW9uIjsKY29uc3QgcHJveHlUcmFuc2ZlckhhbmRsZXIgPSB7CiAgY2FuSGFuZGxlOiAodmFsKSA9PiBpc09iamVjdCh2YWwpICYmIHZhbFtwcm94eU1hcmtlcl0sCiAgc2VyaWFsaXplKG9iaikgewogICAgY29uc3QgeyBwb3J0MSwgcG9ydDIgfSA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpOwogICAgZXhwb3NlKG9iaiwgcG9ydDEpOwogICAgcmV0dXJuIFtwb3J0MiwgW3BvcnQyXV07CiAgfSwKICBkZXNlcmlhbGl6ZShwb3J0KSB7CiAgICBwb3J0LnN0YXJ0KCk7CiAgICByZXR1cm4gd3JhcChwb3J0KTsKICB9Cn07CmNvbnN0IHRocm93VHJhbnNmZXJIYW5kbGVyID0gewogIGNhbkhhbmRsZTogKHZhbHVlKSA9PiBpc09iamVjdCh2YWx1ZSkgJiYgdGhyb3dNYXJrZXIgaW4gdmFsdWUsCiAgc2VyaWFsaXplKHsgdmFsdWUgfSkgewogICAgbGV0IHNlcmlhbGl6ZWQ7CiAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBFcnJvcikgewogICAgICBzZXJpYWxpemVkID0gewogICAgICAgIGlzRXJyb3I6IHRydWUsCiAgICAgICAgdmFsdWU6IHsKICAgICAgICAgIG1lc3NhZ2U6IHZhbHVlLm1lc3NhZ2UsCiAgICAgICAgICBuYW1lOiB2YWx1ZS5uYW1lLAogICAgICAgICAgc3RhY2s6IHZhbHVlLnN0YWNrCiAgICAgICAgfQogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgc2VyaWFsaXplZCA9IHsgaXNFcnJvcjogZmFsc2UsIHZhbHVlIH07CiAgICB9CiAgICByZXR1cm4gW3NlcmlhbGl6ZWQsIFtdXTsKICB9LAogIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWQpIHsKICAgIGlmIChzZXJpYWxpemVkLmlzRXJyb3IpIHsKICAgICAgdGhyb3cgT2JqZWN0LmFzc2lnbihuZXcgRXJyb3Ioc2VyaWFsaXplZC52YWx1ZS5tZXNzYWdlKSwgc2VyaWFsaXplZC52YWx1ZSk7CiAgICB9CiAgICB0aHJvdyBzZXJpYWxpemVkLnZhbHVlOwogIH0KfTsKY29uc3QgdHJhbnNmZXJIYW5kbGVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKFsKICBbInByb3h5IiwgcHJveHlUcmFuc2ZlckhhbmRsZXJdLAogIFsidGhyb3ciLCB0aHJvd1RyYW5zZmVySGFuZGxlcl0KXSk7CmZ1bmN0aW9uIGlzQWxsb3dlZE9yaWdpbihhbGxvd2VkT3JpZ2lucywgb3JpZ2luKSB7CiAgZm9yIChjb25zdCBhbGxvd2VkT3JpZ2luIG9mIGFsbG93ZWRPcmlnaW5zKSB7CiAgICBpZiAob3JpZ2luID09PSBhbGxvd2VkT3JpZ2luIHx8IGFsbG93ZWRPcmlnaW4gPT09ICIqIikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGlmIChhbGxvd2VkT3JpZ2luIGluc3RhbmNlb2YgUmVnRXhwICYmIGFsbG93ZWRPcmlnaW4udGVzdChvcmlnaW4pKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0KICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gZXhwb3NlKG9iaiwgZXAgPSBnbG9iYWxUaGlzLCBhbGxvd2VkT3JpZ2lucyA9IFsiKiJdKSB7CiAgZXAuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGZ1bmN0aW9uIGNhbGxiYWNrKGV2KSB7CiAgICBpZiAoIWV2IHx8ICFldi5kYXRhKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICghaXNBbGxvd2VkT3JpZ2luKGFsbG93ZWRPcmlnaW5zLCBldi5vcmlnaW4pKSB7CiAgICAgIGNvbnNvbGUud2FybihgSW52YWxpZCBvcmlnaW4gJyR7ZXYub3JpZ2lufScgZm9yIGNvbWxpbmsgcHJveHlgKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgY29uc3QgeyBpZCwgdHlwZSwgcGF0aCB9ID0gT2JqZWN0LmFzc2lnbih7IHBhdGg6IFtdIH0sIGV2LmRhdGEpOwogICAgY29uc3QgYXJndW1lbnRMaXN0ID0gKGV2LmRhdGEuYXJndW1lbnRMaXN0IHx8IFtdKS5tYXAoZnJvbVdpcmVWYWx1ZSk7CiAgICBsZXQgcmV0dXJuVmFsdWU7CiAgICB0cnkgewogICAgICBjb25zdCBwYXJlbnQgPSBwYXRoLnNsaWNlKDAsIC0xKS5yZWR1Y2UoKG9iajIsIHByb3ApID0+IG9iajJbcHJvcF0sIG9iaik7CiAgICAgIGNvbnN0IHJhd1ZhbHVlID0gcGF0aC5yZWR1Y2UoKG9iajIsIHByb3ApID0+IG9iajJbcHJvcF0sIG9iaik7CiAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgIGNhc2UgIkdFVCI6CiAgICAgICAgICB7CiAgICAgICAgICAgIHJldHVyblZhbHVlID0gcmF3VmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJTRVQiOgogICAgICAgICAgewogICAgICAgICAgICBwYXJlbnRbcGF0aC5zbGljZSgtMSlbMF1dID0gZnJvbVdpcmVWYWx1ZShldi5kYXRhLnZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiQVBQTFkiOgogICAgICAgICAgewogICAgICAgICAgICByZXR1cm5WYWx1ZSA9IHJhd1ZhbHVlLmFwcGx5KHBhcmVudCwgYXJndW1lbnRMaXN0KTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgIkNPTlNUUlVDVCI6CiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV3IHJhd1ZhbHVlKC4uLmFyZ3VtZW50TGlzdCk7CiAgICAgICAgICAgIHJldHVyblZhbHVlID0gcHJveHkodmFsdWUpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAiRU5EUE9JTlQiOgogICAgICAgICAgewogICAgICAgICAgICBjb25zdCB7IHBvcnQxLCBwb3J0MiB9ID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7CiAgICAgICAgICAgIGV4cG9zZShvYmosIHBvcnQyKTsKICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSB0cmFuc2Zlcihwb3J0MSwgW3BvcnQxXSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJSRUxFQVNFIjoKICAgICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuVmFsdWUgPSB2b2lkIDA7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9IGNhdGNoICh2YWx1ZSkgewogICAgICByZXR1cm5WYWx1ZSA9IHsgdmFsdWUsIFt0aHJvd01hcmtlcl06IDAgfTsKICAgIH0KICAgIFByb21pc2UucmVzb2x2ZShyZXR1cm5WYWx1ZSkuY2F0Y2goKHZhbHVlKSA9PiB7CiAgICAgIHJldHVybiB7IHZhbHVlLCBbdGhyb3dNYXJrZXJdOiAwIH07CiAgICB9KS50aGVuKChyZXR1cm5WYWx1ZTIpID0+IHsKICAgICAgY29uc3QgW3dpcmVWYWx1ZSwgdHJhbnNmZXJhYmxlc10gPSB0b1dpcmVWYWx1ZShyZXR1cm5WYWx1ZTIpOwogICAgICBlcC5wb3N0TWVzc2FnZShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHdpcmVWYWx1ZSksIHsgaWQgfSksIHRyYW5zZmVyYWJsZXMpOwogICAgICBpZiAodHlwZSA9PT0gIlJFTEVBU0UiKSB7CiAgICAgICAgZXAucmVtb3ZlRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIGNhbGxiYWNrKTsKICAgICAgICBjbG9zZUVuZFBvaW50KGVwKTsKICAgICAgICBpZiAoZmluYWxpemVyIGluIG9iaiAmJiB0eXBlb2Ygb2JqW2ZpbmFsaXplcl0gPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgIG9ialtmaW5hbGl6ZXJdKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgY29uc3QgW3dpcmVWYWx1ZSwgdHJhbnNmZXJhYmxlc10gPSB0b1dpcmVWYWx1ZSh7CiAgICAgICAgdmFsdWU6IG5ldyBUeXBlRXJyb3IoIlVuc2VyaWFsaXphYmxlIHJldHVybiB2YWx1ZSIpLAogICAgICAgIFt0aHJvd01hcmtlcl06IDAKICAgICAgfSk7CiAgICAgIGVwLnBvc3RNZXNzYWdlKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgd2lyZVZhbHVlKSwgeyBpZCB9KSwgdHJhbnNmZXJhYmxlcyk7CiAgICB9KTsKICB9KTsKICBpZiAoZXAuc3RhcnQpIHsKICAgIGVwLnN0YXJ0KCk7CiAgfQp9CmZ1bmN0aW9uIGlzTWVzc2FnZVBvcnQoZW5kcG9pbnQpIHsKICByZXR1cm4gZW5kcG9pbnQuY29uc3RydWN0b3IubmFtZSA9PT0gIk1lc3NhZ2VQb3J0IjsKfQpmdW5jdGlvbiBjbG9zZUVuZFBvaW50KGVuZHBvaW50KSB7CiAgaWYgKGlzTWVzc2FnZVBvcnQoZW5kcG9pbnQpKQogICAgZW5kcG9pbnQuY2xvc2UoKTsKfQpmdW5jdGlvbiB3cmFwKGVwLCB0YXJnZXQpIHsKICBjb25zdCBwZW5kaW5nTGlzdGVuZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBlcC5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgZnVuY3Rpb24gaGFuZGxlTWVzc2FnZShldikgewogICAgY29uc3QgeyBkYXRhIH0gPSBldjsKICAgIGlmICghZGF0YSB8fCAhZGF0YS5pZCkgewogICAgICByZXR1cm47CiAgICB9CiAgICBjb25zdCByZXNvbHZlciA9IHBlbmRpbmdMaXN0ZW5lcnMuZ2V0KGRhdGEuaWQpOwogICAgaWYgKCFyZXNvbHZlcikgewogICAgICByZXR1cm47CiAgICB9CiAgICB0cnkgewogICAgICByZXNvbHZlcihkYXRhKTsKICAgIH0gZmluYWxseSB7CiAgICAgIHBlbmRpbmdMaXN0ZW5lcnMuZGVsZXRlKGRhdGEuaWQpOwogICAgfQogIH0pOwogIHJldHVybiBjcmVhdGVQcm94eShlcCwgcGVuZGluZ0xpc3RlbmVycywgW10sIHRhcmdldCk7Cn0KZnVuY3Rpb24gdGhyb3dJZlByb3h5UmVsZWFzZWQoaXNSZWxlYXNlZCkgewogIGlmIChpc1JlbGVhc2VkKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoIlByb3h5IGhhcyBiZWVuIHJlbGVhc2VkIGFuZCBpcyBub3QgdXNlYWJsZSIpOwogIH0KfQpmdW5jdGlvbiByZWxlYXNlRW5kcG9pbnQoZXApIHsKICByZXR1cm4gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwgLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKSwgewogICAgdHlwZTogIlJFTEVBU0UiCiAgfSkudGhlbigoKSA9PiB7CiAgICBjbG9zZUVuZFBvaW50KGVwKTsKICB9KTsKfQpjb25zdCBwcm94eUNvdW50ZXIgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKTsKY29uc3QgcHJveHlGaW5hbGl6ZXJzID0gIkZpbmFsaXphdGlvblJlZ2lzdHJ5IiBpbiBnbG9iYWxUaGlzICYmIG5ldyBGaW5hbGl6YXRpb25SZWdpc3RyeSgoZXApID0+IHsKICBjb25zdCBuZXdDb3VudCA9IChwcm94eUNvdW50ZXIuZ2V0KGVwKSB8fCAwKSAtIDE7CiAgcHJveHlDb3VudGVyLnNldChlcCwgbmV3Q291bnQpOwogIGlmIChuZXdDb3VudCA9PT0gMCkgewogICAgcmVsZWFzZUVuZHBvaW50KGVwKTsKICB9Cn0pOwpmdW5jdGlvbiByZWdpc3RlclByb3h5KHByb3h5MiwgZXApIHsKICBjb25zdCBuZXdDb3VudCA9IChwcm94eUNvdW50ZXIuZ2V0KGVwKSB8fCAwKSArIDE7CiAgcHJveHlDb3VudGVyLnNldChlcCwgbmV3Q291bnQpOwogIGlmIChwcm94eUZpbmFsaXplcnMpIHsKICAgIHByb3h5RmluYWxpemVycy5yZWdpc3Rlcihwcm94eTIsIGVwLCBwcm94eTIpOwogIH0KfQpmdW5jdGlvbiB1bnJlZ2lzdGVyUHJveHkocHJveHkyKSB7CiAgaWYgKHByb3h5RmluYWxpemVycykgewogICAgcHJveHlGaW5hbGl6ZXJzLnVucmVnaXN0ZXIocHJveHkyKTsKICB9Cn0KZnVuY3Rpb24gY3JlYXRlUHJveHkoZXAsIHBlbmRpbmdMaXN0ZW5lcnMsIHBhdGggPSBbXSwgdGFyZ2V0ID0gZnVuY3Rpb24oKSB7Cn0pIHsKICBsZXQgaXNQcm94eVJlbGVhc2VkID0gZmFsc2U7CiAgY29uc3QgcHJveHkyID0gbmV3IFByb3h5KHRhcmdldCwgewogICAgZ2V0KF90YXJnZXQsIHByb3ApIHsKICAgICAgdGhyb3dJZlByb3h5UmVsZWFzZWQoaXNQcm94eVJlbGVhc2VkKTsKICAgICAgaWYgKHByb3AgPT09IHJlbGVhc2VQcm94eSkgewogICAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgICB1bnJlZ2lzdGVyUHJveHkocHJveHkyKTsKICAgICAgICAgIHJlbGVhc2VFbmRwb2ludChlcCk7CiAgICAgICAgICBwZW5kaW5nTGlzdGVuZXJzLmNsZWFyKCk7CiAgICAgICAgICBpc1Byb3h5UmVsZWFzZWQgPSB0cnVlOwogICAgICAgIH07CiAgICAgIH0KICAgICAgaWYgKHByb3AgPT09ICJ0aGVuIikgewogICAgICAgIGlmIChwYXRoLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIHsgdGhlbjogKCkgPT4gcHJveHkyIH07CiAgICAgICAgfQogICAgICAgIGNvbnN0IHIgPSByZXF1ZXN0UmVzcG9uc2VNZXNzYWdlKGVwLCBwZW5kaW5nTGlzdGVuZXJzLCB7CiAgICAgICAgICB0eXBlOiAiR0VUIiwKICAgICAgICAgIHBhdGg6IHBhdGgubWFwKChwKSA9PiBwLnRvU3RyaW5nKCkpCiAgICAgICAgfSkudGhlbihmcm9tV2lyZVZhbHVlKTsKICAgICAgICByZXR1cm4gci50aGVuLmJpbmQocik7CiAgICAgIH0KICAgICAgcmV0dXJuIGNyZWF0ZVByb3h5KGVwLCBwZW5kaW5nTGlzdGVuZXJzLCBbLi4ucGF0aCwgcHJvcF0pOwogICAgfSwKICAgIHNldChfdGFyZ2V0LCBwcm9wLCByYXdWYWx1ZSkgewogICAgICB0aHJvd0lmUHJveHlSZWxlYXNlZChpc1Byb3h5UmVsZWFzZWQpOwogICAgICBjb25zdCBbdmFsdWUsIHRyYW5zZmVyYWJsZXNdID0gdG9XaXJlVmFsdWUocmF3VmFsdWUpOwogICAgICByZXR1cm4gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwgcGVuZGluZ0xpc3RlbmVycywgewogICAgICAgIHR5cGU6ICJTRVQiLAogICAgICAgIHBhdGg6IFsuLi5wYXRoLCBwcm9wXS5tYXAoKHApID0+IHAudG9TdHJpbmcoKSksCiAgICAgICAgdmFsdWUKICAgICAgfSwgdHJhbnNmZXJhYmxlcykudGhlbihmcm9tV2lyZVZhbHVlKTsKICAgIH0sCiAgICBhcHBseShfdGFyZ2V0LCBfdGhpc0FyZywgcmF3QXJndW1lbnRMaXN0KSB7CiAgICAgIHRocm93SWZQcm94eVJlbGVhc2VkKGlzUHJveHlSZWxlYXNlZCk7CiAgICAgIGNvbnN0IGxhc3QgPSBwYXRoW3BhdGgubGVuZ3RoIC0gMV07CiAgICAgIGlmIChsYXN0ID09PSBjcmVhdGVFbmRwb2ludCkgewogICAgICAgIHJldHVybiByZXF1ZXN0UmVzcG9uc2VNZXNzYWdlKGVwLCBwZW5kaW5nTGlzdGVuZXJzLCB7CiAgICAgICAgICB0eXBlOiAiRU5EUE9JTlQiCiAgICAgICAgfSkudGhlbihmcm9tV2lyZVZhbHVlKTsKICAgICAgfQogICAgICBpZiAobGFzdCA9PT0gImJpbmQiKSB7CiAgICAgICAgcmV0dXJuIGNyZWF0ZVByb3h5KGVwLCBwZW5kaW5nTGlzdGVuZXJzLCBwYXRoLnNsaWNlKDAsIC0xKSk7CiAgICAgIH0KICAgICAgY29uc3QgW2FyZ3VtZW50TGlzdCwgdHJhbnNmZXJhYmxlc10gPSBwcm9jZXNzQXJndW1lbnRzKHJhd0FyZ3VtZW50TGlzdCk7CiAgICAgIHJldHVybiByZXF1ZXN0UmVzcG9uc2VNZXNzYWdlKGVwLCBwZW5kaW5nTGlzdGVuZXJzLCB7CiAgICAgICAgdHlwZTogIkFQUExZIiwKICAgICAgICBwYXRoOiBwYXRoLm1hcCgocCkgPT4gcC50b1N0cmluZygpKSwKICAgICAgICBhcmd1bWVudExpc3QKICAgICAgfSwgdHJhbnNmZXJhYmxlcykudGhlbihmcm9tV2lyZVZhbHVlKTsKICAgIH0sCiAgICBjb25zdHJ1Y3QoX3RhcmdldCwgcmF3QXJndW1lbnRMaXN0KSB7CiAgICAgIHRocm93SWZQcm94eVJlbGVhc2VkKGlzUHJveHlSZWxlYXNlZCk7CiAgICAgIGNvbnN0IFthcmd1bWVudExpc3QsIHRyYW5zZmVyYWJsZXNdID0gcHJvY2Vzc0FyZ3VtZW50cyhyYXdBcmd1bWVudExpc3QpOwogICAgICByZXR1cm4gcmVxdWVzdFJlc3BvbnNlTWVzc2FnZShlcCwgcGVuZGluZ0xpc3RlbmVycywgewogICAgICAgIHR5cGU6ICJDT05TVFJVQ1QiLAogICAgICAgIHBhdGg6IHBhdGgubWFwKChwKSA9PiBwLnRvU3RyaW5nKCkpLAogICAgICAgIGFyZ3VtZW50TGlzdAogICAgICB9LCB0cmFuc2ZlcmFibGVzKS50aGVuKGZyb21XaXJlVmFsdWUpOwogICAgfQogIH0pOwogIHJlZ2lzdGVyUHJveHkocHJveHkyLCBlcCk7CiAgcmV0dXJuIHByb3h5MjsKfQpmdW5jdGlvbiBteUZsYXQoYXJyKSB7CiAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5jb25jYXQuYXBwbHkoW10sIGFycik7Cn0KZnVuY3Rpb24gcHJvY2Vzc0FyZ3VtZW50cyhhcmd1bWVudExpc3QpIHsKICBjb25zdCBwcm9jZXNzZWQgPSBhcmd1bWVudExpc3QubWFwKHRvV2lyZVZhbHVlKTsKICByZXR1cm4gW3Byb2Nlc3NlZC5tYXAoKHYpID0+IHZbMF0pLCBteUZsYXQocHJvY2Vzc2VkLm1hcCgodikgPT4gdlsxXSkpXTsKfQpjb25zdCB0cmFuc2ZlckNhY2hlID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7CmZ1bmN0aW9uIHRyYW5zZmVyKG9iaiwgdHJhbnNmZXJzKSB7CiAgdHJhbnNmZXJDYWNoZS5zZXQob2JqLCB0cmFuc2ZlcnMpOwogIHJldHVybiBvYmo7Cn0KZnVuY3Rpb24gcHJveHkob2JqKSB7CiAgcmV0dXJuIE9iamVjdC5hc3NpZ24ob2JqLCB7IFtwcm94eU1hcmtlcl06IHRydWUgfSk7Cn0KZnVuY3Rpb24gdG9XaXJlVmFsdWUodmFsdWUpIHsKICBmb3IgKGNvbnN0IFtuYW1lLCBoYW5kbGVyXSBvZiB0cmFuc2ZlckhhbmRsZXJzKSB7CiAgICBpZiAoaGFuZGxlci5jYW5IYW5kbGUodmFsdWUpKSB7CiAgICAgIGNvbnN0IFtzZXJpYWxpemVkVmFsdWUsIHRyYW5zZmVyYWJsZXNdID0gaGFuZGxlci5zZXJpYWxpemUodmFsdWUpOwogICAgICByZXR1cm4gWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICJIQU5ETEVSIiwKICAgICAgICAgIG5hbWUsCiAgICAgICAgICB2YWx1ZTogc2VyaWFsaXplZFZhbHVlCiAgICAgICAgfSwKICAgICAgICB0cmFuc2ZlcmFibGVzCiAgICAgIF07CiAgICB9CiAgfQogIHJldHVybiBbCiAgICB7CiAgICAgIHR5cGU6ICJSQVciLAogICAgICB2YWx1ZQogICAgfSwKICAgIHRyYW5zZmVyQ2FjaGUuZ2V0KHZhbHVlKSB8fCBbXQogIF07Cn0KZnVuY3Rpb24gZnJvbVdpcmVWYWx1ZSh2YWx1ZSkgewogIHN3aXRjaCAodmFsdWUudHlwZSkgewogICAgY2FzZSAiSEFORExFUiI6CiAgICAgIHJldHVybiB0cmFuc2ZlckhhbmRsZXJzLmdldCh2YWx1ZS5uYW1lKS5kZXNlcmlhbGl6ZSh2YWx1ZS52YWx1ZSk7CiAgICBjYXNlICJSQVciOgogICAgICByZXR1cm4gdmFsdWUudmFsdWU7CiAgfQp9CmZ1bmN0aW9uIHJlcXVlc3RSZXNwb25zZU1lc3NhZ2UoZXAsIHBlbmRpbmdMaXN0ZW5lcnMsIG1zZywgdHJhbnNmZXJzKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICBjb25zdCBpZCA9IGdlbmVyYXRlVVVJRCgpOwogICAgcGVuZGluZ0xpc3RlbmVycy5zZXQoaWQsIHJlc29sdmUpOwogICAgaWYgKGVwLnN0YXJ0KSB7CiAgICAgIGVwLnN0YXJ0KCk7CiAgICB9CiAgICBlcC5wb3N0TWVzc2FnZShPYmplY3QuYXNzaWduKHsgaWQgfSwgbXNnKSwgdHJhbnNmZXJzKTsKICB9KTsKfQpmdW5jdGlvbiBnZW5lcmF0ZVVVSUQoKSB7CiAgcmV0dXJuIG5ldyBBcnJheSg0KS5maWxsKDApLm1hcCgoKSA9PiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUikudG9TdHJpbmcoMTYpKS5qb2luKCItIik7Cn0KY29uc3QgQXBwbHlTcHJpdGVzSW1hZ2VEYXRhV29ya2VyID0gewogIGFzeW5jIGFwcGx5U3ByaXRlcyhpbWFnZURhdGEsIHNwcml0ZXMsIHRpbGVTaXplc0J5UmVzb3VyY2VJZCkgewogICAgY29uc3QgY2xpcHBlZEltYWdlRGF0YXMgPSBbXTsKICAgIGZvciAoY29uc3Qgc3ByaXRlIG9mIHNwcml0ZXMpIHsKICAgICAgY29uc3QgdGlsZVNpemVzID0gdGlsZVNpemVzQnlSZXNvdXJjZUlkLmdldChzcHJpdGUuaW1hZ2VJZCk7CiAgICAgIGlmICghdGlsZVNpemVzKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgZm9yIChjb25zdCB0aWxlU2l6ZSBvZiB0aWxlU2l6ZXMpIHsKICAgICAgICBjb25zdCBjbGlwcGVkSW1hZ2VEYXRhID0gbmV3IEltYWdlRGF0YSguLi50aWxlU2l6ZSk7CiAgICAgICAgaWYgKHNwcml0ZS53aWR0aCA+IHRpbGVTaXplWzBdIHx8IHNwcml0ZS5oZWlnaHQgPiB0aWxlU2l6ZVsxXSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJTcHJpdGVzIGxhcmdlciB0aGVuIG9uZSB0aWxlIG5vdCBzdXBwb3J0ZWQgeWV0Iik7CiAgICAgICAgfQogICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgc3ByaXRlLmhlaWdodDsgeSsrKSB7CiAgICAgICAgICBjb25zdCBzcmNTdGFydEluZGV4ID0gKChzcHJpdGUueSArIHkpICogaW1hZ2VEYXRhLndpZHRoICsgc3ByaXRlLngpICogNDsKICAgICAgICAgIGNvbnN0IGRlc3RTdGFydEluZGV4ID0geSAqIHRpbGVTaXplWzBdICogNDsKICAgICAgICAgIGNvbnN0IHJvd0xlbmd0aCA9IHNwcml0ZS53aWR0aCAqIDQ7CiAgICAgICAgICBjbGlwcGVkSW1hZ2VEYXRhLmRhdGEuc2V0KAogICAgICAgICAgICBpbWFnZURhdGEuZGF0YS5zdWJhcnJheShzcmNTdGFydEluZGV4LCBzcmNTdGFydEluZGV4ICsgcm93TGVuZ3RoKSwKICAgICAgICAgICAgZGVzdFN0YXJ0SW5kZXgKICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIGNsaXBwZWRJbWFnZURhdGFzLnB1c2goY2xpcHBlZEltYWdlRGF0YSk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0cmFuc2ZlcigKICAgICAgY2xpcHBlZEltYWdlRGF0YXMsCiAgICAgIGNsaXBwZWRJbWFnZURhdGFzLm1hcCgoY2xpcHBlZEltYWdlRGF0YSkgPT4gY2xpcHBlZEltYWdlRGF0YS5kYXRhLmJ1ZmZlcikKICAgICk7CiAgfQp9OwpleHBvc2UoQXBwbHlTcHJpdGVzSW1hZ2VEYXRhV29ya2VyKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbHktc3ByaXRlcy1pbWFnZS1kYXRhLURaYThtU0daLmpzLm1hcAo=",DZ=e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0)),i8=typeof self<"u"&&self.Blob&&new Blob(["URL.revokeObjectURL(import.meta.url);",DZ(q5)],{type:"text/javascript;charset=utf-8"});function BZ(e){let t;try{if(t=i8&&(self.URL||self.webkitURL).createObjectURL(i8),!t)throw"";const i=new Worker(t,{type:"module",name:e==null?void 0:e.name});return i.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),i}catch{return new Worker("data:text/javascript;base64,"+q5,{type:"module",name:e==null?void 0:e.name})}}const GZ=200,VZ={leading:!0,trailing:!0},jZ=50,ZZ={leading:!0,trailing:!0},OZ=100*Number.EPSILON,NZ=5,n8=750,UZ={};var Ep,kp;class HZ extends kZ{constructor(i,a){const h=ba(i,i.VERTEX_SHADER,K4),d=ba(i,i.FRAGMENT_SHADER,$4),p=ba(i,i.VERTEX_SHADER,J4),s=ba(i,i.FRAGMENT_SHADER,Q4),w=ba(i,i.VERTEX_SHADER,e8),A=ba(i,i.FRAGMENT_SHADER,t8),z=yu(i,h,d),B=yu(i,p,s),D=yu(i,w,A),V=new FZ,W=new BZ,S=kv(V),j=kv(W);super(vZ(i,z,B,D),Lg.createFactory(S,j),a);ii(this,Ep);ii(this,kp);Ke(this,"gl");Ke(this,"mapProgram");Ke(this,"linesProgram");Ke(this,"pointsProgram");Ke(this,"uniformCache");Ke(this,"previousSignificantViewport");Ke(this,"lastAnimationFrameRequestId");Ke(this,"animating",!1);Ke(this,"animationStart");Ke(this,"animationProgress",0);Ke(this,"disableRender",!1);Ke(this,"throttledPrepareRenderInternal");Ke(this,"throttledChanged");Zi(this,Ep,V),Zi(this,kp,W),this.gl=i,this.options=zi(UZ,this.options),this.mapProgram=z,this.linesProgram=B,this.pointsProgram=D,this.uniformCache=new Map,i.deleteShader(h),i.deleteShader(d),i.deleteShader(h),i.deleteShader(d),i.deleteShader(h),i.deleteShader(d),i.disable(i.DEPTH_TEST),this.addEventListeners(),this.throttledPrepareRenderInternal=Ev(this.prepareRenderInternal.bind(this),GZ,VZ),this.throttledChanged=Ev(this.changed.bind(this),jZ,ZZ)}initializeWebGL(i){const a=ba(i,i.VERTEX_SHADER,K4),h=ba(i,i.FRAGMENT_SHADER,$4),d=ba(i,i.VERTEX_SHADER,J4),p=ba(i,i.FRAGMENT_SHADER,Q4),s=ba(i,i.VERTEX_SHADER,e8),w=ba(i,i.FRAGMENT_SHADER,t8),A=yu(i,a,h),z=yu(i,d,p),B=yu(i,s,w);this.gl=i,this.mapProgram=A,this.linesProgram=z,this.pointsProgram=B,this.uniformCache=new Map,i.disable(i.DEPTH_TEST);for(const D of this.warpedMapList.getWarpedMaps())D.initializeWebGL(A,z,B)}render(i){this.disableRender||(this.viewport=i||this.viewport||Sp.fromSizeAndMaps([this.gl.canvas.width,this.gl.canvas.width],this.warpedMapList),this.loadMissingImagesInViewport(),this.someImagesInViewport()&&this.throttledPrepareRenderInternal(),this.renderInternal())}clear(){this.warpedMapList.clear(),this.mapsInViewport=new Set,this.mapsWithFetchableTilesForViewport=new Set,this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.COLOR_BUFFER_BIT),this.tileCache.clear()}cancelThrottledFunctions(){this.throttledPrepareRenderInternal.cancel(),this.throttledChanged.cancel()}destroy(){this.cancelThrottledFunctions();for(const i of this.warpedMapList.getWarpedMaps())this.removeEventListenersFromWebGL2WarpedMap(i);this.removeEventListeners(),super.destroy(),this.gl.deleteProgram(this.mapProgram),this.gl.deleteProgram(this.linesProgram),this.gl.deleteProgram(this.pointsProgram),Kt(this,Ep).terminate(),Kt(this,kp).terminate()}getUniformLocation(i,a,h){let d=this.uniformCache.get(a);if(d||(d=new Map,this.uniformCache.set(a,d)),!d.has(h)){const p=i.getUniformLocation(a,h);d.set(h,p)}return d.get(h)}updateMapsForViewport(i){const{mapsEnteringViewport:a,mapsLeavingViewport:h}=super.updateMapsForViewport(i);return this.updateVertexBuffers(a),{mapsEnteringViewport:a,mapsLeavingViewport:h}}resetPrevious(i){const a=this.warpedMapList.getWarpedMaps({mapIds:i});for(const h of a)h.resetPrevious()}updateVertexBuffers(i){if(!this.viewport)return;const a=this.warpedMapList.getWarpedMaps({mapIds:i});for(const h of a)h.updateVertexBuffers(this.viewport.projectedGeoToClipHomogeneousTransform)}prepareRenderInternal(){this.assureProjection(),this.requestFetchableTiles()}shouldRequestFetchableTiles(){if(!this.viewport||this.animating)return!1;if(this.previousSignificantViewport){const i=[];for(let h=0;h<4;h++)i.push(ah(this.previousSignificantViewport.projectedGeoRectangle[h],this.viewport.projectedGeoRectangle[h])/Math.pow(this.viewport.projectedGeoPerViewportScale,2));const a=Math.max(...i);return a<OZ?!0:a>Math.pow(NZ,2)?(this.previousSignificantViewport=this.viewport,!0):!1}else return this.previousSignificantViewport=this.viewport,!0}shouldAnticipateInteraction(){return!0}renderInternal(){if(!this.viewport)return;const i=this.gl;i.viewport(0,0,i.canvas.width,i.canvas.height),i.enable(i.BLEND),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),this.renderMapsInternal(),this.renderLinesInternal(),this.renderPointsInternal()}renderMapsInternal(){if(this.viewport){this.setMapProgramUniforms();for(const i of this.mapsWithFetchableTilesForViewport){const a=this.warpedMapList.getWarpedMap(i);if(!a||!a.shouldRenderMap())continue;this.setMapProgramMapUniforms(a);const h=a.resourceTrianglePoints.length,d=this.gl.TRIANGLES,p=0;this.gl.bindVertexArray(a.mapVao),this.gl.drawArrays(d,p,h)}}}renderLinesInternal(){this.setLinesProgramUniforms();for(const i of this.mapsWithFetchableTilesForViewport){const a=this.warpedMapList.getWarpedMap(i);if(!a||!a.shouldRenderLines())continue;this.setLinesProgramMapUniforms(a);const h=a.lineGroups.reduce((s,w)=>s+w.projectedGeoLines.length,0)*6,d=this.gl.TRIANGLES,p=0;this.gl.bindVertexArray(a.linesVao),this.gl.drawArrays(d,p,h)}}renderPointsInternal(){this.setPointsProgramUniforms();for(const i of this.mapsWithFetchableTilesForViewport){const a=this.warpedMapList.getWarpedMap(i);if(!a||!a.shouldRenderPoints())continue;this.setPointsProgramMapUniforms(a);const h=a.pointGroups.reduce((s,w)=>s+w.projectedGeoPoints.length,0),d=this.gl.POINTS,p=0;this.gl.bindVertexArray(a.pointsVao),this.gl.drawArrays(d,p,h)}}setMapProgramUniforms(){const i=this.mapProgram,a=this.gl;a.useProgram(i);const h=this.getUniformLocation(a,i,"u_animationProgress");a.uniform1f(h,this.animationProgress)}setMapProgramMapUniforms(i){if(!this.viewport)return;const a=this.gl,h=this.mapProgram;a.useProgram(h);const d=nv(this.viewport.projectedGeoToClipHomogeneousTransform,i.invertedRenderHomogeneousTransform),p=this.getUniformLocation(a,h,"u_renderHomogeneousTransform");a.uniformMatrix4fv(p,!1,Sf(d));const s=this.getUniformLocation(a,h,"u_opacity");a.uniform1f(s,i.options.opacity);const w=this.getUniformLocation(a,h,"u_saturation");a.uniform1f(w,i.options.saturation);const A=this.getUniformLocation(a,h,"u_removeColor");a.uniform1f(A,i.options.removeColor?1:0);const z=this.getUniformLocation(a,h,"u_removeColorColor");a.uniform3fv(z,P2(i.options.removeColorColor));const B=this.getUniformLocation(a,h,"u_removeColorThreshold");a.uniform1f(B,i.options.removeColorThreshold);const D=this.getUniformLocation(a,h,"u_removeColorHardness");a.uniform1f(D,i.options.removeColorHardness);const V=this.getUniformLocation(a,h,"u_colorize");a.uniform1f(V,i.options.colorize?1:0);const W=this.getUniformLocation(a,h,"u_colorizeColor");a.uniform3fv(W,P2(i.options.colorizeColor));const S=this.getUniformLocation(a,h,"u_renderGrid");a.uniform1f(S,i.options.renderGrid?1:0);const j=this.getUniformLocation(a,h,"u_renderGridColor");a.uniform4fv(j,go(i.options.renderGridColor));const ne=this.getUniformLocation(a,h,"u_distortion");a.uniform1f(ne,i.distortionMeasure?1:0);const te=this.getUniformLocation(a,h,"u_distortionMeasure");a.uniform1i(te,i.distortionMeasure?jv.indexOf(i.distortionMeasure):0);const Q=this.getUniformLocation(a,h,"u_distortionColor00");a.uniform4fv(Q,go(i.options.distortionColor00));const N=this.getUniformLocation(a,h,"u_distortionColor01");a.uniform4fv(N,go(i.options.distortionColor01));const re=this.getUniformLocation(a,h,"u_distortionColor1");a.uniform4fv(re,go(i.options.distortionColor1));const oe=this.getUniformLocation(a,h,"u_distortionColor2");a.uniform4fv(oe,go(i.options.distortionColor2));const ve=this.getUniformLocation(a,h,"u_distortionColor3");a.uniform4fv(ve,go(i.options.distortionColor3));const Pe=this.getUniformLocation(a,h,"u_debugTriangles");a.uniform1f(Pe,i.options.debugTriangles?1:0);const $=this.getUniformLocation(a,h,"u_debugTiles");a.uniform1f($,i.options.debugTiles?1:0);const le=this.getUniformLocation(a,h,"u_scaleFactorForViewport"),Me=i.tileZoomLevelForViewport?i.tileZoomLevelForViewport.scaleFactor:1;a.uniform1i(le,Me);const Ve=this.getUniformLocation(a,h,"u_cachedTilesTextureArray");a.uniform1i(Ve,0),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D_ARRAY,i.cachedTilesTextureArray);const Be=this.getUniformLocation(a,h,"u_cachedTilesResourceOriginPointsAndSizesTexture");a.uniform1i(Be,1),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,i.cachedTilesResourceOriginPointsAndSizesTexture);const q=this.getUniformLocation(a,h,"u_cachedTilesScaleFactorsTexture");a.uniform1i(q,2),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,i.cachedTilesScaleFactorsTexture)}setLinesProgramUniforms(){if(!this.viewport)return;const i=this.gl,a=this.linesProgram;i.useProgram(a);const h=this.getUniformLocation(i,a,"u_viewportToClipHomogeneousTransform");i.uniformMatrix4fv(h,!1,Sf(this.viewport.viewportToClipHomogeneousTransform));const d=this.getUniformLocation(i,a,"u_clipToViewportHomogeneousTransform");i.uniformMatrix4fv(d,!1,Sf(yb(this.viewport.viewportToClipHomogeneousTransform)));const p=this.getUniformLocation(i,a,"u_animationProgress");i.uniform1f(p,this.animationProgress)}setLinesProgramMapUniforms(i){if(!this.viewport)return;const a=this.gl,h=this.linesProgram;a.useProgram(h);const d=nv(this.viewport.projectedGeoToClipHomogeneousTransform,i.invertedRenderHomogeneousTransform),p=this.getUniformLocation(a,h,"u_renderHomogeneousTransform");a.uniformMatrix4fv(p,!1,Sf(d))}setPointsProgramUniforms(){if(!this.viewport)return;const i=this.gl,a=this.pointsProgram;i.useProgram(a);const h=this.getUniformLocation(i,a,"u_animationProgress");i.uniform1f(h,this.animationProgress);const d=this.getUniformLocation(i,a,"u_devicePixelRatio");i.uniform1f(d,this.viewport.devicePixelRatio)}setPointsProgramMapUniforms(i){if(!this.viewport)return;const a=this.gl,h=this.pointsProgram;a.useProgram(h);const d=nv(this.viewport.projectedGeoToClipHomogeneousTransform,i.invertedRenderHomogeneousTransform),p=this.getUniformLocation(a,h,"u_renderHomogeneousTransform");a.uniformMatrix4fv(p,!1,Sf(d))}startAnimation(i){this.changed(),this.updateVertexBuffers(i),this.lastAnimationFrameRequestId!==void 0&&cancelAnimationFrame(this.lastAnimationFrameRequestId),this.animating=!0,this.animationProgress=0,this.animationStart=void 0,this.lastAnimationFrameRequestId=requestAnimationFrame((a=>this.animationFrame(a,i)).bind(this))}animationFrame(i,a){this.animationStart||(this.animationStart=i),i-this.animationStart<n8?(this.animationProgress=(i-this.animationStart)/n8,this.changed(),this.renderInternal(),this.lastAnimationFrameRequestId=requestAnimationFrame((h=>this.animationFrame(h,a)).bind(this))):this.finishAnimation(a)}finishAnimation(i){this.resetPrevious(i),this.updateVertexBuffers(i),this.animating=!1,this.animationProgress=0,this.animationStart=void 0,this.changed()}changed(){this.dispatchEvent(new ai(nr.CHANGED))}imageLoaded(i){i instanceof ai&&this.dispatchEvent(new ai(nr.IMAGELOADED,i.data))}clearMap(i){const a=this.warpedMapList.getWarpedMap(i);a&&a.clearTextures()}mapTileLoaded(i){var a,h;if(i instanceof ai){if(!((a=i.data)!=null&&a.mapIds)||!((h=i.data)!=null&&h.tileUrl))throw new Error("Event data missing");const{mapIds:d,tileUrl:p}=i.data,s=d[0],w=this.tileCache.getCacheableTile(p);if(!w||!w.isCachedTile())return;const A=this.warpedMapList.getWarpedMap(s);if(!A)return;A.addCachedTileAndUpdateTextures(w)}}mapTileDeleted(i){var a;if(i instanceof ai){if(!((a=i.data)!=null&&a.mapIds)||!i.data.tileUrl)throw new Error("Event data missing");const{mapIds:h,tileUrl:d}=i.data,p=h[0],s=this.warpedMapList.getWarpedMap(p);if(!s)return;s.removeCachedTileAndUpdateTextures(d)}}warpedMapAdded(i){var a;if(i instanceof ai){if(!((a=i.data)!=null&&a.mapIds))throw new Error("Event data missing");const{mapIds:h}=i.data,d=h[0],p=this.warpedMapList.getWarpedMap(d);p&&this.addEventListenersToWebGL2WarpedMap(p)}}prepareChange(i){var a;if(i instanceof ai){if(!((a=i.data)!=null&&a.mapIds))throw new Error("Event data missing");const{mapIds:h}=i.data;for(const d of this.warpedMapList.getWarpedMaps({mapIds:h}))this.animating&&d.mixPreviousAndNew(1-this.animationProgress)}}animatedChange(i){var a;if(i instanceof ai){if(!((a=i.data)!=null&&a.mapIds))throw new Error("Event data missing");const{mapIds:h}=i.data;this.startAnimation(h)}}immediateChange(i){var a;if(i instanceof ai){if(!((a=i.data)!=null&&a.mapIds))throw new Error("Event data missing");const{mapIds:h}=i.data;this.finishAnimation(h)}}addEventListenersToWebGL2WarpedMap(i){i.addEventListener(nr.TEXTURESUPDATED,this.throttledChanged.bind(this))}removeEventListenersFromWebGL2WarpedMap(i){i.removeEventListener(nr.TEXTURESUPDATED,this.throttledChanged.bind(this))}contextLost(){this.disableRender=!0,this.cancelThrottledFunctions();for(const i of this.warpedMapList.getWarpedMaps())i.cancelThrottledFunctions();this.tileCache.clear()}contextRestored(){this.initializeWebGL(this.gl),this.disableRender=!1}}Ep=new WeakMap,kp=new WeakMap;const WZ="Renderer not defined. Add the layer to a map before calling this function.",XZ="Canvas not defined. Add the layer to a map before calling this function.";class Ci{constructor(t,i){Ke(this,"defaultSpecificWarpedMapLayerOptions");Ke(this,"options");Ke(this,"container");Ke(this,"canvas");Ke(this,"gl");Ke(this,"renderer");this.defaultSpecificWarpedMapLayerOptions=t,this.options=zi(this.defaultSpecificWarpedMapLayerOptions,i)}async addGeoreferenceAnnotation(t,i){Ci.assertRenderer(this.renderer);const a=await this.renderer.addGeoreferenceAnnotation(t,i);return this.nativeUpdate(),a}async removeGeoreferenceAnnotation(t){Ci.assertRenderer(this.renderer);const i=await this.renderer.warpedMapList.removeGeoreferenceAnnotation(t);return this.nativeUpdate(),i}async addGeoreferenceAnnotationByUrl(t,i){const a=await fetch(t).then(h=>h.json());return this.addGeoreferenceAnnotation(a,i)}async removeGeoreferenceAnnotationByUrl(t){const i=await fetch(t).then(a=>a.json());return this.removeGeoreferenceAnnotation(i)}async addGeoreferencedMap(t,i){Ci.assertRenderer(this.renderer);const a=this.renderer.addGeoreferencedMap(t,i);return this.nativeUpdate(),a}async removeGeoreferencedMap(t){Ci.assertRenderer(this.renderer);const i=this.renderer.warpedMapList.removeGeoreferencedMap(t);return this.nativeUpdate(),i}async removeGeoreferencedMapById(t){Ci.assertRenderer(this.renderer);const i=this.renderer.warpedMapList.removeGeoreferencedMapById(t);return this.nativeUpdate(),i}addImageInfos(t){Ci.assertRenderer(this.renderer);const i=this.renderer.warpedMapList.addImageInfos(t);return this.nativeUpdate(),i}async addSprites(t,i,a){Ci.assertRenderer(this.renderer),await this.renderer.addSprites(t,i,a),this.nativeUpdate()}getWarpedMapList(){return Ci.assertRenderer(this.renderer),this.renderer.warpedMapList}getMapIds(){return Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.getMapIds()}getWarpedMaps(t){return Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.getWarpedMaps({mapIds:t})}getWarpedMap(t){return Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.getWarpedMap(t)}getMapsCenter(t,i){return Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.getMapsCenter(ls({mapIds:t},i))}getMapsBbox(t,i){return Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.getMapsBbox(ls({mapIds:t},i))}getMapsConvexHull(t,i){return Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.getMapsConvexHull(ls({mapIds:t},i))}getMapZIndex(t){return Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.getMapZIndex(t)}getOpacity(){return this.getLayerOptions().opacity??this.getDefaultOptions().opacity}getDefaultOptions(){return Ci.assertRenderer(this.renderer),zi(this.defaultSpecificWarpedMapLayerOptions,this.renderer.getDefaultOptions())}getMapDefaultOptions(t){return Ci.assertRenderer(this.renderer),this.renderer.getMapDefaultOptions(t)}getLayerOptions(){return Ci.assertRenderer(this.renderer),ls(this.options,this.renderer.getOptions())}getMapMapOptions(t){return Ci.assertRenderer(this.renderer),this.renderer.getMapMapOptions(t)}getMapOptions(t){return Ci.assertRenderer(this.renderer),this.renderer.getMapOptions(t)}setOpacity(t){this.setLayerOptions({opacity:t})}setLayerOptions(t,i){Ci.assertRenderer(this.renderer),this.options=zi(this.options,t),this.renderer.setOptions(t,i)}setMapGcps(t,i,a){return this.setMapOptions(t,{gcps:i},void 0,a)}setMapResourceMask(t,i,a){return this.setMapOptions(t,{resourceMask:i},void 0,a)}setMapTransformationType(t,i,a){return this.setMapOptions(t,{transformationType:i},void 0,a)}setMapOptions(t,i,a,h){return this.setMapsOptions([t],i,a,h)}setMapsOptions(t,i,a,h){Ci.assertRenderer(this.renderer),a&&(this.options=zi(this.options,a)),this.renderer.setMapsOptions(t,i,a,h)}setMapsOptionsByMapId(t,i,a){Ci.assertRenderer(this.renderer),i&&(this.options=zi(this.options,i)),this.renderer.setMapsOptionsByMapId(t,i,a)}resetLayerOptions(t,i){Ci.assertRenderer(this.renderer),this.renderer.resetOptions(t,i)}resetMapsOptions(t,i,a,h){Ci.assertRenderer(this.renderer),this.renderer.resetMapsOptions(t,i,a,h)}resetMapsOptionsByMapId(t,i,a){Ci.assertRenderer(this.renderer),this.renderer.resetMapsOptionsByMapId(t,i,a)}bringMapsToFront(t){Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.bringMapsToFront(t),this.nativeUpdate()}sendMapsToBack(t){Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.sendMapsToBack(t),this.nativeUpdate()}bringMapsForward(t){Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.bringMapsForward(t),this.nativeUpdate()}sendMapsBackward(t){Ci.assertRenderer(this.renderer),this.renderer.warpedMapList.sendMapsBackward(t),this.nativeUpdate()}clear(){Ci.assertRenderer(this.renderer),this.renderer.clear(),this.nativeUpdate()}contextLost(t){var i;t.preventDefault(),(i=this.renderer)==null||i.contextLost()}contextRestored(t){var i;t.preventDefault(),(i=this.renderer)==null||i.contextRestored()}addEventListeners(){this.renderer&&(this.renderer.warpedMapList.addEventListener(nr.IMAGEINFOSADDED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.addEventListener(nr.GEOREFERENCEANNOTATIONADDED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.addEventListener(nr.GEOREFERENCEANNOTATIONREMOVED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.addEventListener(nr.WARPEDMAPADDED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.addEventListener(nr.WARPEDMAPREMOVED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.addEventListener(nr.WARPEDMAPENTERED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.addEventListener(nr.WARPEDMAPLEFT,this.nativePassWarpedMapEvent.bind(this)),this.renderer.addEventListener(nr.IMAGELOADED,this.nativeUpdate.bind(this)),this.renderer.tileCache.addEventListener(nr.MAPTILELOADED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.spritesTileCache.addEventListener(nr.MAPTILESLOADEDFROMSPRITES,this.nativePassWarpedMapEvent.bind(this)),this.renderer.tileCache.addEventListener(nr.MAPTILEDELETED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.tileCache.addEventListener(nr.FIRSTMAPTILELOADED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.tileCache.addEventListener(nr.ALLREQUESTEDTILESLOADED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.addEventListener(nr.CLEARED,this.nativeUpdate.bind(this)),this.renderer.warpedMapList.addEventListener(nr.PREPARECHANGE,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.addEventListener(nr.IMMEDIATECHANGE,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.addEventListener(nr.ANIMATEDCHANGE,this.nativePassWarpedMapEvent.bind(this)),this.renderer.addEventListener(nr.CHANGED,this.nativeUpdate.bind(this)))}removeEventListeners(){this.renderer&&(this.renderer.warpedMapList.removeEventListener(nr.IMAGEINFOSADDED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.removeEventListener(nr.GEOREFERENCEANNOTATIONADDED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.removeEventListener(nr.GEOREFERENCEANNOTATIONREMOVED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.removeEventListener(nr.WARPEDMAPADDED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.removeEventListener(nr.WARPEDMAPREMOVED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.removeEventListener(nr.WARPEDMAPENTERED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.removeEventListener(nr.WARPEDMAPLEFT,this.nativePassWarpedMapEvent.bind(this)),this.renderer.removeEventListener(nr.IMAGELOADED,this.nativeUpdate.bind(this)),this.renderer.tileCache.removeEventListener(nr.MAPTILELOADED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.spritesTileCache.removeEventListener(nr.MAPTILESLOADEDFROMSPRITES,this.nativePassWarpedMapEvent.bind(this)),this.renderer.tileCache.removeEventListener(nr.MAPTILEDELETED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.tileCache.removeEventListener(nr.FIRSTMAPTILELOADED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.tileCache.removeEventListener(nr.ALLREQUESTEDTILESLOADED,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.removeEventListener(nr.CLEARED,this.nativeUpdate.bind(this)),this.renderer.warpedMapList.removeEventListener(nr.PREPARECHANGE,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.removeEventListener(nr.IMMEDIATECHANGE,this.nativePassWarpedMapEvent.bind(this)),this.renderer.warpedMapList.removeEventListener(nr.ANIMATEDCHANGE,this.nativePassWarpedMapEvent.bind(this)),this.renderer.removeEventListener(nr.CHANGED,this.nativeUpdate.bind(this)))}static assertRenderer(t){if(!t)throw new Error(WZ)}static assertCanvas(t){if(!t)throw new Error(XZ)}}const qZ={layerId:"warped-map-layer",layerType:"custom",layerRenderingMode:"2d"};class YZ extends Ci{constructor(i){super(qZ,i);Ke(this,"id");Ke(this,"type");Ke(this,"renderingMode");Ke(this,"map");this.id=this.options.layerId,this.type=this.options.layerType,this.renderingMode=this.options.layerRenderingMode}onAdd(i,a){this.map=i,this.renderer=new HZ(a,this.options),this.addEventListeners(),this.map.on("webglcontextlost",this.contextLost.bind(this)),this.map.on("webglcontextrestored",this.contextRestored.bind(this))}onRemove(){var i,a;this.renderer&&(this.removeEventListeners(),(i=this.map)==null||i.off("webglcontextlost",this.contextLost.bind(this)),(a=this.map)==null||a.off("webglcontextrestored",this.contextRestored.bind(this)),this.renderer.destroy())}getBounds(){Ci.assertRenderer(this.renderer);const i=this.renderer.warpedMapList.getMapsBbox({projection:{definition:"EPSG:4326"}});if(i)return[[i[0],i[1]],[i[2],i[3]]]}render(){if(!this.map||!this.renderer)return;const i=this.map.getCanvas(),a=[i.width/window.devicePixelRatio,i.height/window.devicePixelRatio],h=this.map.getCenter(),d=Af([h.lng,h.lat]),p=this.map.unproject([0,a[1]]),s=this.map.unproject([a[0],a[1]]),w=this.map.unproject([a[0],0]),A=this.map.unproject([0,0]),z=Af([p.lng,p.lat]),B=Af([s.lng,s.lat]),D=Af([w.lng,w.lat]),V=Af([A.lng,A.lat]),S=Gv([z,B,D,V]),j=Ly(S,a),ne=-(this.map.getBearing()/180)*Math.PI,te=window.devicePixelRatio,Q=new Sp(a,d,j,{rotation:ne,devicePixelRatio:te});this.renderer.render(Q)}nativeUpdate(){var i;(i=this.map)==null||i.triggerRepaint()}nativePassWarpedMapEvent(i){i instanceof ai&&this.map&&this.map.fire(i.type,{...i.data,layerId:this.id})}}var fo,po,ul,Gg,Ha,Nf,qm;const Pb=class Pb extends Map{constructor(i){super();ii(this,Ha);ii(this,fo,new Map);ii(this,po,fr(0));ii(this,ul,fr(0));ii(this,Gg,wx||-1);if(i){for(var[a,h]of i)super.set(a,h);Kt(this,ul).v=super.size}}has(i){var a=Kt(this,fo),h=a.get(i);if(h===void 0){var d=super.get(i);if(d!==void 0)h=Os(this,Ha,Nf).call(this,0),a.set(i,h);else return T(Kt(this,po)),!1}return T(h),!0}forEach(i,a){Os(this,Ha,qm).call(this),super.forEach(i,a)}get(i){var a=Kt(this,fo),h=a.get(i);if(h===void 0){var d=super.get(i);if(d!==void 0)h=Os(this,Ha,Nf).call(this,0),a.set(i,h);else{T(Kt(this,po));return}}return T(h),super.get(i)}set(i,a){var B;var h=Kt(this,fo),d=h.get(i),p=super.get(i),s=super.set(i,a),w=Kt(this,po);if(d===void 0)d=Os(this,Ha,Nf).call(this,0),h.set(i,d),Pt(Kt(this,ul),super.size),gf(w);else if(p!==a){gf(d);var A=w.reactions===null?null:new Set(w.reactions),z=A===null||!((B=d.reactions)!=null&&B.every(D=>A.has(D)));z&&gf(w)}return s}delete(i){var a=Kt(this,fo),h=a.get(i),d=super.delete(i);return h!==void 0&&(a.delete(i),Pt(Kt(this,ul),super.size),Pt(h,-1),gf(Kt(this,po))),d}clear(){if(super.size!==0){super.clear();var i=Kt(this,fo);Pt(Kt(this,ul),0);for(var a of i.values())Pt(a,-1);gf(Kt(this,po)),i.clear()}}keys(){return T(Kt(this,po)),super.keys()}values(){return Os(this,Ha,qm).call(this),super.values()}entries(){return Os(this,Ha,qm).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return T(Kt(this,ul)),super.size}};fo=new WeakMap,po=new WeakMap,ul=new WeakMap,Gg=new WeakMap,Ha=new WeakSet,Nf=function(i){return wx===Kt(this,Gg)?fr(i):dv(i)},qm=function(){T(Kt(this,po));var i=Kt(this,fo);if(Kt(this,ul).v!==i.size){for(var a of _x(Pb.prototype,this,"keys").call(this))if(!i.has(a)){var h=Os(this,Ha,Nf).call(this,0);i.set(a,h)}}for([,h]of Kt(this,fo))T(h)};let Du=Pb,s8=Symbol("phosphor-svelte");function Wi(){return S8(s8)?fv(s8):{}}var KZ=ht('<path d="M224.49,184.49l-48,48a12,12,0,0,1-17-17L187,188H72a12,12,0,0,1-12-12V32a12,12,0,0,1,24,0V164H187l-27.52-27.51a12,12,0,1,1,17-17l48,48A12,12,0,0,1,224.49,184.49Z"></path>'),$Z=ht('<path d="M216,176l-48,48V128Z" opacity="0.2"></path><path d="M221.66,170.34l-48-48A8,8,0,0,0,160,128v40H80V32a8,8,0,0,0-16,0V176a8,8,0,0,0,8,8h88v40a8,8,0,0,0,13.66,5.66l48-48A8,8,0,0,0,221.66,170.34ZM176,204.69V147.31L204.69,176Z"></path>',1),JZ=ht('<path d="M221.66,181.66l-48,48A8,8,0,0,1,160,224V184H72a8,8,0,0,1-8-8V32a8,8,0,0,1,16,0V168h80V128a8,8,0,0,1,13.66-5.66l48,48A8,8,0,0,1,221.66,181.66Z"></path>'),QZ=ht('<path d="M220.24,180.24l-48,48a6,6,0,0,1-8.48-8.48L201.51,182H72a6,6,0,0,1-6-6V32a6,6,0,0,1,12,0V170H201.51l-37.75-37.76a6,6,0,1,1,8.48-8.48l48,48A6,6,0,0,1,220.24,180.24Z"></path>'),eO=ht('<path d="M221.66,181.66l-48,48a8,8,0,0,1-11.32-11.32L196.69,184H72a8,8,0,0,1-8-8V32a8,8,0,0,1,16,0V168H196.69l-34.35-34.34a8,8,0,0,1,11.32-11.32l48,48A8,8,0,0,1,221.66,181.66Z"></path>'),tO=ht('<path d="M218.83,178.83l-48,48a4,4,0,0,1-5.66-5.66L206.34,180H72a4,4,0,0,1-4-4V32a4,4,0,0,1,8,0V172H206.34l-41.17-41.17a4,4,0,1,1,5.66-5.66l48,48A4,4,0,0,1,218.83,178.83Z"></path>'),rO=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function iO(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=rO();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=KZ();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=$Z();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=JZ();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=QZ();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=eO();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=tO();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var nO=ht('<path d="M228,104a12,12,0,0,1-24,0V69l-59.51,59.51a12,12,0,0,1-17-17L187,52H152a12,12,0,0,1,0-24h64a12,12,0,0,1,12,12Zm-44,24a12,12,0,0,0-12,12v64H52V84h64a12,12,0,0,0,0-24H48A20,20,0,0,0,28,80V208a20,20,0,0,0,20,20H176a20,20,0,0,0,20-20V140A12,12,0,0,0,184,128Z"></path>'),sO=ht('<path d="M184,80V208a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H176A8,8,0,0,1,184,80Z" opacity="0.2"></path><path d="M224,104a8,8,0,0,1-16,0V59.32l-66.33,66.34a8,8,0,0,1-11.32-11.32L196.68,48H152a8,8,0,0,1,0-16h64a8,8,0,0,1,8,8Zm-40,24a8,8,0,0,0-8,8v72H48V80h72a8,8,0,0,0,0-16H48A16,16,0,0,0,32,80V208a16,16,0,0,0,16,16H176a16,16,0,0,0,16-16V136A8,8,0,0,0,184,128Z"></path>',1),aO=ht('<path d="M192,136v72a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V80A16,16,0,0,1,48,64h72a8,8,0,0,1,0,16H48V208H176V136a8,8,0,0,1,16,0Zm32-96a8,8,0,0,0-8-8H152a8,8,0,0,0-5.66,13.66L172.69,72l-42.35,42.34a8,8,0,0,0,11.32,11.32L184,83.31l26.34,26.35A8,8,0,0,0,224,104Z"></path>'),oO=ht('<path d="M222,104a6,6,0,0,1-12,0V54.49l-69.75,69.75a6,6,0,0,1-8.48-8.48L201.51,46H152a6,6,0,0,1,0-12h64a6,6,0,0,1,6,6Zm-38,26a6,6,0,0,0-6,6v72a2,2,0,0,1-2,2H48a2,2,0,0,1-2-2V80a2,2,0,0,1,2-2h72a6,6,0,0,0,0-12H48A14,14,0,0,0,34,80V208a14,14,0,0,0,14,14H176a14,14,0,0,0,14-14V136A6,6,0,0,0,184,130Z"></path>'),lO=ht('<path d="M224,104a8,8,0,0,1-16,0V59.32l-66.33,66.34a8,8,0,0,1-11.32-11.32L196.68,48H152a8,8,0,0,1,0-16h64a8,8,0,0,1,8,8Zm-40,24a8,8,0,0,0-8,8v72H48V80h72a8,8,0,0,0,0-16H48A16,16,0,0,0,32,80V208a16,16,0,0,0,16,16H176a16,16,0,0,0,16-16V136A8,8,0,0,0,184,128Z"></path>'),cO=ht('<path d="M220,104a4,4,0,0,1-8,0V49.66l-73.16,73.17a4,4,0,0,1-5.66-5.66L206.34,44H152a4,4,0,0,1,0-8h64a4,4,0,0,1,4,4Zm-36,28a4,4,0,0,0-4,4v72a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V80a4,4,0,0,1,4-4h72a4,4,0,0,0,0-8H48A12,12,0,0,0,36,80V208a12,12,0,0,0,12,12H176a12,12,0,0,0,12-12V136A4,4,0,0,0,184,132Z"></path>'),hO=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function bu(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=hO();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=nO();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=sO();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=aO();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=oO();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=lO();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=cO();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var uO=ht('<path d="M208,52H182.42L170,33.34A12,12,0,0,0,160,28H96a12,12,0,0,0-10,5.34L73.57,52H48A28,28,0,0,0,20,80V192a28,28,0,0,0,28,28H208a28,28,0,0,0,28-28V80A28,28,0,0,0,208,52Zm4,140a4,4,0,0,1-4,4H48a4,4,0,0,1-4-4V80a4,4,0,0,1,4-4H80a12,12,0,0,0,10-5.34L102.42,52h51.15L166,70.66A12,12,0,0,0,176,76h32a4,4,0,0,1,4,4ZM128,84a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,84Zm0,72a24,24,0,1,1,24-24A24,24,0,0,1,128,156Z"></path>'),dO=ht('<path d="M208,64H176L160,40H96L80,64H48A16,16,0,0,0,32,80V192a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V80A16,16,0,0,0,208,64ZM128,168a36,36,0,1,1,36-36A36,36,0,0,1,128,168Z" opacity="0.2"></path><path d="M208,56H180.28L166.65,35.56A8,8,0,0,0,160,32H96a8,8,0,0,0-6.65,3.56L75.71,56H48A24,24,0,0,0,24,80V192a24,24,0,0,0,24,24H208a24,24,0,0,0,24-24V80A24,24,0,0,0,208,56Zm8,136a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H80a8,8,0,0,0,6.66-3.56L100.28,48h55.43l13.63,20.44A8,8,0,0,0,176,72h32a8,8,0,0,1,8,8ZM128,88a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,88Zm0,72a28,28,0,1,1,28-28A28,28,0,0,1,128,160Z"></path>',1),fO=ht('<path d="M208,56H180.28L166.65,35.56A8,8,0,0,0,160,32H96a8,8,0,0,0-6.65,3.56L75.71,56H48A24,24,0,0,0,24,80V192a24,24,0,0,0,24,24H208a24,24,0,0,0,24-24V80A24,24,0,0,0,208,56Zm-44,76a36,36,0,1,1-36-36A36,36,0,0,1,164,132Z"></path>'),pO=ht('<path d="M208,58H179.21L165,36.67A6,6,0,0,0,160,34H96a6,6,0,0,0-5,2.67L76.78,58H48A22,22,0,0,0,26,80V192a22,22,0,0,0,22,22H208a22,22,0,0,0,22-22V80A22,22,0,0,0,208,58Zm10,134a10,10,0,0,1-10,10H48a10,10,0,0,1-10-10V80A10,10,0,0,1,48,70H80a6,6,0,0,0,5-2.67L99.21,46h57.57L171,67.33A6,6,0,0,0,176,70h32a10,10,0,0,1,10,10ZM128,90a42,42,0,1,0,42,42A42,42,0,0,0,128,90Zm0,72a30,30,0,1,1,30-30A30,30,0,0,1,128,162Z"></path>'),mO=ht('<path d="M208,56H180.28L166.65,35.56A8,8,0,0,0,160,32H96a8,8,0,0,0-6.65,3.56L75.71,56H48A24,24,0,0,0,24,80V192a24,24,0,0,0,24,24H208a24,24,0,0,0,24-24V80A24,24,0,0,0,208,56Zm8,136a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H80a8,8,0,0,0,6.66-3.56L100.28,48h55.43l13.63,20.44A8,8,0,0,0,176,72h32a8,8,0,0,1,8,8ZM128,88a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,88Zm0,72a28,28,0,1,1,28-28A28,28,0,0,1,128,160Z"></path>'),gO=ht('<path d="M208,60H178.13L163.32,37.78A4,4,0,0,0,160,36H96a4,4,0,0,0-3.32,1.78L77.85,60H48A20,20,0,0,0,28,80V192a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V80A20,20,0,0,0,208,60Zm12,132a12,12,0,0,1-12,12H48a12,12,0,0,1-12-12V80A12,12,0,0,1,48,68H80a4,4,0,0,0,3.33-1.78L98.13,44h59.72l14.82,22.22A4,4,0,0,0,176,68h32a12,12,0,0,1,12,12ZM128,92a40,40,0,1,0,40,40A40,40,0,0,0,128,92Zm0,72a32,32,0,1,1,32-32A32,32,0,0,1,128,164Z"></path>'),_O=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function vO(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=_O();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=uO();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=dO();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=fO();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=pO();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=mO();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=gO();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var yO=ht('<path d="M216.49,104.49l-80,80a12,12,0,0,1-17,0l-80-80a12,12,0,0,1,17-17L128,159l71.51-71.52a12,12,0,0,1,17,17Z"></path>'),bO=ht('<path d="M208,96l-80,80L48,96Z" opacity="0.2"></path><path d="M215.39,92.94A8,8,0,0,0,208,88H48a8,8,0,0,0-5.66,13.66l80,80a8,8,0,0,0,11.32,0l80-80A8,8,0,0,0,215.39,92.94ZM128,164.69,67.31,104H188.69Z"></path>',1),wO=ht('<path d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,48,88H208a8,8,0,0,1,5.66,13.66Z"></path>'),xO=ht('<path d="M212.24,100.24l-80,80a6,6,0,0,1-8.48,0l-80-80a6,6,0,0,1,8.48-8.48L128,167.51l75.76-75.75a6,6,0,0,1,8.48,8.48Z"></path>'),MO=ht('<path d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"></path>'),IO=ht('<path d="M210.83,98.83l-80,80a4,4,0,0,1-5.66,0l-80-80a4,4,0,0,1,5.66-5.66L128,170.34l77.17-77.17a4,4,0,1,1,5.66,5.66Z"></path>'),AO=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function TO(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=AO();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=yO();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=bO();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=wO();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=xO();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=MO();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=IO();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var CO=ht('<path d="M216.49,168.49a12,12,0,0,1-17,0L128,97,56.49,168.49a12,12,0,0,1-17-17l80-80a12,12,0,0,1,17,0l80,80A12,12,0,0,1,216.49,168.49Z"></path>'),SO=ht('<path d="M208,160H48l80-80Z" opacity="0.2"></path><path d="M213.66,154.34l-80-80a8,8,0,0,0-11.32,0l-80,80A8,8,0,0,0,48,168H208a8,8,0,0,0,5.66-13.66ZM67.31,152,128,91.31,188.69,152Z"></path>',1),PO=ht('<path d="M215.39,163.06A8,8,0,0,1,208,168H48a8,8,0,0,1-5.66-13.66l80-80a8,8,0,0,1,11.32,0l80,80A8,8,0,0,1,215.39,163.06Z"></path>'),EO=ht('<path d="M212.24,164.24a6,6,0,0,1-8.48,0L128,88.49,52.24,164.24a6,6,0,0,1-8.48-8.48l80-80a6,6,0,0,1,8.48,0l80,80A6,6,0,0,1,212.24,164.24Z"></path>'),kO=ht('<path d="M213.66,165.66a8,8,0,0,1-11.32,0L128,91.31,53.66,165.66a8,8,0,0,1-11.32-11.32l80-80a8,8,0,0,1,11.32,0l80,80A8,8,0,0,1,213.66,165.66Z"></path>'),RO=ht('<path d="M210.83,162.83a4,4,0,0,1-5.66,0L128,85.66,50.83,162.83a4,4,0,0,1-5.66-5.66l80-80a4,4,0,0,1,5.66,0l80,80A4,4,0,0,1,210.83,162.83Z"></path>'),LO=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function zO(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=LO();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=CO();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=SO();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=PO();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=EO();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=kO();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=RO();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var FO=ht('<path d="M232.49,80.49l-128,128a12,12,0,0,1-17,0l-56-56a12,12,0,1,1,17-17L96,183,215.51,63.51a12,12,0,0,1,17,17Z"></path>'),DO=ht('<path d="M232,56V200a16,16,0,0,1-16,16H40a16,16,0,0,1-16-16V56A16,16,0,0,1,40,40H216A16,16,0,0,1,232,56Z" opacity="0.2"></path><path d="M205.66,85.66l-96,96a8,8,0,0,1-11.32,0l-40-40a8,8,0,0,1,11.32-11.32L104,164.69l90.34-90.35a8,8,0,0,1,11.32,11.32Z"></path>',1),BO=ht('<path d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM205.66,85.66l-96,96a8,8,0,0,1-11.32,0l-40-40a8,8,0,0,1,11.32-11.32L104,164.69l90.34-90.35a8,8,0,0,1,11.32,11.32Z"></path>'),GO=ht('<path d="M228.24,76.24l-128,128a6,6,0,0,1-8.48,0l-56-56a6,6,0,0,1,8.48-8.48L96,191.51,219.76,67.76a6,6,0,0,1,8.48,8.48Z"></path>'),VO=ht('<path d="M229.66,77.66l-128,128a8,8,0,0,1-11.32,0l-56-56a8,8,0,0,1,11.32-11.32L96,188.69,218.34,66.34a8,8,0,0,1,11.32,11.32Z"></path>'),jO=ht('<path d="M226.83,74.83l-128,128a4,4,0,0,1-5.66,0l-56-56a4,4,0,0,1,5.66-5.66L96,194.34,221.17,69.17a4,4,0,1,1,5.66,5.66Z"></path>'),ZO=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function Y5(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=ZO();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=FO();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=DO();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=BO();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=GO();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=VO();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=jO();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var OO=ht('<path d="M172,164a12,12,0,0,1-12,12H96a12,12,0,0,1,0-24h64A12,12,0,0,1,172,164Zm-12-52H96a12,12,0,0,0,0,24h64a12,12,0,0,0,0-24Zm60-64V216a20,20,0,0,1-20,20H56a20,20,0,0,1-20-20V48A20,20,0,0,1,56,28H90.53a51.88,51.88,0,0,1,74.94,0H200A20,20,0,0,1,220,48ZM100.29,60h55.42a28,28,0,0,0-55.42,0ZM196,52H178.59A52.13,52.13,0,0,1,180,64v8a12,12,0,0,1-12,12H88A12,12,0,0,1,76,72V64a52.13,52.13,0,0,1,1.41-12H60V212H196Z"></path>'),NO=ht('<path d="M208,48V216a8,8,0,0,1-8,8H56a8,8,0,0,1-8-8V48a8,8,0,0,1,8-8H96a39.83,39.83,0,0,0-8,24v8h80V64a39.83,39.83,0,0,0-8-24h40A8,8,0,0,1,208,48Z" opacity="0.2"></path><path d="M168,152a8,8,0,0,1-8,8H96a8,8,0,0,1,0-16h64A8,8,0,0,1,168,152Zm-8-40H96a8,8,0,0,0,0,16h64a8,8,0,0,0,0-16Zm56-64V216a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V48A16,16,0,0,1,56,32H92.26a47.92,47.92,0,0,1,71.48,0H200A16,16,0,0,1,216,48ZM96,64h64a32,32,0,0,0-64,0ZM200,48H173.25A47.93,47.93,0,0,1,176,64v8a8,8,0,0,1-8,8H88a8,8,0,0,1-8-8V64a47.93,47.93,0,0,1,2.75-16H56V216H200Z"></path>',1),UO=ht('<path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm32,128H96a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Zm0-32H96a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Z"></path>'),HO=ht('<path d="M166,152a6,6,0,0,1-6,6H96a6,6,0,0,1,0-12h64A6,6,0,0,1,166,152Zm-6-38H96a6,6,0,0,0,0,12h64a6,6,0,0,0,0-12Zm54-66V216a14,14,0,0,1-14,14H56a14,14,0,0,1-14-14V48A14,14,0,0,1,56,34H93.17a45.91,45.91,0,0,1,69.66,0H200A14,14,0,0,1,214,48ZM94,64v2h68V64a34,34,0,0,0-68,0ZM202,48a2,2,0,0,0-2-2H170.33A45.77,45.77,0,0,1,174,64v8a6,6,0,0,1-6,6H88a6,6,0,0,1-6-6V64a45.77,45.77,0,0,1,3.67-18H56a2,2,0,0,0-2,2V216a2,2,0,0,0,2,2H200a2,2,0,0,0,2-2Z"></path>'),WO=ht('<path d="M168,152a8,8,0,0,1-8,8H96a8,8,0,0,1,0-16h64A8,8,0,0,1,168,152Zm-8-40H96a8,8,0,0,0,0,16h64a8,8,0,0,0,0-16Zm56-64V216a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V48A16,16,0,0,1,56,32H92.26a47.92,47.92,0,0,1,71.48,0H200A16,16,0,0,1,216,48ZM96,64h64a32,32,0,0,0-64,0ZM200,48H173.25A47.93,47.93,0,0,1,176,64v8a8,8,0,0,1-8,8H88a8,8,0,0,1-8-8V64a47.93,47.93,0,0,1,2.75-16H56V216H200Z"></path>'),XO=ht('<path d="M164,152a4,4,0,0,1-4,4H96a4,4,0,0,1,0-8h64A4,4,0,0,1,164,152Zm-4-36H96a4,4,0,0,0,0,8h64a4,4,0,0,0,0-8Zm52-68V216a12,12,0,0,1-12,12H56a12,12,0,0,1-12-12V48A12,12,0,0,1,56,36H94.08a44,44,0,0,1,67.84,0H200A12,12,0,0,1,212,48ZM92,64v4h72V64a36,36,0,0,0-72,0ZM204,48a4,4,0,0,0-4-4H167.17A43.71,43.71,0,0,1,172,64v8a4,4,0,0,1-4,4H88a4,4,0,0,1-4-4V64a43.71,43.71,0,0,1,4.83-20H56a4,4,0,0,0-4,4V216a4,4,0,0,0,4,4H200a4,4,0,0,0,4-4Z"></path>'),qO=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function YO(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=qO();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=OO();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=NO();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=UO();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=HO();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=WO();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=XO();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var KO=ht('<path d="M216,28H88A12,12,0,0,0,76,40V76H40A12,12,0,0,0,28,88V216a12,12,0,0,0,12,12H168a12,12,0,0,0,12-12V180h36a12,12,0,0,0,12-12V40A12,12,0,0,0,216,28ZM156,204H52V100H156Zm48-48H180V88a12,12,0,0,0-12-12H100V52H204Z"></path>'),$O=ht('<path d="M216,40V168H168V88H88V40Z" opacity="0.2"></path><path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path>',1),JO=ht('<path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32Zm-8,128H176V88a8,8,0,0,0-8-8H96V48H208Z"></path>'),QO=ht('<path d="M216,34H88a6,6,0,0,0-6,6V82H40a6,6,0,0,0-6,6V216a6,6,0,0,0,6,6H168a6,6,0,0,0,6-6V174h42a6,6,0,0,0,6-6V40A6,6,0,0,0,216,34ZM162,210H46V94H162Zm48-48H174V88a6,6,0,0,0-6-6H94V46H210Z"></path>'),eN=ht('<path d="M216,32H88a8,8,0,0,0-8,8V80H40a8,8,0,0,0-8,8V216a8,8,0,0,0,8,8H168a8,8,0,0,0,8-8V176h40a8,8,0,0,0,8-8V40A8,8,0,0,0,216,32ZM160,208H48V96H160Zm48-48H176V88a8,8,0,0,0-8-8H96V48H208Z"></path>'),tN=ht('<path d="M216,36H88a4,4,0,0,0-4,4V84H40a4,4,0,0,0-4,4V216a4,4,0,0,0,4,4H168a4,4,0,0,0,4-4V172h44a4,4,0,0,0,4-4V40A4,4,0,0,0,216,36ZM164,212H44V92H164Zm48-48H172V88a4,4,0,0,0-4-4H92V44H212Z"></path>'),rN=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function iN(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=rN();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=KO();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=$O();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=JO();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=QO();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=eN();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=tN();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var nN=ht('<path d="M224,44H32A12,12,0,0,0,20,56V192a20,20,0,0,0,20,20H216a20,20,0,0,0,20-20V56A12,12,0,0,0,224,44ZM193.15,68,128,127.72,62.85,68ZM44,188V83.28l75.89,69.57a12,12,0,0,0,16.22,0L212,83.28V188Z"></path>'),sN=ht('<path d="M224,56l-96,88L32,56Z" opacity="0.2"></path><path d="M224,48H32a8,8,0,0,0-8,8V192a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A8,8,0,0,0,224,48ZM203.43,64,128,133.15,52.57,64ZM216,192H40V74.19l82.59,75.71a8,8,0,0,0,10.82,0L216,74.19V192Z"></path>',1),aN=ht('<path d="M224,48H32a8,8,0,0,0-8,8V192a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A8,8,0,0,0,224,48Zm-8,144H40V74.19l82.59,75.71a8,8,0,0,0,10.82,0L216,74.19V192Z"></path>'),oN=ht('<path d="M224,50H32a6,6,0,0,0-6,6V192a14,14,0,0,0,14,14H216a14,14,0,0,0,14-14V56A6,6,0,0,0,224,50ZM208.58,62,128,135.86,47.42,62ZM216,194H40a2,2,0,0,1-2-2V69.64l86,78.78a6,6,0,0,0,8.1,0L218,69.64V192A2,2,0,0,1,216,194Z"></path>'),lN=ht('<path d="M224,48H32a8,8,0,0,0-8,8V192a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A8,8,0,0,0,224,48ZM203.43,64,128,133.15,52.57,64ZM216,192H40V74.19l82.59,75.71a8,8,0,0,0,10.82,0L216,74.19V192Z"></path>'),cN=ht('<path d="M224,52H32a4,4,0,0,0-4,4V192a12,12,0,0,0,12,12H216a12,12,0,0,0,12-12V56A4,4,0,0,0,224,52Zm-10.28,8L128,138.57,42.28,60ZM216,196H40a4,4,0,0,1-4-4V65.09L125.3,147a4,4,0,0,0,5.4,0L220,65.09V192A4,4,0,0,1,216,196Z"></path>'),hN=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function uN(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=hN();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=nN();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=sN();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=aN();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=oN();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=lN();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=cN();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var dN=ht('<path d="M56.88,31.93A12,12,0,1,0,39.12,48.07l16,17.65C20.67,88.66,5.72,121.58,5,123.13a12.08,12.08,0,0,0,0,9.75c.37.82,9.13,20.26,28.49,39.61C59.37,198.34,92,212,128,212a131.34,131.34,0,0,0,51-10l20.09,22.1a12,12,0,0,0,17.76-16.14ZM128,188c-29.59,0-55.47-10.73-76.91-31.88A130.69,130.69,0,0,1,29.52,128c5.27-9.31,18.79-29.9,42-44.29l90.09,99.11A109.33,109.33,0,0,1,128,188Zm123-55.12c-.36.81-9,20-28,39.16a12,12,0,1,1-17-16.9A130.48,130.48,0,0,0,226.48,128a130.36,130.36,0,0,0-21.57-28.12C183.46,78.73,157.59,68,128,68c-3.35,0-6.7.14-10,.42a12,12,0,1,1-2-23.91c3.93-.34,8-.51,12-.51,36,0,68.63,13.67,94.49,39.52,19.35,19.35,28.11,38.8,28.48,39.61A12.08,12.08,0,0,1,251,132.88Z"></path>'),fN=ht('<path d="M128,56C48,56,16,128,16,128s32,72,112,72,112-72,112-72S208,56,128,56Zm0,112a40,40,0,1,1,40-40A40,40,0,0,1,128,168Z" opacity="0.2"></path><path d="M53.92,34.62A8,8,0,1,0,42.08,45.38L61.32,66.55C25,88.84,9.38,123.2,8.69,124.76a8,8,0,0,0,0,6.5c.35.79,8.82,19.57,27.65,38.4C61.43,194.74,93.12,208,128,208a127.11,127.11,0,0,0,52.07-10.83l22,24.21a8,8,0,1,0,11.84-10.76Zm47.33,75.84,41.67,45.85a32,32,0,0,1-41.67-45.85ZM128,192c-30.78,0-57.67-11.19-79.93-33.25A133.16,133.16,0,0,1,25,128c4.69-8.79,19.66-33.39,47.35-49.38l18,19.75a48,48,0,0,0,63.66,70l14.73,16.2A112,112,0,0,1,128,192Zm6-95.43a8,8,0,0,1,3-15.72,48.16,48.16,0,0,1,38.77,42.64,8,8,0,0,1-7.22,8.71,6.39,6.39,0,0,1-.75,0,8,8,0,0,1-8-7.26A32.09,32.09,0,0,0,134,96.57Zm113.28,34.69c-.42.94-10.55,23.37-33.36,43.8a8,8,0,1,1-10.67-11.92A132.77,132.77,0,0,0,231.05,128a133.15,133.15,0,0,0-23.12-30.77C185.67,75.19,158.78,64,128,64a118.37,118.37,0,0,0-19.36,1.57A8,8,0,1,1,106,49.79,134,134,0,0,1,128,48c34.88,0,66.57,13.26,91.66,38.35,18.83,18.83,27.3,37.62,27.65,38.41A8,8,0,0,1,247.31,131.26Z"></path>',1),pN=ht('<path d="M96.68,57.87a4,4,0,0,1,2.08-6.6A130.13,130.13,0,0,1,128,48c34.88,0,66.57,13.26,91.66,38.35,18.83,18.83,27.3,37.62,27.65,38.41a8,8,0,0,1,0,6.5c-.35.79-8.82,19.57-27.65,38.4q-4.28,4.26-8.79,8.07a4,4,0,0,1-5.55-.36ZM213.92,210.62a8,8,0,1,1-11.84,10.76L180,197.13A127.21,127.21,0,0,1,128,208c-34.88,0-66.57-13.26-91.66-38.34C17.51,150.83,9,132.05,8.69,131.26a8,8,0,0,1,0-6.5C9,124,17.51,105.18,36.34,86.35a135,135,0,0,1,25-19.78L42.08,45.38A8,8,0,1,1,53.92,34.62Zm-65.49-48.25-52.69-58a40,40,0,0,0,52.69,58Z"></path>'),mN=ht('<path d="M52.44,36A6,6,0,0,0,43.56,44L64.44,67c-37.28,21.9-53.23,57-53.92,58.57a6,6,0,0,0,0,4.88c.34.77,8.66,19.22,27.24,37.8C55,185.47,84.62,206,128,206a124.91,124.91,0,0,0,52.57-11.25l23,25.29a6,6,0,0,0,8.88-8.08Zm48.62,71.32,45,49.52a34,34,0,0,1-45-49.52ZM128,194c-31.38,0-58.78-11.42-81.45-33.93A134.57,134.57,0,0,1,22.69,128c4.29-8.2,20.1-35.18,50-51.91L92.89,98.3a46,46,0,0,0,61.35,67.48l17.81,19.6A113.47,113.47,0,0,1,128,194Zm6.4-99.4a6,6,0,0,1,2.25-11.79,46.17,46.17,0,0,1,37.15,40.87,6,6,0,0,1-5.42,6.53l-.56,0a6,6,0,0,1-6-5.45A34.1,34.1,0,0,0,134.4,94.6Zm111.08,35.85c-.41.92-10.37,23-32.86,43.12a6,6,0,1,1-8-8.94A134.07,134.07,0,0,0,233.31,128a134.67,134.67,0,0,0-23.86-32.07C186.78,73.42,159.38,62,128,62a120.19,120.19,0,0,0-19.69,1.6,6,6,0,1,1-2-11.83A131.12,131.12,0,0,1,128,50c43.38,0,73,20.54,90.24,37.76,18.58,18.58,26.9,37,27.24,37.81A6,6,0,0,1,245.48,130.45Z"></path>'),gN=ht('<path d="M53.92,34.62A8,8,0,1,0,42.08,45.38L61.32,66.55C25,88.84,9.38,123.2,8.69,124.76a8,8,0,0,0,0,6.5c.35.79,8.82,19.57,27.65,38.4C61.43,194.74,93.12,208,128,208a127.11,127.11,0,0,0,52.07-10.83l22,24.21a8,8,0,1,0,11.84-10.76Zm47.33,75.84,41.67,45.85a32,32,0,0,1-41.67-45.85ZM128,192c-30.78,0-57.67-11.19-79.93-33.25A133.16,133.16,0,0,1,25,128c4.69-8.79,19.66-33.39,47.35-49.38l18,19.75a48,48,0,0,0,63.66,70l14.73,16.2A112,112,0,0,1,128,192Zm6-95.43a8,8,0,0,1,3-15.72,48.16,48.16,0,0,1,38.77,42.64,8,8,0,0,1-7.22,8.71,6.39,6.39,0,0,1-.75,0,8,8,0,0,1-8-7.26A32.09,32.09,0,0,0,134,96.57Zm113.28,34.69c-.42.94-10.55,23.37-33.36,43.8a8,8,0,1,1-10.67-11.92A132.77,132.77,0,0,0,231.05,128a133.15,133.15,0,0,0-23.12-30.77C185.67,75.19,158.78,64,128,64a118.37,118.37,0,0,0-19.36,1.57A8,8,0,1,1,106,49.79,134,134,0,0,1,128,48c34.88,0,66.57,13.26,91.66,38.35,18.83,18.83,27.3,37.62,27.65,38.41A8,8,0,0,1,247.31,131.26Z"></path>'),_N=ht('<path d="M51,37.31A4,4,0,0,0,45,42.69L67.59,67.5C29.34,89,13,124.81,12.34,126.38a4.08,4.08,0,0,0,0,3.25c.34.77,8.52,18.89,26.83,37.2,17,17,46.14,37.17,88.83,37.17a122.59,122.59,0,0,0,53.06-11.69l24,26.38a4,4,0,1,0,5.92-5.38ZM149.1,157.16A36,36,0,0,1,101,104.22ZM128,196c-32,0-59.89-11.65-83-34.62A135.81,135.81,0,0,1,20.44,128c3.65-7.23,20.09-36.81,52.68-54.43l22.45,24.7a44,44,0,0,0,59,64.83l20.89,23A114.94,114.94,0,0,1,128,196Zm6.78-103.36a4,4,0,0,1,1.49-7.86,44.15,44.15,0,0,1,35.54,39.09,4,4,0,0,1-3.61,4.35l-.38,0a4,4,0,0,1-4-3.63A36.1,36.1,0,0,0,134.78,92.64Zm108.88,37c-.41.91-10.2,22.58-32.38,42.45a4,4,0,0,1-2.67,1,4,4,0,0,1-2.67-7A136.71,136.71,0,0,0,235.56,128,136.07,136.07,0,0,0,211,94.62C187.89,71.65,160,60,128,60a122,122,0,0,0-20,1.63,4,4,0,0,1-1.32-7.89A129.3,129.3,0,0,1,128,52c42.7,0,71.87,20.22,88.83,37.18,18.31,18.31,26.49,36.44,26.83,37.2A4.08,4.08,0,0,1,243.66,129.63Z"></path>'),vN=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function a8(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=vN();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=dN();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=fN();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=pN();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=mN();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=gN();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=_N();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var yN=ht('<path d="M216.49,79.52l-56-56A12,12,0,0,0,152,20H56A20,20,0,0,0,36,40V216a20,20,0,0,0,20,20H200a20,20,0,0,0,20-20V88A12,12,0,0,0,216.49,79.52ZM160,57l23,23H160ZM60,212V44h76V92a12,12,0,0,0,12,12h48V212Zm112-80a12,12,0,0,1-12,12H96a12,12,0,0,1,0-24h64A12,12,0,0,1,172,132Zm0,40a12,12,0,0,1-12,12H96a12,12,0,0,1,0-24h64A12,12,0,0,1,172,172Z"></path>'),bN=ht('<path d="M208,88H152V32Z" opacity="0.2"></path><path d="M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Zm-32-80a8,8,0,0,1-8,8H96a8,8,0,0,1,0-16h64A8,8,0,0,1,168,136Zm0,32a8,8,0,0,1-8,8H96a8,8,0,0,1,0-16h64A8,8,0,0,1,168,168Z"></path>',1),wN=ht('<path d="M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,176H96a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Zm0-32H96a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Zm-8-56V44l44,44Z"></path>'),xN=ht('<path d="M212.24,83.76l-56-56A6,6,0,0,0,152,26H56A14,14,0,0,0,42,40V216a14,14,0,0,0,14,14H200a14,14,0,0,0,14-14V88A6,6,0,0,0,212.24,83.76ZM158,46.48,193.52,82H158ZM200,218H56a2,2,0,0,1-2-2V40a2,2,0,0,1,2-2h90V88a6,6,0,0,0,6,6h50V216A2,2,0,0,1,200,218Zm-34-82a6,6,0,0,1-6,6H96a6,6,0,0,1,0-12h64A6,6,0,0,1,166,136Zm0,32a6,6,0,0,1-6,6H96a6,6,0,0,1,0-12h64A6,6,0,0,1,166,168Z"></path>'),MN=ht('<path d="M213.66,82.34l-56-56A8,8,0,0,0,152,24H56A16,16,0,0,0,40,40V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V88A8,8,0,0,0,213.66,82.34ZM160,51.31,188.69,80H160ZM200,216H56V40h88V88a8,8,0,0,0,8,8h48V216Zm-32-80a8,8,0,0,1-8,8H96a8,8,0,0,1,0-16h64A8,8,0,0,1,168,136Zm0,32a8,8,0,0,1-8,8H96a8,8,0,0,1,0-16h64A8,8,0,0,1,168,168Z"></path>'),IN=ht('<path d="M210.83,85.17l-56-56A4,4,0,0,0,152,28H56A12,12,0,0,0,44,40V216a12,12,0,0,0,12,12H200a12,12,0,0,0,12-12V88A4,4,0,0,0,210.83,85.17ZM156,41.65,198.34,84H156ZM200,220H56a4,4,0,0,1-4-4V40a4,4,0,0,1,4-4h92V88a4,4,0,0,0,4,4h52V216A4,4,0,0,1,200,220Zm-36-84a4,4,0,0,1-4,4H96a4,4,0,0,1,0-8h64A4,4,0,0,1,164,136Zm0,32a4,4,0,0,1-4,4H96a4,4,0,0,1,0-8h64A4,4,0,0,1,164,168Z"></path>'),AN=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function TN(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=AN();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=yN();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=bN();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=wN();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=xN();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=MN();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=IN();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var CN=ht('<path d="M128,76a52,52,0,1,0,52,52A52.06,52.06,0,0,0,128,76Zm0,80a28,28,0,1,1,28-28A28,28,0,0,1,128,156Zm92-27.21v-1.58l14-17.51a12,12,0,0,0,2.23-10.59A111.75,111.75,0,0,0,225,71.89,12,12,0,0,0,215.89,66L193.61,63.5l-1.11-1.11L190,40.1A12,12,0,0,0,184.11,31a111.67,111.67,0,0,0-27.23-11.27A12,12,0,0,0,146.3,22L128.79,36h-1.58L109.7,22a12,12,0,0,0-10.59-2.23A111.75,111.75,0,0,0,71.89,31.05,12,12,0,0,0,66,40.11L63.5,62.39,62.39,63.5,40.1,66A12,12,0,0,0,31,71.89,111.67,111.67,0,0,0,19.77,99.12,12,12,0,0,0,22,109.7l14,17.51v1.58L22,146.3a12,12,0,0,0-2.23,10.59,111.75,111.75,0,0,0,11.29,27.22A12,12,0,0,0,40.11,190l22.28,2.48,1.11,1.11L66,215.9A12,12,0,0,0,71.89,225a111.67,111.67,0,0,0,27.23,11.27A12,12,0,0,0,109.7,234l17.51-14h1.58l17.51,14a12,12,0,0,0,10.59,2.23A111.75,111.75,0,0,0,184.11,225a12,12,0,0,0,5.91-9.06l2.48-22.28,1.11-1.11L215.9,190a12,12,0,0,0,9.06-5.91,111.67,111.67,0,0,0,11.27-27.23A12,12,0,0,0,234,146.3Zm-24.12-4.89a70.1,70.1,0,0,1,0,8.2,12,12,0,0,0,2.61,8.22l12.84,16.05A86.47,86.47,0,0,1,207,166.86l-20.43,2.27a12,12,0,0,0-7.65,4,69,69,0,0,1-5.8,5.8,12,12,0,0,0-4,7.65L166.86,207a86.47,86.47,0,0,1-10.49,4.35l-16.05-12.85a12,12,0,0,0-7.5-2.62c-.24,0-.48,0-.72,0a70.1,70.1,0,0,1-8.2,0,12.06,12.06,0,0,0-8.22,2.6L99.63,211.33A86.47,86.47,0,0,1,89.14,207l-2.27-20.43a12,12,0,0,0-4-7.65,69,69,0,0,1-5.8-5.8,12,12,0,0,0-7.65-4L49,166.86a86.47,86.47,0,0,1-4.35-10.49l12.84-16.05a12,12,0,0,0,2.61-8.22,70.1,70.1,0,0,1,0-8.2,12,12,0,0,0-2.61-8.22L44.67,99.63A86.47,86.47,0,0,1,49,89.14l20.43-2.27a12,12,0,0,0,7.65-4,69,69,0,0,1,5.8-5.8,12,12,0,0,0,4-7.65L89.14,49a86.47,86.47,0,0,1,10.49-4.35l16.05,12.85a12.06,12.06,0,0,0,8.22,2.6,70.1,70.1,0,0,1,8.2,0,12,12,0,0,0,8.22-2.6l16.05-12.85A86.47,86.47,0,0,1,166.86,49l2.27,20.43a12,12,0,0,0,4,7.65,69,69,0,0,1,5.8,5.8,12,12,0,0,0,7.65,4L207,89.14a86.47,86.47,0,0,1,4.35,10.49l-12.84,16.05A12,12,0,0,0,195.88,123.9Z"></path>'),SN=ht('<path d="M207.86,123.18l16.78-21a99.14,99.14,0,0,0-10.07-24.29l-26.7-3a81,81,0,0,0-6.81-6.81l-3-26.71a99.43,99.43,0,0,0-24.3-10l-21,16.77a81.59,81.59,0,0,0-9.64,0l-21-16.78A99.14,99.14,0,0,0,77.91,41.43l-3,26.7a81,81,0,0,0-6.81,6.81l-26.71,3a99.43,99.43,0,0,0-10,24.3l16.77,21a81.59,81.59,0,0,0,0,9.64l-16.78,21a99.14,99.14,0,0,0,10.07,24.29l26.7,3a81,81,0,0,0,6.81,6.81l3,26.71a99.43,99.43,0,0,0,24.3,10l21-16.77a81.59,81.59,0,0,0,9.64,0l21,16.78a99.14,99.14,0,0,0,24.29-10.07l3-26.7a81,81,0,0,0,6.81-6.81l26.71-3a99.43,99.43,0,0,0,10-24.3l-16.77-21A81.59,81.59,0,0,0,207.86,123.18ZM128,168a40,40,0,1,1,40-40A40,40,0,0,1,128,168Z" opacity="0.2"></path><path d="M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Zm88-29.84q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.6,107.6,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.29,107.29,0,0,0-26.25-10.86,8,8,0,0,0-7.06,1.48L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.6,107.6,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06Zm-16.1-6.5a73.93,73.93,0,0,1,0,8.68,8,8,0,0,0,1.74,5.48l14.19,17.73a91.57,91.57,0,0,1-6.23,15L187,173.11a8,8,0,0,0-5.1,2.64,74.11,74.11,0,0,1-6.14,6.14,8,8,0,0,0-2.64,5.1l-2.51,22.58a91.32,91.32,0,0,1-15,6.23l-17.74-14.19a8,8,0,0,0-5-1.75h-.48a73.93,73.93,0,0,1-8.68,0,8.06,8.06,0,0,0-5.48,1.74L100.45,215.8a91.57,91.57,0,0,1-15-6.23L82.89,187a8,8,0,0,0-2.64-5.1,74.11,74.11,0,0,1-6.14-6.14,8,8,0,0,0-5.1-2.64L46.43,170.6a91.32,91.32,0,0,1-6.23-15l14.19-17.74a8,8,0,0,0,1.74-5.48,73.93,73.93,0,0,1,0-8.68,8,8,0,0,0-1.74-5.48L40.2,100.45a91.57,91.57,0,0,1,6.23-15L69,82.89a8,8,0,0,0,5.1-2.64,74.11,74.11,0,0,1,6.14-6.14A8,8,0,0,0,82.89,69L85.4,46.43a91.32,91.32,0,0,1,15-6.23l17.74,14.19a8,8,0,0,0,5.48,1.74,73.93,73.93,0,0,1,8.68,0,8.06,8.06,0,0,0,5.48-1.74L155.55,40.2a91.57,91.57,0,0,1,15,6.23L173.11,69a8,8,0,0,0,2.64,5.1,74.11,74.11,0,0,1,6.14,6.14,8,8,0,0,0,5.1,2.64l22.58,2.51a91.32,91.32,0,0,1,6.23,15l-14.19,17.74A8,8,0,0,0,199.87,123.66Z"></path>',1),PN=ht('<path d="M216,130.16q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.6,107.6,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.29,107.29,0,0,0-26.25-10.86,8,8,0,0,0-7.06,1.48L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.6,107.6,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06ZM128,168a40,40,0,1,1,40-40A40,40,0,0,1,128,168Z"></path>'),EN=ht('<path d="M128,82a46,46,0,1,0,46,46A46.06,46.06,0,0,0,128,82Zm0,80a34,34,0,1,1,34-34A34,34,0,0,1,128,162ZM214,130.84c.06-1.89.06-3.79,0-5.68L229.33,106a6,6,0,0,0,1.11-5.29A105.34,105.34,0,0,0,219.76,74.9a6,6,0,0,0-4.53-3l-24.45-2.71q-1.93-2.07-4-4l-2.72-24.46a6,6,0,0,0-3-4.53,105.65,105.65,0,0,0-25.77-10.66A6,6,0,0,0,150,26.68l-19.2,15.37c-1.89-.06-3.79-.06-5.68,0L106,26.67a6,6,0,0,0-5.29-1.11A105.34,105.34,0,0,0,74.9,36.24a6,6,0,0,0-3,4.53L69.23,65.22q-2.07,1.94-4,4L40.76,72a6,6,0,0,0-4.53,3,105.65,105.65,0,0,0-10.66,25.77A6,6,0,0,0,26.68,106l15.37,19.2c-.06,1.89-.06,3.79,0,5.68L26.67,150.05a6,6,0,0,0-1.11,5.29A105.34,105.34,0,0,0,36.24,181.1a6,6,0,0,0,4.53,3l24.45,2.71q1.94,2.07,4,4L72,215.24a6,6,0,0,0,3,4.53,105.65,105.65,0,0,0,25.77,10.66,6,6,0,0,0,5.29-1.11L125.16,214c1.89.06,3.79.06,5.68,0l19.21,15.38a6,6,0,0,0,3.75,1.31,6.2,6.2,0,0,0,1.54-.2,105.34,105.34,0,0,0,25.76-10.68,6,6,0,0,0,3-4.53l2.71-24.45q2.07-1.93,4-4l24.46-2.72a6,6,0,0,0,4.53-3,105.49,105.49,0,0,0,10.66-25.77,6,6,0,0,0-1.11-5.29Zm-3.1,41.63-23.64,2.63a6,6,0,0,0-3.82,2,75.14,75.14,0,0,1-6.31,6.31,6,6,0,0,0-2,3.82l-2.63,23.63A94.28,94.28,0,0,1,155.14,218l-18.57-14.86a6,6,0,0,0-3.75-1.31h-.36a78.07,78.07,0,0,1-8.92,0,6,6,0,0,0-4.11,1.3L100.87,218a94.13,94.13,0,0,1-17.34-7.17L80.9,187.21a6,6,0,0,0-2-3.82,75.14,75.14,0,0,1-6.31-6.31,6,6,0,0,0-3.82-2l-23.63-2.63A94.28,94.28,0,0,1,38,155.14l14.86-18.57a6,6,0,0,0,1.3-4.11,78.07,78.07,0,0,1,0-8.92,6,6,0,0,0-1.3-4.11L38,100.87a94.13,94.13,0,0,1,7.17-17.34L68.79,80.9a6,6,0,0,0,3.82-2,75.14,75.14,0,0,1,6.31-6.31,6,6,0,0,0,2-3.82l2.63-23.63A94.28,94.28,0,0,1,100.86,38l18.57,14.86a6,6,0,0,0,4.11,1.3,78.07,78.07,0,0,1,8.92,0,6,6,0,0,0,4.11-1.3L155.13,38a94.13,94.13,0,0,1,17.34,7.17l2.63,23.64a6,6,0,0,0,2,3.82,75.14,75.14,0,0,1,6.31,6.31,6,6,0,0,0,3.82,2l23.63,2.63A94.28,94.28,0,0,1,218,100.86l-14.86,18.57a6,6,0,0,0-1.3,4.11,78.07,78.07,0,0,1,0,8.92,6,6,0,0,0,1.3,4.11L218,155.13A94.13,94.13,0,0,1,210.85,172.47Z"></path>'),kN=ht('<path d="M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Zm88-29.84q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.21,107.21,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.71,107.71,0,0,0-26.25-10.87,8,8,0,0,0-7.06,1.49L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.21,107.21,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06Zm-16.1-6.5a73.93,73.93,0,0,1,0,8.68,8,8,0,0,0,1.74,5.48l14.19,17.73a91.57,91.57,0,0,1-6.23,15L187,173.11a8,8,0,0,0-5.1,2.64,74.11,74.11,0,0,1-6.14,6.14,8,8,0,0,0-2.64,5.1l-2.51,22.58a91.32,91.32,0,0,1-15,6.23l-17.74-14.19a8,8,0,0,0-5-1.75h-.48a73.93,73.93,0,0,1-8.68,0,8,8,0,0,0-5.48,1.74L100.45,215.8a91.57,91.57,0,0,1-15-6.23L82.89,187a8,8,0,0,0-2.64-5.1,74.11,74.11,0,0,1-6.14-6.14,8,8,0,0,0-5.1-2.64L46.43,170.6a91.32,91.32,0,0,1-6.23-15l14.19-17.74a8,8,0,0,0,1.74-5.48,73.93,73.93,0,0,1,0-8.68,8,8,0,0,0-1.74-5.48L40.2,100.45a91.57,91.57,0,0,1,6.23-15L69,82.89a8,8,0,0,0,5.1-2.64,74.11,74.11,0,0,1,6.14-6.14A8,8,0,0,0,82.89,69L85.4,46.43a91.32,91.32,0,0,1,15-6.23l17.74,14.19a8,8,0,0,0,5.48,1.74,73.93,73.93,0,0,1,8.68,0,8,8,0,0,0,5.48-1.74L155.55,40.2a91.57,91.57,0,0,1,15,6.23L173.11,69a8,8,0,0,0,2.64,5.1,74.11,74.11,0,0,1,6.14,6.14,8,8,0,0,0,5.1,2.64l22.58,2.51a91.32,91.32,0,0,1,6.23,15l-14.19,17.74A8,8,0,0,0,199.87,123.66Z"></path>'),RN=ht('<path d="M128,84a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,84Zm0,80a36,36,0,1,1,36-36A36,36,0,0,1,128,164Zm83.93-32.49q.13-3.51,0-7l15.83-19.79a4,4,0,0,0,.75-3.53A103.64,103.64,0,0,0,218,75.9a4,4,0,0,0-3-2l-25.19-2.8c-1.58-1.71-3.24-3.37-4.95-4.95L182.07,41a4,4,0,0,0-2-3A104,104,0,0,0,154.82,27.5a4,4,0,0,0-3.53.74L131.51,44.07q-3.51-.14-7,0L104.7,28.24a4,4,0,0,0-3.53-.75A103.64,103.64,0,0,0,75.9,38a4,4,0,0,0-2,3l-2.8,25.19c-1.71,1.58-3.37,3.24-4.95,4.95L41,73.93a4,4,0,0,0-3,2A104,104,0,0,0,27.5,101.18a4,4,0,0,0,.74,3.53l15.83,19.78q-.14,3.51,0,7L28.24,151.3a4,4,0,0,0-.75,3.53A103.64,103.64,0,0,0,38,180.1a4,4,0,0,0,3,2l25.19,2.8c1.58,1.71,3.24,3.37,4.95,4.95l2.8,25.2a4,4,0,0,0,2,3,104,104,0,0,0,25.28,10.46,4,4,0,0,0,3.53-.74l19.78-15.83q3.51.13,7,0l19.79,15.83a4,4,0,0,0,2.5.88,4,4,0,0,0,1-.13A103.64,103.64,0,0,0,180.1,218a4,4,0,0,0,2-3l2.8-25.19c1.71-1.58,3.37-3.24,4.95-4.95l25.2-2.8a4,4,0,0,0,3-2,104,104,0,0,0,10.46-25.28,4,4,0,0,0-.74-3.53Zm.17,42.83-24.67,2.74a4,4,0,0,0-2.55,1.32,76.2,76.2,0,0,1-6.48,6.48,4,4,0,0,0-1.32,2.55l-2.74,24.66a95.45,95.45,0,0,1-19.64,8.15l-19.38-15.51a4,4,0,0,0-2.5-.87h-.24a73.67,73.67,0,0,1-9.16,0,4,4,0,0,0-2.74.87l-19.37,15.5a95.33,95.33,0,0,1-19.65-8.13l-2.74-24.67a4,4,0,0,0-1.32-2.55,76.2,76.2,0,0,1-6.48-6.48,4,4,0,0,0-2.55-1.32l-24.66-2.74a95.45,95.45,0,0,1-8.15-19.64l15.51-19.38a4,4,0,0,0,.87-2.74,77.76,77.76,0,0,1,0-9.16,4,4,0,0,0-.87-2.74l-15.5-19.37A95.33,95.33,0,0,1,43.9,81.66l24.67-2.74a4,4,0,0,0,2.55-1.32,76.2,76.2,0,0,1,6.48-6.48,4,4,0,0,0,1.32-2.55l2.74-24.66a95.45,95.45,0,0,1,19.64-8.15l19.38,15.51a4,4,0,0,0,2.74.87,73.67,73.67,0,0,1,9.16,0,4,4,0,0,0,2.74-.87l19.37-15.5a95.33,95.33,0,0,1,19.65,8.13l2.74,24.67a4,4,0,0,0,1.32,2.55,76.2,76.2,0,0,1,6.48,6.48,4,4,0,0,0,2.55,1.32l24.66,2.74a95.45,95.45,0,0,1,8.15,19.64l-15.51,19.38a4,4,0,0,0-.87,2.74,77.76,77.76,0,0,1,0,9.16,4,4,0,0,0,.87,2.74l15.5,19.37A95.33,95.33,0,0,1,212.1,174.34Z"></path>'),LN=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function zN(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=LN();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=CN();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=SN();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=PN();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=EN();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=kN();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=RN();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var FN=ht('<path d="M20,108A12,12,0,0,1,32,96h76a12,12,0,0,1,0,24H32A12,12,0,0,1,20,108ZM224,96H148a12,12,0,0,0,0,24h76a12,12,0,0,0,0-24ZM68,136H32a12,12,0,0,0,0,24H68a12,12,0,0,0,0-24Zm156,0H188a12,12,0,0,0,0,24h36a12,12,0,0,0,0-24ZM96,148a12,12,0,0,0,12,12h40a12,12,0,0,0,0-24H108A12,12,0,0,0,96,148ZM52,176H32a12,12,0,0,0,0,24H52a12,12,0,0,0,0-24Zm56,0H92a12,12,0,0,0,0,24h16a12,12,0,0,0,0-24Zm56,0H148a12,12,0,0,0,0,24h16a12,12,0,0,0,0-24Zm60,0H204a12,12,0,0,0,0,24h20a12,12,0,0,0,0-24ZM32,80H224a12,12,0,0,0,0-24H32a12,12,0,0,0,0,24Z"></path>'),DN=ht('<path d="M224,64V184H32V64Z" opacity="0.2"></path><path d="M24,104a8,8,0,0,1,8-8h80a8,8,0,0,1,0,16H32A8,8,0,0,1,24,104Zm200-8H144a8,8,0,0,0,0,16h80a8,8,0,0,0,0-16ZM72,136H32a8,8,0,0,0,0,16H72a8,8,0,0,0,0-16Zm152,0H184a8,8,0,0,0,0,16h40a8,8,0,0,0,0-16ZM96,144a8,8,0,0,0,8,8h48a8,8,0,0,0,0-16H104A8,8,0,0,0,96,144ZM56,176H32a8,8,0,0,0,0,16H56a8,8,0,0,0,0-16Zm56,0H88a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16Zm56,0H144a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16Zm56,0H200a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16ZM32,72H224a8,8,0,0,0,0-16H32a8,8,0,0,0,0,16Z"></path>',1),BN=ht('<path d="M80,192a8,8,0,0,1-8,8H32a8,8,0,0,1,0-16H72A8,8,0,0,1,80,192Zm144-8H184a8,8,0,0,0,0,16h40a8,8,0,0,0,0-16Zm-72,0H104a8,8,0,0,0,0,16h48a8,8,0,0,0,0-16ZM32,168h80a8,8,0,0,0,0-16H32a8,8,0,0,0,0,16Zm192-16H144a8,8,0,0,0,0,16h80a8,8,0,0,0,0-16Zm0-96H32a8,8,0,0,0-8,8V88a8,8,0,0,0,8,8H224a8,8,0,0,0,8-8V64A8,8,0,0,0,224,56Zm0,56H32a8,8,0,0,0-8,8v8a8,8,0,0,0,8,8H224a8,8,0,0,0,8-8v-8A8,8,0,0,0,224,112Z"></path>'),GN=ht('<path d="M26,104a6,6,0,0,1,6-6h80a6,6,0,0,1,0,12H32A6,6,0,0,1,26,104Zm198-6H144a6,6,0,0,0,0,12h80a6,6,0,0,0,0-12ZM72,138H32a6,6,0,0,0,0,12H72a6,6,0,0,0,0-12Zm152,0H184a6,6,0,0,0,0,12h40a6,6,0,0,0,0-12ZM98,144a6,6,0,0,0,6,6h48a6,6,0,0,0,0-12H104A6,6,0,0,0,98,144ZM56,178H32a6,6,0,0,0,0,12H56a6,6,0,0,0,0-12Zm56,0H88a6,6,0,0,0,0,12h24a6,6,0,0,0,0-12Zm56,0H144a6,6,0,0,0,0,12h24a6,6,0,0,0,0-12Zm56,0H200a6,6,0,0,0,0,12h24a6,6,0,0,0,0-12ZM32,70H224a6,6,0,0,0,0-12H32a6,6,0,0,0,0,12Z"></path>'),VN=ht('<path d="M24,104a8,8,0,0,1,8-8h80a8,8,0,0,1,0,16H32A8,8,0,0,1,24,104Zm200-8H144a8,8,0,0,0,0,16h80a8,8,0,0,0,0-16ZM72,136H32a8,8,0,0,0,0,16H72a8,8,0,0,0,0-16Zm152,0H184a8,8,0,0,0,0,16h40a8,8,0,0,0,0-16ZM96,144a8,8,0,0,0,8,8h48a8,8,0,0,0,0-16H104A8,8,0,0,0,96,144ZM56,176H32a8,8,0,0,0,0,16H56a8,8,0,0,0,0-16Zm56,0H88a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16Zm56,0H144a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16Zm56,0H200a8,8,0,0,0,0,16h24a8,8,0,0,0,0-16ZM32,72H224a8,8,0,0,0,0-16H32a8,8,0,0,0,0,16Z"></path>'),jN=ht('<path d="M28,104a4,4,0,0,1,4-4h80a4,4,0,0,1,0,8H32A4,4,0,0,1,28,104Zm196-4H144a4,4,0,0,0,0,8h80a4,4,0,0,0,0-8ZM72,140H32a4,4,0,0,0,0,8H72a4,4,0,0,0,0-8Zm152,0H184a4,4,0,0,0,0,8h40a4,4,0,0,0,0-8Zm-124,4a4,4,0,0,0,4,4h48a4,4,0,0,0,0-8H104A4,4,0,0,0,100,144ZM56,180H32a4,4,0,0,0,0,8H56a4,4,0,0,0,0-8Zm56,0H88a4,4,0,0,0,0,8h24a4,4,0,0,0,0-8Zm56,0H144a4,4,0,0,0,0,8h24a4,4,0,0,0,0-8Zm56,0H200a4,4,0,0,0,0,8h24a4,4,0,0,0,0-8ZM32,68H224a4,4,0,0,0,0-8H32a4,4,0,0,0,0,8Z"></path>'),ZN=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function ON(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=ZN();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=FN();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=DN();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=BN();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=GN();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=VN();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=jN();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var NN=ht('<path d="M188,76a31.85,31.85,0,0,0-11.21,2,32,32,0,0,0-48.79-11A32,32,0,0,0,76,92v16H68a32,32,0,0,0-32,32v12a92,92,0,0,0,184,0V108A32,32,0,0,0,188,76Zm8,76a68,68,0,0,1-136,0V140a8,8,0,0,1,8-8h8v20a12,12,0,0,0,24,0V92a8,8,0,0,1,16,0v28a12,12,0,0,0,24,0V92a8,8,0,0,1,16,0v28a12,12,0,0,0,24,0V108a8,8,0,0,1,16,0Z"></path>'),UN=ht('<path d="M208,108v44a80,80,0,0,1-160,0V140a20,20,0,0,1,20-20H88V92a20,20,0,0,1,40,0,20,20,0,0,1,40,0v16a20,20,0,0,1,40,0Z" opacity="0.2"></path><path d="M188,80a27.79,27.79,0,0,0-13.36,3.4,28,28,0,0,0-46.64-11A28,28,0,0,0,80,92v20H68a28,28,0,0,0-28,28v12a88,88,0,0,0,176,0V108A28,28,0,0,0,188,80Zm12,72a72,72,0,0,1-144,0V140a12,12,0,0,1,12-12H80v24a8,8,0,0,0,16,0V92a12,12,0,0,1,24,0v28a8,8,0,0,0,16,0V92a12,12,0,0,1,24,0v28a8,8,0,0,0,16,0V108a12,12,0,0,1,24,0Z"></path>',1),HN=ht('<path d="M216,104v48a88,88,0,0,1-176,0V136a16,16,0,0,1,32,0v8a8,8,0,0,0,16,0V88a16,16,0,0,1,32,0v16a8,8,0,0,0,16,0V88a16,16,0,0,1,32,0v16a8,8,0,0,0,16,0,16,16,0,0,1,32,0Z"></path>'),WN=ht('<path d="M188,82a25.85,25.85,0,0,0-14.59,4.49A26,26,0,0,0,128,75.41,26,26,0,0,0,82,92v22H68a26,26,0,0,0-26,26v12a86,86,0,0,0,172,0V108A26,26,0,0,0,188,82Zm14,70a74,74,0,0,1-148,0V140a14,14,0,0,1,14-14H82v26a6,6,0,0,0,12,0V92a14,14,0,0,1,28,0v28a6,6,0,0,0,12,0V92a14,14,0,0,1,28,0v28a6,6,0,0,0,12,0V108a14,14,0,0,1,28,0Z"></path>'),XN=ht('<path d="M188,80a27.79,27.79,0,0,0-13.36,3.4,28,28,0,0,0-46.64-11A28,28,0,0,0,80,92v20H68a28,28,0,0,0-28,28v12a88,88,0,0,0,176,0V108A28,28,0,0,0,188,80Zm12,72a72,72,0,0,1-144,0V140a12,12,0,0,1,12-12H80v24a8,8,0,0,0,16,0V92a12,12,0,0,1,24,0v28a8,8,0,0,0,16,0V92a12,12,0,0,1,24,0v28a8,8,0,0,0,16,0V108a12,12,0,0,1,24,0Z"></path>'),qN=ht('<path d="M188,84a23.87,23.87,0,0,0-16.07,6.2A24,24,0,0,0,128,78.75,24,24,0,0,0,84,92v24H68a24,24,0,0,0-24,24v12a84,84,0,0,0,168,0V108A24,24,0,0,0,188,84Zm16,68a76,76,0,0,1-152,0V140a16,16,0,0,1,16-16H84v28a4,4,0,0,0,8,0V92a16,16,0,0,1,32,0v28a4,4,0,0,0,8,0V92a16,16,0,0,1,32,0v28a4,4,0,0,0,8,0V108a16,16,0,0,1,32,0Z"></path>'),YN=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function KN(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=YN();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=NN();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=UN();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=HN();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=WN();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=XN();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=qN();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var $N=ht('<path d="M108,84a16,16,0,1,1,16,16A16,16,0,0,1,108,84Zm128,44A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128Zm-72,36.68V132a20,20,0,0,0-20-20,12,12,0,0,0-4,23.32V168a20,20,0,0,0,20,20,12,12,0,0,0,4-23.32Z"></path>'),JN=ht('<path d="M224,128a96,96,0,1,1-96-96A96,96,0,0,1,224,128Z" opacity="0.2"></path><path d="M144,176a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176Zm88-48A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128ZM124,96a12,12,0,1,0-12-12A12,12,0,0,0,124,96Z"></path>',1),QN=ht('<path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm-4,48a12,12,0,1,1-12,12A12,12,0,0,1,124,72Zm12,112a16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40a8,8,0,0,1,0,16Z"></path>'),eU=ht('<path d="M142,176a6,6,0,0,1-6,6,14,14,0,0,1-14-14V128a2,2,0,0,0-2-2,6,6,0,0,1,0-12,14,14,0,0,1,14,14v40a2,2,0,0,0,2,2A6,6,0,0,1,142,176ZM124,94a10,10,0,1,0-10-10A10,10,0,0,0,124,94Zm106,34A102,102,0,1,1,128,26,102.12,102.12,0,0,1,230,128Zm-12,0a90,90,0,1,0-90,90A90.1,90.1,0,0,0,218,128Z"></path>'),tU=ht('<path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm16-40a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176ZM112,84a12,12,0,1,1,12,12A12,12,0,0,1,112,84Z"></path>'),rU=ht('<path d="M140,176a4,4,0,0,1-4,4,12,12,0,0,1-12-12V128a4,4,0,0,0-4-4,4,4,0,0,1,0-8,12,12,0,0,1,12,12v40a4,4,0,0,0,4,4A4,4,0,0,1,140,176ZM124,92a8,8,0,1,0-8-8A8,8,0,0,0,124,92Zm104,36A100,100,0,1,1,128,28,100.11,100.11,0,0,1,228,128Zm-8,0a92,92,0,1,0-92,92A92.1,92.1,0,0,0,220,128Z"></path>'),iU=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function sy(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=iU();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=$N();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=JN();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=QN();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=eU();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=tU();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=rU();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var nU=ht('<path d="M216,20H40A20,20,0,0,0,20,40V216a20,20,0,0,0,20,20H216a20,20,0,0,0,20-20V40A20,20,0,0,0,216,20Zm-4,192H44V44H212ZM112,176V120a12,12,0,0,1,21.43-7.41A40,40,0,0,1,192,148v28a12,12,0,0,1-24,0V148a16,16,0,0,0-32,0v28a12,12,0,0,1-24,0ZM96,120v56a12,12,0,0,1-24,0V120a12,12,0,0,1,24,0ZM68,80A16,16,0,1,1,84,96,16,16,0,0,1,68,80Z"></path>'),sU=ht('<path d="M224,40V216a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8H216A8,8,0,0,1,224,40Z" opacity="0.2"></path><path d="M216,24H40A16,16,0,0,0,24,40V216a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V40A16,16,0,0,0,216,24Zm0,192H40V40H216V216ZM96,112v64a8,8,0,0,1-16,0V112a8,8,0,0,1,16,0Zm88,28v36a8,8,0,0,1-16,0V140a20,20,0,0,0-40,0v36a8,8,0,0,1-16,0V112a8,8,0,0,1,15.79-1.78A36,36,0,0,1,184,140ZM100,84A12,12,0,1,1,88,72,12,12,0,0,1,100,84Z"></path>',1),aU=ht('<path d="M216,24H40A16,16,0,0,0,24,40V216a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V40A16,16,0,0,0,216,24ZM96,176a8,8,0,0,1-16,0V112a8,8,0,0,1,16,0ZM88,96a12,12,0,1,1,12-12A12,12,0,0,1,88,96Zm96,80a8,8,0,0,1-16,0V140a20,20,0,0,0-40,0v36a8,8,0,0,1-16,0V112a8,8,0,0,1,15.79-1.78A36,36,0,0,1,184,140Z"></path>'),oU=ht('<path d="M216,26H40A14,14,0,0,0,26,40V216a14,14,0,0,0,14,14H216a14,14,0,0,0,14-14V40A14,14,0,0,0,216,26Zm2,190a2,2,0,0,1-2,2H40a2,2,0,0,1-2-2V40a2,2,0,0,1,2-2H216a2,2,0,0,1,2,2ZM94,112v64a6,6,0,0,1-12,0V112a6,6,0,0,1,12,0Zm88,28v36a6,6,0,0,1-12,0V140a22,22,0,0,0-44,0v36a6,6,0,0,1-12,0V112a6,6,0,0,1,12,0v2.11A34,34,0,0,1,182,140ZM98,84A10,10,0,1,1,88,74,10,10,0,0,1,98,84Z"></path>'),lU=ht('<path d="M216,24H40A16,16,0,0,0,24,40V216a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V40A16,16,0,0,0,216,24Zm0,192H40V40H216V216ZM96,112v64a8,8,0,0,1-16,0V112a8,8,0,0,1,16,0Zm88,28v36a8,8,0,0,1-16,0V140a20,20,0,0,0-40,0v36a8,8,0,0,1-16,0V112a8,8,0,0,1,15.79-1.78A36,36,0,0,1,184,140ZM100,84A12,12,0,1,1,88,72,12,12,0,0,1,100,84Z"></path>'),cU=ht('<path d="M216,28H40A12,12,0,0,0,28,40V216a12,12,0,0,0,12,12H216a12,12,0,0,0,12-12V40A12,12,0,0,0,216,28Zm4,188a4,4,0,0,1-4,4H40a4,4,0,0,1-4-4V40a4,4,0,0,1,4-4H216a4,4,0,0,1,4,4ZM92,112v64a4,4,0,0,1-8,0V112a4,4,0,0,1,8,0Zm88,28v36a4,4,0,0,1-8,0V140a24,24,0,0,0-48,0v36a4,4,0,0,1-8,0V112a4,4,0,0,1,8,0v6.87A32,32,0,0,1,180,140ZM96,84a8,8,0,1,1-8-8A8,8,0,0,1,96,84Z"></path>'),hU=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function uU(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=hU();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=nU();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=sU();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=aU();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=oU();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=lU();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=cU();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var dU=ht('<path d="M156,112a12,12,0,0,1-12,12H80a12,12,0,0,1,0-24h64A12,12,0,0,1,156,112Zm76.49,120.49a12,12,0,0,1-17,0L168,185a92.12,92.12,0,1,1,17-17l47.54,47.53A12,12,0,0,1,232.49,232.49ZM112,180a68,68,0,1,0-68-68A68.08,68.08,0,0,0,112,180Z"></path>'),fU=ht('<path d="M192,112a80,80,0,1,1-80-80A80,80,0,0,1,192,112Z" opacity="0.2"></path><path d="M229.66,218.34,179.6,168.28a88.21,88.21,0,1,0-11.32,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Zm112,0a8,8,0,0,1-8,8H80a8,8,0,0,1,0-16h64A8,8,0,0,1,152,112Z"></path>',1),pU=ht('<path d="M229.66,218.34,179.6,168.28a88.21,88.21,0,1,0-11.32,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM144,120H80a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Z"></path>'),mU=ht('<path d="M150,112a6,6,0,0,1-6,6H80a6,6,0,0,1,0-12h64A6,6,0,0,1,150,112Zm78.24,116.24a6,6,0,0,1-8.48,0l-51.38-51.38a86.15,86.15,0,1,1,8.48-8.48l51.38,51.38A6,6,0,0,1,228.24,228.24ZM112,186a74,74,0,1,0-74-74A74.09,74.09,0,0,0,112,186Z"></path>'),gU=ht('<path d="M152,112a8,8,0,0,1-8,8H80a8,8,0,0,1,0-16h64A8,8,0,0,1,152,112Zm77.66,117.66a8,8,0,0,1-11.32,0l-50.06-50.07a88.11,88.11,0,1,1,11.31-11.31l50.07,50.06A8,8,0,0,1,229.66,229.66ZM112,184a72,72,0,1,0-72-72A72.08,72.08,0,0,0,112,184Z"></path>'),_U=ht('<path d="M148,112a4,4,0,0,1-4,4H80a4,4,0,0,1,0-8h64A4,4,0,0,1,148,112Zm78.83,114.83a4,4,0,0,1-5.66,0l-52.7-52.7a84.1,84.1,0,1,1,5.66-5.66l52.7,52.7A4,4,0,0,1,226.83,226.83ZM112,188a76,76,0,1,0-76-76A76.08,76.08,0,0,0,112,188Z"></path>'),vU=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function yU(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=vU();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=dU();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=fU();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=pU();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=mU();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=gU();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=_U();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var bU=ht('<path d="M156,112a12,12,0,0,1-12,12H124v20a12,12,0,0,1-24,0V124H80a12,12,0,0,1,0-24h20V80a12,12,0,0,1,24,0v20h20A12,12,0,0,1,156,112Zm76.49,120.49a12,12,0,0,1-17,0L168,185a92.12,92.12,0,1,1,17-17l47.54,47.53A12,12,0,0,1,232.49,232.49ZM112,180a68,68,0,1,0-68-68A68.08,68.08,0,0,0,112,180Z"></path>'),wU=ht('<path d="M192,112a80,80,0,1,1-80-80A80,80,0,0,1,192,112Z" opacity="0.2"></path><path d="M229.66,218.34,179.6,168.28a88.21,88.21,0,1,0-11.32,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Zm112,0a8,8,0,0,1-8,8H120v24a8,8,0,0,1-16,0V120H80a8,8,0,0,1,0-16h24V80a8,8,0,0,1,16,0v24h24A8,8,0,0,1,152,112Z"></path>',1),xU=ht('<path d="M229.66,218.34,179.6,168.28a88.21,88.21,0,1,0-11.32,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM144,120H120v24a8,8,0,0,1-16,0V120H80a8,8,0,0,1,0-16h24V80a8,8,0,0,1,16,0v24h24a8,8,0,0,1,0,16Z"></path>'),MU=ht('<path d="M150,112a6,6,0,0,1-6,6H118v26a6,6,0,0,1-12,0V118H80a6,6,0,0,1,0-12h26V80a6,6,0,0,1,12,0v26h26A6,6,0,0,1,150,112Zm78.24,116.24a6,6,0,0,1-8.48,0l-51.38-51.38a86.15,86.15,0,1,1,8.48-8.48l51.38,51.38A6,6,0,0,1,228.24,228.24ZM112,186a74,74,0,1,0-74-74A74.09,74.09,0,0,0,112,186Z"></path>'),IU=ht('<path d="M152,112a8,8,0,0,1-8,8H120v24a8,8,0,0,1-16,0V120H80a8,8,0,0,1,0-16h24V80a8,8,0,0,1,16,0v24h24A8,8,0,0,1,152,112Zm77.66,117.66a8,8,0,0,1-11.32,0l-50.06-50.07a88.11,88.11,0,1,1,11.31-11.31l50.07,50.06A8,8,0,0,1,229.66,229.66ZM112,184a72,72,0,1,0-72-72A72.08,72.08,0,0,0,112,184Z"></path>'),AU=ht('<path d="M148,112a4,4,0,0,1-4,4H116v28a4,4,0,0,1-8,0V116H80a4,4,0,0,1,0-8h28V80a4,4,0,0,1,8,0v28h28A4,4,0,0,1,148,112Zm78.83,114.83a4,4,0,0,1-5.66,0l-52.7-52.7a84.1,84.1,0,1,1,5.66-5.66l52.7,52.7A4,4,0,0,1,226.83,226.83ZM112,188a76,76,0,1,0-76-76A76.08,76.08,0,0,0,112,188Z"></path>'),TU=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function CU(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=TU();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=bU();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=wU();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=xU();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=MU();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=IU();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=AU();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var SU=ht('<path d="M232.49,215.51,185,168a92.12,92.12,0,1,0-17,17l47.53,47.54a12,12,0,0,0,17-17ZM44,112a68,68,0,1,1,68,68A68.07,68.07,0,0,1,44,112Z"></path>'),PU=ht('<path d="M192,112a80,80,0,1,1-80-80A80,80,0,0,1,192,112Z" opacity="0.2"></path><path d="M229.66,218.34,179.6,168.28a88.21,88.21,0,1,0-11.32,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path>',1),EU=ht('<path d="M168,112a56,56,0,1,1-56-56A56,56,0,0,1,168,112Zm61.66,117.66a8,8,0,0,1-11.32,0l-50.06-50.07a88,88,0,1,1,11.32-11.31l50.06,50.06A8,8,0,0,1,229.66,229.66ZM112,184a72,72,0,1,0-72-72A72.08,72.08,0,0,0,112,184Z"></path>'),kU=ht('<path d="M228.24,219.76l-51.38-51.38a86.15,86.15,0,1,0-8.48,8.48l51.38,51.38a6,6,0,0,0,8.48-8.48ZM38,112a74,74,0,1,1,74,74A74.09,74.09,0,0,1,38,112Z"></path>'),RU=ht('<path d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"></path>'),LU=ht('<path d="M226.83,221.17l-52.7-52.7a84.1,84.1,0,1,0-5.66,5.66l52.7,52.7a4,4,0,0,0,5.66-5.66ZM36,112a76,76,0,1,1,76,76A76.08,76.08,0,0,1,36,112Z"></path>'),zU=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function K5(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=zU();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=SU();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=PU();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=EU();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=kU();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=RU();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=LU();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var FU=ht('<path d="M128,60a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,60Zm0,64a20,20,0,1,1,20-20A20,20,0,0,1,128,124Zm0-112a92.1,92.1,0,0,0-92,92c0,77.36,81.64,135.4,85.12,137.83a12,12,0,0,0,13.76,0,259,259,0,0,0,42.18-39C205.15,170.57,220,136.37,220,104A92.1,92.1,0,0,0,128,12Zm31.3,174.71A249.35,249.35,0,0,1,128,216.89a249.35,249.35,0,0,1-31.3-30.18C80,167.37,60,137.31,60,104a68,68,0,0,1,136,0C196,137.31,176,167.37,159.3,186.71Z"></path>'),DU=ht('<path d="M128,24a80,80,0,0,0-80,80c0,72,80,128,80,128s80-56,80-128A80,80,0,0,0,128,24Zm0,112a32,32,0,1,1,32-32A32,32,0,0,1,128,136Z" opacity="0.2"></path><path d="M128,64a40,40,0,1,0,40,40A40,40,0,0,0,128,64Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,128,128Zm0-112a88.1,88.1,0,0,0-88,88c0,31.4,14.51,64.68,42,96.25a254.19,254.19,0,0,0,41.45,38.3,8,8,0,0,0,9.18,0A254.19,254.19,0,0,0,174,200.25c27.45-31.57,42-64.85,42-96.25A88.1,88.1,0,0,0,128,16Zm0,206c-16.53-13-72-60.75-72-118a72,72,0,0,1,144,0C200,161.23,144.53,209,128,222Z"></path>',1),BU=ht('<path d="M128,16a88.1,88.1,0,0,0-88,88c0,75.3,80,132.17,83.41,134.55a8,8,0,0,0,9.18,0C136,236.17,216,179.3,216,104A88.1,88.1,0,0,0,128,16Zm0,56a32,32,0,1,1-32,32A32,32,0,0,1,128,72Z"></path>'),GU=ht('<path d="M128,66a38,38,0,1,0,38,38A38,38,0,0,0,128,66Zm0,64a26,26,0,1,1,26-26A26,26,0,0,1,128,130Zm0-112a86.1,86.1,0,0,0-86,86c0,30.91,14.34,63.74,41.47,94.94a252.32,252.32,0,0,0,41.09,38,6,6,0,0,0,6.88,0,252.32,252.32,0,0,0,41.09-38c27.13-31.2,41.47-64,41.47-94.94A86.1,86.1,0,0,0,128,18Zm0,206.51C113,212.93,54,163.62,54,104a74,74,0,0,1,148,0C202,163.62,143,212.93,128,224.51Z"></path>'),VU=ht('<path d="M128,64a40,40,0,1,0,40,40A40,40,0,0,0,128,64Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,128,128Zm0-112a88.1,88.1,0,0,0-88,88c0,31.4,14.51,64.68,42,96.25a254.19,254.19,0,0,0,41.45,38.3,8,8,0,0,0,9.18,0A254.19,254.19,0,0,0,174,200.25c27.45-31.57,42-64.85,42-96.25A88.1,88.1,0,0,0,128,16Zm0,206c-16.53-13-72-60.75-72-118a72,72,0,0,1,144,0C200,161.23,144.53,209,128,222Z"></path>'),jU=ht('<path d="M128,68a36,36,0,1,0,36,36A36,36,0,0,0,128,68Zm0,64a28,28,0,1,1,28-28A28,28,0,0,1,128,132Zm0-112a84.09,84.09,0,0,0-84,84c0,30.42,14.17,62.79,41,93.62a250,250,0,0,0,40.73,37.66,4,4,0,0,0,4.58,0A250,250,0,0,0,171,197.62c26.81-30.83,41-63.2,41-93.62A84.09,84.09,0,0,0,128,20Zm37.1,172.23A254.62,254.62,0,0,1,128,227a254.62,254.62,0,0,1-37.1-34.81C73.15,171.8,52,139.9,52,104a76,76,0,0,1,152,0C204,139.9,182.85,171.8,165.1,192.23Z"></path>'),ZU=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function o8(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=ZU();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=FU();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=DU();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=BU();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=GU();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=VU();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=jU();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var OU=ht('<path d="M231.38,46.54a12,12,0,0,0-10.29-2.18L161.4,59.28l-60-30a12,12,0,0,0-8.28-.91l-64,16A12,12,0,0,0,20,56V200a12,12,0,0,0,14.91,11.64L94.6,196.72l60,30a12,12,0,0,0,8.28.91l64-16A12,12,0,0,0,236,200V56A12,12,0,0,0,231.38,46.54ZM108,59.42l40,20V196.58l-40-20Zm-64,6,40-10V174.63l-40,10ZM212,190.63l-40,10V81.37l40-10Z"></path>'),NU=ht('<path d="M160,72V216L96,184V40Z" opacity="0.2"></path><path d="M228.92,49.69a8,8,0,0,0-6.86-1.45L160.93,63.52,99.58,32.84a8,8,0,0,0-5.52-.6l-64,16A8,8,0,0,0,24,56V200a8,8,0,0,0,9.94,7.76l61.13-15.28,61.35,30.68A8.15,8.15,0,0,0,160,224a8,8,0,0,0,1.94-.24l64-16A8,8,0,0,0,232,200V56A8,8,0,0,0,228.92,49.69ZM104,52.94l48,24V203.06l-48-24ZM40,62.25l48-12v127.5l-48,12Zm176,131.5-48,12V78.25l48-12Z"></path>',1),UU=ht('<path d="M228.92,49.69a8,8,0,0,0-6.86-1.45L160.93,63.52,99.58,32.84a8,8,0,0,0-5.52-.6l-64,16A8,8,0,0,0,24,56V200a8,8,0,0,0,9.94,7.76l61.13-15.28,61.35,30.68A8.15,8.15,0,0,0,160,224a8,8,0,0,0,1.94-.24l64-16A8,8,0,0,0,232,200V56A8,8,0,0,0,228.92,49.69ZM96,176a8,8,0,0,0-1.94.24L40,189.75V62.25L95.07,48.48l.93.46Zm120,17.75-55.07,13.77-.93-.46V80a8,8,0,0,0,1.94-.23L216,66.25Z"></path>'),HU=ht('<path d="M227.69,51.27a6,6,0,0,0-5.15-1.09L160.7,65.64l-62-31a6,6,0,0,0-4.14-.45l-64,16A6,6,0,0,0,26,56V200a6,6,0,0,0,7.46,5.82L95.3,190.36l62,31a6,6,0,0,0,4.14.45l64-16A6,6,0,0,0,230,200V56A6,6,0,0,0,227.69,51.27ZM102,49.71l52,26V206.29l-52-26Zm-64,11,52-13V179.32l-52,13ZM218,195.32l-52,13V76.68l52-13Z"></path>'),WU=ht('<path d="M228.92,49.69a8,8,0,0,0-6.86-1.45L160.93,63.52,99.58,32.84a8,8,0,0,0-5.52-.6l-64,16A8,8,0,0,0,24,56V200a8,8,0,0,0,9.94,7.76l61.13-15.28,61.35,30.68A8.15,8.15,0,0,0,160,224a8,8,0,0,0,1.94-.24l64-16A8,8,0,0,0,232,200V56A8,8,0,0,0,228.92,49.69ZM104,52.94l48,24V203.06l-48-24ZM40,62.25l48-12v127.5l-48,12Zm176,131.5-48,12V78.25l48-12Z"></path>'),XU=ht('<path d="M226.46,52.85a4,4,0,0,0-3.43-.73L160.47,67.76,97.79,36.42a4,4,0,0,0-2.76-.3l-64,16A4,4,0,0,0,28,56V200a4,4,0,0,0,5,3.88l62.56-15.64,62.68,31.34a4,4,0,0,0,2.76.3l64-16a4,4,0,0,0,3-3.88V56A4,4,0,0,0,226.46,52.85ZM100,46.47l56,28V209.53l-56-28ZM36,59.12l56-14V180.88l-56,14ZM220,196.88l-56,14V75.12l56-14Z"></path>'),qU=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function ay(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=qU();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=OU();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=NU();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=UU();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=HU();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=WU();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=XU();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var YU=ht('<path d="M160,80a32,32,0,1,0-32-32A32,32,0,0,0,160,80Zm0-40a8,8,0,1,1-8,8A8,8,0,0,1,160,40Zm94.32,153.88L199.76,101.8A19.85,19.85,0,0,0,182.55,92h0a19.83,19.83,0,0,0-17.2,9.8l-18.7,31.55-37.42-63.5a20,20,0,0,0-34.46,0L1.66,193.91A12,12,0,0,0,12,212H244a12,12,0,0,0,10.32-18.12ZM92,87.87,108.57,116H75.43ZM33,188l28.28-48h61.44L151,188Zm145.86,0L160.56,157l22-37.1L222.94,188Z"></path>'),KU=ht('<path d="M144,52a20,20,0,1,1,20,20A20,20,0,0,1,144,52Zm49.44,55.92a8,8,0,0,0-13.77,0l-33,55.75-21-35.67H50.35L8,200H248Z" opacity="0.2"></path><path d="M164,80a28,28,0,1,0-28-28A28,28,0,0,0,164,80Zm0-40a12,12,0,1,1-12,12A12,12,0,0,1,164,40Zm90.88,155.92-54.56-92.08A15.87,15.87,0,0,0,186.55,96h0a15.85,15.85,0,0,0-13.76,7.84L146.63,148l-44.84-76.1a16,16,0,0,0-27.58,0L1.11,195.94A8,8,0,0,0,8,208H248a8,8,0,0,0,6.88-12.08ZM88,80l23.57,40H64.43ZM22,192l33-56h66l33,56Zm150.57,0-16.66-28.28L186.55,112,234,192Z"></path>',1),$U=ht('<path d="M254.88,195.92l-54.56-92.08A15.87,15.87,0,0,0,186.55,96h0a15.85,15.85,0,0,0-13.76,7.84l-15.64,26.39a4,4,0,0,0,0,4.07l26.8,45.47a8.13,8.13,0,0,1-1.89,10.55,8,8,0,0,1-11.8-2.26L101.79,71.88a16,16,0,0,0-27.58,0L1.11,195.94a8,8,0,0,0,1,9.52A8.23,8.23,0,0,0,8.23,208H247.77a8.29,8.29,0,0,0,6.09-2.55A8,8,0,0,0,254.88,195.92ZM64.43,120,88,80l23.57,40ZM140,52a24,24,0,1,1,24,24A24,24,0,0,1,140,52Z"></path>'),JU=ht('<path d="M164,78a26,26,0,1,0-26-26A26,26,0,0,0,164,78Zm0-40a14,14,0,1,1-14,14A14,14,0,0,1,164,38Zm89.16,158.94L198.6,104.86a13.9,13.9,0,0,0-12-6.86h0a13.88,13.88,0,0,0-12,6.86l-27.88,47.05-46.56-79a14,14,0,0,0-24.13,0L2.83,197A6,6,0,0,0,8,206H248a6,6,0,0,0,5.16-9.06ZM86.27,79a2,2,0,0,1,3.46,0l25.34,43H60.93ZM18.5,194l35.36-60h68.29l19.3,32.77,0,0,16,27.2Zm152.93,0-17.85-30.29L184.83,111a2,2,0,0,1,1.72-1,1.93,1.93,0,0,1,1.72,1l49.2,83Z"></path>'),QU=ht('<path d="M164,80a28,28,0,1,0-28-28A28,28,0,0,0,164,80Zm0-40a12,12,0,1,1-12,12A12,12,0,0,1,164,40Zm90.88,155.92-54.56-92.08A15.87,15.87,0,0,0,186.55,96h0a15.85,15.85,0,0,0-13.76,7.84L146.63,148l-44.84-76.1a16,16,0,0,0-27.58,0L1.11,195.94A8,8,0,0,0,8,208H248a8,8,0,0,0,6.88-12.08ZM88,80l23.57,40H64.43ZM22,192l33-56h66l18.74,31.8,0,0L154,192Zm150.57,0-16.66-28.28L186.55,112,234,192Z"></path>'),eH=ht('<path d="M164,76a24,24,0,1,0-24-24A24,24,0,0,0,164,76Zm0-40a16,16,0,1,1-16,16A16,16,0,0,1,164,36Zm87.44,162-54.56-92.08A11.91,11.91,0,0,0,186.55,100h0a11.89,11.89,0,0,0-10.32,5.88l-29.61,50L98.34,73.91a12,12,0,0,0-20.68,0L4.55,198A4,4,0,0,0,8,204H248a4,4,0,0,0,3.44-6ZM84.55,78a4,4,0,0,1,6.9,0l27.12,46H57.43ZM15,196l37.71-64h70.58L161,196Zm155.29,0-19-32.29L183.11,110a4,4,0,0,1,6.88,0l51,86Z"></path>'),tH=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function rH(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=tH();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=YU();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=KU();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=$U();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=JU();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=QU();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=eH();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var iH=ht('<path d="M238.7,102.46,62.81,37.21l-.25-.09A20,20,0,0,0,37.12,62.56l.09.25L102.46,238.7A20,20,0,0,0,121.3,252h.35a20,20,0,0,0,18.77-14.12l.09-.29,21.23-75.85,75.85-21.23.29-.09a20,20,0,0,0,.82-38Zm-89.93,38a12,12,0,0,0-8.32,8.32l-19.68,70.29L62.8,62.8l156.26,58Z"></path>'),nH=ht('<path d="M234.35,129,152,152,129,234.35a8,8,0,0,1-15.21.27l-65.28-176A8,8,0,0,1,58.63,48.46l176,65.28A8,8,0,0,1,234.35,129Z" opacity="0.2"></path><path d="M237.33,106.21,61.41,41l-.16-.05A16,16,0,0,0,40.9,61.25a1,1,0,0,0,.05.16l65.26,175.92A15.77,15.77,0,0,0,121.28,248h.3a15.77,15.77,0,0,0,15-11.29l.06-.2,21.84-78,78-21.84.2-.06a16,16,0,0,0,.62-30.38ZM149.84,144.3a8,8,0,0,0-5.54,5.54L121.3,232l-.06-.17L56,56l175.82,65.22.16.06Z"></path>',1),sH=ht('<path d="M248,121.58a15.76,15.76,0,0,1-11.29,15l-.2.06-78,21.84-21.84,78-.06.2a15.77,15.77,0,0,1-15,11.29h-.3a15.77,15.77,0,0,1-15.07-10.67L41,61.41a1,1,0,0,1-.05-.16A16,16,0,0,1,61.25,40.9l.16.05,175.92,65.26A15.78,15.78,0,0,1,248,121.58Z"></path>'),aH=ht('<path d="M236.65,108.1,60.72,42.83l-.13,0A14,14,0,0,0,42.78,60.59s0,.09,0,.13L108.1,236.65A13.77,13.77,0,0,0,121.28,246h.26a13.8,13.8,0,0,0,13.14-9.88l0-.15,22.14-79.1L236,134.73l.15,0a14,14,0,0,0,.53-26.58Zm-4,15.1-82.26,23a6,6,0,0,0-4.16,4.16l-23,82.26a1.85,1.85,0,0,1-1.86,1.36,1.82,1.82,0,0,1-1.92-1.35.61.61,0,0,0,0-.12L54.11,56.62a2,2,0,0,1,2.51-2.51l175.91,65.26.12,0a2,2,0,0,1,0,3.79Z"></path>'),oH=ht('<path d="M237.33,106.21,61.41,41l-.16-.05A16,16,0,0,0,40.9,61.25a1,1,0,0,0,.05.16l65.26,175.92A15.77,15.77,0,0,0,121.28,248h.3a15.77,15.77,0,0,0,15-11.29l.06-.2,21.84-78,78-21.84.2-.06a16,16,0,0,0,.62-30.38ZM149.84,144.3a8,8,0,0,0-5.54,5.54L121.3,232l-.06-.17L56,56l175.82,65.22.16.06Z"></path>'),lH=ht('<path d="M236,110,59.93,44.67A12,12,0,0,0,44.69,60L110,235.93A11.83,11.83,0,0,0,121.28,244h.22a11.82,11.82,0,0,0,11.26-8.47l0-.1,22.45-80.19,80.19-22.44.1,0A12,12,0,0,0,236,110Zm-2.79,15.12-82.3,23a4,4,0,0,0-2.78,2.77l-23,82.3a3.88,3.88,0,0,1-3.74,2.78,4,4,0,0,1-3.88-2.77L52.22,57.32a3.93,3.93,0,0,1,1-4.14A4,4,0,0,1,56,52a3.86,3.86,0,0,1,1.25.21l176.08,65.32a4,4,0,0,1-.09,7.59Z"></path>'),cH=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function hH(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=cH();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=iH();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=nH();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=sH();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=aH();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=oH();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=lH();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var uH=ht('<path d="M238.15,78.54,177.46,17.86a20,20,0,0,0-28.3,0L97.2,70c-12.43-3.33-36.68-5.72-61.74,14.5a20,20,0,0,0-1.6,29.73l45.46,45.47-39.8,39.8a12,12,0,0,0,17,17l39.8-39.81,45.47,45.46A20,20,0,0,0,155.91,228c.46,0,.93,0,1.4-.05A20,20,0,0,0,171.87,220c4.69-6.23,11-16.13,14.44-28s3.45-22.88.16-33.4l51.7-51.87A20,20,0,0,0,238.15,78.54Zm-74.26,68.79a12,12,0,0,0-2.23,13.84c3.43,6.86,6.9,21-6.28,40.65L54.08,100.53c21.09-14.59,39.53-6.64,41-6a11.67,11.67,0,0,0,13.81-2.29l54.43-54.61,55,55Z"></path>'),dH=ht('<path d="M229.66,98.34,172.39,155.8c11.46,22.93-1.72,45.86-10.11,57a8,8,0,0,1-12,.83L42.34,105.76A8,8,0,0,1,43,93.85c29.65-23.92,57.4-10,57.4-10l57.27-57.46a8,8,0,0,1,11.31,0L229.66,87A8,8,0,0,1,229.66,98.34Z" opacity="0.2"></path><path d="M235.32,81.37,174.63,20.69a16,16,0,0,0-22.63,0L98.37,74.49c-10.66-3.34-35-7.37-60.4,13.14a16,16,0,0,0-1.29,23.78L85,159.71,42.34,202.34a8,8,0,0,0,11.32,11.32L96.29,171l48.29,48.29A16,16,0,0,0,155.9,224c.38,0,.75,0,1.13,0a15.93,15.93,0,0,0,11.64-6.33c19.64-26.1,17.75-47.32,13.19-60L235.33,104A16,16,0,0,0,235.32,81.37ZM224,92.69h0l-57.27,57.46a8,8,0,0,0-1.49,9.22c9.46,18.93-1.8,38.59-9.34,48.62L48,100.08c12.08-9.74,23.64-12.31,32.48-12.31A40.13,40.13,0,0,1,96.81,91a8,8,0,0,0,9.25-1.51L163.32,32,224,92.68Z"></path>',1),fH=ht('<path d="M235.33,104l-53.47,53.65c4.56,12.67,6.45,33.89-13.19,60A15.93,15.93,0,0,1,157,224c-.38,0-.75,0-1.13,0a16,16,0,0,1-11.32-4.69L96.29,171,53.66,213.66a8,8,0,0,1-11.32-11.32L85,159.71l-48.3-48.3A16,16,0,0,1,38,87.63c25.42-20.51,49.75-16.48,60.4-13.14L152,20.7a16,16,0,0,1,22.63,0l60.69,60.68A16,16,0,0,1,235.33,104Z"></path>'),pH=ht('<path d="M233.91,82.79,173.22,22.1a14,14,0,0,0-19.81,0L98.93,76.77c-9.52-3.25-34-8.34-59.71,12.41A14,14,0,0,0,38.1,110l49.71,49.71-44.05,44a6,6,0,1,0,8.48,8.48l44.05-44.05L146,217.89a14,14,0,0,0,9.9,4.11q.49,0,1,0a14,14,0,0,0,10.19-5.54c19.72-26.21,17.15-47.23,12.46-59.3l54.37-54.55A14,14,0,0,0,233.91,82.79ZM225.42,94.1h0l-57.27,57.46a6,6,0,0,0-1.11,6.92c9.94,19.88-1.71,40.32-9.54,50.72a2,2,0,0,1-3,.2L46.58,101.51a2,2,0,0,1,.18-3c12.5-10.09,24.5-12.76,33.7-12.76a42.13,42.13,0,0,1,17.25,3.41A6,6,0,0,0,104.64,88L161.9,30.59a2,2,0,0,1,2.83,0l60.69,60.68A2,2,0,0,1,225.42,94.1Z"></path>'),mH=ht('<path d="M235.32,81.37,174.63,20.69a16,16,0,0,0-22.63,0L98.37,74.49c-10.66-3.34-35-7.37-60.4,13.14a16,16,0,0,0-1.29,23.78L85,159.71,42.34,202.34a8,8,0,0,0,11.32,11.32L96.29,171l48.29,48.29A16,16,0,0,0,155.9,224c.38,0,.75,0,1.13,0a15.93,15.93,0,0,0,11.64-6.33c19.64-26.1,17.75-47.32,13.19-60L235.33,104A16,16,0,0,0,235.32,81.37ZM224,92.69h0l-57.27,57.46a8,8,0,0,0-1.49,9.22c9.46,18.93-1.8,38.59-9.34,48.62L48,100.08c12.08-9.74,23.64-12.31,32.48-12.31A40.13,40.13,0,0,1,96.81,91a8,8,0,0,0,9.25-1.51L163.32,32,224,92.68Z"></path>'),gH=ht('<path d="M232.49,84.2,171.8,23.51a12,12,0,0,0-17,0L99.45,79.07c-8.08-3-32.79-9.45-59,11.67a12,12,0,0,0-1,17.84l51.13,51.13L45.17,205.17a4,4,0,0,0,5.66,5.66l45.46-45.47,51.12,51.12A12,12,0,0,0,155.9,220c.28,0,.57,0,.85,0a12,12,0,0,0,8.73-4.74c19.83-26.36,16.51-47.18,11.71-58.57l55.3-55.49A12,12,0,0,0,232.49,84.2Zm-5.66,11.31h0L169.56,153a4,4,0,0,0-.75,4.61c10.43,20.85-1.62,42-9.73,52.83a4,4,0,0,1-6,.4L45.17,102.93a4,4,0,0,1,.33-6C58.44,86.53,70.86,83.74,80.44,83.74A43.9,43.9,0,0,1,98.6,87.38a4,4,0,0,0,4.62-.75l57.27-57.46a4,4,0,0,1,5.66,0l60.68,60.69A4,4,0,0,1,226.83,95.51Z"></path>'),_H=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function ov(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=_H();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=uH();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=dH();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=fH();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=pH();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=mH();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=gH();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var vH=ht('<path d="M252,104a36,36,0,0,0-57.4-28.93,145.56,145.56,0,0,0-52.54-14.45l3.8-22.81,15.67,2.61a24,24,0,1,0,3.95-23.67L138,12.16A12,12,0,0,0,124.16,22l-6.38,38.31C97.48,61.62,78,66.7,61.4,75.07a36,36,0,0,0-47.52,53.68A62.87,62.87,0,0,0,12,144c0,23.29,12.65,44.87,35.63,60.78C69.26,219.75,97.8,228,128,228s58.74-8.25,80.37-23.22C231.35,188.87,244,167.29,244,144a62.87,62.87,0,0,0-1.88-15.25A36.16,36.16,0,0,0,252,104Zm-29.91,10.34a12,12,0,0,0-5,15A39.61,39.61,0,0,1,220,144c0,15.18-9,29.75-25.29,41.05C177.05,197.27,153.36,204,128,204s-49-6.73-66.71-18.95C45,173.75,36,159.18,36,144a39.74,39.74,0,0,1,2.84-14.64,12,12,0,0,0-4.93-15A12,12,0,1,1,49.71,97a12,12,0,0,0,15.94,3.18l.22-.13C82.94,89.68,105,84,128,84H128c23,0,45,5.69,62.09,16l.22.13A12,12,0,0,0,206.29,97,11.88,11.88,0,0,1,216,92a12,12,0,0,1,6.09,22.34ZM88,148a20,20,0,1,1,20-20A20,20,0,0,1,88,148Zm100-20a20,20,0,1,1-20-20A20,20,0,0,1,188,128Zm-20.52,40.52a12,12,0,0,1-8,15,111.88,111.88,0,0,1-63,0,12,12,0,0,1,7-23,88.12,88.12,0,0,0,49,0A12,12,0,0,1,167.48,168.52Z"></path>'),yH=ht('<path d="M228.21,124.67h0A51.6,51.6,0,0,1,232,144c0,39.76-46.56,72-104,72S24,183.76,24,144a51.6,51.6,0,0,1,3.79-19.33h0A24,24,0,1,1,59.41,89.88h0C77.72,78.75,101.72,72,128,72s50.28,6.75,68.59,17.88h0a24,24,0,1,1,31.62,34.79Z" opacity="0.2"></path><path d="M248,104a32,32,0,0,0-52.94-24.19c-16.75-8.9-36.76-14.28-57.66-15.53l5.19-31.17,17.72,2.72a24,24,0,1,0,2.87-15.74l-26-4a8,8,0,0,0-9.11,6.59L121.2,64.16c-21.84.94-42.82,6.38-60.26,15.65a32,32,0,0,0-42.59,47.74A59,59,0,0,0,16,144c0,21.93,12,42.35,33.91,57.49C70.88,216,98.61,224,128,224s57.12-8,78.09-22.51C228,186.35,240,165.93,240,144a59,59,0,0,0-2.35-16.45A32.16,32.16,0,0,0,248,104ZM184,24a8,8,0,1,1-8,8A8,8,0,0,1,184,24Zm40.13,93.78a8,8,0,0,0-3.29,10A43.62,43.62,0,0,1,224,144c0,16.53-9.59,32.27-27,44.33C178.67,201,154.17,208,128,208s-50.67-7-69-19.67C41.59,176.27,32,160.53,32,144a43.75,43.75,0,0,1,3.14-16.17,8,8,0,0,0-3.27-10A16,16,0,1,1,52.94,94.59a8,8,0,0,0,10.63,2.12l.18-.11C81.45,85.9,104.25,80,128,80h0c23.73,0,46.53,5.9,64.23,16.6l.18.11a8,8,0,0,0,10.63-2.12,16,16,0,1,1,21.07,23.19ZM88,144a16,16,0,1,1,16-16A16,16,0,0,1,88,144Zm96-16a16,16,0,1,1-16-16A16,16,0,0,1,184,128Zm-16.93,44.25a8,8,0,0,1-3.32,10.82,76.18,76.18,0,0,1-71.5,0,8,8,0,1,1,7.5-14.14,60.18,60.18,0,0,0,56.5,0A8,8,0,0,1,167.07,172.25Z"></path>',1),bH=ht('<path d="M248,104a32,32,0,0,0-52.94-24.19c-16.75-8.9-36.76-14.28-57.66-15.53l5.19-31.17,17.72,2.72a24,24,0,1,0,2.87-15.74l-26-4a8,8,0,0,0-9.11,6.59L121.2,64.16c-21.84.94-42.82,6.38-60.26,15.65a32,32,0,0,0-42.59,47.74A59,59,0,0,0,16,144c0,21.93,12,42.35,33.91,57.49C70.88,216,98.61,224,128,224s57.12-8,78.09-22.51C228,186.35,240,165.93,240,144a59,59,0,0,0-2.35-16.45A32.16,32.16,0,0,0,248,104ZM72,128a16,16,0,1,1,16,16A16,16,0,0,1,72,128Zm91.75,55.07a76.18,76.18,0,0,1-71.5,0,8,8,0,1,1,7.5-14.14,60.18,60.18,0,0,0,56.5,0,8,8,0,1,1,7.5,14.14ZM168,144a16,16,0,1,1,16-16A16,16,0,0,1,168,144Z"></path>'),wH=ht('<path d="M246,104a30,30,0,0,0-50.64-21.76C178,72.75,157,67.17,135.05,66.18l5.89-35.35,21.16,3.26a22,22,0,1,0,2.17-11.81l-27.36-4.21A6,6,0,0,0,130.08,23L122.9,66.09c-22.64.74-44.41,6.38-62.26,16.15a30,30,0,1,0-40,44.66A57.07,57.07,0,0,0,18,144c0,21.26,11.74,41.09,33.05,55.84C71.68,214.13,99,222,128,222s56.32-7.87,76.95-22.16C226.26,185.09,238,165.26,238,144a57.07,57.07,0,0,0-2.63-17.1A30.16,30.16,0,0,0,246,104ZM184,22a10,10,0,1,1-10,10A10,10,0,0,1,184,22Zm41.15,97.51a6,6,0,0,0-2.46,7.51A45.65,45.65,0,0,1,226,144c0,36.39-44,66-98,66s-98-29.61-98-66a45.63,45.63,0,0,1,3.3-16.94,6,6,0,0,0-2.45-7.55,18,18,0,1,1,23.71-26.1,6,6,0,0,0,7.79,1.7,3.79,3.79,0,0,0,.34-.2C80.7,84,103.89,78,128,78h0c24.1,0,47.28,6,65.29,16.9l.16.11a6,6,0,0,0,8-1.6,18,18,0,1,1,23.71,26.1ZM165.3,173.19a6,6,0,0,1-2.49,8.11,74.22,74.22,0,0,1-69.62,0,6,6,0,0,1,5.62-10.6,62.2,62.2,0,0,0,58.38,0A6,6,0,0,1,165.3,173.19ZM88,142a14,14,0,1,1,14-14A14,14,0,0,1,88,142Zm94-14a14,14,0,1,1-14-14A14,14,0,0,1,182,128Z"></path>'),xH=ht('<path d="M248,104a32,32,0,0,0-52.94-24.19c-16.75-8.9-36.76-14.28-57.66-15.53l5.19-31.17,17.72,2.72a24,24,0,1,0,2.87-15.74l-26-4a8,8,0,0,0-9.11,6.59L121.2,64.16c-21.84.94-42.82,6.38-60.26,15.65a32,32,0,0,0-42.59,47.74A59,59,0,0,0,16,144c0,21.93,12,42.35,33.91,57.49C70.88,216,98.61,224,128,224s57.12-8,78.09-22.51C228,186.35,240,165.93,240,144a59,59,0,0,0-2.35-16.45A32.16,32.16,0,0,0,248,104ZM184,24a8,8,0,1,1-8,8A8,8,0,0,1,184,24Zm40.13,93.78a8,8,0,0,0-3.29,10A43.58,43.58,0,0,1,224,144c0,16.53-9.59,32.27-27,44.33C178.67,201,154.17,208,128,208s-50.67-7-69-19.67C41.59,176.27,32,160.53,32,144a43.75,43.75,0,0,1,3.14-16.17,8,8,0,0,0-3.27-10A16,16,0,1,1,52.94,94.59a8,8,0,0,0,10.45,2.23l.36-.22C81.45,85.9,104.25,80,128,80h0c23.73,0,46.53,5.9,64.23,16.6l.42.25a8,8,0,0,0,10.39-2.26,16,16,0,1,1,21.07,23.19ZM88,144a16,16,0,1,1,16-16A16,16,0,0,1,88,144Zm96-16a16,16,0,1,1-16-16A16,16,0,0,1,184,128Zm-16.93,44.25a8,8,0,0,1-3.32,10.82,76.18,76.18,0,0,1-71.5,0,8,8,0,1,1,7.5-14.14,60.18,60.18,0,0,0,56.5,0A8,8,0,0,1,167.07,172.25Z"></path>'),MH=ht('<path d="M244,104a28,28,0,0,0-48.3-19.28c-17.9-10.11-40-15.94-63-16.65l6.59-39.52L164,32.36a20,20,0,1,0,1.46-7.87l-28.87-4.44a4,4,0,0,0-4.56,3.29L124.6,68.05c-23.48.52-46.06,6.36-64.3,16.67A28,28,0,1,0,23,126.21,55.14,55.14,0,0,0,20,144c0,20.58,11.43,39.83,32.18,54.2C72.49,212.26,99.42,220,128,220s55.51-7.74,75.82-21.8C224.57,183.83,236,164.58,236,144a55.14,55.14,0,0,0-3-17.79A28.14,28.14,0,0,0,244,104ZM184,20a12,12,0,1,1-12,12A12,12,0,0,1,184,20Zm40.53,106.25A47.69,47.69,0,0,1,228,144c0,37.5-44.86,68-100,68S28,181.5,28,144a47.71,47.71,0,0,1,3.45-17.72,4,4,0,0,0-1.62-5,20,20,0,1,1,26.35-29,4,4,0,0,0,5.19,1.13l.25-.16C80,82.11,103.51,76,128,76h0c24.48,0,48,6.11,66.37,17.21l.25.16a4,4,0,0,0,5.19-1.13,20,20,0,1,1,26.35,29A4,4,0,0,0,224.53,126.25Zm-61,47.88a4,4,0,0,1-1.65,5.4,72.22,72.22,0,0,1-67.76,0,4,4,0,0,1,3.76-7.06,64.23,64.23,0,0,0,60.24,0A4,4,0,0,1,163.53,174.13ZM88,140a12,12,0,1,1,12-12A12,12,0,0,1,88,140Zm92-12a12,12,0,1,1-12-12A12,12,0,0,1,180,128Z"></path>'),IH=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function AH(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=IH();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=vH();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=yH();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=bH();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=wH();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=xH();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=MH();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var TH=ht('<path d="M240.49,103.52l-80-80A12,12,0,0,0,140,32V68.74c-25.76,3.12-53.66,15.89-76.75,35.47-29.16,24.74-47.32,56.69-51.14,90A16,16,0,0,0,39.67,207h0c10.46-11.14,47-45.74,100.33-50.42V192a12,12,0,0,0,20.48,8.48l80-80A12,12,0,0,0,240.49,103.52ZM164,163V144a12,12,0,0,0-12-12c-49,0-86.57,21.56-109.79,40.11,7.13-18.16,19.63-35.22,36.57-49.59C101.3,103.41,128.67,92,152,92a12,12,0,0,0,12-12V61l51,51Z"></path>'),CH=ht('<path d="M152,192V144c-61.4,0-104.61,37.19-121.07,54.72a4,4,0,0,1-6.9-3.18C31.51,130.45,99.19,80,152,80V32l80,80Z" opacity="0.2"></path><path d="M237.66,106.35l-80-80A8,8,0,0,0,144,32V72.35c-25.94,2.22-54.59,14.92-78.16,34.91-28.38,24.08-46.05,55.11-49.76,87.37a12,12,0,0,0,20.68,9.58h0c11-11.71,50.14-48.74,107.24-52V192a8,8,0,0,0,13.66,5.65l80-80A8,8,0,0,0,237.66,106.35ZM160,172.69V144a8,8,0,0,0-8-8c-28.08,0-55.43,7.33-81.29,21.8a196.17,196.17,0,0,0-36.57,26.52c5.8-23.84,20.42-46.51,42.05-64.86C99.41,99.77,127.75,88,152,88a8,8,0,0,0,8-8V51.32L220.69,112Z"></path>',1),SH=ht('<path d="M237.66,117.66l-80,80A8,8,0,0,1,144,192V152.23c-57.1,3.24-96.25,40.27-107.24,52h0a12,12,0,0,1-20.68-9.58c3.71-32.26,21.38-63.29,49.76-87.37,23.57-20,52.22-32.69,78.16-34.91V32a8,8,0,0,1,13.66-5.66l80,80A8,8,0,0,1,237.66,117.66Z"></path>'),PH=ht('<path d="M236.24,107.76l-80-80A6,6,0,0,0,146,32V74.2c-54.48,3.59-120.39,55-127.93,120.66a10,10,0,0,0,17.23,8h0C46.56,190.85,87,152.6,146,150.13V192a6,6,0,0,0,10.24,4.24l80-80A6,6,0,0,0,236.24,107.76ZM158,177.52V144a6,6,0,0,0-6-6c-27.73,0-54.76,7.25-80.32,21.55a193.38,193.38,0,0,0-40.81,30.65c4.7-26.56,20.16-52,44-72.27C98.47,97.94,127.29,86,152,86a6,6,0,0,0,6-6V46.49L223.51,112Z"></path>'),EH=ht('<path d="M237.66,106.35l-80-80A8,8,0,0,0,144,32V72.35c-25.94,2.22-54.59,14.92-78.16,34.91-28.38,24.08-46.05,55.11-49.76,87.37a12,12,0,0,0,20.68,9.58h0c11-11.71,50.14-48.74,107.24-52V192a8,8,0,0,0,13.66,5.65l80-80A8,8,0,0,0,237.66,106.35ZM160,172.69V144a8,8,0,0,0-8-8c-28.08,0-55.43,7.33-81.29,21.8a196.17,196.17,0,0,0-36.57,26.52c5.8-23.84,20.42-46.51,42.05-64.86C99.41,99.77,127.75,88,152,88a8,8,0,0,0,8-8V51.32L220.69,112Z"></path>'),kH=ht('<path d="M234.83,109.17l-80-80A4,4,0,0,0,148,32V76.09c-54,2.44-120.43,53.55-127.94,119a7.87,7.87,0,0,0,4.58,8.16,8,8,0,0,0,3.41.77,7.9,7.9,0,0,0,5.79-2.55h0c11.53-12.27,53.29-51.73,114.16-53.4V192a4,4,0,0,0,6.83,2.83l80-80A4,4,0,0,0,234.83,109.17ZM156,182.33V144a4,4,0,0,0-4-4c-27.39,0-54.08,7.17-79.34,21.3A189.91,189.91,0,0,0,28,196l2.92,2.74L28,196c3.36-29.21,19.55-57.48,45.6-79.57C97.53,96.11,126.83,84,152,84a4,4,0,0,0,4-4V41.66L226.34,112Z"></path>'),RH=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function LH(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=RH();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=TH();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=CH();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=SH();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=PH();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=EH();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=kH();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var zH=ht('<path d="M234.36,170A12,12,0,0,1,230,186.37l-96,56a12,12,0,0,1-12.1,0l-96-56a12,12,0,0,1,12.09-20.74l90,52.48L218,165.63A12,12,0,0,1,234.36,170ZM218,117.63,128,170.11,38.05,117.63A12,12,0,0,0,26,138.37l96,56a12,12,0,0,0,12.1,0l96-56A12,12,0,0,0,218,117.63ZM20,80a12,12,0,0,1,6-10.37l96-56a12.06,12.06,0,0,1,12.1,0l96,56a12,12,0,0,1,0,20.74l-96,56a12,12,0,0,1-12.1,0l-96-56A12,12,0,0,1,20,80Zm35.82,0L128,122.11,200.18,80,128,37.89Z"></path>'),FH=ht('<path d="M224,80l-96,56L32,80l96-56Z" opacity="0.2"></path><path d="M230.91,172A8,8,0,0,1,228,182.91l-96,56a8,8,0,0,1-8.06,0l-96-56A8,8,0,0,1,36,169.09l92,53.65,92-53.65A8,8,0,0,1,230.91,172ZM220,121.09l-92,53.65L36,121.09A8,8,0,0,0,28,134.91l96,56a8,8,0,0,0,8.06,0l96-56A8,8,0,1,0,220,121.09ZM24,80a8,8,0,0,1,4-6.91l96-56a8,8,0,0,1,8.06,0l96,56a8,8,0,0,1,0,13.82l-96,56a8,8,0,0,1-8.06,0l-96-56A8,8,0,0,1,24,80Zm23.88,0L128,126.74,208.12,80,128,33.26Z"></path>',1),DH=ht('<path d="M220,169.09l-92,53.65L36,169.09A8,8,0,0,0,28,182.91l96,56a8,8,0,0,0,8.06,0l96-56A8,8,0,1,0,220,169.09Z"></path><path d="M220,121.09l-92,53.65L36,121.09A8,8,0,0,0,28,134.91l96,56a8,8,0,0,0,8.06,0l96-56A8,8,0,1,0,220,121.09Z"></path><path d="M28,86.91l96,56a8,8,0,0,0,8.06,0l96-56a8,8,0,0,0,0-13.82l-96-56a8,8,0,0,0-8.06,0l-96,56a8,8,0,0,0,0,13.82Z"></path>',1),BH=ht('<path d="M229.18,173a6,6,0,0,1-2.16,8.2l-96,56a6,6,0,0,1-6,0l-96-56a6,6,0,0,1,6-10.36l93,54.23,93-54.23A6,6,0,0,1,229.18,173ZM221,122.82l-93,54.23L35,122.82a6,6,0,0,0-6,10.36l96,56a6,6,0,0,0,6,0l96-56a6,6,0,0,0-6-10.36ZM26,80a6,6,0,0,1,3-5.18l96-56a6,6,0,0,1,6,0l96,56a6,6,0,0,1,0,10.36l-96,56a6,6,0,0,1-6,0l-96-56A6,6,0,0,1,26,80Zm17.91,0L128,129.05,212.09,80,128,31Z"></path>'),GH=ht('<path d="M230.91,172A8,8,0,0,1,228,182.91l-96,56a8,8,0,0,1-8.06,0l-96-56A8,8,0,0,1,36,169.09l92,53.65,92-53.65A8,8,0,0,1,230.91,172ZM220,121.09l-92,53.65L36,121.09A8,8,0,0,0,28,134.91l96,56a8,8,0,0,0,8.06,0l96-56A8,8,0,1,0,220,121.09ZM24,80a8,8,0,0,1,4-6.91l96-56a8,8,0,0,1,8.06,0l96,56a8,8,0,0,1,0,13.82l-96,56a8,8,0,0,1-8.06,0l-96-56A8,8,0,0,1,24,80Zm23.88,0L128,126.74,208.12,80,128,33.26Z"></path>'),VH=ht('<path d="M227.45,174a4,4,0,0,1-1.44,5.48l-96,56a4,4,0,0,1-4,0l-96-56a4,4,0,0,1,4-6.92l94,54.83,94-54.83A4,4,0,0,1,227.45,174ZM222,124.54l-94,54.83L34,124.54a4,4,0,0,0-4,6.92l96,56a4,4,0,0,0,4,0l96-56a4,4,0,0,0-4-6.92ZM28,80a4,4,0,0,1,2-3.46l96-56a4,4,0,0,1,4,0l96,56a4,4,0,0,1,0,6.92l-96,56a4,4,0,0,1-4,0l-96-56A4,4,0,0,1,28,80Zm11.94,0L128,131.37,216.06,80,128,28.63Z"></path>'),jH=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function ZH(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=jH();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=zH();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=FH();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=DH();qr(2),se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=BH();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=GH();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=VH();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var OH=ht('<path d="M225.24,174.74a12,12,0,0,1-1.58,16.89C205.49,206.71,189.06,212,174.15,212c-19.76,0-36.86-9.29-51.88-17.44-25.06-13.62-44.86-24.37-74.61.3a12,12,0,1,1-15.32-18.48c42.25-35,75-17.23,101.39-2.92,25.06,13.61,44.86,24.37,74.61-.3A12,12,0,0,1,225.24,174.74Zm-16.9-57.59c-29.75,24.67-49.55,13.91-74.61.3-26.35-14.3-59.14-32.11-101.39,2.92a12,12,0,0,0,15.32,18.48c29.75-24.67,49.55-13.92,74.61-.3,15,8.15,32.12,17.44,51.88,17.44,14.91,0,31.34-5.29,49.51-20.36a12,12,0,0,0-15.32-18.48ZM47.66,82.84c29.75-24.67,49.55-13.92,74.61-.3,15,8.15,32.12,17.44,51.88,17.44,14.91,0,31.34-5.29,49.51-20.36a12,12,0,0,0-15.32-18.48c-29.75,24.67-49.55,13.92-74.61.3-26.35-14.3-59.14-32.11-101.39,2.93A12,12,0,1,0,47.66,82.84Z"></path>'),NH=ht('<path d="M216,70.39v112c-72,59.69-104-56.47-176,3.22v-112C112,13.92,144,130.08,216,70.39Z" opacity="0.2"></path><path d="M222.16,177.25a8,8,0,0,1-1,11.25c-17.36,14.39-32.86,19.5-47,19.5-18.58,0-34.82-8.82-49.93-17-25.35-13.76-47.24-25.64-79.07.74a8,8,0,1,1-10.22-12.31c40.17-33.28,70.32-16.92,96.93-2.48,25.35,13.75,47.24,25.63,79.07-.74A8,8,0,0,1,222.16,177.25Zm-11.27-57c-31.83,26.38-53.72,14.5-79.07.74-26.61-14.43-56.76-30.79-96.93,2.49a8,8,0,0,0,10.22,12.31c31.83-26.38,53.72-14.5,79.07-.74,15.11,8.19,31.35,17,49.93,17,14.14,0,29.64-5.11,47-19.5a8,8,0,1,0-10.22-12.31ZM45.11,79.8c31.83-26.37,53.72-14.49,79.07-.74,15.11,8.2,31.35,17,49.93,17,14.14,0,29.64-5.12,47-19.5a8,8,0,1,0-10.22-12.31c-31.83,26.38-53.72,14.5-79.07.74C105.21,50.58,75.06,34.22,34.89,67.5A8,8,0,1,0,45.11,79.8Z"></path>',1),UH=ht('<path d="M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM197.2,176.87c-13.07,11.18-24.9,15.1-35.64,15.1-14.26,0-26.62-6.92-37.47-13-18.41-10.31-32.95-18.45-54.89.31a8,8,0,1,1-10.4-12.16c30.42-26,54.09-12.76,73.11-2.11,18.41,10.31,33,18.45,54.89-.31a8,8,0,0,1,10.4,12.16Zm0-44c-13.07,11.18-24.9,15.1-35.64,15.1-14.26,0-26.62-6.92-37.47-13-18.41-10.31-32.95-18.45-54.89.31a8,8,0,0,1-10.4-12.16c30.42-26,54.09-12.76,73.11-2.11,18.41,10.31,33,18.45,54.89-.31a8,8,0,1,1,10.4,12.16Zm0-44c-13.07,11.18-24.9,15.1-35.64,15.1-14.26,0-26.62-6.92-37.47-13-18.41-10.31-32.95-18.45-54.89.31A8,8,0,0,1,58.8,79.13c30.42-26,54.09-12.76,73.11-2.11,18.41,10.31,33,18.45,54.89-.31a8,8,0,1,1,10.4,12.16Z"></path>'),HH=ht('<path d="M220.62,178.58a6,6,0,0,1-.79,8.45c-16.87,14-32,19-45.75,19-18.19,0-34.13-8.66-48.94-16.7-26-14.12-48.44-26.31-81.31,1A6,6,0,0,1,36.17,181c39.13-32.45,68.65-16.41,94.69-2.26s48.44,26.31,81.31-1A6,6,0,0,1,220.62,178.58Zm-8.45-56.81c-32.87,27.27-55.32,15.07-81.31,1S75.3,92.54,36.17,125a6,6,0,0,0,7.66,9.25c32.87-27.27,55.32-15.08,81.31-1,14.81,8,30.75,16.71,48.94,16.71,13.79,0,28.88-5,45.75-19a6,6,0,0,0-7.66-9.24ZM43.83,78.21c32.87-27.27,55.32-15.07,81.31-1C140,85.3,155.89,94,174.08,94c13.79,0,28.88-5,45.75-19a6,6,0,1,0-7.66-9.24c-32.87,27.27-55.32,15.07-81.31,1S75.3,36.52,36.17,69a6,6,0,1,0,7.66,9.24Z"></path>'),WH=ht('<path d="M222.16,177.25a8,8,0,0,1-1,11.25c-17.36,14.39-32.86,19.5-47,19.5-18.58,0-34.82-8.82-49.93-17-25.35-13.76-47.24-25.64-79.07.74a8,8,0,1,1-10.22-12.31c40.17-33.28,70.32-16.92,96.93-2.48,25.35,13.75,47.24,25.63,79.07-.74A8,8,0,0,1,222.16,177.25Zm-11.27-57c-31.83,26.38-53.72,14.5-79.07.74-26.61-14.43-56.76-30.79-96.93,2.49a8,8,0,0,0,10.22,12.31c31.83-26.38,53.72-14.5,79.07-.74,15.11,8.19,31.35,17,49.93,17,14.14,0,29.64-5.11,47-19.5a8,8,0,1,0-10.22-12.31ZM45.11,79.8c31.83-26.37,53.72-14.49,79.07-.74,15.11,8.2,31.35,17,49.93,17,14.14,0,29.64-5.12,47-19.5a8,8,0,1,0-10.22-12.31c-31.83,26.38-53.72,14.5-79.07.74C105.21,50.58,75.06,34.22,34.89,67.5A8,8,0,1,0,45.11,79.8Z"></path>'),XH=ht('<path d="M219.08,179.84a4,4,0,0,1-.53,5.63C203.56,197.9,188.9,204,173.93,204a54.84,54.84,0,0,1-6.12-.34c-15-1.65-28.6-9-41.72-16.14-25.52-13.86-49.62-27-83.54,1.18a4,4,0,0,1-5.1-6.16c17-14.12,33.62-20.08,50.74-18.19,15,1.64,28.6,9,41.72,16.14,25.52,13.86,49.62,26.94,83.54-1.18A4,4,0,0,1,219.08,179.84Zm-5.63-56.53c-33.92,28.12-58,15-83.54,1.17-13.12-7.12-26.69-14.49-41.72-16.14-17.12-1.88-33.72,4.07-50.74,18.19a4,4,0,1,0,5.1,6.16c33.92-28.12,58-15,83.54-1.17,13.12,7.12,26.69,14.49,41.72,16.14a57.34,57.34,0,0,0,6.12.34c15,0,29.63-6.1,44.62-18.53a4,4,0,1,0-5.1-6.16ZM42.55,76.69c33.92-28.13,58-15,83.54-1.18,13.12,7.13,26.69,14.5,41.72,16.14a54.84,54.84,0,0,0,6.12.34c15,0,29.63-6.1,44.62-18.53a4,4,0,1,0-5.1-6.16c-33.92,28.13-58,15-83.54,1.18C116.79,61.35,103.22,54,88.19,52.34c-17.12-1.88-33.72,4.07-50.74,18.19a4,4,0,1,0,5.1,6.16Z"></path>'),qH=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function YH(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=qH();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=OH();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=NH();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=UH();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=HH();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=WH();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=XH();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var KH=ht('<path d="M187.3,159.06A36.09,36.09,0,0,1,152,188a84.09,84.09,0,0,1-84-84A36.09,36.09,0,0,1,96.94,68.7,12,12,0,0,1,110,75.1l11.48,23a12,12,0,0,1-.75,12l-8.52,12.78a44.56,44.56,0,0,0,20.91,20.91l12.78-8.52a12,12,0,0,1,12-.75l23,11.48A12,12,0,0,1,187.3,159.06ZM236,128A108,108,0,0,1,78.77,224.15L46.34,235A20,20,0,0,1,21,209.66l10.81-32.43A108,108,0,1,1,236,128Zm-24,0A84,84,0,1,0,55.27,170.06a12,12,0,0,1,1,9.81l-9.93,29.79,29.79-9.93a12.1,12.1,0,0,1,3.8-.62,12,12,0,0,1,6,1.62A84,84,0,0,0,212,128Z"></path>'),$H=ht('<path d="M128,32A96,96,0,0,0,44.89,176.07L32.42,213.46a8,8,0,0,0,10.12,10.12l37.39-12.47A96,96,0,1,0,128,32Zm24,152a80,80,0,0,1-80-80,32,32,0,0,1,32-32l16,32-12.32,18.47a48.19,48.19,0,0,0,25.85,25.85L152,136l32,16A32,32,0,0,1,152,184Z" opacity="0.2"></path><path d="M187.58,144.84l-32-16a8,8,0,0,0-8,.5l-14.69,9.8a40.55,40.55,0,0,1-16-16l9.8-14.69a8,8,0,0,0,.5-8l-16-32A8,8,0,0,0,104,64a40,40,0,0,0-40,40,88.1,88.1,0,0,0,88,88,40,40,0,0,0,40-40A8,8,0,0,0,187.58,144.84ZM152,176a72.08,72.08,0,0,1-72-72A24,24,0,0,1,99.29,80.46l11.48,23L101,118a8,8,0,0,0-.73,7.51,56.47,56.47,0,0,0,30.15,30.15A8,8,0,0,0,138,155l14.62-9.74,23,11.48A24,24,0,0,1,152,176ZM128,24A104,104,0,0,0,36.18,176.88L24.83,210.93a16,16,0,0,0,20.24,20.24l34.05-11.35A104,104,0,1,0,128,24Zm0,192a87.87,87.87,0,0,1-44.06-11.81,8,8,0,0,0-6.54-.67L40,216,52.47,178.6a8,8,0,0,0-.66-6.54A88,88,0,1,1,128,216Z"></path>',1),JH=ht('<path d="M152.58,145.23l23,11.48A24,24,0,0,1,152,176a72.08,72.08,0,0,1-72-72A24,24,0,0,1,99.29,80.46l11.48,23L101,118a8,8,0,0,0-.73,7.51,56.47,56.47,0,0,0,30.15,30.15A8,8,0,0,0,138,155ZM232,128A104,104,0,0,1,79.12,219.82L45.07,231.17a16,16,0,0,1-20.24-20.24l11.35-34.05A104,104,0,1,1,232,128Zm-40,24a8,8,0,0,0-4.42-7.16l-32-16a8,8,0,0,0-8,.5l-14.69,9.8a40.55,40.55,0,0,1-16-16l9.8-14.69a8,8,0,0,0,.5-8l-16-32A8,8,0,0,0,104,64a40,40,0,0,0-40,40,88.1,88.1,0,0,0,88,88A40,40,0,0,0,192,152Z"></path>'),QH=ht('<path d="M186.68,146.63l-32-16a6,6,0,0,0-6,.38L133,141.46A42.49,42.49,0,0,1,114.54,123L125,107.33a6,6,0,0,0,.38-6l-16-32A6,6,0,0,0,104,66a38,38,0,0,0-38,38,86.1,86.1,0,0,0,86,86,38,38,0,0,0,38-38A6,6,0,0,0,186.68,146.63ZM152,178a74.09,74.09,0,0,1-74-74,26,26,0,0,1,22.42-25.75l12.66,25.32-10.39,15.58a6,6,0,0,0-.54,5.63,54.43,54.43,0,0,0,29.07,29.07,6,6,0,0,0,5.63-.54l15.58-10.39,25.32,12.66A26,26,0,0,1,152,178ZM128,26A102,102,0,0,0,38.35,176.69L26.73,211.56a14,14,0,0,0,17.71,17.71l34.87-11.62A102,102,0,1,0,128,26Zm0,192a90,90,0,0,1-45.06-12.08,6.09,6.09,0,0,0-3-.81,6.2,6.2,0,0,0-1.9.31L40.65,217.88a2,2,0,0,1-2.53-2.53L50.58,178a6,6,0,0,0-.5-4.91A90,90,0,1,1,128,218Z"></path>'),eW=ht('<path d="M187.58,144.84l-32-16a8,8,0,0,0-8,.5l-14.69,9.8a40.55,40.55,0,0,1-16-16l9.8-14.69a8,8,0,0,0,.5-8l-16-32A8,8,0,0,0,104,64a40,40,0,0,0-40,40,88.1,88.1,0,0,0,88,88,40,40,0,0,0,40-40A8,8,0,0,0,187.58,144.84ZM152,176a72.08,72.08,0,0,1-72-72A24,24,0,0,1,99.29,80.46l11.48,23L101,118a8,8,0,0,0-.73,7.51,56.47,56.47,0,0,0,30.15,30.15A8,8,0,0,0,138,155l14.61-9.74,23,11.48A24,24,0,0,1,152,176ZM128,24A104,104,0,0,0,36.18,176.88L24.83,210.93a16,16,0,0,0,20.24,20.24l34.05-11.35A104,104,0,1,0,128,24Zm0,192a87.87,87.87,0,0,1-44.06-11.81,8,8,0,0,0-6.54-.67L40,216,52.47,178.6a8,8,0,0,0-.66-6.54A88,88,0,1,1,128,216Z"></path>'),tW=ht('<path d="M185.79,148.42l-32-16a4,4,0,0,0-4,.25l-16.64,11.1a44.56,44.56,0,0,1-20.91-20.91l11.1-16.64a4,4,0,0,0,.25-4l-16-32A4,4,0,0,0,104,68a36,36,0,0,0-36,36,84.09,84.09,0,0,0,84,84,36,36,0,0,0,36-36A4,4,0,0,0,185.79,148.42ZM152,180a76.08,76.08,0,0,1-76-76,28,28,0,0,1,25.58-27.9l13.8,27.61-11,16.54A4,4,0,0,0,104,124a52.43,52.43,0,0,0,28,28,4,4,0,0,0,3.76-.37l16.54-11,27.61,13.8A28,28,0,0,1,152,180ZM128,28A100,100,0,0,0,40.53,176.5l-11.9,35.69a12,12,0,0,0,15.18,15.18l35.69-11.9A100,100,0,1,0,128,28Zm0,192a92,92,0,0,1-46.07-12.35,4.05,4.05,0,0,0-2-.54,3.93,3.93,0,0,0-1.27.21L41.28,219.78a4,4,0,0,1-5.06-5.06l12.46-37.38a4,4,0,0,0-.33-3.27A92,92,0,1,1,128,220Z"></path>'),rW=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function iW(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=rW();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=KH();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=$H();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=JH();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=QH();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=eW();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=tW();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}var nW=ht('<path d="M208.49,191.51a12,12,0,0,1-17,17L128,145,64.49,208.49a12,12,0,0,1-17-17L111,128,47.51,64.49a12,12,0,0,1,17-17L128,111l63.51-63.52a12,12,0,0,1,17,17L145,128Z"></path>'),sW=ht('<path d="M216,56V200a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V56A16,16,0,0,1,56,40H200A16,16,0,0,1,216,56Z" opacity="0.2"></path><path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>',1),aW=ht('<path d="M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM181.66,170.34a8,8,0,0,1-11.32,11.32L128,139.31,85.66,181.66a8,8,0,0,1-11.32-11.32L116.69,128,74.34,85.66A8,8,0,0,1,85.66,74.34L128,116.69l42.34-42.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>'),oW=ht('<path d="M204.24,195.76a6,6,0,1,1-8.48,8.48L128,136.49,60.24,204.24a6,6,0,0,1-8.48-8.48L119.51,128,51.76,60.24a6,6,0,0,1,8.48-8.48L128,119.51l67.76-67.75a6,6,0,0,1,8.48,8.48L136.49,128Z"></path>'),lW=ht('<path d="M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"></path>'),cW=ht('<path d="M202.83,197.17a4,4,0,0,1-5.66,5.66L128,133.66,58.83,202.83a4,4,0,0,1-5.66-5.66L122.34,128,53.17,58.83a4,4,0,0,1,5.66-5.66L128,122.34l69.17-69.17a4,4,0,1,1,5.66,5.66L133.66,128Z"></path>'),hW=ht('<svg><!><rect width="256" height="256" fill="none"></rect><!></svg>');function uW(e,t){Ur(t,!0);const i=Wi();let a=Ri(t,["$$slots","$$events","$$legacy","children"]),h=pt(()=>t.weight??i.weight??"regular"),d=pt(()=>t.color??i.color??"currentColor"),p=pt(()=>t.size??i.size??"1em"),s=pt(()=>t.mirrored??i.mirrored??!1);function w(S){let{weight:j,color:ne,size:te,mirrored:Q,...N}=S;return N}var A=hW();Pi(A,(S,j)=>({xmlns:"http://www.w3.org/2000/svg",role:"img",width:T(p),height:T(p),fill:T(d),transform:T(s)?"scale(-1, 1)":void 0,viewBox:"0 0 256 256",...S,...j}),[()=>w(i),()=>w(a)]);var z=Rt(A);{var B=S=>{var j=_t(),ne=lt(j);Ii(ne,()=>t.children),se(S,j)};Qe(z,S=>{t.children&&S(B)})}var D=Gt(z,2);{var V=S=>{var j=nW();se(S,j)},W=S=>{var j=_t(),ne=lt(j);{var te=N=>{var re=sW();qr(),se(N,re)},Q=N=>{var re=_t(),oe=lt(re);{var ve=$=>{var le=aW();se($,le)},Pe=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=oW();se(q,me)},Be=q=>{var me=_t(),Ee=lt(me);{var Ne=ye=>{var ge=lW();se(ye,ge)},$e=ye=>{var ge=_t(),Ye=lt(ge);{var We=Se=>{var Ce=cW();se(Se,Ce)},ot=Se=>{var Ce=wi();Ce.nodeValue=(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),""),se(Se,Ce)};Qe(Ye,Se=>{T(h)==="thin"?Se(We):Se(ot,!1)},!0)}se(ye,ge)};Qe(Ee,ye=>{T(h)==="regular"?ye(Ne):ye($e,!1)},!0)}se(q,me)};Qe(Me,q=>{T(h)==="light"?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(oe,$=>{T(h)==="fill"?$(ve):$(Pe,!1)},!0)}se(N,re)};Qe(ne,N=>{T(h)==="duotone"?N(te):N(Q,!1)},!0)}se(S,j)};Qe(D,S=>{T(h)==="bold"?S(V):S(W,!1)})}Tt(A),se(e,A),Hr()}const dW=e=>e;function xb(e){const t=e-1;return t*t*t+1}function fW(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function l8(e){const t=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}function c1(e,{delay:t=0,duration:i=400,easing:a=dW}={}){const h=+getComputedStyle(e).opacity;return{delay:t,duration:i,easing:a,css:d=>`opacity: ${d*h}`}}function Ao(e,{delay:t=0,duration:i=400,easing:a=xb,x:h=0,y:d=0,opacity:p=0}={}){const s=getComputedStyle(e),w=+s.opacity,A=s.transform==="none"?"":s.transform,z=w*(1-p),[B,D]=l8(h),[V,W]=l8(d);return{delay:t,duration:i,easing:a,css:(S,j)=>`
			transform: ${A} translate(${(1-S)*B}${D}, ${(1-S)*V}${W});
			opacity: ${w-z*j}`}}function zg(e,{delay:t=0,duration:i=400,easing:a=xb,axis:h="y"}={}){const d=getComputedStyle(e),p=+d.opacity,s=h==="y"?"height":"width",w=parseFloat(d[s]),A=h==="y"?["top","bottom"]:["left","right"],z=A.map(ne=>`${ne[0].toUpperCase()}${ne.slice(1)}`),B=parseFloat(d[`padding${z[0]}`]),D=parseFloat(d[`padding${z[1]}`]),V=parseFloat(d[`margin${z[0]}`]),W=parseFloat(d[`margin${z[1]}`]),S=parseFloat(d[`border${z[0]}Width`]),j=parseFloat(d[`border${z[1]}Width`]);return{delay:t,duration:i,easing:a,css:ne=>`overflow: hidden;opacity: ${Math.min(ne*20,1)*p};${s}: ${ne*w}px;padding-${A[0]}: ${ne*B}px;padding-${A[1]}: ${ne*D}px;margin-${A[0]}: ${ne*V}px;margin-${A[1]}: ${ne*W}px;border-${A[0]}-width: ${ne*S}px;border-${A[1]}-width: ${ne*j}px;min-${s}: 0`}}function $5(e,{delay:t=0,duration:i=400,easing:a=xb,start:h=0,opacity:d=0}={}){const p=getComputedStyle(e),s=+p.opacity,w=p.transform==="none"?"":p.transform,A=1-h,z=s*(1-d);return{delay:t,duration:i,easing:a,css:(B,D)=>`
			transform: ${w} scale(${1-A*D});
			opacity: ${s-z*D}
		`}}function c8(e,{delay:t=0,speed:i,duration:a,easing:h=fW}={}){let d=e.getTotalLength();const p=getComputedStyle(e);return p.strokeLinecap!=="butt"&&(d+=parseInt(p.strokeWidth)),a===void 0?i===void 0?a=800:a=d/i:typeof a=="function"&&(a=a(d)),{delay:t,duration:a,easing:h,css:(s,w)=>`
			stroke-dasharray: ${d};
			stroke-dashoffset: ${w*d};
		`}}var pW=zr('<h1 class="w-full text-center text-[22px] font-[700] text-[#336]"> </h1>'),mW=zr(`<div class="fixed inset-0 z-2000 flex items-center justify-center" role="dialog" aria-modal="true"><button type="button" class="absolute inset-0 cursor-default bg-[#333366aa] bg-[url('/wave_pattern.png')] bg-size-[32px]" aria-label="Sluit venster"></button> <div class="
				relative z-10
				flex max-h-[90vh] w-[90vw]
				max-w-120 flex-col items-center
				rounded-[8px] border border-gray-200 bg-white shadow-lg
			"><button type="button" class="absolute top-4 right-4 rounded-[8px] bg-[#ff44aa22] p-2 opacity-50 transition-opacity hover:opacity-100" aria-label="Sluit venster"><!></button> <div class="flex h-full w-full flex-col items-center overflow-auto overflow-x-hidden py-8"><!> <div class="mt-2 p-8 text-[#336]"><!></div></div></div></div>`);function Mb(e,t){Ur(t,!0);let i=pi(t,"visible",15),a=pi(t,"opacity",3,100),h=fr(void 0),d=fr(void 0),p=fr(void 0);function s(){i(!1)}function w(W){i()&&W.key==="Escape"&&s()}function A(){if(!T(h))return;const S=T(h).querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');S.length>0&&(Pt(d,S[0],!0),Pt(p,S[S.length-1],!0))}function z(W){var S,j;i()&&W.key==="Tab"&&(W.shiftKey?document.activeElement===T(d)&&(W.preventDefault(),(S=T(p))==null||S.focus()):document.activeElement===T(p)&&(W.preventDefault(),(j=T(d))==null||j.focus()))}Yi(()=>{i()&&T(h)&&(A(),setTimeout(()=>{var W;(W=T(d))==null||W.focus()},100))});var B=_t();Tn("keydown",pl,w),Tn("keydown",Km,z);var D=lt(B);{var V=W=>{var S=mW();let j;var ne=Rt(S);ne.__click=s;var te=Gt(ne,2),Q=Rt(te);Q.__click=s;var N=Rt(Q);uW(N,{size:"24",color:"#f4a",weight:"bold"}),Tt(Q);var re=Gt(Q,2),oe=Rt(re);{var ve=le=>{var Me=pW(),Ve=Rt(Me,!0);Tt(Me),$r(()=>xn(Ve,t.title)),se(le,Me)};Qe(oe,le=>{t.title&&le(ve)})}var Pe=Gt(oe,2),$=Rt(Pe);Ii($,()=>t.children??_o),Tt(Pe),Tt(re),Tt(te),ha(te,le=>Pt(h,le),()=>T(h)),Tt(S),$r(()=>j=Bi(S,"",j,{opacity:a()+"%"})),Vn(3,ne,()=>Ao,()=>({y:-5,duration:250})),Vn(3,te,()=>Ao,()=>({y:-20,duration:250})),se(W,S)};Qe(D,W=>{i()&&W(V)})}se(e,B),Hr()}_s(["click"]);var gW=zr("<!> Gekopieerd",1),_W=zr("<!> Kopieer",1),vW=zr('<p class="w-full text-center">Deel het kaartgedeelte dat jij nu bekijkt.</p> <div class="mt-4 flex items-center"><input type="text" readonly="" class="h-12 w-2/3 rounded-[6px] border-2 border-[#eef] bg-[#ff44aa11] px-2 py-1 text-[16px] font-[500] text-[#336]"/> <button class="ml-4 h-12 w-42 cursor-pointer rounded-[6px] bg-[#336] px-4 py-1 font-[600] text-white transition-colors hover:bg-[#558]"><!></button></div> <div class="mt-4 text-center"><a class="mx-4"><!></a> <a class="mx-4" target="_blank" rel="noopener noreferrer"><!></a> <a class="mx-4" target="_blank" rel="noopener noreferrer"><!></a> <a class="mx-4" target="_blank" rel="noopener noreferrer"><!></a></div>',1);function yW(e,t){Ur(t,!0);let i=pi(t,"visible",15);async function a(d){const s={["text/plain"]:d},w=new ClipboardItem(s);await navigator.clipboard.write([w]),Pt(h,!0)}let h=fr(!1);Yi(()=>{if(T(h)){const d=setTimeout(()=>{Pt(h,!1)},1e3);return()=>clearTimeout(d)}}),Mb(e,{title:"Deel jouw Watertijdreis",get visible(){return i()},set visible(d){i(d)},children:(d,p)=>{var s=vW(),w=Gt(lt(s),2),A=Rt(w);Hl(A),mT(A,typeof window<"u"?window.location.href:"");var z=Gt(A,2);z.__click=()=>a(window.location.href);var B=Rt(z);{var D=ve=>{var Pe=gW(),$=lt(Pe);Y5($,{size:"22",color:"#fff",class:"relative -top-2 mt-4 mr-2 inline"}),qr(),se(ve,Pe)},V=ve=>{var Pe=_W(),$=lt(Pe);YO($,{size:"22",color:"#fff",class:"relative -top-2 mt-4 mr-2 inline"}),qr(),se(ve,Pe)};Qe(B,ve=>{T(h)?ve(D):ve(V,!1)})}Tt(z),Tt(w);var W=Gt(w,2),S=Rt(W);pr(S,"href",`mailto:?subject=Bekijk%20Watertijdreis%20en%20reis%20terug%20in%20de%20tijd&body=Ik%20wil%20je%20uitnodigen%20om%20de%20Watertijdreis%20te%20bekijken.%20Klik%20op%20deze%20link%20om%20te%20beginnen:%0A%0A${typeof window<"u"?window.location.href:""}`);var j=Rt(S);uN(j,{size:"30",color:"#f4a",class:"relative -top-1 mt-6 inline"}),Tt(S);var ne=Gt(S,2);pr(ne,"href","https://www.linkedin.com/sharing/share-offsite/?url=dev.watertijdreis.nl");var te=Rt(ne);uU(te,{size:"30",color:"#f4a",class:"relative -top-1 mt-6 inline"}),Tt(ne);var Q=Gt(ne,2);pr(Q,"href",`https://reddit.com/submit?url=${typeof window<"u"?encodeURIComponent(window.location.href):""}&title=${encodeURIComponent("Watertijdreis - Reis door de tijd!")}`);var N=Rt(Q);AH(N,{size:"30",color:"#f4a",class:"relative -top-1 mt-6 inline"}),Tt(Q);var re=Gt(Q,2);pr(re,"href",`https://wa.me/?text=${typeof window<"u"?encodeURIComponent(`Watertijdreis - Reis door de tijd!
Klik op de link om door de tijd te reizen!
`+window.location.href):""}`);var oe=Rt(re);iW(oe,{size:"30",color:"#f4a",class:"relative -top-1 mt-6 mr-1 inline"}),Tt(re),Tt(W),se(d,s)},$$slots:{default:!0}}),Hr()}_s(["click"]);const Fg=Xs({x:1/0,y:1/0});var bW=zr(`<kbd class="
                    ml-1 flex items-center rounded-[4px] border border-[#eef] bg-white
                    px-1 font-sans text-[12px] text-[#cce]
                    shadow-[0px_2px_0px_0px_#cce] select-none
                    "><span> </span></kbd>`),wW=zr(`<button class="
        group relative cursor-pointer
        rounded-[9px] font-[500]
        text-[#336] backdrop-blur-sm transition-all
        duration-500 ease-out active:scale-95 active:outline-3
    "><div class="pointer-events-none absolute inset-0 rounded-[9px] transition-opacity duration-500"></div> <div class="relative z-10 m-0.5 flex items-center rounded-[8px] bg-[#fff] px-2.25 py-2 shadow-lg hover:bg-[#ffffffe5]"><!> <div class="ease-[cubic-bezier(0.3, 0.8, 0.3, 2.3)] overflow-hidden transition-[width] duration-300"><div class="flex origin-left items-center whitespace-nowrap transition-all delay-100 duration-500 ease-out"><span class="ml-1"><!></span> <!></div></div></div></button>`);function $c(e,t){Ur(t,!0);let i=pi(t,"kbd",7,void 0),a=pi(t,"children",3,""),h=pi(t,"collapsed",7,!1),d=pi(t,"collapseAfterRender",3,!0),p=pi(t,"collapseAfterRenderDelay",3,2e3),s=pi(t,"openOnHover",3,!0),w=pi(t,"tabindex",3,void 0);const A=typeof window<"u"&&matchMedia("(pointer: coarse)").matches;!/Mac|iPhone|iPad/.test(navigator.userAgent)&&i()&&i(i().replace("â","Ctrl "));let B=fr(void 0),D=fr(null),V=fr(0),W=fr(Xs({left:0,top:0,width:0,height:0}));Yi(()=>{if(d()){const Be=setTimeout(()=>h(!0),p());return()=>clearTimeout(Be)}}),Yi(()=>{if(!T(D))return;const Be=new ResizeObserver(q=>{for(const me of q)Pt(V,me.borderBoxSize[0].inlineSize,!0)});return Be.observe(T(D)),()=>Be.disconnect()});function S(){T(B)&&Pt(W,T(B).getBoundingClientRect(),!0)}Yi(()=>{if(!T(B))return;const Be=new ResizeObserver(S);return Be.observe(T(B)),window.addEventListener("scroll",S,{capture:!0,passive:!0}),window.addEventListener("resize",S,{passive:!0}),()=>{Be.disconnect(),window.removeEventListener("scroll",S,{capture:!0}),window.removeEventListener("resize",S)}}),Yi(()=>{if(!T(B))return;const Be=Fg.x,q=Fg.y,me=T(W).left+T(W).width/2,Ee=T(W).top+T(W).height/2;Math.hypot(Be-me,q-Ee)<300?(T(B).style.setProperty("--x",`${Be-T(W).left}px`),T(B).style.setProperty("--y",`${q-T(W).top}px`),T(B).style.setProperty("--grad-opacity","1")):T(B).style.setProperty("--grad-opacity","0")});let j=null;var ne=wW();ne.__click=function(...Be){var q;(q=t.onclick)==null||q.apply(this,Be)},Bi(ne,"",{},{"--grad-opacity":"0"});var te=Rt(ne);Bi(te,"",{},{opacity:"var(--grad-opacity)",background:"radial-gradient(circle at var(--x, 50%) var(--y, 50%), #ff44aa88 0%, #eeeeff88 80%)"});var Q=Gt(te,2),N=Rt(Q);mo(N,()=>t.Icon,(Be,q)=>{q(Be,{color:"#3333aa",weight:"regular",class:"inline h-5.5 w-5.5 drop-shadow-[1px_1px_0_#33336622] transition-opacity duration-300 group-hover:opacity-100"})});var re=Gt(N,2);let oe;var ve=Rt(re);let Pe;var $=Rt(ve),le=Rt($);Ii(le,()=>a()??_o),Tt($);var Me=Gt($,2);{var Ve=Be=>{var q=bW(),me=Rt(q),Ee=Rt(me,!0);Tt(me),Tt(q),$r(()=>xn(Ee,i())),se(Be,q)};Qe(Me,Be=>{i()&&Be(Ve)})}Tt(ve),ha(ve,Be=>Pt(D,Be),()=>T(D)),Tt(re),Tt(Q),Tt(ne),ha(ne,Be=>Pt(B,Be),()=>T(B)),$r(()=>{pr(ne,"tabindex",w()),oe=Bi(re,"",oe,{width:`${(h()?0:T(V))??""}px`}),Pe=Bi(ve,"",Pe,{width:"max-content",transform:`translateX(${h()?-6:0}px) scaleX(${h()?85:100}%)`,opacity:h()?0:1,padding:h()?"0px":"0 4px"})}),Tn("mouseenter",ne,()=>{!A&&s()&&(j=setTimeout(()=>h(!1),500))}),Tn("mouseleave",ne,()=>{!A&&s()&&(h(!0),clearTimeout(j))}),se(e,ne),Hr()}_s(["click"]);var Rp,Lp;class xW{constructor(t){ii(this,Rp,fr(!1));ii(this,Lp,fr(null));Ke(this,"sprites",new Map);Ke(this,"initialized",!1);this.sources=t}get loading(){return T(Kt(this,Rp))}set loading(t){Pt(Kt(this,Rp),t,!0)}get error(){return T(Kt(this,Lp))}set error(t){Pt(Kt(this,Lp),t,!0)}async init(){if(!this.initialized){this.loading=!0,this.error=null;try{const t=await Promise.all(this.sources.map(a=>fetch(a.jsonUrl)));for(const a of t)if(!a.ok)throw new Error(`HTTP Error: ${a.status}`);(await Promise.all(t.map(a=>a.json()))).forEach((a,h)=>{const d=this.sources[h];for(const p of a)this.sprites.set(p.allmapsId,{...p,sourceImageUrl:d.imageUrl,sheetWidth:d.sheetWidth,sheetHeight:d.sheetHeight})}),this.initialized=!0}catch(t){console.error("SpriteSheet laadfout:",t),this.error=t instanceof Error?t.message:String(t)}finally{this.loading=!1}}}getSprite(t){return this.sprites.get(t)}}Rp=new WeakMap,Lp=new WeakMap;const MW=[{jsonUrl:"./sprites/regular-sheets-128.json",imageUrl:"./sprites/regular-sheets-128.jpg",sheetWidth:3072,sheetHeight:3078},{jsonUrl:"./sprites/special-sheets-128.json",imageUrl:"./sprites/special-sheets-128.jpg",sheetWidth:1792,sheetHeight:1951}],Su=new xW(MW);var IW=zr("<div> </div>"),AW=zr('<div class="sprite-image svelte-14njmyt" role="img" aria-label="Kaart thumbnail"></div>'),TW=zr("<div><!></div>");function oy(e,t){Ur(t,!0);let i=pi(t,"id",7),a=pi(t,"height",3,void 0),h=pi(t,"width",3,void 0),d=pi(t,"className",3,"");i(i().replace("-b",""));let p=pt(()=>Su.loading?null:Su.getSprite(i())),s=pt(()=>{if(!T(p))return{refWidth:h()?typeof h()=="number"?`${h()}px`:h():"128px",refHeight:a()?typeof a()=="number"?`${a()}px`:a():"104px",scaleFactor:1,isReady:!1};const V=T(p).width,W=T(p).height,S=typeof h()=="number"?h():void 0,j=typeof a()=="number"?a():void 0;let ne=0,te=0;S!==void 0&&(ne=S/V),j!==void 0&&(te=j/W);const Q=[];ne>0&&Q.push(ne),te>0&&Q.push(te);let N;Q.length===0?N=1:N=Math.min(...Q);const re=V*N,oe=W*N,ve=typeof h()=="string"&&h()?h():`${re}px`,Pe=typeof a()=="string"&&a()?a():`${oe}px`;return{refWidth:ve,refHeight:Pe,scaleFactor:N,isReady:!0}}),w=pt(()=>{if(!T(p)||!T(s).isReady)return"";const{refWidth:V,refHeight:W,scaleFactor:S}=T(s),j=T(p).x*S,ne=T(p).y*S,te=T(p).sheetWidth,Q=T(p).sheetHeight,N=te*S,re=Q*S;return[`width: ${V}`,`height: ${W}`,`background-image: url('${T(p).sourceImageUrl}')`,`background-position: -${j}px -${ne}px`,`background-size: ${N}px ${re}px`,"background-repeat: no-repeat"].join(";")});var A=TW(),z=Rt(A);{var B=V=>{var W=IW();let S;var j=Rt(W,!0);Tt(W),$r(()=>{Ys(W,1,`placeholder ${Su.loading?"loading":"error"}`,"svelte-14njmyt"),pr(W,"title",T(p)?void 0:"Kaart niet gevonden"),S=Bi(W,"",S,{width:T(s).refWidth,height:T(s).refHeight}),xn(j,Su.loading?"Laden...":"?")}),se(V,W)},D=V=>{var W=AW();$r(()=>Bi(W,T(w))),se(V,W)};Qe(z,V=>{Su.loading||!T(p)?V(B):V(D,!1)})}Tt(A),$r(()=>Ys(A,1,`thumbnail-wrapper ${d()??""}`,"svelte-14njmyt")),se(e,A),Hr()}var CW=zr(`<div class="prose sm:p-6 sm:pt-0"><p>Watertijdreis maakt het mogelijk om ruim 150 jaar aan Nederlandse watergeschiedenis te
			ontdekken. Vanaf de negentiende eeuw is er veel veranderd in de manier waarop we water beheren
			en afwateren. De Waterstaatskaarten, vervaardigd door Rijkswaterstaat tussen 1865 en 1992,
			brengen die veranderingen landsdekkend in beeld. Je ziet hoe Nederland zich in korte tijd snel
			heeft ontwikkeld: afwateringsgebieden verschoven, beek- en rivierlopen zijn verlegd, nieuwe
			waterbouwkundige kunstwerken zijn gebouwd en grotere wateren zijn ingepolderd. Deze
			cultuurhistorische tijdreis geeft inzicht in de keuzes die hebben geleid tot het landschap van
			nu, en kan inspireren om historische kennis opnieuw te benutten.</p> <p>GeÃ¯nspireerd op <a href="https://www.topotijdreis.nl/">Topotijdreis</a> vormt de tijdlijn het startpunt
			van je reis. In een aantal sprongen reis je voor elk gebied in Nederland door twee eeuwen watergeschiedenis.
			Het hele land is opgedeeld in zoân 160 kaartbladen, die elk voorzien zijn van een legenda boordevol
			informatie. Deze informatie kan op verschillende manieren worden gedeeld en gedownload. De URL
			past zich tijdens je reis aan je locatie en tijdstip aan, zodat je jouw kaartbeeld kunt opslaan
			en delen. Daarnaast is het mogelijk de historische kaarten met verschillende achtergrondkaarten
			te combineren. Door bijvoorbeeld de waterlaag aan of uit te zetten kun je huidige waterlopen en
			-lichamen vergelijken met die van vroeger.</p> <p>Tot nu toe was een landsdekkende verbeelding van twee eeuwen aan waterstaatsgeschiedenis niet
			eerder overzichtelijk gepresenteerd. Om die reden hebben de <a href="https://www.cultureelerfgoed.nl/">Rijksdienst voor het Cultureel Erfgoed</a> (RCE) en <a href="https://www.stowa.nl/">STOWA</a> het initiatief genomen voor Watertijdreis.
			Samen met <a href="https://allmaps.org/">Allmaps</a>, <a href="https://www.tudelft.nl/">TU Delft</a>, <a href="https://www.uu.nl/universiteitsbibliotheek">Universiteitsbliotheek Utrecht</a> en <a href="https://www.linkedin.com/company/de-geomaten/">De Geomaten</a> kon deze applicatie worden gemaakt. Watertijdreis zal in de toekomst worden uitgebreid met meer
			historische kaarten die onze watergeschiedenis verbeelden.</p> <p>Voor vragen, feedback en suggesties neem contact op met:</p> <blockquote><a href="mailto:waterenklimaat@cultureelerfgoed.nl">waterenklimaat@cultureelerfgoed.nl</a></blockquote> <hr/> <i>Meer informatie:</i> <ul><li><a href="https://publicaties.stowa.nl/stowa-ter-info-94/samenwerking-tussen-stowa-en-rijksdienst-voor-het-cultureel-erfgoed-erfgoedspecialisten-bieden-waterschappen-inzicht-in-het-water-en-bodemgestuurde-verleden">Erfgoedspecialisten bieden waterschappen inzicht in het water-en-bodemgestuurde verleden</a> (STOWA)</li> <li><a href="https://www.cultureelerfgoed.nl/onderwerpen/bronnen-en-kaarten/overzicht/leven-met-water-kaart">Leven met water</a> (RCE)</li> <li><a href="https://rce.webgis.nl/nl/map/erfgoedatlas">Erfgoedatlas</a> (RCE)</li> <li><a href="https://open.rijkswaterstaat.nl/@28836/waterstaat-kaart-geschiedenis/">Waterstaat in kaart. Geschiedenis van de waterstaatskaart van Nederland 1865-1992</a> (Rijkswaterstaat)</li></ul> <i>Gebruikte techniek:</i> <ul><li><a href="https://repository.tudelft.nl/record/a39e2c3e-640c-4fa5-8abf-1e376d75ae5f">Georeferencing Historic Map Series: An Automated Approach</a> (TU Delft)</li> <li><a href="https://www.e-perimetron.org/Vol_20_1/Meijers_et_al.pdf">Mapping the Edge: A Novel Approach to Georeferencing Historical Map Series</a> (PDF)</li> <li><a href="https://iiif.io/api/extension/georef/">Georeference Extension</a> (IIIF Consortium)</li></ul> <i>Broncode en data:</i> <ul><li><a href="https://github.com/allmaps/watertijdreis">Broncode applicatie</a> (GitHub)</li> <li><a href="https://github.com/tu-delft-heritage/watertijdreis-data">Georeference Annotations</a> (GitHub)</li> <li>Scans (Universiteitsbliotheek Utrecht) <ul><li><a href="https://objects.library.uu.nl/reader/1874-389916">Editie 1</a></li> <li><a href="https://objects.library.uu.nl/reader/1874-456650">Editie 1 BIS</a></li> <li><a href="https://objects.library.uu.nl/reader/1874-455650">Editie 2</a></li> <li><a href="https://objects.library.uu.nl/reader/1874-456550">Editie 2 BIS</a></li> <li><a href="https://objects.library.uu.nl/reader/1874-456551">Editie 3</a></li> <li><a href="https://objects.library.uu.nl/reader/1874-456552">Editie 3 BIS</a></li> <li><a href="https://objects.library.uu.nl/reader/1874-456588">Editie 4</a></li> <li><a href="https://objects.library.uu.nl/reader/1874-456553">Editie 4 BIS</a></li> <li><a href="https://objects.library.uu.nl/reader/1874-456827">Editie 5</a></li></ul></li></ul> <hr/> <div class="flex flex-wrap"><div class="basis-2/2 p-2"><a href="https://www.cultureelerfgoed.nl/"><img class="mx-auto h-20" alt="RCE Logo" src="/img/svg/rce-logo.svg"/></a></div> <div class="basis-2/2 p-2"><a href="https://www.stowa.nl/"><img class="mx-auto h-10" alt="STOWA Logo" src="/img/svg/stowa-logo.svg"/></a></div> <div class="basis-1/2 p-2"><a href="https://allmaps.org/"><img class="mx-auto h-15" alt="Allmaps Logo" src="/img/svg/allmaps-logo.svg"/></a></div> <div class="basis-1/2 p-2"><a href="https://www.tudelft.nl/"><img class="mx-auto h-20" alt="TU Delft Logo" src="/img/svg/tu-logo.svg"/></a></div> <div class="basis-2/2 p-2"><a href="https://www.linkedin.com/company/de-geomaten/"><img class="mx-auto h-10" alt="De Geomaten Logo" src="/img/svg/geomaten-logo.svg"/></a></div></div></div>`);function SW(e,t){Ur(t,!0);let i=pi(t,"visible",15);Mb(e,{title:"Over Watertijdreis",get visible(){return i()},set visible(a){i(a)},children:(a,h)=>{var d=CW();se(a,d)},$$slots:{default:!0}}),Hr()}var PW=zr("<span> </span>"),EW=zr('<!> <!> <div class="absolute top-2 left-2 z-999 flex items-center gap-1 rounded-[8px] bg-[#ffffff] p-4 text-[#336] shadow-lg sm:top-5 sm:left-5 svelte-zne36e" role="group"><button class="svelte-zne36e"><h1 class="mr-1 flex inline cursor-pointer gap-[1px] text-[20px] font-[700] text-shadow-[2px_2px_0_#eef] svelte-zne36e"></h1></button> <!> <!></div>',1);function kW(e,t){Ur(t,!0);let i=fr(!1),a=fr(!1),h=fr(!1);setTimeout(()=>Pt(h,!0),2e3);var d=EW(),p=lt(d);SW(p,{get visible(){return T(i)},set visible(V){Pt(i,V,!0)}});var s=Gt(p,2);yW(s,{get visible(){return T(a)},set visible(V){Pt(a,V,!0)}});var w=Gt(s,2),A=Rt(w);A.__click=function(...V){var W;(W=t.resetState)==null||W.apply(this,V)};var z=Rt(A);Mo(z,20,()=>"Watertijdreis".split(""),ml,(V,W,S)=>{var j=PW();let ne;Bi(j,"",{},{animation:"","animation-delay":S*100+"ms"});var te=Rt(j,!0);Tt(j),$r(()=>{ne=Ys(j,1,"inline-block will-change-[transform,text-shadow,color] svelte-zne36e",null,ne,{wave:t.historicMapsLoaded,"wave-loading":!t.historicMapsLoaded}),xn(te,W)}),se(V,j)}),Tt(z),Tt(A);var B=Gt(A,2);$c(B,{tabindex:"1",onclick:()=>Pt(i,!T(i)),get Icon(){return sy},children:(V,W)=>{qr();var S=wi("Over");se(V,S)},$$slots:{default:!0}});var D=Gt(B,2);$c(D,{tabindex:"2",onclick:()=>Pt(a,!T(a)),get Icon(){return LH},children:(V,W)=>{qr();var S=wi("Delen");se(V,S)},$$slots:{default:!0}}),Tt(w),Tn("mouseenter",w,()=>Pt(h,!1)),Tn("mouseleave",w,()=>Pt(h,!0)),se(e,d),Hr()}_s(["click"]);var RW=ht('<polygon stroke="#ff44aa"></polygon>'),LW=ht('<rect fill="none" stroke="#33336644"></rect>'),zW=ht('<path fill="none" stroke="#33a"></path><path fill="none" stroke="#33a"></path>',1),FW=ht("<g><!></g>"),DW=ht('<svg class="transition-scale pointer-events-none absolute bottom-32 left-2 z-998 origin-bottom-left scale-80 touch-none duration-300 hover:scale-100 sm:right-8" style="filter: drop-shadow( 1px 1px 0px #33336666);"><g><!><!><!></g></svg>');function BW(e,t){Ur(t,!0);let i=pt(()=>t.visibleHistoricMapsInViewport.size==1?t.visibleHistoricMapsInViewport.values().next().value:null),a=pt(()=>t.historicMapsLoaded?t.visibleHistoricMaps.values().toArray().map(V=>({type:"Feature",geometry:Zx(structuredClone(V.polygon)),properties:{id:V.id}})):[]),h=160,d=200,p=pt(()=>{const V=W8({type:"FeatureCollection",features:T(a)}),W=V[2]-V[0],S=V[3]-V[1],j=W*.075,ne=S*.075;return[V[0]-j,V[1]-ne,W+j*2,S+ne*2]}),s=pt(()=>{if(t.viewportPolygon)return Zx(t.viewportPolygon)});function w(V){return V.map(W=>W.join(",")).join(" ")}function A(V){const W=T(p)[0]+T(p)[2]/h*2,S=T(p)[1]+T(p)[2]/h*2,j=T(p)[0]+T(p)[2]-4*(T(p)[2]/h),ne=T(p)[1]+T(p)[3]-4*(T(p)[2]/h),te=V.map(([$,le])=>[Math.min(Math.max($,W),j),Math.min(Math.max(le,S),ne)]),Q=te.map($=>$[0]),N=te.map($=>$[1]),re=Math.min(...Q),oe=Math.min(...N),ve=Math.max(...Q)-re,Pe=Math.max(...N)-oe;return{x:re,y:oe,width:ve,height:Pe}}var z=_t(),B=lt(z);{var D=V=>{var W=DW();pr(W,"width",h),pr(W,"height",d);var S=Rt(W),j=Rt(S);Mo(j,17,()=>T(a),ml,(re,oe)=>{const ve=pt(()=>!t.clickedHistoricMap&&T(i)&&T(oe).properties.id==T(i).id),Pe=pt(()=>t.selectedHistoricMap&&T(oe).properties.id==t.selectedHistoricMap.id),$=pt(()=>t.clickedHistoricMap&&T(oe).properties.id==t.clickedHistoricMap.id),le=pt(()=>!t.selectedHistoricMap&&t.visibleHistoricMapsInViewport.has(T(oe).properties.id)),Me=pt(()=>T(ve)||T($)||T(Pe)?"#ff44aaaa":T(le)?"#ff44aa44":"#ff44aa11");var Ve=RW();$r(Be=>{pr(Ve,"points",Be),pr(Ve,"fill",T(Me)),pr(Ve,"stroke-width",T(p)[2]/h*1.33)},[()=>w(T(oe).geometry.coordinates[0])]),se(re,Ve)});var ne=Gt(j);{var te=re=>{const oe=pt(()=>{const{x:Pe,y:$,width:le,height:Me}=A(T(s).geometry.coordinates[0]);return{x:Pe,y:$,w:le,h:Me}});var ve=LW();$r(()=>{pr(ve,"x",T(oe).x),pr(ve,"y",T(oe).y),pr(ve,"width",T(oe).w),pr(ve,"height",T(oe).h),pr(ve,"stroke-width",T(p)[2]/h*4),pr(ve,"rx",T(p)[2]/h*2),pr(ve,"ry",T(p)[2]/h*2)}),se(re,ve)};Qe(ne,re=>{T(s)&&!t.selectedHistoricMap&&re(te)})}var Q=Gt(ne);{var N=re=>{var oe=FW(),ve=Rt(oe);mv(ve,()=>T(i)||t.clickedHistoricMap||t.selectedHistoricMap||t.sheetIndexVisible&&t.hoveredHistoricMap,Pe=>{const $=pt(()=>T(i)||t.clickedHistoricMap||t.selectedHistoricMap||t.sheetIndexVisible&&t.hoveredHistoricMap),le=pt(()=>T(a).find(It=>It.properties.id==T($).id)),Me=pt(()=>T(le)?by(T(le)).geometry.coordinates:[0,0]),Ve=pt(()=>T(Me)[0]),Be=pt(()=>T(Me)[1]),q=pt(()=>T(p)[0]+T(p)[2]/2),me=pt(()=>T(p)[1]-T(p)[3]*.03),Ee=pt(()=>T(p)[2]/h*2),Ne=pt(()=>Math.atan2(T(me)-T(Be),T(q)-T(Ve))),$e=pt(()=>T(Ee)*5),ye=pt(()=>T(q)-T($e)*Math.cos(T(Ne))+T($e)*.5*Math.sin(T(Ne))),ge=pt(()=>T(me)-T($e)*Math.sin(T(Ne))-T($e)*.5*Math.cos(T(Ne))),Ye=pt(()=>T(q)-T($e)*Math.cos(T(Ne))-T($e)*.5*Math.sin(T(Ne))),We=pt(()=>T(me)-T($e)*Math.sin(T(Ne))+T($e)*.5*Math.cos(T(Ne)));var ot=zW(),Se=lt(ot),Ce=Gt(Se);$r(()=>{pr(Se,"stroke-width",T(Ee)),pr(Se,"d",`
								M ${T(Ve)} ${T(Be)}
								L ${T(q)} ${T(me)}
								L ${T(ye)} ${T(ge)}
							`),pr(Ce,"stroke-width",T(Ee)),pr(Ce,"d",`
								M ${T(Ve)} ${T(Be)}
								L ${T(q)} ${T(me)}
								L ${T(Ye)} ${T(We)}
							`)}),Vn(5,Se,()=>c8,()=>({duration:250})),Vn(5,Ce,()=>c8,()=>({duration:250})),se(Pe,ot)}),Tt(oe),Vn(2,oe,()=>c1,()=>({duration:250})),se(re,oe)};Qe(Q,re=>{(T(i)||t.clickedHistoricMap||t.selectedHistoricMap||t.sheetIndexVisible&&t.hoveredHistoricMap)&&re(N)})}Tt(S),Tt(W),$r(re=>{pr(W,"viewBox",re),pr(S,"transform",`scale(1, -1) translate(0, -${T(p)[1]*2+T(p)[3]})`)},[()=>T(p).join(" ")]),se(V,W)};Qe(B,V=>{t.visibleHistoricMaps.size&&V(D)})}se(e,z),Hr()}function h8(e){return Object.prototype.toString.call(e)==="[object Date]"}function ly(e,t,i,a){if(typeof i=="number"||h8(i)){const h=a-i,d=(i-t)/(e.dt||1/60),p=e.opts.stiffness*h,s=e.opts.damping*d,w=(p-s)*e.inv_mass,A=(d+w)*e.dt;return Math.abs(A)<e.opts.precision&&Math.abs(h)<e.opts.precision?a:(e.settled=!1,h8(i)?new Date(i.getTime()+A):i+A)}else{if(Array.isArray(i))return i.map((h,d)=>ly(e,t[d],i[d],a[d]));if(typeof i=="object"){const h={};for(const d in i)h[d]=ly(e,t[d],i[d],a[d]);return h}else throw new Error(`Cannot spring ${typeof i} values`)}}var Jc,Qc,eh,Ma,Nl,th,Hu,rh,zp,dl,Wu,Vg,J5;const Eb=class Eb{constructor(t,i={}){ii(this,Vg);ii(this,Jc,fr(.15));ii(this,Qc,fr(.8));ii(this,eh,fr(.01));ii(this,Ma);ii(this,Nl);ii(this,th);ii(this,Hu,0);ii(this,rh,1);ii(this,zp,0);ii(this,dl,null);ii(this,Wu,null);Zi(this,Ma,fr(t)),Zi(this,Nl,fr(t)),typeof i.stiffness=="number"&&(Kt(this,Jc).v=km(i.stiffness,0,1)),typeof i.damping=="number"&&(Kt(this,Qc).v=km(i.damping,0,1)),typeof i.precision=="number"&&(Kt(this,eh).v=i.precision)}static of(t,i){const a=new Eb(t(),i);return vy(()=>{a.set(t())}),a}set(t,i){var h,d;if((h=Kt(this,Wu))==null||h.reject(new Error("Aborted")),i!=null&&i.instant||Kt(this,Ma).v===void 0)return(d=Kt(this,dl))==null||d.abort(),Zi(this,dl,null),Pt(Kt(this,Ma),Pt(Kt(this,Nl),t)),Zi(this,th,t),Promise.resolve();i!=null&&i.preserveMomentum&&(Zi(this,rh,0),Zi(this,zp,i.preserveMomentum));var a=Zi(this,Wu,tT());return a.promise.catch(_o),Os(this,Vg,J5).call(this,t).then(()=>{a===Kt(this,Wu)&&a.resolve(void 0)}),a.promise}get current(){return T(Kt(this,Ma))}get damping(){return T(Kt(this,Qc))}set damping(t){Pt(Kt(this,Qc),km(t,0,1))}get precision(){return T(Kt(this,eh))}set precision(t){Pt(Kt(this,eh),t)}get stiffness(){return T(Kt(this,Jc))}set stiffness(t){Pt(Kt(this,Jc),km(t,0,1))}get target(){return T(Kt(this,Nl))}set target(t){this.set(t)}};Jc=new WeakMap,Qc=new WeakMap,eh=new WeakMap,Ma=new WeakMap,Nl=new WeakMap,th=new WeakMap,Hu=new WeakMap,rh=new WeakMap,zp=new WeakMap,dl=new WeakMap,Wu=new WeakMap,Vg=new WeakSet,J5=function(t){var a;if(Pt(Kt(this,Nl),t),(a=Kt(this,Ma)).v??(a.v=t),Kt(this,th)??Zi(this,th,Kt(this,Ma).v),!Kt(this,dl)){Zi(this,Hu,vo.now());var i=1e3/(Kt(this,zp)*60);Kt(this,dl)??Zi(this,dl,B8(h=>{Zi(this,rh,Math.min(Kt(this,rh)+i,1));const d=Math.min(h-Kt(this,Hu),1e3/30),p={inv_mass:Kt(this,rh),opts:{stiffness:Kt(this,Jc).v,damping:Kt(this,Qc).v,precision:Kt(this,eh).v},settled:!0,dt:d*60/1e3};var s=ly(p,Kt(this,th),Kt(this,Ma).v,Kt(this,Nl).v);return Zi(this,th,Kt(this,Ma).v),Zi(this,Hu,h),Pt(Kt(this,Ma),s),p.settled&&Zi(this,dl,null),!p.settled}))}return Kt(this,dl).promise};let cy=Eb;function km(e,t,i){return Math.max(t,Math.min(i,e))}var GW=zr(`<div class="timeline-pointer touch-action-none pointer-events-none absolute -top-1.5 left-1/2 -translate-x-1/2"><div class="absolute top-0 left-[-1px] h-100 w-[2px] bg-[#eef]"></div> <div class="absolute top-0 left-[-20px] h-[20px] w-[50px] rounded-sm bg-[#eef]"></div> <div class="absolute top-[0px] left-[-33px] h-[20px] w-[15px] bg-[#eef] shadow-md" style="clip-path: polygon(0% 50%, 100% 0%, 100% 100%);"></div> <div class="absolute top-[20px] left-[-7px] h-[8px] w-[14px] bg-[#eef]" style="clip-path: polygon(0% 0%, 100% 0%, 50% 100%);"></div> <div style="
    position: absolute;
    top: 0;
    left: 0;
    height: 20px;
    color: #336;
	font-family: 'ivypresto-display';
    font-size: 18px;
    font-weight: 600;
    pointer-events: none;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 4px;
    "> </div></div>`);function VW(e,t){var i=GW();Bi(i,"z-index: 1000",{},{left:"50%"});var a=Gt(Rt(i),8),h=Rt(a,!0);Tt(a),Tt(i),$r(()=>xn(h,t.year)),se(e,i)}_s(["click"]);function jW(e){return e!==null&&typeof e=="object"}const ZW=["string","number","bigint","boolean"];function hy(e){return e==null||ZW.includes(typeof e)?!0:Array.isArray(e)?e.every(t=>hy(t)):typeof e=="object"?Object.getPrototypeOf(e)===Object.prototype:!1}const uy=Symbol("box"),OW=Symbol("is-writable");function cl(e,t){const i=pt(e);return t?{[uy]:!0,[OW]:!0,get current(){return T(i)},set current(a){t(a)}}:{[uy]:!0,get current(){return e()}}}function NW(e){return jW(e)&&uy in e}function UW(...e){return function(t){var i;for(const a of e)if(a){if(t.defaultPrevented)return;typeof a=="function"?a.call(this,t):(i=a.current)==null||i.call(this,t)}}}var wu={},lv,u8;function HW(){if(u8)return lv;u8=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,i=/^\s*/,a=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,h=/^:\s*/,d=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,p=/^[;\s]*/,s=/^\s+|\s+$/g,w=`
`,A="/",z="*",B="",D="comment",V="declaration";lv=function(S,j){if(typeof S!="string")throw new TypeError("First argument must be a string");if(!S)return[];j=j||{};var ne=1,te=1;function Q(Be){var q=Be.match(t);q&&(ne+=q.length);var me=Be.lastIndexOf(w);te=~me?Be.length-me:te+Be.length}function N(){var Be={line:ne,column:te};return function(q){return q.position=new re(Be),Pe(),q}}function re(Be){this.start=Be,this.end={line:ne,column:te},this.source=j.source}re.prototype.content=S;function oe(Be){var q=new Error(j.source+":"+ne+":"+te+": "+Be);if(q.reason=Be,q.filename=j.source,q.line=ne,q.column=te,q.source=S,!j.silent)throw q}function ve(Be){var q=Be.exec(S);if(q){var me=q[0];return Q(me),S=S.slice(me.length),q}}function Pe(){ve(i)}function $(Be){var q;for(Be=Be||[];q=le();)q!==!1&&Be.push(q);return Be}function le(){var Be=N();if(!(A!=S.charAt(0)||z!=S.charAt(1))){for(var q=2;B!=S.charAt(q)&&(z!=S.charAt(q)||A!=S.charAt(q+1));)++q;if(q+=2,B===S.charAt(q-1))return oe("End of comment missing");var me=S.slice(2,q-2);return te+=2,Q(me),S=S.slice(q),te+=2,Be({type:D,comment:me})}}function Me(){var Be=N(),q=ve(a);if(q){if(le(),!ve(h))return oe("property missing ':'");var me=ve(d),Ee=Be({type:V,property:W(q[0].replace(e,B)),value:me?W(me[0].replace(e,B)):B});return ve(p),Ee}}function Ve(){var Be=[];$(Be);for(var q;q=Me();)q!==!1&&(Be.push(q),$(Be));return Be}return Pe(),Ve()};function W(S){return S?S.replace(s,B):B}return lv}var d8;function WW(){if(d8)return wu;d8=1;var e=wu&&wu.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(wu,"__esModule",{value:!0}),wu.default=i;var t=e(HW());function i(a,h){var d=null;if(!a||typeof a!="string")return d;var p=(0,t.default)(a),s=typeof h=="function";return p.forEach(function(w){if(w.type==="declaration"){var A=w.property,z=w.value;s?h(A,z,w):z&&(d=d||{},d[A]=z)}}),d}return wu}var XW=WW();const f8=Hg(XW),qW=f8.default||f8,YW=/\d/,KW=["-","_","/","."];function $W(e=""){if(!YW.test(e))return e!==e.toLowerCase()}function JW(e){const t=[];let i="",a,h;for(const d of e){const p=KW.includes(d);if(p===!0){t.push(i),i="",a=void 0;continue}const s=$W(d);if(h===!1){if(a===!1&&s===!0){t.push(i),i=d,a=s;continue}if(a===!0&&s===!1&&i.length>1){const w=i.at(-1);t.push(i.slice(0,Math.max(0,i.length-1))),i=w+d,a=s;continue}}i+=d,a=s,h=p}return t.push(i),t}function Q5(e){return e?JW(e).map(t=>eX(t)).join(""):""}function QW(e){return tX(Q5(e||""))}function eX(e){return e?e[0].toUpperCase()+e.slice(1):""}function tX(e){return e?e[0].toLowerCase()+e.slice(1):""}function Rm(e){if(!e)return{};const t={};function i(a,h){if(a.startsWith("-moz-")||a.startsWith("-webkit-")||a.startsWith("-ms-")||a.startsWith("-o-")){t[Q5(a)]=h;return}if(a.startsWith("--")){t[a]=h;return}t[QW(a)]=h}return qW(e,i),t}function rX(...e){return(...t)=>{for(const i of e)typeof i=="function"&&i(...t)}}function iX(e,t){const i=RegExp(e,"g");return a=>{if(typeof a!="string")throw new TypeError(`expected an argument of type string, but got ${typeof a}`);return a.match(i)?a.replace(i,t):a}}const nX=iX(/[A-Z]/,e=>`-${e.toLowerCase()}`);function sX(e){if(!e||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected an argument of type object, but got ${typeof e}`);return Object.keys(e).map(t=>`${nX(t)}: ${e[t]};`).join(`
`)}function eM(e={}){return sX(e).replace(`
`," ")}const aX=["onabort","onanimationcancel","onanimationend","onanimationiteration","onanimationstart","onauxclick","onbeforeinput","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncompositionend","oncompositionstart","oncompositionupdate","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onfocusin","onfocusout","onformdata","ongotpointercapture","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onlostpointercapture","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onpaste","onpause","onplay","onplaying","onpointercancel","onpointerdown","onpointerenter","onpointerleave","onpointermove","onpointerout","onpointerover","onpointerup","onprogress","onratechange","onreset","onresize","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onselectionchange","onselectstart","onslotchange","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ontransitioncancel","ontransitionend","ontransitionrun","ontransitionstart","onvolumechange","onwaiting","onwebkitanimationend","onwebkitanimationiteration","onwebkitanimationstart","onwebkittransitionend","onwheel"],oX=new Set(aX);function lX(e){return oX.has(e)}function Ib(...e){const t={...e[0]};for(let i=1;i<e.length;i++){const a=e[i];if(a){for(const h of Object.keys(a)){const d=t[h],p=a[h],s=typeof d=="function",w=typeof p=="function";if(s&&lX(h)){const A=d,z=p;t[h]=UW(A,z)}else if(s&&w)t[h]=rX(d,p);else if(h==="class"){const A=hy(d),z=hy(p);A&&z?t[h]=Fm(d,p):A?t[h]=Fm(d):z&&(t[h]=Fm(p))}else if(h==="style"){const A=typeof d=="object",z=typeof p=="object",B=typeof d=="string",D=typeof p=="string";if(A&&z)t[h]={...d,...p};else if(A&&D){const V=Rm(p);t[h]={...d,...V}}else if(B&&z){const V=Rm(d);t[h]={...V,...p}}else if(B&&D){const V=Rm(d),W=Rm(p);t[h]={...V,...W}}else A?t[h]=d:z?t[h]=p:B?t[h]=d:D&&(t[h]=p)}else t[h]=p!==void 0?p:d}for(const h of Object.getOwnPropertySymbols(a)){const d=t[h],p=a[h];t[h]=p!==void 0?p:d}}}return typeof t.style=="object"&&(t.style=eM(t.style).replaceAll(`
`," ")),t.hidden===!1&&(t.hidden=void 0,delete t.hidden),t.disabled===!1&&(t.disabled=void 0,delete t.disabled),t}const cX={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",transform:"translateX(-100%)"},hX=eM(cX);function tM(e,t){return{[oT()]:i=>NW(e)?(e.current=i,Yu(()=>t==null?void 0:t(i)),()=>{"isConnected"in i&&i.isConnected||(e.current=null)}):(e(i),Yu(()=>t==null?void 0:t(i)),()=>{"isConnected"in i&&i.isConnected||e(null)})}}const uX=typeof window<"u"?window:void 0;function dX(e){let t=e.activeElement;for(;t!=null&&t.shadowRoot;){const i=t.shadowRoot.activeElement;if(i===t)break;t=i}return t}var Xu,Fp;class fX{constructor(t={}){ii(this,Xu);ii(this,Fp);const{window:i=uX,document:a=i==null?void 0:i.document}=t;i!==void 0&&(Zi(this,Xu,a),Zi(this,Fp,rT(h=>{const d=xx(i,"focusin",h),p=xx(i,"focusout",h);return()=>{d(),p()}})))}get current(){var t;return(t=Kt(this,Fp))==null||t.call(this),Kt(this,Xu)?dX(Kt(this,Xu)):null}}Xu=new WeakMap,Fp=new WeakMap;new fX;var Dp,fl;class pX{constructor(t){ii(this,Dp);ii(this,fl);Zi(this,Dp,t),Zi(this,fl,Symbol(t))}get key(){return Kt(this,fl)}exists(){return S8(Kt(this,fl))}get(){const t=fv(Kt(this,fl));if(t===void 0)throw new Error(`Context "${Kt(this,Dp)}" not found`);return t}getOr(t){const i=fv(Kt(this,fl));return i===void 0?t:i}set(t){return iT(Kt(this,fl),t)}}Dp=new WeakMap,fl=new WeakMap;function mX(e){return e?"true":"false"}function p8(e){return e?"":void 0}function gX(e){return e?!0:void 0}function _X(e){return e?"checked":"unchecked"}function vX(e,t){return e?"true":"false"}var qu,Bp;class yX{constructor(t){ii(this,qu);ii(this,Bp);Ke(this,"attrs");Zi(this,qu,t.getVariant?t.getVariant():null),Zi(this,Bp,Kt(this,qu)?`data-${Kt(this,qu)}-`:`data-${t.component}-`),this.getAttr=this.getAttr.bind(this),this.selector=this.selector.bind(this),this.attrs=Object.fromEntries(t.parts.map(i=>[i,this.getAttr(i)]))}getAttr(t,i){return i?`data-${i}-${t}`:`${Kt(this,Bp)}${t}`}selector(t,i){return`[${this.getAttr(t,i)}]`}}qu=new WeakMap,Bp=new WeakMap;function bX(e){const t=new yX(e);return{...t.attrs,selector:t.selector,getAttr:t.getAttr}}const wX="Enter",xX=" ";function MX(){}function rM(e,t){return`bits-${e}`}var IX=zr("<input/>"),AX=zr("<input/>");function TX(e,t){Ur(t,!0);let i=pi(t,"value",15),a=Ri(t,["$$slots","$$events","$$legacy","value"]);const h=pt(()=>Ib(a,{"aria-hidden":"true",tabindex:-1,style:hX}));var d=_t(),p=lt(d);{var s=A=>{var z=IX();Pi(z,()=>({...T(h),value:i()}),void 0,void 0,void 0,void 0,!0),se(A,z)},w=A=>{var z=AX();Pi(z,()=>({...T(h)}),void 0,void 0,void 0,void 0,!0),$m(z,i),se(A,z)};Qe(p,A=>{T(h).type==="checkbox"?A(s):A(w,!1)})}se(e,d),Hr()}const iM=bX({component:"switch",parts:["root","thumb"]}),Ab=new pX("Switch.Root");var Gp,fy,Vp,jp,Zp;const kb=class kb{constructor(t){ii(this,Gp);Ke(this,"opts");Ke(this,"attachment");ii(this,Vp,pt(()=>({"data-disabled":p8(this.opts.disabled.current),"data-state":_X(this.opts.checked.current),"data-required":p8(this.opts.required.current)})));ii(this,jp,pt(()=>({checked:this.opts.checked.current})));ii(this,Zp,pt(()=>({...this.sharedProps,id:this.opts.id.current,role:"switch",disabled:gX(this.opts.disabled.current),"aria-checked":vX(this.opts.checked.current),"aria-required":mX(this.opts.required.current),[iM.root]:"",onclick:this.onclick,onkeydown:this.onkeydown,...this.attachment})));this.opts=t,this.attachment=tM(t.ref),this.onkeydown=this.onkeydown.bind(this),this.onclick=this.onclick.bind(this)}static create(t){return Ab.set(new kb(t))}onkeydown(t){!(t.key===wX||t.key===xX)||this.opts.disabled.current||(t.preventDefault(),Os(this,Gp,fy).call(this))}onclick(t){this.opts.disabled.current||Os(this,Gp,fy).call(this)}get sharedProps(){return T(Kt(this,Vp))}set sharedProps(t){Pt(Kt(this,Vp),t)}get snippetProps(){return T(Kt(this,jp))}set snippetProps(t){Pt(Kt(this,jp),t)}get props(){return T(Kt(this,Zp))}set props(t){Pt(Kt(this,Zp),t)}};Gp=new WeakSet,fy=function(){this.opts.checked.current=!this.opts.checked.current},Vp=new WeakMap,jp=new WeakMap,Zp=new WeakMap;let dy=kb;var Op,Np;const Rb=class Rb{constructor(t){Ke(this,"root");ii(this,Op,pt(()=>this.root.opts.name.current!==void 0));ii(this,Np,pt(()=>({type:"checkbox",name:this.root.opts.name.current,value:this.root.opts.value.current,checked:this.root.opts.checked.current,disabled:this.root.opts.disabled.current,required:this.root.opts.required.current})));this.root=t}static create(){return new Rb(Ab.get())}get shouldRender(){return T(Kt(this,Op))}set shouldRender(t){Pt(Kt(this,Op),t)}get props(){return T(Kt(this,Np))}set props(t){Pt(Kt(this,Np),t)}};Op=new WeakMap,Np=new WeakMap;let py=Rb;var Up,Hp;const Lb=class Lb{constructor(t,i){Ke(this,"opts");Ke(this,"root");Ke(this,"attachment");ii(this,Up,pt(()=>({checked:this.root.opts.checked.current})));ii(this,Hp,pt(()=>({...this.root.sharedProps,id:this.opts.id.current,[iM.thumb]:"",...this.attachment})));this.opts=t,this.root=i,this.attachment=tM(t.ref)}static create(t){return new Lb(t,Ab.get())}get snippetProps(){return T(Kt(this,Up))}set snippetProps(t){Pt(Kt(this,Up),t)}get props(){return T(Kt(this,Hp))}set props(t){Pt(Kt(this,Hp),t)}};Up=new WeakMap,Hp=new WeakMap;let my=Lb;function CX(e,t){Ur(t,!1);const i=py.create();uA();var a=_t(),h=lt(a);{var d=p=>{TX(p,sT(()=>i.props))};Qe(h,p=>{i.shouldRender&&p(d)})}se(e,a),Hr()}var SX=zr("<button><!></button>"),PX=zr("<!> <!>",1);function cv(e,t){const i=P8();Ur(t,!0);let a=pi(t,"ref",15,null),h=pi(t,"id",19,()=>rM(i)),d=pi(t,"disabled",3,!1),p=pi(t,"required",3,!1),s=pi(t,"checked",15,!1),w=pi(t,"value",3,"on"),A=pi(t,"name",3,void 0),z=pi(t,"type",3,"button"),B=pi(t,"onCheckedChange",3,MX),D=Ri(t,["$$slots","$$events","$$legacy","child","children","ref","id","disabled","required","checked","value","name","type","onCheckedChange"]);const V=dy.create({checked:cl(()=>s(),N=>{var re;s(N),(re=B())==null||re(N)}),disabled:cl(()=>d()??!1),required:cl(()=>p()),value:cl(()=>w()),name:cl(()=>A()),id:cl(()=>h()),ref:cl(()=>a(),N=>a(N))}),W=pt(()=>Ib(D,V.props,{type:z()}));var S=PX(),j=lt(S);{var ne=N=>{var re=_t(),oe=lt(re);{let ve=pt(()=>({props:T(W),...V.snippetProps}));Ii(oe,()=>t.child,()=>T(ve))}se(N,re)},te=N=>{var re=SX();Pi(re,()=>({...T(W)}));var oe=Rt(re);Ii(oe,()=>t.children??_o,()=>V.snippetProps),Tt(re),se(N,re)};Qe(j,N=>{t.child?N(ne):N(te,!1)})}var Q=Gt(j,2);CX(Q,{}),se(e,S),Hr()}var EX=zr("<span><!></span>");function hv(e,t){const i=P8();Ur(t,!0);let a=pi(t,"ref",15,null),h=pi(t,"id",19,()=>rM(i)),d=Ri(t,["$$slots","$$events","$$legacy","child","children","ref","id"]);const p=my.create({id:cl(()=>h()),ref:cl(()=>a(),D=>a(D))}),s=pt(()=>Ib(d,p.props));var w=_t(),A=lt(w);{var z=D=>{var V=_t(),W=lt(V);{let S=pt(()=>({props:T(s),...p.snippetProps}));Ii(W,()=>t.child,()=>T(S))}se(D,V)},B=D=>{var V=EX();Pi(V,()=>({...T(s)}));var W=Rt(V);Ii(W,()=>t.children??_o,()=>p.snippetProps),Tt(V),se(D,V)};Qe(A,D=>{t.child?D(z):D(B,!1)})}se(e,w),Hr()}var kX=zr('<div class="fixed right-2 bottom-34 w-80 rounded-lg bg-white px-3 py-3 shadow-lg transition-all duration-200"><ul class="flex flex-col gap-2 text-sm font-[500] text-[#333366]"><li class="flex cursor-pointer items-center justify-between rounded-md px-2 py-1 hover:bg-gray-50">Periode: <input type="number" class="w-20 rounded border border-[#eef] px-2 py-1 text-[16px] font-[600] text-[#33a]"/> tot <input type="number" class="w-20 rounded border border-[#eef] px-2 py-1 text-[16px] font-[600] text-[#33a]"/></li> <li class="flex items-center justify-between rounded-md px-2 py-1 hover:bg-gray-50">Reguliere Waterstaatskaarten <!></li> <li class="flex items-center justify-between rounded-md px-2 py-1 hover:bg-gray-50">Edities: <button class="cursor-pointer rounded-[4px] border-1 border-[#eef] p-2 px-2.5 hover:bg-[#eef]">Alle</button> <button class="cursor-pointer rounded-[4px] border-1 border-[#eef] p-2 px-2.5 hover:bg-[#eef]">1</button> <button class="cursor-pointer rounded-[4px] border-1 border-[#eef] p-2 px-2.5 hover:bg-[#eef]">2</button> <button class="cursor-pointer rounded-[4px] border-1 border-[#eef] p-2 px-2.5 hover:bg-[#eef]">3</button> <button class="cursor-pointer rounded-[4px] border-1 border-[#eef] p-2 px-2.5 hover:bg-[#eef]">4</button> <button class="cursor-pointer rounded-[4px] border-1 border-[#eef] p-2 px-2.5 hover:bg-[#eef]">5</button></li> <li><!> <label><input type="checkbox"/></label> BIS-edities tonen</li> <li class="flex cursor-pointer items-center justify-between rounded-md px-2 py-1 hover:bg-gray-50">Hydrologische Waarnemingspunten <!></li> <li class="flex cursor-pointer items-center justify-between rounded-md px-2 py-1 hover:bg-gray-50">Watervoorzieningseenheden <!></li></ul></div>'),RX=zr(`<div class="pointer-events-auto absolute top-2 right-2 z-[50000] select-none"><button title="Instellingen" class="
			flex h-8 w-8 cursor-pointer items-center justify-center
			rounded-full bg-[#eef] text-[#444]
			shadow-md transition-all
			hover:scale-105 hover:shadow-lg
            active:scale-95
		"><!></button> <!></div>`);function LX(e,t){Ur(t,!0);let i=pi(t,"filter",15),a=fr(!1),h=fr(void 0);function d(){Pt(a,!T(a))}function p(){Pt(a,!1)}function s(le){var Me;if(T(a))if(le.key==="Tab"){const Ve=(Me=T(h))==null?void 0:Me.querySelectorAll('button, input, [tabindex]:not([tabindex="-1"])');if(!Ve||Ve.length===0)return;const Be=Ve[0],q=Ve[Ve.length-1];le.shiftKey?document.activeElement===Be&&(le.preventDefault(),q.focus()):document.activeElement===q&&(le.preventDefault(),Be.focus())}else le.key==="Escape"&&Pt(a,!1)}let w=fr(!i().type),A=fr(Xs(i().edition)),z=fr(Xs(i().bis)),B=fr(i().type==="HWP"),D=fr(i().type==="WVE");function V(){Pt(w,!1),Pt(z,!1),Pt(B,!1),Pt(D,!1),te("All")}function W(le){if(T(w)&&!le)return!1;T(w)!==le&&(i(i().type=void 0,!0),t.applyFilter(i())),le?(V(),Pt(w,!0)):(Pt(w,!1),T(z)&&(i(i().bis=!1,!0),t.applyFilter(i())),Pt(z,!1))}function S(le){T(w)&&(T(z)!==le&&(i(i().bis=le,!0),t.applyFilter(i())),Pt(z,le,!0))}function j(le){T(B)!==le&&(te("All"),i(i().type="HWP",!0),i(i().yearEnd=t.maxYear,!0),t.applyFilter(i())),le?(V(),Pt(B,!0)):(Pt(B,!1),W(!0))}function ne(le){T(D)!==le&&(te("All"),i(i().type="WVE",!0),i(i().yearEnd=t.maxYear,!0),t.applyFilter(i())),le?(V(),Pt(D,!0)):(Pt(D,!1),W(!0))}function te(le){T(w)&&(T(A)!==le&&(i(i().edition=le,!0),i(i().yearEnd=t.maxYear,!0),t.applyFilter(i())),Pt(A,le,!0))}let Q=pt(()=>i().yearStart),N=pt(()=>i().yearEnd);var re=RX();Tn("pointerdown",pl,p),Tn("keydown",pl,s);var oe=Rt(re);oe.__pointerdown=le=>{le.stopPropagation(),d()},oe.__keydown=le=>{(le.key==="Enter"||le.key===" ")&&(le.preventDefault(),le.stopPropagation(),d())};var ve=Rt(oe);zN(ve,{size:18}),Tt(oe);var Pe=Gt(oe,2);{var $=le=>{var Me=kX();Me.__pointerdown=Yt=>{Yt.stopImmediatePropagation()};var Ve=Rt(Me),Be=Rt(Ve),q=Gt(Rt(Be));Hl(q),q.__change=()=>{Pt(Q,Math.max(t.minYear,Math.min(i().yearEnd-1,T(Q)))),i(i().yearStart=T(Q),!0),t.applyFilter(i())},q.__input=()=>{T(Q)>=t.minYear&&T(Q)<i().yearEnd&&i(i().yearStart=T(Q),!0)};var me=Gt(q,2);Hl(me),me.__change=()=>{Pt(N,Math.max(t.minYear,Math.min(t.maxYear,T(N)))),i(i().yearEnd=T(N),!0),t.applyFilter(i())},me.__input=()=>{T(N)>=t.minYear&&T(N)<=t.maxYear&&i(i().yearEnd=T(N),!0)},Tt(Be);var Ee=Gt(Be,2),Ne=Gt(Rt(Ee));mo(Ne,()=>cv,(Yt,Ar)=>{Ar(Yt,{get checked(){return T(w)},onCheckedChange:W,get disabled(){return T(w)},class:`
		relative inline-flex h-[22px]
		w-[40px] cursor-pointer
		items-center rounded-full
		bg-gray-300 px-[2px]
		transition-colors data-[state=checked]:bg-[#ff66aa]
	`,children:(yr,kr)=>{var Tr=_t(),Dr=lt(Tr);mo(Dr,()=>hv,(hi,ni)=>{ni(hi,{class:`
			block
			h-[18px] w-[18px]
			translate-x-0 cursor-pointer
			rounded-full bg-white
			transition-transform
			duration-200 data-[state=checked]:translate-x-[18px]
		`})}),se(yr,Tr)},$$slots:{default:!0}})}),Tt(Ee);var $e=Gt(Ee,2);let ye;var ge=Gt(Rt($e));ge.__click=()=>te("All");var Ye=Gt(ge,2);Ye.__click=()=>te(1);var We=Gt(Ye,2);We.__click=()=>te(2);var ot=Gt(We,2);ot.__click=()=>te(3);var Se=Gt(ot,2);Se.__click=()=>te(4);var Ce=Gt(Se,2);Ce.__click=()=>te(5),Tt($e);var It=Gt($e,2),Lt=Rt(It);iO(Lt,{});var Xt=Gt(Lt,2),Jt=Rt(Xt);Hl(Jt),Jt.__change=Yt=>S(Yt.target.checked),Tt(Xt),qr(),Tt(It);var dr=Gt(It,2),zt=Gt(Rt(dr));mo(zt,()=>cv,(Yt,Ar)=>{Ar(Yt,{get checked(){return T(B)},onCheckedChange:j,class:`
		relative inline-flex h-[22px]
		w-[40px] cursor-pointer
		items-center rounded-full
		bg-gray-300 px-[2px]
		transition-colors data-[state=checked]:bg-[#ff66aa]
	`,children:(yr,kr)=>{var Tr=_t(),Dr=lt(Tr);mo(Dr,()=>hv,(hi,ni)=>{ni(hi,{class:`
			block
			h-[18px] w-[18px]
			translate-x-0 cursor-pointer
			rounded-full bg-white
			transition-transform
			duration-200 data-[state=checked]:translate-x-[18px] 
		`})}),se(yr,Tr)},$$slots:{default:!0}})}),Tt(dr);var Zt=Gt(dr,2),Ot=Gt(Rt(Zt));mo(Ot,()=>cv,(Yt,Ar)=>{Ar(Yt,{get checked(){return T(D)},onCheckedChange:ne,class:`
		relative inline-flex h-[22px]
		w-[40px] cursor-pointer
		items-center rounded-full
		bg-gray-300 px-[2px]
		transition-colors  data-[state=checked]:bg-[#ff66aa]
	`,children:(yr,kr)=>{var Tr=_t(),Dr=lt(Tr);mo(Dr,()=>hv,(hi,ni)=>{ni(hi,{class:`
			block
			h-[18px] w-[18px]
			translate-x-0 cursor-pointer
			rounded-full bg-white
			transition-transform
			duration-200 data-[state=checked]:translate-x-[18px]
		`})}),se(yr,Tr)},$$slots:{default:!0}})}),Tt(Zt),Tt(Ve),Tt(Me),ha(Me,Yt=>Pt(h,Yt),()=>T(h)),$r(()=>{pr(q,"min",t.minYear-1),pr(q,"max",i().yearEnd),pr(me,"min",i().yearStart),pr(me,"max",t.maxYear+1),ye=Bi($e,"",ye,{opacity:T(w)?"100%":"50%","pointer-events":T(w)?"auto":"none"}),Bi(ge,T(A)=="All"?"background: #336; color: #eef;":""),Bi(Ye,T(A)==1?"background: #336; color: #eef":""),Bi(We,T(A)==2?"background: #336; color: #eef":""),Bi(ot,T(A)==3?"background: #336; color: #eef":""),Bi(Se,T(A)==4?"background: #336; color: #eef":""),Bi(Ce,T(A)==5?"background: #336; color: #eef":""),Ys(It,1,`
		flex cursor-pointer items-center justify-start gap-2 rounded-md px-2 py-1
		pl-5 transition
		${T(w)?"text-[#333366] hover:bg-gray-100":"cursor-not-allowed text-gray-300 opacity-80"}
	`),Ys(Xt,1,`
			flex items-center gap-2
			${T(w)?"cursor-pointer":"pointer-events-none cursor-not-allowed"}
		`),gT(Jt,T(z)),Jt.disabled=!T(w),Ys(Jt,1,`
								h-4 w-4 rounded border-gray-300 text-[#fff]
								${T(w)?"cursor-pointer":"opacity-80"}
								accent-[#f4a]
							`)}),$m(q,()=>T(Q),Yt=>Pt(Q,Yt)),$m(me,()=>T(N),Yt=>Pt(N,Yt)),Vn(3,Me,()=>$5,()=>({duration:250,y:10})),se(le,Me)};Qe(Pe,le=>{T(a)&&le($)})}Tt(re),se(e,re),Hr()}_s(["pointerdown","keydown","change","input","click"]);_s(["pointerdown","pointermove","pointerup","change"]);var zX=zr('<img alt="" class="block h-full w-auto object-cover"/>'),FX=zr('<div class="pointer-events-none absolute rounded-[4px] border-[4px] border-[#33336666]"></div>'),DX=zr('<div class="pointer-events-none flex-shrink-0 p-4 pr-1" style="transform-style: preserve-3d; perspective: 100px"><div class="h-22 w-fit origin-[10%_100%] overflow-hidden opacity-0 shadow-md transition-all delay-300 duration-500 will-change-transform"><!> <!></div></div>'),BX=zr('<!> <span class="whitespace-nowrap">Sluiten</span> <!>',1),GX=zr('<!> <span class="whitespace-nowrap">Openen</span> <!>',1),VX=zr('<button class="mt-2 flex items-center gap-1.5 rounded-lg border-2 border-[#eeeeff22] bg-[#eeeeff11] px-3 py-1.5 text-[12px] font-[600] text-[#eef] shadow-md transition-colors hover:cursor-pointer hover:bg-[#4a4a7a]"><!></button>'),jX=zr('<div class="flex w-full flex-shrink-1 flex-col items-start justify-center gap-1 pr-4"><h1 class="line-clamp-2 max-w-50 truncate text-[16px] font-bold text-[#eef]"> </h1> <p class="text-[14px] font-[500] text-[#eeeeff]"> </p> <!></div>'),ZX=zr('<li class="rounded-[4px] px-2 py-1 odd:bg-[#eeeeff11]"><i class="font-[600] opacity-50"> </i> <span class="font-[500]"> </span></li>'),OX=zr('<img class="block h-full w-auto object-cover"/>'),NX=zr('<button tabindex="15"><div class="h-14 flex-shrink-0 overflow-hidden rounded-[2px] bg-[#eeeeff11] shadow-md"><!></div> <div class="flex flex-1 items-center text-left"><p class="px-2 text-[12px] font-[600] text-[#eef]"><!></p></div></button>'),UX=zr('<div class="px-4 pb-0"><h3 class="mb-1 text-[16px] font-[600] text-[#eef]">Bijbladen</h3> <div class="flex flex-col"></div></div>'),HX=zr("<!> XYZ tile URL gekopieerd",1),WX=zr("<!> KopiÃ«er XYZ tile URL",1),XX=zr('<a target="_blank" rel="noopener noreferrer" class="text-[#f4a] hover:underline"><!> Open in Allmaps Viewer</a> <a target="_blank" rel="noopener noreferrer" class="text-[#f4a] hover:underline"><!> Open Georeference Annotation</a> <button class="cursor-pointer text-left text-[#f4a] hover:underline"><!></button> <a target="_blank" rel="noopener noreferrer" class="text-[#f4a] hover:underline"><!> Open in geojson.io</a>',1),qX=zr('<div class="scrollable flex flex-col gap-4 overflow-x-hidden overflow-y-auto border-t border-[#eeeeff10] svelte-1q190uh"><div class="pt-2"><div class="px-4 pb-0"><ul class="text-[14px] text-[#eef]"><li class="rounded-[4px] px-2 py-1 odd:bg-[#eeeeff11]"><i class="font-[600] opacity-50">Bladtitel:</i> <span class="font-[500]"> </span></li> <!></ul></div></div> <!> <div class="px-4 pb-6"><h3 class="mb-2 text-[16px] font-[600] text-[#eef]">Externe links</h3> <div class="flex flex-col gap-2 rounded-[4px] bg-[#eeeeff11] p-2 text-[13px]"><a target="_blank" rel="noopener noreferrer" class="text-[#f4a] hover:underline"><!> Utrecht Universiteit Library</a> <a target="_blank" rel="noopener noreferrer" class="text-[#f4a] hover:underline"><!> Open in Theseus</a> <!> <a target="_blank" rel="noopener noreferrer" class="text-[#f4a] hover:underline"><!> Download PNG</a></div></div></div>'),YX=zr('<div><div class="relative z-20 flex h-30 items-stretch gap-3 bg-inherit"><!> <!></div> <!></div>');function KX(e,t){Ur(t,!0);const i="https://tu-delft-heritage.github.io/watertijdreis-data/collection.json";let a=fr(null);Yi(()=>{fetch(i).then(le=>le.json()).then(le=>Pt(a,le,!0))});async function h(le,Me){var Ee;if(!T(a))return null;const Ve=`Editie ${le}`,Be=(Ee=T(a).items.find(Ne=>{var $e,ye;return((ye=($e=Ne==null?void 0:Ne.label)==null?void 0:$e.nl)==null?void 0:ye[0])===Ve}))==null?void 0:Ee.id;return await(await fetch(Be)).json()}let d=pt(()=>t.selectedHistoricMap||t.clickedHistoricMap||t.sheetIndexVisible&&t.hoveredHistoricMap||(t.visibleHistoricMapsInViewport.size==1?t.visibleHistoricMapsInViewport.values().next().value:null)),p=null,s=null,w=fr(null),A=fr(null),z=pt(()=>T(d)&&T(w)?T(w).items.find(le=>le.id==T(d).manifestId):null),B=pt(()=>!T(z)||!T(w)?[]:T(w).structures.find(Me=>Me.items.find(Ve=>Ve.id==T(z).id)).items.map(Me=>T(w).items.find(Ve=>Ve.id==Me.id))),D=pt(()=>{if(!T(B))return null;const le=T(B).find(Me=>!V(Me).flat().includes("Type"));return le?t.historicMapsById.values().find(Me=>Me.manifestId==le.id):null});Yi(()=>{T(d)&&(T(d).edition!==p||T(d).bis!==s)&&(p=T(d).edition,s=T(d).bis,Pt(A,h(T(d).edition).then(le=>{Pt(A,null),Pt(w,le||null,!0)}),!0))});function V(le=T(z),Me="nl"){return le.metadata.map(Ve=>{const Be=Ve.label[Me]??Ve.label.en??Ve.label.none,q=Ve.value[Me]??Ve.value.en??Ve.value.none;return[Be==null?void 0:Be[0],q==null?void 0:q[0]]})}function W(le){if(!t.viewportPolygon)return;const[Me,Ve,Be,q]=le.geoFullMaskBbox,me=W8(t.viewportPolygon),[Ee,Ne,$e,ye]=me,ge=Be-Me,Ye=q-Ve,We=(Ee-Me)/ge,ot=(q-ye)/Ye,Se=($e-Me)/ge,Ce=(q-Ne)/Ye;return{leftPct:We*100,topPct:ot*100,widthPct:(Se-We)*100,heightPct:(Ce-ot)*100}}async function S(le){const Ve={["text/plain"]:le},Be=new ClipboardItem(Ve);await navigator.clipboard.write([Be]),Pt(j,!0)}let j=fr(!1);Yi(()=>{if(T(j)){const le=setTimeout(()=>{Pt(j,!1)},1e3);return()=>clearTimeout(le)}});async function ne(le){var ot,Se,Ce,It;const{id:Me,height:Ve,width:Be}=le,q=t.warpedMapLayer.getWarpedMap(T(D).id),[me,Ee,Ne,$e]=q.geoFullMaskBbox,ye={"@context":"https://schemas.allmaps.org/map/2/context.json",type:"GeoreferencedMap",id:Me,resource:{id:(It=(Ce=(Se=(ot=le.items[0])==null?void 0:ot.items[0])==null?void 0:Se.body)==null?void 0:Ce.service[0])==null?void 0:It.id,width:Be,height:Ve,type:"ImageService2",tiles:[{width:256,height:256,scaleFactors:[1,2,4,8,16,32]}]},gcps:[{resource:[0,0],geo:[me+.5,$e]},{resource:[Be,0],geo:[Ne+.5,$e]},{resource:[Be,Ve],geo:[Ne+.5,Ee]},{resource:[0,Ve],geo:[me+.5,Ee]}],resourceMask:[[0,Ve],[Be,Ve],[Be,0],[0,0]],transformation:{type:"straight"}};await t.warpedMapLayer.addGeoreferencedMap(ye);const ge=t.warpedMapLayer.getWarpedMap(Me),Ye=[ge==null?void 0:ge.geoMask.concat([ge==null?void 0:ge.geoMask[0]])],We={...T(D),id:Me,manifestId:Me,polygon:{type:"Polygon",coordinates:Ye},type:"Achterkant",geoFullMaskBbox:ge==null?void 0:ge.geoFullMaskBbox};t.historicMapsById.set(Me,We),t.changeHistoricMapView(We)}let te=fr(!1),Q=fr(null);Yi(()=>{T(d)&&T(Q)&&(T(Q).style.transform=`scale(${T(d)?100:25}%) translate(${T(d)?0:-30}px,0px) rotateX(${T(d)?0:60}deg) rotateY(${T(d),0}deg)`,T(Q).style.opacity=1)});function N(){Pt(te,!T(te))}let re=fr(!1);Yi(()=>{Pt(re,window.innerWidth<768);const le=()=>{Pt(re,window.innerWidth<768)};return window.addEventListener("resize",le),()=>window.removeEventListener("resize",le)}),Yi(()=>{t.selectedHistoricMap||Pt(te,!1)});let oe=fr(null);var ve=_t(),Pe=lt(ve);{var $=le=>{var Me=YX();let Ve;var Be=Rt(Me),q=Rt(Be);mv(q,()=>T(d).id,$e=>{var ye=DX(),ge=Rt(ye);Bi(ge,"",{},{transform:"translate(-30px,0px) rotateX(60deg) scale(25%)"});var Ye=Rt(ge);{var We=It=>{const Lt=pt(()=>{var dr,zt,Zt,Ot,Yt,Ar,yr,kr,Tr,Dr,hi,ni;return((yr=(Ar=(Yt=(Ot=(Zt=(zt=(dr=T(z).items)==null?void 0:dr[0])==null?void 0:zt.items)==null?void 0:Zt[0])==null?void 0:Ot.body)==null?void 0:Yt.service)==null?void 0:Ar[0])==null?void 0:yr.id)||((ni=(hi=(Dr=(Tr=(kr=T(z).items)==null?void 0:kr[0])==null?void 0:Tr.items)==null?void 0:Dr[0])==null?void 0:hi.body)==null?void 0:ni.id)}),Xt=pt(()=>T(Lt)?`${T(Lt)}/full/,256/0/default.jpg`:"");var Jt=zX();$r(()=>pr(Jt,"src",T(Xt))),se(It,Jt)},ot=It=>{oy(It,{get id(){return T(d).id},height:88})};Qe(Ye,It=>{T(z)&&V(T(z)).flat().includes("Achterkant")?It(We):It(ot,!1)})}var Se=Gt(Ye,2);{var Ce=It=>{const Lt=pt(()=>{const{leftPct:Jt,topPct:dr,widthPct:zt,heightPct:Zt}=W(T(d));return{leftPct:Jt,topPct:dr,widthPct:zt,heightPct:Zt}});var Xt=FX();$r(()=>Bi(Xt,`left: ${T(Lt).leftPct??""}%; top: ${T(Lt).topPct??""}%; width: ${T(Lt).widthPct??""}%; height: ${T(Lt).heightPct??""}%;`)),se(It,Xt)};Qe(Se,It=>{T(d)&&t.viewportPolygon&&It(Ce)})}Tt(ge),ha(ge,It=>Pt(Q,It),()=>T(Q)),Tt(ye),se($e,ye)});var me=Gt(q,2);mv(me,()=>T(d).id,$e=>{var ye=jX(),ge=Rt(ye),Ye=Rt(ge,!0);Tt(ge);var We=Gt(ge,2),ot=Rt(We);Tt(We);var Se=Gt(We,2);{var Ce=It=>{var Lt=VX();Lt.__click=N,Lt.__keydown=zt=>{(zt.key==="Enter"||zt.key===" ")&&(zt.preventDefault(),N())};var Xt=Rt(Lt);{var Jt=zt=>{var Zt=BX(),Ot=lt(Zt);sy(Ot,{class:"inline",size:"18"});var Yt=Gt(Ot,4);TO(Yt,{color:"#eef",size:18,weight:"bold"}),se(zt,Zt)},dr=zt=>{var Zt=GX(),Ot=lt(Zt);sy(Ot,{class:"inline",size:"18"});var Yt=Gt(Ot,4);zO(Yt,{color:"#eef",size:18}),se(zt,Zt)};Qe(Xt,zt=>{T(te)?zt(Jt):zt(dr,!1)})}Tt(Lt),Vn(3,Lt,()=>zg,()=>({duration:300})),se(It,Lt)};Qe(Se,It=>{t.selectedHistoricMap&&It(Ce)})}Tt(ye),$r(()=>{var It,Lt,Xt;xn(Ye,T(D)?T(D).label:T(d)?T(d).label:"..."),xn(ot,`${((It=T(d))==null?void 0:It.yearEnd)??""} Â· Editie ${((Lt=T(d))==null?void 0:Lt.edition)??""}${(Xt=T(d))!=null&&Xt.bis?" BIS":""}`)}),Vn(5,ye,()=>Ao,()=>({x:-20})),se($e,ye)}),Tt(Be);var Ee=Gt(Be,2);{var Ne=$e=>{const ye=pt(()=>V(T(z))),ge=pt(()=>"https://tu-delft-heritage.github.io/watertijdreis-data/collection.json"),Ye=pt(()=>T(w).id),We=pt(()=>T(z).id),ot=pt(()=>{var Pr;return(Pr=T(We).match(/\/p(\d*)$/))==null?void 0:Pr[1]}),Se=pt(()=>{var Pr,xi,Fi,ct;return(ct=(Fi=(xi=(Pr=T(z).items[0])==null?void 0:Pr.items[0])==null?void 0:xi.body)==null?void 0:Fi.service[0])==null?void 0:ct.id}),Ce=pt(()=>T(w).rendering[0].id);var It=qX(),Lt=Rt(It),Xt=Rt(Lt),Jt=Rt(Xt),dr=Rt(Jt),zt=Gt(Rt(dr),2),Zt=Rt(zt,!0);Tt(zt),Tt(dr);var Ot=Gt(dr,2);Mo(Ot,17,()=>T(ye),ml,(Pr,xi)=>{var Fi=pt(()=>nT(T(xi),2));let ct=()=>T(Fi)[0],be=()=>T(Fi)[1];var we=ZX(),Te=Rt(we),Ge=Rt(Te);Tt(Te);var He=Gt(Te,2),nt=Rt(He,!0);Tt(He),Tt(we),$r(()=>{xn(Ge,`${ct()??""}:`),xn(nt,be())}),se(Pr,we)}),Tt(Jt),Tt(Xt),Tt(Lt);var Yt=Gt(Lt,2);{var Ar=Pr=>{var xi=UX(),Fi=Gt(Rt(xi),2);Mo(Fi,21,()=>T(B),ml,(ct,be,we,Te)=>{const Ge=pt(()=>V(T(be))),He=pt(()=>{var st;return((st=T(Ge).find(qe=>qe[0]==="Type"))==null?void 0:st[1].replace("Achterkant","Hoofdblad (achterkant)").replace("Watervoorzieningseenheden","Watervoorzienings-<br>eenheden"))||"Hoofdblad (voorkant)"}),nt=pt(()=>t.historicMapsById.values().find(st=>st.manifestId==T(be).id)),yt=pt(()=>{var st,qe,Ct,wt,jt,ie,k,C,M,P,O,xe;return((k=(ie=(jt=(wt=(Ct=(qe=(st=T(be).items)==null?void 0:st[0])==null?void 0:qe.items)==null?void 0:Ct[0])==null?void 0:wt.body)==null?void 0:jt.service)==null?void 0:ie[0])==null?void 0:k.id)||((xe=(O=(P=(M=(C=T(be).items)==null?void 0:C[0])==null?void 0:M.items)==null?void 0:P[0])==null?void 0:O.body)==null?void 0:xe.id)}),ut=pt(()=>T(yt)?`${T(yt)}/full/,256/0/default.jpg`:""),St=pt(()=>T(z).id===T(be).id);var Vt=_t(),Ft=lt(Vt);{var sr=st=>{var qe=NX();qe.__click=()=>{T(nt)?t.changeHistoricMapView(T(nt)):ne(T(be)),T(oe)&&(T(oe).scrollTop=0)},qe.__keydown=P=>{if(P.key==="Enter"||P.key===" "){P.preventDefault();const O=t.historicMapsById.values().find(xe=>xe.manifestId==T(be).id);O?t.changeHistoricMapView(O):ne(T(be))}};var Ct=Rt(qe),wt=Rt(Ct);{var jt=P=>{oy(P,{get id(){return T(nt).id},height:56})},ie=P=>{var O=OX();$r(()=>{pr(O,"src",T(ut)),pr(O,"alt",T(He))}),se(P,O)};Qe(wt,P=>{T(He).toLowerCase().includes("achterkant")?P(ie,!1):P(jt)})}Tt(Ct);var k=Gt(Ct,2),C=Rt(k),M=Rt(C);k8(M,()=>T(He)),Tt(C),Tt(k),Tt(qe),$r(()=>Ys(qe,1,`flex cursor-pointer items-center gap-1 rounded-[4px] p-1.5 transition-colors hover:bg-[#eeeeff11] ${T(St)?"text-color-[#f4a] rounded-[6px] bg-[#eeeeff30]":""}`)),se(st,qe)};Qe(Ft,st=>{T(ut)&&st(sr)})}se(ct,Vt)}),Tt(Fi),Tt(xi),se(Pr,xi)};Qe(Yt,Pr=>{T(B)&&T(B).length>1&&Pr(Ar)})}var yr=Gt(Yt,2),kr=Gt(Rt(yr),2),Tr=Rt(kr),Dr=Rt(Tr);bu(Dr,{size:"15",color:"#f4a",class:"relative inline"}),qr(),Tt(Tr);var hi=Gt(Tr,2),ni=Rt(hi);bu(ni,{size:"15",color:"#f4a",class:"relative inline"}),qr(),Tt(hi);var ui=Gt(hi,2);{var dn=Pr=>{const xi=pt(()=>T(z).annotations[0].id);var Fi=XX(),ct=lt(Fi),be=Rt(ct);bu(be,{size:"15",color:"#f4a",class:"relative inline"}),qr(),Tt(ct);var we=Gt(ct,2),Te=Rt(we);bu(Te,{size:"15",color:"#f4a",class:"relative inline"}),qr(),Tt(we);var Ge=Gt(we,2);Ge.__click=()=>S(`https://allmaps.xyz/{z}/{x}/{y}.png?url=${T(xi)}&transformation.type=thin-plate-spline`);var He=Rt(Ge);{var nt=Vt=>{var Ft=HX(),sr=lt(Ft);Y5(sr,{size:"15",color:"#f4a",class:"relative inline"}),qr(),se(Vt,Ft)},yt=Vt=>{var Ft=WX(),sr=lt(Ft);iN(sr,{size:"15",color:"#f4a",class:"relative inline"}),qr(),se(Vt,Ft)};Qe(He,Vt=>{T(j)?Vt(nt):Vt(yt,!1)})}Tt(Ge);var ut=Gt(Ge,2),St=Rt(ut);bu(St,{size:"15",color:"#f4a",class:"relative inline"}),qr(),Tt(ut),$r(()=>{pr(ct,"href",`https://viewer.allmaps.org/?url=${T(xi)??""}`),pr(we,"href",T(xi)),pr(ut,"href",`https://geojson.io/#data=data:text/x-url,${T(xi)}.geojson`)}),se(Pr,Fi)};Qe(ui,Pr=>{T(z).annotations&&Pr(dn)})}var Xi=Gt(ui,2),fn=Rt(Xi);bu(fn,{size:"15",color:"#f4a",class:"relative inline"}),qr(),Tt(Xi),Tt(kr),Tt(yr),Tt(It),ha(It,Pr=>Pt(oe,Pr),()=>T(oe)),$r(()=>{Bi(It,`max-height: calc(${T(re)?"50vh":"60vh"} - 120px);`),xn(Zt,T(d).label),pr(Tr,"href",`${T(Ce)}?page=${T(ot)}`),pr(hi,"href",`https://theseus-viewer.netlify.app/embed?iiif-content=${T(Ye)}&canvas=${T(We)}&collection=${T(ge)}&panel=navPlace`),pr(Xi,"href",`${T(Se)}/full/max/0/default.png`)}),Vn(3,It,()=>zg,()=>({duration:300})),se($e,It)};Qe(Ee,$e=>{T(te)&&$e(Ne)})}Tt(Me),$r(()=>{Ys(Me,1,`
			fixed right-2 bottom-2 left-2 z-[1000] overflow-hidden rounded-[8px] bg-gradient-to-r from-[#336]
			from-[270px] to-[#336] shadow-lg transition-[width] duration-300 sm:top-auto sm:to-transparent sm:to-[calc(50%-30px)]
			${T(te)||t.selectedHistoricMap?"bg-[#336]":""}
			${T(te)||t.selectedHistoricMap?"w-auto sm:w-87":"w-auto sm:w-[calc(100vh-16px)]"}
		`),Ve=Bi(Me,"",Ve,{"background-color":t.selectedHistoricMap?"#336":"","max-height":T(te)?T(re)?"50vh":"60vh":"120px","pointer-events":t.selectedHistoricMap?"auto":"none"})}),Vn(3,Me,()=>c1,()=>({duration:500})),se(le,Me)};Qe(Pe,le=>{T(d)&&le($)})}se(e,ve),Hr()}_s(["click","keydown"]);var $X=zr(`<div class="
			border-2 border-[#33336611] bg-[#3333aa22] font-[500] text-[14px]
			shadow-[0_2px_2px_rgba(0,0,0,0.05)] backdrop-blur-md
			px-4 py-2 fixed bottom-42 left-1/2 -translate-x-1/2 text-center text-[#336] rounded-[8px] z-999 shadow-lg"><!></div>`);function nM(e,t){Ur(t,!0);let i=pi(t,"content",3,"");const a=2500;let h=fr(!1),d;Yi(()=>{i()&&(clearTimeout(d),Pt(h,!0),d=setTimeout(()=>Pt(h,!1),a))});var p=_t(),s=lt(p);{var w=A=>{var z=$X(),B=Rt(z);k8(B,i),Tt(z),Vn(3,z,()=>Ao,()=>({y:20,duration:250})),se(A,z)};Qe(s,A=>{T(h)&&A(w)})}se(e,p),Hr()}var JX=zr('<div class="h-full w-full"><!></div>'),QX=zr('<div class="absolute h-8 w-10 origin-bottom shadow-[0_6px_6px_rgba(0,0,0,0.1)]"><!></div>'),eq=zr('<div class="absolute"></div>');function tq(e,t){Ur(t,!0);const i=40,a=2,h=pt(()=>`
        transform: 
            translateX(${t.x-i/2}px) 
            translateY(75px)
            rotateX(60deg);
        transform-style: preserve-3d;
    `);function d(s){const w=s.split("").reduce((V,W)=>V+W.charCodeAt(0),0),A=w%20-10,z=44,B=46+w%20,D=70+w%20;return{rotation:A,color:`hsl(${z}deg, ${B}%, ${D}%)`}}var p=eq();Mo(p,23,()=>t.maps,s=>s.id,(s,w,A)=>{const z=pt(()=>t.mapsInViewport.has(T(w).id)),B=pt(()=>d(T(w).id)),D=pt(()=>t.selectedYear+.5>T(w).yearEnd&&T(z));var V=QX();let W;var S=Rt(V);{var j=ne=>{var te=JX(),Q=Rt(te);oy(Q,{get id(){return T(w).id},height:32}),Tt(te),Vn(3,te,()=>$5,()=>({duration:200})),se(ne,te)};Qe(S,ne=>{T(D)&&ne(j)})}Tt(V),$r(()=>W=Bi(V,`
                transform: 
                    translateZ(${T(A)*a}px)
                    rotateZ(${T(B).rotation??""}deg);
                transition: opacity 0.5s;
            `,W,{"background-color":T(z)?T(B).color:"transparent",border:T(z)?"":"1px solid #eeeeff44"})),se(s,V)}),Tt(p),$r(()=>Bi(p,T(h))),se(e,p),Hr()}var rq=zr('<div class="absolute inset-0 z-2000 flex flex-col items-center justify-center bg-linear-to-b from-transparent to-[#336] svelte-jz8gxy"><div class="hand-animation svelte-jz8gxy"><!></div> <p class="mt-4 text-[14px] font-[600] text-[#eef] text-shadow-[1px_1px_0_#000] svelte-jz8gxy">Sleep de tijdlijn om door de tijd te reizen</p></div>'),iq=ht('<line stroke="#eef" stroke-dasharray="4 2" class="svelte-jz8gxy"></line>'),nq=ht('<path stroke="#eeeeff88" stroke-width="1.5" class="svelte-jz8gxy"></path>'),sq=ht('<path stroke="#eeeeff88" stroke-width="1.5" class="svelte-jz8gxy"></path>'),aq=ht('<text font-family="ivypresto-display" font-size="12" font-weight="700" style="cursor: pointer; pointer-events: auto;" class="svelte-jz8gxy"> </text>'),oq=ht('<text font-family="ivypresto-display" font-size="12" style="cursor: pointer; pointer-events: auto;" class="svelte-jz8gxy"> </text>'),lq=ht('<text font-family="ivypresto-display" font-size="12" style="cursor: pointer; pointer-events: auto;" class="svelte-jz8gxy"> </text>'),cq=ht('<g filter="url(#hardShadow)" class="svelte-jz8gxy"><line stroke="#eeeeff88" stroke-width="1" opacity="0.4" class="svelte-jz8gxy"></line><line stroke="#eeeeff88" stroke-width="1" opacity="0.4" class="svelte-jz8gxy"></line><line stroke="#eeeeff88" stroke-width="1" opacity="0.4" class="svelte-jz8gxy"></line><text font-size="12" font-weight="600" fill="#eeeeff88" text-anchor="middle" style="text-shadow: black; pointer-events: none; " class="svelte-jz8gxy"> </text><line stroke="#eeeeff88" stroke-width="1" opacity="0.4" class="svelte-jz8gxy"></line></g>'),hq=zr('<div class="fixed right-2 bottom-2 left-2 z-999 h-30 w-auto cursor-pointer touch-none select-none svelte-jz8gxy"><!> <!> <div class="absolute h-full w-full overflow-hidden rounded-[8px] bg-[#336] bg-size-[32px] svelte-jz8gxy"><div class="absolute inset-0 bg-[url(/wave_pattern8.png)] bg-size-[auto_11px] svelte-jz8gxy"></div> <div class="absolute top-0 left-1/2 z-998 h-full w-1/2 bg-black/33 backdrop-blur-xs svelte-jz8gxy"></div> <div class="pointer-events-none absolute top-0 left-0 z-1000 h-full w-1/6 bg-gradient-to-r from-[#225] to-transparent svelte-jz8gxy"></div> <div class="pointer-events-none absolute top-0 right-0 z-1000 h-full w-1/6 bg-gradient-to-l from-[#225] to-transparent svelte-jz8gxy"></div> <div class="absolute inset-0 z-1 h-[200px] w-full svelte-jz8gxy" style="perspective: 1000px; transform-style: preserve-3d;"></div> <svg class="pointer-events-none absolute inset-0 z-999 h-full w-full cursor-grab svelte-jz8gxy"><defs class="svelte-jz8gxy"><filter id="hardShadow" x="-50%" y="-50%" width="200%" height="200%" class="svelte-jz8gxy"><feDropShadow dx="1" dy="1" stdDeviation="1" flood-color="#000" flood-opacity="1" class="svelte-jz8gxy"></feDropShadow></filter></defs><!><rect x="0" y="0" fill="transparent" style="cursor: pointer; pointer-events: auto;" class="svelte-jz8gxy"></rect><!><!><path stroke="#eeeeff88" stroke-width="1.5" class="svelte-jz8gxy"></path><!><!></svg></div> <!></div>');function uq(e,t){Ur(t,!0);let i=pi(t,"filter",15),a=fr(0),h=fr(120),d=fr(50),p=fr(0),s=fr(0),w=fr(.6),A=null,z=null,B=new Map,D=-1,V=0,W=0,S=0,j=!1;const ne=4,te=5,Q=200,N=1600,re=2300,oe="#eef";let ve=new cy({start:i().yearEnd-10,end:i().yearEnd+10},{stiffness:.1,damping:.5});Yi(()=>{if(T(a)>0&&T(d)>0){const zt=T(a)/2/T(d),Zt=i().yearEnd-zt,Ot=i().yearEnd+zt,Yt=Math.max(Zt,N),Ar=Math.min(Ot,re);ve.set({start:Yt,end:Ar})}});function Pe(zt){return(zt-ve.current.start)/(ve.current.end-ve.current.start)*T(a)}let $=pt(()=>Math.floor(ve.current.start)),le=pt(()=>Math.ceil(ve.current.end));function Me(){const zt=Array.from(B.values());if(zt.length!==2)return-1;const Zt=Math.abs(zt[0].clientX-zt[1].clientX),Ot=Math.abs(zt[0].clientY-zt[1].clientY);return Math.hypot(Zt,Ot)}let Ve=null,Be=null;function q(zt){zt.preventDefault(),B.set(zt.pointerId,zt),B.size===1?(V=zt.clientX,W=zt.clientX,S=zt.clientY,j=!1):B.size===2&&(D=Me()),Ve=setInterval(()=>{Be&&Be()},1e3/ne),t.setLabelVisibility(!0),T(It)&&Lt()}function me(zt){if(B.has(zt.pointerId)){if(zt.preventDefault(),B.set(zt.pointerId,zt),B.size===2){const Zt=Me();if(D>0&&Zt>0){const Ot=Zt/D;let Yt=T(d)*Ot;Yt=Math.max(te,Math.min(Q,Yt)),Pt(d,Yt,!0)}D=Zt}else if(B.size===1){const Zt=V-zt.clientX,Ot=S-zt.clientY;(Math.abs(zt.clientX-W)>5||Math.abs(Ot)>5)&&(j=!0,t.setLabelVisibility(!0));const Yt=ve.current.end-ve.current.start,Ar=Zt/T(a)*Yt,yr=Math.min(Math.max(i().yearEnd+Ar,T(ot)-1),T(Se)+1);Math.floor(yr)-i().yearEnd&&(Be=t.applyFilter.bind(this,i())),i(i().yearEnd=yr,!0),Pt(p,T(p)+Zt*-.5),Pt(s,Zt*-.2),Pt(w,.9),z&&clearTimeout(z),V=zt.clientX}}}function Ee(zt){if(B.size!==0){if(B.delete(zt.pointerId),B.size<2&&(D=-1),B.size===1){const Zt=B.values().next().value;Zt&&(V=Zt.clientX)}if(B.size===0){const Zt=Math.round(i().yearEnd);Math.floor(Zt)-i().yearEnd&&(Be=t.applyFilter.bind(this,i())),i(i().yearEnd=Zt,!0),Be&&Be(),Ve&&clearInterval(Ve),A&&clearTimeout(A);let Ot=0;const Yt=1e3,Ar=T(s),yr=()=>{Ot+=16;const ni=Math.min(Ot/Yt,1),ui=1-(1-ni)*(1-ni);Pt(s,Ar*(1-ui)),Pt(p,T(p)+T(s)),ni<1?A=setTimeout(yr,16):(Pt(s,0),A=null)};yr(),z&&clearTimeout(z);let kr=0;const Tr=400,Dr=T(w),hi=()=>{kr+=16;const ni=Math.min(kr/Tr,1);Pt(w,Dr+(.3-Dr)*ni),ni<1?z=setTimeout(hi,16):(Pt(w,.3),z=null)};hi()}t.setLabelVisibility(!1)}}function Ne(zt){zt.preventDefault();const Zt=1+Math.min(Math.max(zt.deltaY/100,-.08),.08);let Ot=T(d)/Zt;Ot=Math.max(te,Math.min(Q,Ot)),Pt(d,Ot,!0)}let $e=pt(()=>{let zt="",Zt="",Ot="";const yr=10-5*Math.max(0,(9-T(d))/2),kr=5;for(let Tr=T($);Tr<=T(le);Tr++){const Dr=Pe(Tr);Tr%25===0?zt+=`M${Dr},0 L${Dr},10 `:Tr%5===0&&T(d)>7?Zt+=`M${Dr},0 L${Dr},${yr} `:T(d)>3&&(Ot+=`M${Dr},0 L${Dr},${kr} `)}return{major:zt,medium:Zt,minor:Ot}}),ye=pt(()=>t.historicMapsById.values().filter(zt=>i().edition==="All"||i().edition===zt.edition).filter(zt=>i().bis||!zt.bis).filter(zt=>i().type==zt.type).toArray()),ge=pt(()=>{var Zt;if(!t.historicMapsLoaded)return{};const zt={};for(const Ot of T(ye))(zt[Zt=Ot.yearEnd]??(zt[Zt]=[])).push(Ot);return zt}),Ye=pt(()=>{if(!t.historicMapsLoaded)return;const zt=new Map;for(const Zt of T(ye)){const Ot=`${Zt.edition}-${Zt.bis}`;let Yt=zt.get(Ot);Yt?(Yt.yearStart=Math.min(Zt.yearEnd,Yt.yearStart),Yt.yearEnd=Math.max(Zt.yearEnd,Yt.yearEnd)):(Yt={name:`Editie ${Zt.edition}`+(Zt.bis?" (bis)":""),edition:Zt.edition,bis:Zt.bis,yearStart:Zt.yearEnd,yearEnd:Zt.yearEnd},zt.set(Ot,Yt))}return Array.from(zt.values())}),We=pt(()=>[...Object.keys(T(ge))].map(zt=>+zt).sort((zt,Zt)=>zt-Zt)),ot=pt(()=>T(We)?Math.min(...T(We)):i().yearEnd),Se=pt(()=>T(We)?Math.max(...T(We)):i().yearEnd);const Ce="timeline_hint_shown";let It=fr(!1);function Lt(){Pt(It,!1),localStorage.setItem(Ce,"true")}pv(()=>{typeof window<"u"&&!localStorage.getItem(Ce)&&(Pt(It,!0),setTimeout(Lt,8e3))});var Xt=_t();Tn("pointermove",pl,me),Tn("pointerup",pl,Ee),Tn("pointercancel",pl,Ee);var Jt=lt(Xt);{var dr=zt=>{var Zt=hq(),Ot=Rt(Zt);{var Yt=Te=>{var Ge=rq();Ge.__mousedown=Lt;var He=Rt(Ge),nt=Rt(He);KN(nt,{size:25,color:"#fff",class:"drop-shadow-[1px_1px_0_#333366]"}),Tt(He),qr(2),Tt(Ge),Tn("pointerenter",Ge,Lt),Tn("wheel",Ge,Lt),Vn(3,Ge,()=>c1,()=>({duration:500})),se(Te,Ge)};Qe(Ot,Te=>{T(It)&&Te(Yt)})}var Ar=Gt(Ot,2);{let Te=pt(()=>Math.ceil((ve.current.start+ve.current.end)/2));VW(Ar,{get year(){return T(Te)}})}var yr=Gt(Ar,2);yr.__pointerdown=q;var kr=Rt(yr),Tr=Gt(kr,8);Mo(Tr,21,()=>T(We),ml,(Te,Ge)=>{var He=_t(),nt=lt(He);{var yt=ut=>{const St=pt(()=>Pe(T(Ge)));tq(ut,{get x(){return T(St)},get maps(){return T(ge)[T(Ge)]},get pixelsPerYear(){return T(d)},get mapsInViewport(){return t.mapsInViewport},get getHistoricMapThumbnail(){return t.getHistoricMapThumbnail},get hoveredHistoricMap(){return t.hoveredHistoricMap},get selectedYear(){return i().yearEnd}})};Qe(nt,ut=>{T(Ge)>=T($)&&T(Ge)<=T(le)&&ut(yt)})}se(Te,He)}),Tt(Tr);var Dr=Gt(Tr,2),hi=Gt(Rt(Dr));{var ni=Te=>{const Ge=pt(()=>Pe(i().yearStart));var He=iq();pr(He,"y1",0),pr(He,"stroke-width",2),$r(()=>{pr(He,"x1",T(Ge)),pr(He,"x2",T(Ge)),pr(He,"y2",T(h))}),se(Te,He)};Qe(hi,Te=>{i().yearStart>T(ot)&&Te(ni)})}var ui=Gt(hi);ui.__click=Te=>{if(j)return;const Ge=Te.currentTarget.getBoundingClientRect(),He=Te.clientX-Ge.left,nt=ve.current.start+He/T(a)*(ve.current.end-ve.current.start),yt=Math.round(nt);yt>=T(ot)&&yt<=T(Se)&&i(i().yearEnd=yt,!0)};var dn=Gt(ui);{var Xi=Te=>{var Ge=nq();$r(()=>{pr(Ge,"d",T($e).minor),pr(Ge,"opacity",1-(5-T(d))/2)}),se(Te,Ge)};Qe(dn,Te=>{T(d)>3&&Te(Xi)})}var fn=Gt(dn);{var Pr=Te=>{var Ge=sq();$r(()=>{pr(Ge,"d",T($e).medium),pr(Ge,"opacity",1-(9-T(d))/2)}),se(Te,Ge)};Qe(fn,Te=>{T(d)>7&&Te(Pr)})}var xi=Gt(fn),Fi=Gt(xi);Mo(Fi,17,()=>({length:T(le)-T($)+1}),ml,(Te,Ge,He)=>{const nt=pt(()=>T($)+He),yt=pt(()=>Pe(T(nt)));var ut=_t(),St=lt(ut);{var Vt=sr=>{var st=aq();pr(st,"fill",oe),st.__click=()=>{T(nt)>=T(ot)&&T(nt)<=T(Se)&&i(i().yearEnd=T(nt),!0)};var qe=Rt(st,!0);Tt(st),$r(()=>{pr(st,"x",T(yt)-12),pr(st,"y",22),xn(qe,T(nt))}),se(sr,st)},Ft=sr=>{var st=_t(),qe=lt(st);{var Ct=jt=>{var ie=oq();pr(ie,"fill",oe),ie.__click=()=>{T(nt)>=T(ot)&&T(nt)<=T(Se)&&i(i().yearEnd=T(nt),!0)};var k=Rt(ie,!0);Tt(ie),$r(()=>{pr(ie,"x",T(yt)-12),pr(ie,"y",22),pr(ie,"opacity",1-(9-T(d))/2),xn(k,T(nt))}),se(jt,ie)},wt=jt=>{var ie=_t(),k=lt(ie);{var C=M=>{var P=lq();pr(P,"fill",oe),P.__click=()=>{T(nt)>=T(ot)&&T(nt)<=T(Se)&&i(i().yearEnd=T(nt),!0)};var O=Rt(P,!0);Tt(P),$r(()=>{pr(P,"x",T(yt)-12),pr(P,"y",22),pr(P,"opacity",1-(38-T(d))/3),xn(O,T(nt))}),se(M,P)};Qe(k,M=>{T(d)>35&&M(C)},!0)}se(jt,ie)};Qe(qe,jt=>{T(nt)%5===0&&T(d)>7?jt(Ct):jt(wt,!1)},!0)}se(sr,st)};Qe(St,sr=>{T(nt)%25===0?sr(Vt):sr(Ft,!1)})}se(Te,ut)});var ct=Gt(Fi);{var be=Te=>{var Ge=_t(),He=lt(Ge);Mo(He,17,()=>T(Ye),ml,(nt,yt,ut,St)=>{const Vt=pt(()=>ut%2==0?110:108),Ft=pt(()=>Pe(T(yt).yearStart)),sr=pt(()=>Pe((T(yt).yearStart+T(yt).yearEnd)/2)),st=pt(()=>Pe(T(yt).yearEnd));var qe=cq(),Ct=Rt(qe),wt=Gt(Ct),jt=Gt(wt),ie=Gt(jt),k=Rt(ie,!0);Tt(ie);var C=Gt(ie);Tt(qe),$r(()=>{pr(Ct,"x1",T(Ft)),pr(Ct,"y1",T(Vt)),pr(Ct,"x2",T(Ft)),pr(Ct,"y2",T(Vt)-5),pr(wt,"x1",T(Ft)),pr(wt,"y1",T(Vt)),pr(wt,"x2",T(sr)-25),pr(wt,"y2",T(Vt)),pr(jt,"x1",T(sr)+25),pr(jt,"y1",T(Vt)),pr(jt,"x2",T(st)),pr(jt,"y2",T(Vt)),pr(ie,"x",T(sr)),pr(ie,"y",T(Vt)+4),xn(k,T(yt).name),pr(C,"x1",T(st)),pr(C,"y1",T(Vt)),pr(C,"x2",T(st)),pr(C,"y2",T(Vt)-5)}),se(nt,qe)}),se(Te,Ge)};Qe(ct,Te=>{T(Ye)&&Te(be)})}Tt(Dr),Tt(yr);var we=Gt(yr,2);LX(we,{get applyFilter(){return t.applyFilter},get minYear(){return T(ot)},get maxYear(){return T(Se)},get filter(){return i()},set filter(Te){i(Te)}}),Tt(Zt),$r(()=>{Bi(kr,`background-position: ${T(p)??""}px 0; opacity: ${T(w)??""}; pointer-events: none;`),pr(ui,"width",T(a)),pr(ui,"height",T(h)),pr(xi,"d",T($e).major)}),Tn("wheel",yr,Ne),Jm(yr,"clientWidth",Te=>Pt(a,Te)),Jm(yr,"clientHeight",Te=>Pt(h,Te)),se(zt,Zt)};Qe(Jt,zt=>{t.visible&&zt(dr)})}se(e,Xt),Hr()}_s(["mousedown","pointerdown","click"]);var dq=zr('<span class="truncate"> </span> <span role="button" tabindex="0" class="cursor-pointer"><!></span>',1),fq=zr('<span class="truncate"> </span> <span role="button" tabindex="0" class="cursor-pointer"><!></span>',1),pq=zr(`<kbd class="
					ml-1 flex inline items-center rounded-[4px] border border-[#eef] bg-white
					px-1 font-sans text-[12px] text-[#cce]
					shadow-[0px_2px_0px_0px_#cce] select-none
					"><span>Spatie</span></kbd>`),mq=zr('<span class="truncate"> </span> <!>',1),gq=zr(`<div class="
        group fixed top-21 left-2 z-1000 my-3 flex flex-shrink-0 cursor-pointer items-center justify-center
        rounded-[9px] border-2 border-[#33336611] bg-[#33336611] font-[500]
        text-[#336] shadow-[0_2px_2px_rgba(0,0,0,0.05)]
        backdrop-blur-md duration-500
        sm:top-24 sm:left-5
    "><span class="absolute left-0 h-full w-1/2 rounded-[8px] bg-white shadow-md transition-[left,width] duration-300 ease-out"></span> <button class="z-2 flex cursor-pointer items-center gap-1 rounded-[7px] px-3 py-1.5 transition-[background] duration-300" tabindex="3"><!> Kaart</button> <button class="z-2 flex max-w-50 cursor-pointer items-center gap-1 rounded-[7px] px-3 py-1.5 transition-[background] duration-300" tabindex="4"><!> <!></button></div> <!>`,1);function _q(e,t){Ur(t,!0);let i=pi(t,"pinnedHistoricMap",15),a=fr(!1),h=fr(86),d=fr(0),p=fr(null);function s(){Pt(a,!1),i()&&t.selectedHistoricMap&&i().id==t.selectedHistoricMap.id&&Pt(p,t.saveMapView(!1),!0),t.restoreView(),t.setSheetIndexVisibility(!1)}function w(){Pt(a,!0),t.clickedHistoricMap&&!t.selectedHistoricMap?(t.extendClickedMapTimeout(),t.setHistoricMapView(t.clickedHistoricMap)):i()&&!t.selectedHistoricMap?(t.extendClickedMapTimeout(),t.setHistoricMapView(i(),T(p))):t.setSheetIndexVisibility()||s()}Yi(()=>{t.selectedHistoricMap?Pt(a,!0):Pt(a,!1)});let A="",z=fr(!1),B=fr(!0);setTimeout(()=>{Pt(B,!1)},2e3);function D($,le){const Me=zg($,le),Ve=c1($,le);return{duration:Math.max(Me.duration,Ve.duration),delay:Math.min(Me.delay,Ve.delay),css:Be=>`
				${Me.css?Me.css(Be)+";":""}
				${Ve.css?Ve.css(Be)+";":""}
			`}}var V=gq();Tn("keydown",Km,$=>{$.key==" "&&!T(z)&&(Pt(z,!0),w()),$.key=="Escape"&&s()}),Tn("keyup",Km,$=>{$.key==" "&&Pt(z,!1)});var W=lt(V),S=Rt(W);let j;var ne=Gt(S,2);ne.__click=s;var te=Rt(ne);{let $=pt(()=>T(a)?"#336":"#f4a");ay(te,{size:"18",get color(){return T($)},class:"shrink-0 transition-[fill] duration-500"})}qr(),Tt(ne);var Q=Gt(ne,2);Q.__click=w;var N=Rt(Q);{let $=pt(()=>T(a)?"#f4a":"#336");TN(N,{size:"18",get color(){return T($)},class:"shrink-0 transition-[fill] duration-500"})}var re=Gt(N,2);{var oe=$=>{var le=dq(),Me=lt(le),Ve=Rt(Me,!0);Tt(Me);var Be=Gt(Me,2);Be.__click=Ne=>{Ne.stopPropagation(),i()?i(null):i(t.selectedHistoricMap)};var q=Rt(Be);{var me=Ne=>{ov(Ne,{size:"18",class:"relative -top-[2px] ml-1 inline",weight:"fill"})},Ee=Ne=>{ov(Ne,{size:"18",class:"relative -top-[2px] ml-1 inline",weight:"regular"})};Qe(q,Ne=>{i()&&i().id==t.selectedHistoricMap.id?Ne(me):Ne(Ee,!1)})}Tt(Be),$r(()=>xn(Ve,t.selectedHistoricMap.label)),se($,le)},ve=$=>{var le=_t(),Me=lt(le);{var Ve=q=>{var me=fq(),Ee=lt(me),Ne=Rt(Ee,!0);Tt(Ee);var $e=Gt(Ee,2);$e.__click=ge=>{ge.stopPropagation(),i(null)};var ye=Rt($e);ov(ye,{size:"18",class:"relative -top-[2px] ml-1 inline",weight:"fill"}),Tt($e),$r(()=>xn(Ne,i().label)),se(q,me)},Be=q=>{var me=mq(),Ee=lt(me),Ne=Rt(Ee,!0);Tt(Ee);var $e=Gt(Ee,2);{var ye=ge=>{var Ye=pq();Vn(3,Ye,()=>D,()=>({axis:"x",duration:300})),se(ge,Ye)};Qe($e,ge=>{T(B)&&ge(ye)})}$r(()=>xn(Ne,t.clickedHistoricMap?t.clickedHistoricMap.label:"Bladindex")),se(q,me)};Qe(Me,q=>{i()&&!t.clickedHistoricMap?q(Ve):q(Be,!1)},!0)}se($,le)};Qe(re,$=>{t.selectedHistoricMap?$(oe):$(ve,!1)})}Tt(Q),Tt(W);var Pe=Gt(W,2);nM(Pe,{content:A}),$r(()=>j=Bi(S,"",j,{left:(T(a)?T(h):0)+"px",width:(T(a)?T(d):T(h))+"px"})),Jm(ne,"clientWidth",$=>Pt(h,$)),Jm(Q,"clientWidth",$=>Pt(d,$)),se(e,V),Hr()}_s(["click"]);var vq=zr('<span class="truncate text-[13px] text-gray-500"> </span>'),yq=zr('<li class="w-full"><button type="button"><div class="flex min-w-0 flex-col"><span class="truncate leading-tight font-medium"> </span> <!></div></button></li>'),bq=zr('<li class="px-4 py-8 text-center text-sm text-gray-500"> </li>'),wq=zr(`<ul class="
						relative max-h-[50vh] w-full overflow-y-auto
						bg-white text-[#336] sm:max-h-[60vh]"><!></ul>`),xq=zr(`<div class="fixed inset-0 z-1000 flex items-center justify-center" role="dialog" aria-modal="true"><button type="button" class="absolute inset-0 cursor-default bg-[#333366aa] bg-[url('/wave_pattern.png')] bg-size-[32px]" aria-label="Sluit venster"></button> <div class="
				absolute top-10 z-10 flex
				w-[94vw]
				flex-col overflow-hidden
				rounded-[8px] border-gray-200
				bg-white shadow-lg sm:top-1/4 sm:w-[600px] sm:max-w-[90vw]"><div class="relative w-full border-b border-[#eef]"><div class="pointer-events-none absolute top-1/2 left-4 -translate-y-1/2"><!></div> <input class="
						focus-ring-0 w-full bg-transparent px-4 py-4 pr-12
						pl-12 text-[18px] font-[500] text-[#336]
						placeholder:text-[#88a] focus:outline-none sm:text-[20px]
					 svelte-ojient" type="search" enterkeyhint="search" spellcheck="false" autocomplete="off" placeholder="Zoek een locatie..."/></div> <!></div></div>`);function Mq(e,t){Ur(t,!0);let i=pi(t,"visible",15),a=fr(void 0),h=fr(void 0),d=fr(""),p=fr(Xs([])),s=fr(0),w=fr(void 0),A=fr(void 0),z=fr(void 0),B=pt(()=>D(T(p).flat(1)));function D($){const le=new Map;for(const Me of $){const Ve=[Me.properties.label.toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),""),Math.round(Me.geometry.coordinates[0]*1e5),Math.round(Me.geometry.coordinates[1]*1e5)].join("|");le.has(Ve)||le.set(Ve,Me)}return Array.from(le.values())}const W=z6(async $=>{if(!$||$.length<2){Pt(p,[],!0);return}const le=t.providers.map(async Me=>{try{return(await Me.getFeatures($)).map(Be=>({...Be,properties:{...Be.properties,provider:Me.name,label:S(Be.properties.label)}}))}catch(Ve){return console.error(Ve),[]}});Pt(p,await Promise.all(le),!0),Pt(s,0)},200,{leading:!0,trailing:!0});Yi(()=>{W(T(d))}),Yi(()=>{var $;i()?(($=T(a))==null||$.focus(),setTimeout(()=>{var le;(le=T(a))==null||le.focus(),N()},50)):(Pt(d,""),Pt(p,[],!0))});function S($){return $.replace(/,\s*(nederland|the netherlands)$/i,"")}function j($){t.flyToFeature($),i(!1)}function ne($){if(!T(h))return;const le=T(h).children[$];le&&le.scrollIntoView({block:"nearest",behavior:"smooth"})}function te($){if($.stopPropagation(),$.stopImmediatePropagation(),$.key==="Escape"){i(!1);return}T(B).length!==0&&($.key==="Enter"?($.preventDefault(),j(T(B)[T(s)])):$.key==="ArrowDown"?($.preventDefault(),Pt(s,Math.min(T(s)+1,T(B).length-1),!0),ne(T(s))):$.key==="ArrowUp"&&($.preventDefault(),Pt(s,Math.max(T(s)-1,0),!0),ne(T(s))))}function Q(){i(!1)}function N(){if(!T(w))return;const le=T(w).querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');le.length>0&&(Pt(A,le[0],!0),Pt(z,le[le.length-1],!0))}function re($){var le,Me;!i()||$.key!=="Tab"||($.shiftKey?document.activeElement===T(A)&&($.preventDefault(),(le=T(z))==null||le.focus()):document.activeElement===T(z)&&($.preventDefault(),(Me=T(A))==null||Me.focus()))}var oe=_t();Tn("keydown",Km,re);var ve=lt(oe);{var Pe=$=>{var le=xq(),Me=Rt(le);Me.__click=Q;var Ve=Gt(Me,2),Be=Rt(Ve),q=Rt(Be),me=Rt(q);K5(me,{size:"24",color:"#f4a"}),Tt(q);var Ee=Gt(q,2);Hl(Ee),Ee.__keydown=te,ha(Ee,ye=>Pt(a,ye),()=>T(a)),Tt(Be);var Ne=Gt(Be,2);{var $e=ye=>{var ge=wq(),Ye=Rt(ge);{var We=Se=>{var Ce=_t(),It=lt(Ce);Mo(It,17,()=>T(B),ml,(Lt,Xt,Jt)=>{var dr=yq(),zt=Rt(dr);pr(zt,"id",`geo-item-${Jt}`),zt.__click=()=>j(T(Xt));var Zt=Rt(zt),Ot=Rt(Zt),Yt=Rt(Ot,!0);Tt(Ot);var Ar=Gt(Ot,2);{var yr=kr=>{var Tr=vq(),Dr=Rt(Tr,!0);Tt(Tr),$r(()=>xn(Dr,T(Xt).properties.alt)),se(kr,Tr)};Qe(Ar,kr=>{T(Xt).properties.alt&&kr(yr)})}Tt(Zt),Tt(zt),Tt(dr),$r(()=>{Ys(zt,1,`
										group flex w-full cursor-pointer items-center justify-between px-4
										py-3 text-left text-[16px] transition-colors
										duration-75 focus:outline-none
										${Jt===T(s)?"bg-[#eeeeff88] underline":""}
									`),xn(Yt,T(Xt).properties.label)}),Tn("mouseenter",zt,()=>Pt(s,Jt,!0)),se(Lt,dr)}),se(Se,Ce)},ot=Se=>{var Ce=bq(),It=Rt(Ce);Tt(Ce),$r(()=>xn(It,`Geen resultaten gevonden voor "${T(d)??""}"`)),se(Se,Ce)};Qe(Ye,Se=>{T(B).length>0?Se(We):Se(ot,!1)})}Tt(ge),ha(ge,Se=>Pt(h,Se),()=>T(h)),Vn(3,ge,()=>zg,()=>({duration:200})),se(ye,ge)};Qe(Ne,ye=>{T(d)!==""&&ye($e)})}Tt(Ve),Tt(le),ha(le,ye=>Pt(w,ye),()=>T(w)),Vn(3,Me,()=>Ao,()=>({y:-5,duration:250})),$m(Ee,()=>T(d),ye=>Pt(d,ye)),Vn(3,Ve,()=>Ao,()=>({y:-20,duration:250})),se($,le)};Qe(ve,$=>{i()&&$(Pe)})}se(e,oe),Hr()}_s(["click","keydown"]);class Iq{constructor(t,i){Ke(this,"name");Ke(this,"apiKey");Ke(this,"controller");this.name=t,this.apiKey=i}async getFeatures(t){this.controller&&this.controller.abort(),this.controller=new AbortController;const i=this.controller.signal;let a=[];if(t=="")return a;try{a=await fetch(this.queryFunction(t),{signal:i}).then(h=>h.json()).then(h=>h.features).then(h=>this.featuresFunction(h))}catch(h){i.aborted||console.error("Error fetching",this.name,": ",h)}return a.map(h=>({...h,properties:{...h.properties,provider:this.name}}))}}class Aq extends Iq{constructor(t){super("Geocode.Earth",t)}queryFunction(t){return`https://api.geocode.earth/v1/autocomplete?api_key=${this.apiKey}&boundary.country=NLD&layers=-venue&text=${t}`}featuresFunction(t){return t}}const Tq="ge-abd14e8fcecffc15",Cq="ca7652ec836f269a";_s(["click"]);var Sq=zr(`<button class="
					w-full cursor-pointer px-3 py-2 text-left
					text-[16px] font-[500] text-[#336]
					transition-colors hover:bg-[#f5f5ff]
				"><!> </button>`),Pq=zr(`<div class="
			z-[9999] overflow-hidden rounded-[9px] border border-[#eef]
			bg-white shadow-lg
		"></div>`),Eq=zr(`<div class="relative inline-block text-left"><button class="
			group relative cursor-pointer rounded-[9px]
			bg-linear-to-bl from-[#33336622] to-[#ffffff8]
			font-[500] text-[#336] backdrop-blur-sm
			transition-all duration-300 ease-out active:scale-95
		"><div class="m-0.5 flex items-center gap-2 rounded-[8px] bg-white px-2.5 py-2 shadow-lg"><!> <div class="max-w-45 min-w-45 break-words"><span class="ml-1"> </span></div> <svg fill="none" stroke="#336" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></div></button></div> <!>`,1);function m8(e,t){Ur(t,!0);let i=pi(t,"options",19,()=>[]),a=pi(t,"value",7,null),h=pi(t,"onchange",3,()=>{}),d=pi(t,"Icon",3,null),p=fr(!1),s,w=fr(Xs({top:0,left:0,width:0}));a()===null&&a(i()[0].value);let A=pt(()=>i().find(le=>le.value==a()));function z(){if(!T(p)&&s){const le=s.getBoundingClientRect();Pt(w,{top:le.bottom+4,left:le.left,width:le.width},!0)}Pt(p,!T(p))}function B(le){a(le.value),h()(le),Pt(p,!1)}function D(le){T(p)&&s&&!s.contains(le.target)&&Pt(p,!1)}Yi(()=>{T(p)?document.addEventListener("click",D):document.removeEventListener("click",D)});var V=Eq(),W=lt(V),S=Rt(W);S.__click=z;var j=Rt(S),ne=Rt(j);{var te=le=>{var Me=_t(),Ve=lt(Me);mo(Ve,()=>T(A).icon,(Be,q)=>{q(Be,{color:"#ff44aa",weight:"regular",class:"inline h-5.5 w-5.5 drop-shadow-[1px_1px_0_#33336622]"})}),se(le,Me)},Q=le=>{var Me=_t(),Ve=lt(Me);{var Be=q=>{var me=_t(),Ee=lt(me);mo(Ee,d,(Ne,$e)=>{$e(Ne,{color:"#ff44aa",weight:"regular",class:"inline h-5.5 w-5.5 drop-shadow-[1px_1px_0_#33336622]"})}),se(q,me)};Qe(Ve,q=>{d()&&q(Be)},!0)}se(le,Me)};Qe(ne,le=>{T(A).icon?le(te):le(Q,!1)})}var N=Gt(ne,2),re=Rt(N),oe=Rt(re,!0);Tt(re),Tt(N);var ve=Gt(N,2);Tt(j),Tt(S),Tt(W),ha(W,le=>s=le,()=>s);var Pe=Gt(W,2);{var $=le=>{var Me=Pq();Mo(Me,21,i,ml,(Ve,Be)=>{const q=pt(()=>T(Be).icon);var me=Sq();me.__click=()=>B(T(Be));var Ee=Rt(me);{var Ne=ye=>{var ge=_t(),Ye=lt(ge);mo(Ye,()=>T(q),(We,ot)=>{ot(We,{class:"mr-1 inline",color:"#ff44aa"})}),se(ye,ge)};Qe(Ee,ye=>{T(q)&&ye(Ne)})}var $e=Gt(Ee);Tt(me),$r(()=>xn($e,` ${T(Be).label??""}`)),se(Ve,me)}),Tt(Me),$r(()=>Bi(Me,`
			position: fixed;
			top: ${T(w).top??""}px;
			left: ${T(w).left??""}px;
			width: ${T(w).width??""}px;
		`)),Vn(3,Me,()=>Ao,()=>({y:-5,duration:150})),se(le,Me)};Qe(Pe,le=>{T(p)&&le($)})}$r(()=>{xn(oe,T(A).label),Ys(ve,0,`ml-auto h-4 w-4 transition-transform duration-300 ease-out ${T(p)?"rotate-180":""}`)}),se(e,V),Hr()}_s(["click"]);var kq=zr(`<div class="flex flex-col gap-0 select-none"><div class="text-sm font-[600] text-[#336]"><!> </div> <div class="
			group rounded-[12px]px-2 relative flex
			h-6 cursor-pointer items-center
			active:scale-[0.99]
		" style="touch-action: none" tabindex="-1" role="slider" aria-valuemin="0" aria-valuemax="100" aria-label="Doorzichtigheid"><div class="relative h-2 w-full rounded-full bg-[#00000022]"><div class="absolute top-0 left-0 h-full rounded-full bg-linear-to-r from-[#336] from-[67%] to-[#336]"></div> <div></div></div></div></div>`);function g8(e,t){Ur(t,!0);let i=pi(t,"value",7,50),a=pi(t,"onchange",3,()=>{}),h=fr(null),d=fr(!1);function p($){Pt(d,!0),A($),window.addEventListener("pointermove",s),window.addEventListener("pointerup",w)}function s($){T(d)&&A($)}function w(){Pt(d,!1),a()(i()),window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",w)}function A($){var Be,q,me,Ee;const le=T(h).getBoundingClientRect(),Me=$.clientX??((q=(Be=$.touches)==null?void 0:Be[0])==null?void 0:q.clientX)??((Ee=(me=$.targetTouches)==null?void 0:me[0])==null?void 0:Ee.clientX);if(!Me)return;const Ve=Math.min(Math.max(Me-le.left,0),le.width);i(Math.round(Ve/le.width*100)),a()(i())}let z=fr(void 0),B=fr(!1);function D($){if($.key==="ArrowLeft"||$.key==="ArrowDown")$.preventDefault(),$.stopImmediatePropagation(),i(Math.max(0,i()-5)),a()(i());else if($.key==="ArrowRight"||$.key==="ArrowUp")$.preventDefault(),$.stopImmediatePropagation(),i(Math.min(100,i()+5)),a()(i());else if($.key==="Tab"){Pt(B,!1);return}else $.key!=="Escape"&&$.stopPropagation()}function V(){Pt(B,!0)}function W(){Pt(B,!1)}Yi(()=>{T(B)&&T(z)&&document.activeElement!==T(z)&&T(z).focus()});var S=kq(),j=Rt(S),ne=Rt(j);ON(ne,{color:"#f4a",size:"20",class:"mr-1 inline"});var te=Gt(ne);Tt(j);var Q=Gt(j,2);Q.__pointerdown=p,Q.__keydown=D;var N=Rt(Q),re=Rt(N);let oe;var ve=Gt(re,2);let Pe;Tt(N),ha(N,$=>Pt(h,$),()=>T(h)),Tt(Q),ha(Q,$=>Pt(z,$),()=>T(z)),Tt(S),$r(()=>{xn(te,` ${i()??""}%`),pr(Q,"aria-valuenow",i()),oe=Bi(re,"",oe,{width:`${i()}%`}),Ys(ve,1,`
					absolute top-1/2 h-4.5 w-4.5 -translate-y-1/2
					rounded-full bg-[#336] shadow-[2px_2px_8px_#33336655] outline-3 outline-[#fff]
					transition-transform duration-300
					${T(d)?"scale-90":""}
				`),Pe=Bi(ve,"",Pe,{left:`calc(${i()*.95}% - 0.3rem)`})}),Tn("focus",Q,V),Tn("blur",Q,W),se(e,S),Hr()}_s(["pointerdown","keydown"]);var Rq=zr('<div class="mt-4 max-w-60 text-[15px] font-[500] text-[#336]"><input type="checkbox" class="mr-2 accent-[#f4a]"/> Waterlagen vÃ³Ã³r historische kaarten <kbd class="bg-background-alt text-xxs pointer-events-none ml-1 flex inline items-center gap-1 rounded-sm border px-1 font-sans font-medium text-[#cce] shadow-[0px_2px_0px_0px_#cce] select-none dark:border-[rgba(0,_0,_0,_0.10)] dark:bg-white dark:shadow-[0px_2px_0px_0px_#B8B8B8]"><span class="text-foreground-alt text-[12px]">W</span></kbd> <br/> <input type="checkbox" class="mr-2 accent-[#f4a]"/> Plaatsnamen vÃ³Ã³r historische kaarten <kbd class="bg-background-alt text-xxs pointer-events-none ml-1 flex inline items-center gap-1 rounded-sm border px-1 font-sans font-medium text-[#cce] shadow-[0px_2px_0px_0px_#cce] select-none dark:border-[rgba(0,_0,_0,_0.10)] dark:bg-white dark:shadow-[0px_2px_0px_0px_#B8B8B8]"><span class="text-foreground-alt text-[12px]">T</span></kbd></div>'),Lq=zr('<p class="text-[12px] opacity-50">Achtergrondkaart</p> <!> <!> <div><p class="mt-4 text-[12px] opacity-50">Zichtbaarheid waterstaatskaarten</p> <!></div> <p class="mt-4 text-[12px] opacity-50">Overlaygkaart</p> <!>',1),zq=zr('<div class="fixed z-1100 box-content -translate-x-4 -translate-y-4 rounded-[8px] bg-white p-4 shadow-lg"><p class="mt-4 text-[12px] text-[#558]">Zichtbaarheid waterstaatskaarten</p> <!></div>'),Fq=zr("<!> <!>",1);function Dq(e,t){Ur(t,!0);let i=pi(t,"visible",15),a=pi(t,"layerOptions",15),h,d=fr(Xs(a().historicMapsOpacity));Yi(()=>{clearInterval(h),i()&&(Pt(d,a().historicMapsOpacity,!0),h=setInterval(()=>{a(a().historicMapsOpacity=T(d),!0)},200))});let p,s=fr(Xs({top:0,left:0,width:0})),w=fr(!1);Yi(()=>{i()&&setTimeout(()=>{},250)});function A(){if(!p)return;Pt(w,!0);const ne=p.getBoundingClientRect();Pt(s,{top:ne.top,left:ne.left,width:ne.width},!0),document.addEventListener("pointerup",z)}function z(){Pt(w,!1),document.removeEventListener("pointerup",z)}let B=[{value:"none",label:"Geen achtergrond",icon:a8},{value:"protomaps",label:"OpenStreetMap",icon:ay},{value:"satelliet",label:"Sattelietbeeld",icon:vO},{value:"ahn",label:"Hoogtekaart (AHN)",icon:rH}],D=[{value:"none",label:"Geen overlegkaart",icon:a8},{value:"waterschapsgrenzen",label:"Waterschapsgrenzen (PDOK)",icon:YH},{value:"gemeentegrenzen",label:"Gemeentegrenzen (PDOK)",icon:o8}];var V=Fq(),W=lt(V);{let ne=pt(()=>T(w)?0:100);Mb(W,{title:"Lagen",get opacity(){return T(ne)},get visible(){return i()},set visible(te){i(te)},children:(te,Q)=>{var N=Lq(),re=Gt(lt(N),2);m8(re,{get Icon(){return ay},get options(){return B},get value(){return a().baseMap},onchange:Me=>a(a().baseMap=Me.value,!0)});var oe=Gt(re,2);{var ve=Me=>{var Ve=Rq(),Be=Rt(Ve);Hl(Be);var q=Gt(Be,6);Hl(q),qr(2),Tt(Ve),Sx(Be,()=>a().protoMapsWaterInFront,me=>a(a().protoMapsWaterInFront=me,!0)),Sx(q,()=>a().protomapsLabelsInFront,me=>a(a().protomapsLabelsInFront=me,!0)),se(Me,Ve)};Qe(oe,Me=>{a().baseMap==="protomaps"&&Me(ve)})}var Pe=Gt(oe,2);Pe.__pointerdown=A;var $=Gt(Rt(Pe),2);g8($,{get value(){return T(d)},onchange:Me=>{Pt(d,Me,!0)}}),Tt(Pe),ha(Pe,Me=>p=Me,()=>p);var le=Gt(Pe,4);m8(le,{get Icon(){return o8},get options(){return D},get value(){return a().overlay},onchange:Me=>a(a().overlay=Me.value,!0)}),se(te,N)},$$slots:{default:!0}})}var S=Gt(W,2);{var j=ne=>{var te=zq(),Q=Gt(Rt(te),2);g8(Q,{get value(){return T(d)}}),Tt(te),$r(()=>Bi(te,`
			position: fixed;
			top: ${T(s).top-16}px;
			left: ${T(s).left??""}px;
			width: ${T(s).width??""}px;
		`)),se(ne,te)};Qe(S,ne=>{T(w)&&ne(j)})}se(e,V),Hr()}_s(["pointerdown"]);_s(["click"]);var Bq=zr("<div><!></div> <div><!></div> <div><!></div>",1),Gq=zr('<!> <!> <div><!> <div><!> <div class="relative -top-[2px]"><!></div></div> <div class="mt-4 h-2 rounded-b-[4px] border-2 border-t-0 border-[#333366aa] text-right shadow-[1px_1px_0_#eef] transition-all duration-250 text-shadow-[1px_1px_0_#eef]"><span class="relative -top-4 p-2 text-[12px] font-[600] text-[#336]"> </span></div></div>',1);function Vq(e,t){Ur(t,!0);let i=pi(t,"layerOptions",15),a=/Mac|iPhone|iPad/.test(navigator.userAgent),h=fr(!1);Yi(()=>{Pt(h,!0)});let d=fr(!1),p=fr(!1),s=fr(!1);setTimeout(()=>Pt(s,!0),2e3);const w=document.querySelector(".maplibregl-ctrl-scale");let A=fr(Xs(w.clientWidth)),z=fr(Xs(w.innerText));setInterval(()=>{Pt(A,w.clientWidth,!0),Pt(z,w.innerText,!0)},250);var B=Gq();Tn("keydown",pl,$=>{$.key.toLowerCase()==="k"&&(a?$.metaKey:$.ctrlKey)&&($.preventDefault(),Pt(d,!0)),$.key.toLowerCase()==="l"&&Pt(p,!T(p))});var D=lt(B);{let $=pt(()=>[new Aq(Tq)]);Mq(D,{get flyToFeature(){return t.flyToFeature},get providers(){return T($)},get visible(){return T(d)},set visible(le){Pt(d,le,!0)}})}var V=Gt(D,2);Dq(V,{get visible(){return T(p)},set visible($){Pt(p,$,!0)},get layerOptions(){return i()},set layerOptions($){i($)}});var W=Gt(V,2),S=Rt(W);{var j=$=>{var le=Bq(),Me=lt(le),Ve=Rt(Me);$c(Ve,{tabindex:"5",get Icon(){return K5},kbd:"âK",onclick:()=>Pt(d,!0),children:(Ne,$e)=>{qr();var ye=wi("Zoek plaats ...");se(Ne,ye)},$$slots:{default:!0}}),Tt(Me);var Be=Gt(Me,2),q=Rt(Be);$c(q,{tabindex:"6",get Icon(){return hH},get onclick(){return t.flyToUserLocation},children:(Ne,$e)=>{qr();var ye=wi("Mijn locatie tonen");se(Ne,ye)},$$slots:{default:!0}}),Tt(Be);var me=Gt(Be,2),Ee=Rt(me);$c(Ee,{tabindex:"7",get Icon(){return ZH},kbd:"L",onclick:()=>Pt(p,!T(p)),children:(Ne,$e)=>{qr();var ye=wi("Lagen");se(Ne,ye)},$$slots:{default:!0}}),Tt(me),Vn(3,Me,()=>Ao,()=>({x:100,duration:250})),Vn(3,Be,()=>Ao,()=>({x:100,duration:250})),Vn(3,me,()=>Ao,()=>({x:100,duration:250})),se($,le)};Qe(S,$=>{t.selectedHistoricMap||$(j)})}var ne=Gt(S,2);Ys(ne,1,`
			flex w-fit flex-col items-end
			justify-center overflow-hidden rounded-lg
		`);var te=Rt(ne);$c(te,{get Icon(){return CU},get onclick(){return t.zoomIn},kbd:"+",children:($,le)=>{qr();var Me=wi("InzoomenÂ ");se($,Me)},$$slots:{default:!0}});var Q=Gt(te,2),N=Rt(Q);$c(N,{get Icon(){return yU},get onclick(){return t.zoomOut},kbd:"-",children:($,le)=>{qr();var Me=wi("Uitzoomen");se($,Me)},$$slots:{default:!0}}),Tt(Q),Tt(ne);var re=Gt(ne,2);let oe;var ve=Rt(re),Pe=Rt(ve,!0);Tt(ve),Tt(re),Tt(W),$r(()=>{Ys(W,1,`
	fixed right-2 flex flex-col items-end gap-2 transition-all duration-300
	${t.selectedHistoricMap?"bottom-36 sm:bottom-2":"bottom-36"}
	`),oe=Bi(re,"",oe,{width:T(A)+"px"}),xn(Pe,T(z))}),se(e,B),Hr()}function jq(){return new Promise((e,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by your browser."));return}navigator.geolocation.getCurrentPosition(i=>{const{latitude:a,longitude:h}=i.coords;e({lat:a,lng:h})},i=>{t(i)},{enableHighAccuracy:!1,timeout:15e3,maximumAge:1e4})})}var Zq=Object.defineProperty,ko=(e,t)=>Zq(e,"name",{value:t,configurable:!0});function Us(e,t){let i="script";return e==="name"?i="script":e==="name2"?i="script2":e==="name3"&&(i="script3"),[["coalesce",["get",`pgf:${e}`],["get",e]],{"text-font":["case",["==",["get",i],"Devanagari"],["literal",["Noto Sans Devanagari Regular v1"]],["literal",[t||"Noto Sans Regular"]]]}]}ko(Us,"get_name_block");function co(e,t,i){let a="name";return i==="name"?a="":i==="name2"?a="2":i==="name3"&&(a="3"),t==="Latin"?["has",`script${a}`]:e==="ja"?["all",["!=",["get",`script${a}`],"Han"],["!=",["get",`script${a}`],"Hiragana"],["!=",["get",`script${a}`],"Katakana"],["!=",["get",`script${a}`],"Mixed-Japanese"]]:["!=",["get",`script${a}`],t]}ko(co,"is_not_in_target_script");function Za(e){return e==="Devanagari"?{"text-font":["literal",["Noto Sans Devanagari Regular v1"]]}:{}}ko(Za,"get_font_formatting");function Tb(e){let t=Oq.find(i=>i.lang===e);return t===void 0?"Latin":t.script}ko(Tb,"get_default_script");function sM(e,t){let i=t||Tb(e),a;return i==="Devanagari"?a="pgf:":a="",["format",["coalesce",["get",`${a}name:${e}`],["get","name:en"]],Za(i)]}ko(sM,"get_country_name");function Va(e,t,i){let a=t||Tb(e),h;return a==="Devanagari"?h="pgf:":h="",["case",["all",["any",["has","name"],["has","pgf:name"]],["!",["any",["has","name2"],["has","pgf:name2"]]],["!",["any",["has","name3"],["has","pgf:name3"]]]],["case",co(e,a,"name"),["case",["any",["is-supported-script",["get","name"]],["has","pgf:name"]],["format",["coalesce",["get",`${h}name:${e}`],["get","name:en"]],Za(a),`
`,{},["case",["all",["!",["has",`${h}name:${e}`]],["has","name:en"],["!",["has","script"]]],"",["coalesce",["get","pgf:name"],["get","name"]]],{"text-font":["case",["==",["get","script"],"Devanagari"],["literal",["Noto Sans Devanagari Regular v1"]],["literal",[i||"Noto Sans Regular"]]]}],["get","name:en"]],["format",["coalesce",["get",`${h}name:${e}`],["get","pgf:name"],["get","name"]],Za(a)]],["all",["any",["has","name"],["has","pgf:name"]],["any",["has","name2"],["has","pgf:name2"]],["!",["any",["has","name3"],["has","pgf:name3"]]]],["case",["all",co(e,a,"name"),co(e,a,"name2")],["format",["get",`${h}name:${e}`],Za(a),`
`,{},...Us("name",i),`
`,{},...Us("name2",i)],["case",co(e,a,"name2"),["format",["coalesce",["get",`${h}name:${e}`],["get","pgf:name"],["get","name"]],Za(a),`
`,{},...Us("name2",i)],["format",["coalesce",["get",`${h}name:${e}`],["get","pgf:name2"],["get","name2"]],Za(a),`
`,{},...Us("name",i)]]],["case",["all",co(e,a,"name"),co(e,a,"name2"),co(e,a,"name3")],["format",["get",`${h}name:${e}`],Za(a),`
`,{},...Us("name",i),`
`,{},...Us("name2",i),`
`,{},...Us("name3",i)],["case",["!",co(e,a,"name")],["format",["coalesce",["get",`${h}name:${e}`],["get","pgf:name"],["get","name"]],Za(a),`
`,{},...Us("name2",i),`
`,{},...Us("name3",i)],["!",co(e,a,"name2")],["format",["coalesce",["get",`${h}name:${e}`],["get","pgf:name2"],["get","name2"]],Za(a),`
`,{},...Us("name",i),`
`,{},...Us("name3",i)],["format",["coalesce",["get",`${h}name:${e}`],["get","pgf:name3"],["get","name3"]],Za(a),`
`,{},...Us("name",i),`
`,{},...Us("name2",i)]]]]}ko(Va,"get_multiline_name");var Oq=[{lang:"ar",full_name:"Arabic",script:"Arabic"},{lang:"cs",full_name:"Czech",script:"Latin"},{lang:"bg",full_name:"Bulgarian",script:"Cyrillic"},{lang:"da",full_name:"Danish",script:"Latin"},{lang:"de",full_name:"German",script:"Latin"},{lang:"el",full_name:"Greek",script:"Greek"},{lang:"en",full_name:"English",script:"Latin"},{lang:"es",full_name:"Spanish",script:"Latin"},{lang:"et",full_name:"Estonian",script:"Latin"},{lang:"fa",full_name:"Persian",script:"Arabic"},{lang:"fi",full_name:"Finnish",script:"Latin"},{lang:"fr",full_name:"French",script:"Latin"},{lang:"ga",full_name:"Irish",script:"Latin"},{lang:"he",full_name:"Hebrew",script:"Hebrew"},{lang:"hi",full_name:"Hindi",script:"Devanagari"},{lang:"hr",full_name:"Croatian",script:"Latin"},{lang:"hu",full_name:"Hungarian",script:"Latin"},{lang:"id",full_name:"Indonesian",script:"Latin"},{lang:"it",full_name:"Italian",script:"Latin"},{lang:"ja",full_name:"Japanese",script:""},{lang:"ko",full_name:"Korean",script:"Hangul"},{lang:"lt",full_name:"Lithuanian",script:"Latin"},{lang:"lv",full_name:"Latvian",script:"Latin"},{lang:"ne",full_name:"Nepali",script:"Devanagari"},{lang:"nl",full_name:"Dutch",script:"Latin"},{lang:"no",full_name:"Norwegian",script:"Latin"},{lang:"mr",full_name:"Marathi",script:"Devanagari"},{lang:"mt",full_name:"Maltese",script:"Latin"},{lang:"pl",full_name:"Polish",script:"Latin"},{lang:"pt",full_name:"Portuguese",script:"Latin"},{lang:"ro",full_name:"Romanian",script:"Latin"},{lang:"ru",full_name:"Russian",script:"Cyrillic"},{lang:"sk",full_name:"Slovak",script:"Latin"},{lang:"sl",full_name:"Slovenian",script:"Latin"},{lang:"sv",full_name:"Swedish",script:"Latin"},{lang:"tr",full_name:"Turkish",script:"Latin"},{lang:"uk",full_name:"Ukrainian",script:"Cyrillic"},{lang:"ur",full_name:"Urdu",script:"Arabic"},{lang:"vi",full_name:"Vietnamese",script:"Latin"},{lang:"zh-Hans",full_name:"Chinese (Simplified)",script:"Han"},{lang:"zh-Hant",full_name:"Chinese (Traditional)",script:"Han"}];function aM(e,t){return[{id:"background",type:"background",paint:{"background-color":t.background}},{id:"earth",type:"fill",filter:["==","$type","Polygon"],source:e,"source-layer":"earth",paint:{"fill-color":t.earth}},...t.landcover?[{id:"landcover",type:"fill",source:e,"source-layer":"landcover",paint:{"fill-color":["match",["get","kind"],"grassland",t.landcover.grassland,"barren",t.landcover.barren,"urban_area",t.landcover.urban_area,"farmland",t.landcover.farmland,"glacier",t.landcover.glacier,"scrub",t.landcover.scrub,t.landcover.forest],"fill-opacity":["interpolate",["linear"],["zoom"],5,1,7,0]}}]:[],{id:"landuse_park",type:"fill",source:e,"source-layer":"landuse",filter:["in","kind","national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course","wood","nature_reserve","forest","scrub","grassland","grass","military","naval_base","airfield"],paint:{"fill-opacity":["interpolate",["linear"],["zoom"],6,0,11,1],"fill-color":["case",["in",["get","kind"],["literal",["national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course"]]],t.park_b,["in",["get","kind"],["literal",["wood","nature_reserve","forest"]]],t.wood_b,["in",["get","kind"],["literal",["scrub","grassland","grass"]]],t.scrub_b,["in",["get","kind"],["literal",["glacier"]]],t.glacier,["in",["get","kind"],["literal",["sand"]]],t.sand,["in",["get","kind"],["literal",["military","naval_base","airfield"]]],t.zoo,t.earth]}},{id:"landuse_urban_green",type:"fill",source:e,"source-layer":"landuse",filter:["in","kind","allotments","village_green","playground"],paint:{"fill-color":t.park_b,"fill-opacity":.7}},{id:"landuse_hospital",type:"fill",source:e,"source-layer":"landuse",filter:["==","kind","hospital"],paint:{"fill-color":t.hospital}},{id:"landuse_industrial",type:"fill",source:e,"source-layer":"landuse",filter:["==","kind","industrial"],paint:{"fill-color":t.industrial}},{id:"landuse_school",type:"fill",source:e,"source-layer":"landuse",filter:["in","kind","school","university","college"],paint:{"fill-color":t.school}},{id:"landuse_beach",type:"fill",source:e,"source-layer":"landuse",filter:["in","kind","beach"],paint:{"fill-color":t.beach}},{id:"landuse_zoo",type:"fill",source:e,"source-layer":"landuse",filter:["in","kind","zoo"],paint:{"fill-color":t.zoo}},{id:"landuse_aerodrome",type:"fill",source:e,"source-layer":"landuse",filter:["in","kind","aerodrome"],paint:{"fill-color":t.aerodrome}},{id:"roads_runway",type:"line",source:e,"source-layer":"roads",filter:["==","kind_detail","runway"],paint:{"line-color":t.runway,"line-width":["interpolate",["exponential",1.6],["zoom"],10,0,12,4,18,30]}},{id:"roads_taxiway",type:"line",source:e,"source-layer":"roads",minzoom:13,filter:["==","kind_detail","taxiway"],paint:{"line-color":t.runway,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,15,6]}},{id:"landuse_runway",type:"fill",source:e,"source-layer":"landuse",filter:["any",["in","kind","runway","taxiway"]],paint:{"fill-color":t.runway}},{id:"water",type:"fill",filter:["==","$type","Polygon"],source:e,"source-layer":"water",paint:{"fill-color":t.water}},{id:"water_stream",type:"line",source:e,"source-layer":"water",minzoom:14,filter:["in","kind","stream"],paint:{"line-color":t.water,"line-width":.5}},{id:"water_river",type:"line",source:e,"source-layer":"water",minzoom:9,filter:["in","kind","river"],paint:{"line-color":t.water,"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1,18,12]}},{id:"landuse_pedestrian",type:"fill",source:e,"source-layer":"landuse",filter:["in","kind","pedestrian","dam"],paint:{"fill-color":t.pedestrian}},{id:"landuse_pier",type:"fill",source:e,"source-layer":"landuse",filter:["==","kind","pier"],paint:{"fill-color":t.pier}},{id:"roads_tunnels_other_casing",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_tunnel"],["in","kind","other","path"]],paint:{"line-color":t.tunnel_other_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_tunnels_minor_casing",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","minor_road"]],paint:{"line-color":t.tunnel_minor_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_link_casing",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_tunnel"],["has","is_link"]],paint:{"line-color":t.tunnel_link_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_tunnels_major_casing",type:"line",source:e,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":t.tunnel_major_casing,"line-dasharray":[3,2],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_tunnels_highway_casing",type:"line",source:e,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":t.tunnel_highway_casing,"line-dasharray":[6,.5],"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_tunnels_other",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_tunnel"],["in","kind","other","path"]],paint:{"line-color":t.tunnel_other,"line-dasharray":[4.5,.5],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_tunnels_minor",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","minor_road"]],paint:{"line-color":t.tunnel_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_tunnels_link",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_tunnel"],["has","is_link"]],paint:{"line-color":t.tunnel_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_tunnels_major",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==","kind","major_road"]],paint:{"line-color":t.tunnel_major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_tunnels_highway",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_tunnel"],["==",["get","kind"],"highway"],["!",["has","is_link"]]],paint:{"line-color":t.tunnel_highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}},{id:"buildings",type:"fill",source:e,"source-layer":"buildings",filter:["in","kind","building","building_part"],paint:{"fill-color":t.buildings,"fill-opacity":.5}},{id:"roads_pier",type:"line",source:e,"source-layer":"roads",filter:["==","kind_detail","pier"],paint:{"line-color":t.pier,"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,.5,20,16]}},{id:"roads_minor_service_casing",type:"line",source:e,"source-layer":"roads",minzoom:13,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["==","kind_detail","service"]],paint:{"line-color":t.minor_service_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,18,8],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,.8]}},{id:"roads_minor_casing",type:"line",source:e,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["!=","kind_detail","service"]],paint:{"line-color":t.minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1]}},{id:"roads_link_casing",type:"line",source:e,"source-layer":"roads",minzoom:13,filter:["has","is_link"],paint:{"line-color":t.minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1.5]}},{id:"roads_major_casing_late",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":t.major_casing_late,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_highway_casing_late",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":t.highway_casing_late,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_other",type:"line",source:e,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["in","kind","other","path"],["!=","kind_detail","pier"]],paint:{"line-color":t.other,"line-dasharray":[3,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_link",type:"line",source:e,"source-layer":"roads",filter:["has","is_link"],paint:{"line-color":t.link,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_minor_service",type:"line",source:e,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["==","kind_detail","service"]],paint:{"line-color":t.minor_service,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,18,8]}},{id:"roads_minor",type:"line",source:e,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","minor_road"],["!=","kind_detail","service"]],paint:{"line-color":["interpolate",["exponential",1.6],["zoom"],11,t.minor_a,16,t.minor_b],"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_major_casing_early",type:"line",source:e,"source-layer":"roads",maxzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":t.major_casing_early,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,13],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1]}},{id:"roads_major",type:"line",source:e,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":t.major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_highway_casing_early",type:"line",source:e,"source-layer":"roads",maxzoom:12,filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":t.highway_casing_early,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1]}},{id:"roads_highway",type:"line",source:e,"source-layer":"roads",filter:["all",["!has","is_tunnel"],["!has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":t.highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}},{id:"roads_rail",type:"line",source:e,"source-layer":"roads",filter:["==","kind","rail"],paint:{"line-dasharray":[.3,.75],"line-opacity":.5,"line-color":t.railway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,.15,18,9]}},{id:"boundaries_country",type:"line",source:e,"source-layer":"boundaries",filter:["<=","kind_detail",2],paint:{"line-color":t.boundaries,"line-width":.7,"line-dasharray":["step",["zoom"],["literal",[2,0]],4,["literal",[2,1]]]}},{id:"boundaries",type:"line",source:e,"source-layer":"boundaries",filter:[">","kind_detail",2],paint:{"line-color":t.boundaries,"line-width":.4,"line-dasharray":["step",["zoom"],["literal",[2,0]],4,["literal",[2,1]]]}},{id:"roads_bridges_other_casing",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["in","kind","other","path"]],paint:{"line-color":t.bridges_other_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_bridges_link_casing",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["has","is_link"]],paint:{"line-color":t.bridges_minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],12,0,12.5,1.5]}},{id:"roads_bridges_minor_casing",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","minor_road"]],paint:{"line-color":t.bridges_minor_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11],"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,.8]}},{id:"roads_bridges_major_casing",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":t.bridges_major_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,.5,18,10],"line-width":["interpolate",["exponential",1.6],["zoom"],9,0,9.5,1.5]}},{id:"roads_bridges_other",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["in","kind","other","path"]],paint:{"line-color":t.bridges_other,"line-dasharray":[2,1],"line-width":["interpolate",["exponential",1.6],["zoom"],14,0,20,7]}},{id:"roads_bridges_minor",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","minor_road"]],paint:{"line-color":t.bridges_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],11,0,12.5,.5,15,2,18,11]}},{id:"roads_bridges_link",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["has","is_link"]],paint:{"line-color":t.bridges_minor,"line-width":["interpolate",["exponential",1.6],["zoom"],13,0,13.5,1,18,11]}},{id:"roads_bridges_major",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","major_road"]],paint:{"line-color":t.bridges_major,"line-width":["interpolate",["exponential",1.6],["zoom"],6,0,12,1.6,15,3,18,13]}},{id:"roads_bridges_highway_casing",type:"line",source:e,"source-layer":"roads",minzoom:12,filter:["all",["has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":t.bridges_highway_casing,"line-gap-width":["interpolate",["exponential",1.6],["zoom"],3,0,3.5,.5,18,15],"line-width":["interpolate",["exponential",1.6],["zoom"],7,0,7.5,1,20,15]}},{id:"roads_bridges_highway",type:"line",source:e,"source-layer":"roads",filter:["all",["has","is_bridge"],["==","kind","highway"],["!has","is_link"]],paint:{"line-color":t.bridges_highway,"line-width":["interpolate",["exponential",1.6],["zoom"],3,0,6,1.1,12,1.6,15,5,18,15]}}]}ko(aM,"nolabels_layers");function oM(e,t,i,a){return[{id:"address_label",type:"symbol",source:e,"source-layer":"buildings",minzoom:18,filter:["==","kind","address"],layout:{"symbol-placement":"point","text-font":[t.italic||"Noto Sans Italic"],"text-field":["get","addr_housenumber"],"text-size":12},paint:{"text-color":t.address_label,"text-halo-color":t.address_label_halo,"text-halo-width":1}},{id:"water_waterway_label",type:"symbol",source:e,"source-layer":"water",minzoom:13,filter:["in","kind","river","stream"],layout:{"symbol-placement":"line","text-font":[t.italic||"Noto Sans Italic"],"text-field":Va(i,a,t.regular),"text-size":12,"text-letter-spacing":.2},paint:{"text-color":t.ocean_label,"text-halo-color":t.water,"text-halo-width":1}},{id:"roads_oneway",type:"symbol",source:e,"source-layer":"roads",minzoom:16,filter:["==",["get","oneway"],"yes"],layout:{"symbol-placement":"line","icon-image":"arrow","icon-rotate":90,"symbol-spacing":100}},{id:"roads_labels_minor",type:"symbol",source:e,"source-layer":"roads",minzoom:15,filter:["in","kind","minor_road","other","path"],layout:{"symbol-sort-key":["get","min_zoom"],"symbol-placement":"line","text-font":[t.regular||"Noto Sans Regular"],"text-field":Va(i,a,t.regular),"text-size":12},paint:{"text-color":t.roads_label_minor,"text-halo-color":t.roads_label_minor_halo,"text-halo-width":1}},{id:"water_label_ocean",type:"symbol",source:e,"source-layer":"water",filter:["in","kind","sea","ocean","bay","strait","fjord"],layout:{"text-font":[t.italic||"Noto Sans Italic"],"text-field":Va(i,a,t.regular),"text-size":["interpolate",["linear"],["zoom"],3,10,10,12],"text-letter-spacing":.1,"text-max-width":9,"text-transform":"uppercase"},paint:{"text-color":t.ocean_label,"text-halo-width":1,"text-halo-color":t.water}},{id:"earth_label_islands",type:"symbol",source:e,"source-layer":"earth",filter:["in","kind","island"],layout:{"text-font":[t.italic||"Noto Sans Italic"],"text-field":Va(i,a,t.regular),"text-size":10,"text-letter-spacing":.1,"text-max-width":8},paint:{"text-color":t.subplace_label,"text-halo-color":t.subplace_label_halo,"text-halo-width":1}},{id:"water_label_lakes",type:"symbol",source:e,"source-layer":"water",filter:["in","kind","lake","water"],layout:{"text-font":[t.italic||"Noto Sans Italic"],"text-field":Va(i,a,t.regular),"text-size":["interpolate",["linear"],["zoom"],3,10,6,12,10,12],"text-letter-spacing":.1,"text-max-width":9},paint:{"text-color":t.ocean_label,"text-halo-color":t.water,"text-halo-width":1}},{id:"roads_shields",type:"symbol",source:e,"source-layer":"roads",filter:["all",["in",["get","kind"],["literal",["highway","major_road"]]],["has","shield_text"],["<=",["length",["get","shield_text"]],5]],layout:{"icon-image":["match",["get","network"],"US:I",["concat","US:I-",["length",["get","shield_text"]],"char"],"NL:S-road",["concat","NL:S-road-",["length",["get","shield_text"]],"char"],["concat","generic_shield-",["length",["get","shield_text"]],"char"]],"text-field":["get","shield_text"],"text-font":[t.bold||"Noto Sans Medium"],"text-size":8,"icon-size":.8,"symbol-placement":"line","icon-rotation-alignment":"viewport","text-rotation-alignment":"viewport"},paint:{"text-color":t.roads_label_major}},{id:"roads_labels_major",type:"symbol",source:e,"source-layer":"roads",minzoom:11,filter:["in","kind","highway","major_road"],layout:{"symbol-sort-key":["get","min_zoom"],"symbol-placement":"line","text-font":[t.regular||"Noto Sans Regular"],"text-field":Va(i,a,t.regular),"text-size":12},paint:{"text-color":t.roads_label_major,"text-halo-color":t.roads_label_major_halo,"text-halo-width":1}},...t.pois?[{id:"pois",type:"symbol",source:e,"source-layer":"pois",filter:["all",["in",["get","kind"],["literal",["beach","forest","marina","park","peak","zoo","garden","bench","aerodrome","station","bus_stop","ferry_terminal","stadium","university","library","school","animal","toilets","drinking_water","post_office","building","townhall","restaurant","fast_food","cafe","bar","supermarket","convenience","books","beauty","electronics","clothes","attraction","museum","theatre","artwork"]]],[">=",["zoom"],["+",["get","min_zoom"],0]]],layout:{"icon-image":["match",["get","kind"],"station","train_station",["get","kind"]],"text-font":[t.regular||"Noto Sans Regular"],"text-justify":"auto","text-field":Va(i,a,t.regular),"text-size":["interpolate",["linear"],["zoom"],17,10,19,16],"text-max-width":8,"text-offset":[1.1,0],"text-variable-anchor":["left","right"]},paint:{"text-color":["case",["in",["get","kind"],["literal",["beach","forest","marina","park","peak","zoo","garden","bench"]]],t.pois.green,["in",["get","kind"],["literal",["aerodrome","station","bus_stop","ferry_terminal"]]],t.pois.lapis,["in",["get","kind"],["literal",["stadium","university","library","school","animal","toilets","drinking_water","post_office","building","townhall"]]],t.pois.slategray,["in",["get","kind"],["literal",["supermarket","convenience","books","beauty","electronics","clothes"]]],t.pois.blue,["in",["get","kind"],["literal",["restaurant","fast_food","cafe","bar"]]],t.pois.tangerine,["in",["get","kind"],["literal",["attraction","museum","theatre","artwork"]]],t.pois.pink,t.earth],"text-halo-color":t.earth,"text-halo-width":1}}]:[],{id:"places_subplace",type:"symbol",source:e,"source-layer":"places",filter:["in","kind","neighbourhood","macrohood"],layout:{"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-field":Va(i,a,t.regular),"text-font":[t.regular||"Noto Sans Regular"],"text-max-width":7,"text-letter-spacing":.1,"text-padding":["interpolate",["linear"],["zoom"],5,2,8,4,12,18,15,20],"text-size":["interpolate",["exponential",1.2],["zoom"],11,8,14,14,18,24],"text-transform":"uppercase"},paint:{"text-color":t.subplace_label,"text-halo-color":t.subplace_label_halo,"text-halo-width":1}},{id:"places_region",type:"symbol",source:e,"source-layer":"places",filter:["==","kind","region"],layout:{"symbol-sort-key":["get","sort_key"],"text-field":["step",["zoom"],["coalesce",["get","ref:en"],["get","ref"]],6,Va(i,a,t.regular)],"text-font":[t.regular||"Noto Sans Regular"],"text-size":["interpolate",["linear"],["zoom"],3,11,7,16],"text-radial-offset":.2,"text-anchor":"center","text-transform":"uppercase"},paint:{"text-color":t.state_label,"text-halo-color":t.state_label_halo,"text-halo-width":1}},{id:"places_locality",type:"symbol",source:e,"source-layer":"places",filter:["==","kind","locality"],layout:{"icon-image":["step",["zoom"],["case",["==",["get","capital"],"yes"],"capital","townspot"],8,""],"icon-size":.7,"text-field":Va(i,a,t.regular),"text-font":["case",["<=",["get","min_zoom"],5],["literal",[t.bold||"Noto Sans Medium"]],["literal",[t.regular||"Noto Sans Regular"]]],"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-padding":["interpolate",["linear"],["zoom"],5,3,8,7,12,11],"text-size":["interpolate",["linear"],["zoom"],2,["case",["<",["get","population_rank"],13],8,[">=",["get","population_rank"],13],13,0],4,["case",["<",["get","population_rank"],13],10,[">=",["get","population_rank"],13],15,0],6,["case",["<",["get","population_rank"],12],11,[">=",["get","population_rank"],12],17,0],8,["case",["<",["get","population_rank"],11],11,[">=",["get","population_rank"],11],18,0],10,["case",["<",["get","population_rank"],9],12,[">=",["get","population_rank"],9],20,0],15,["case",["<",["get","population_rank"],8],12,[">=",["get","population_rank"],8],22,0]],"icon-padding":["interpolate",["linear"],["zoom"],0,0,8,4,10,8,12,6,22,2],"text-justify":"auto","text-variable-anchor":["step",["zoom"],["literal",["bottom","left","right","top"]],8,["literal",["center"]]],"text-radial-offset":.3},paint:{"text-color":t.city_label,"text-halo-color":t.city_label_halo,"text-halo-width":1}},{id:"places_country",type:"symbol",source:e,"source-layer":"places",filter:["==","kind","country"],layout:{"symbol-sort-key":["case",["has","sort_key"],["get","sort_key"],["get","min_zoom"]],"text-field":sM(i,a),"text-font":[t.bold||"Noto Sans Medium"],"text-size":["interpolate",["linear"],["zoom"],2,["case",["<",["get","population_rank"],10],8,[">=",["get","population_rank"],10],12,0],6,["case",["<",["get","population_rank"],8],10,[">=",["get","population_rank"],8],18,0],8,["case",["<",["get","population_rank"],7],11,[">=",["get","population_rank"],7],20,0]],"icon-padding":["interpolate",["linear"],["zoom"],0,2,14,2,16,20,17,2,22,2],"text-transform":"uppercase"},paint:{"text-color":t.country_label,"text-halo-color":t.earth,"text-halo-width":1}}]}ko(oM,"labels_layers");var Nq={background:"#cccccc",earth:"#e2dfda",park_a:"#cfddd5",park_b:"#9cd3b4",hospital:"#e4dad9",industrial:"#d1dde1",school:"#e4ded7",wood_a:"#d0ded0",wood_b:"#a0d9a0",pedestrian:"#e3e0d4",scrub_a:"#cedcd7",scrub_b:"#99d2bb",glacier:"#e7e7e7",sand:"#e2e0d7",beach:"#e8e4d0",aerodrome:"#dadbdf",runway:"#e9e9ed",water:"#80deea",zoo:"#c6dcdc",military:"#dcdcdc",tunnel_other_casing:"#e0e0e0",tunnel_minor_casing:"#e0e0e0",tunnel_link_casing:"#e0e0e0",tunnel_major_casing:"#e0e0e0",tunnel_highway_casing:"#e0e0e0",tunnel_other:"#d5d5d5",tunnel_minor:"#d5d5d5",tunnel_link:"#d5d5d5",tunnel_major:"#d5d5d5",tunnel_highway:"#d5d5d5",pier:"#e0e0e0",buildings:"#cccccc",minor_service_casing:"#e0e0e0",minor_casing:"#e0e0e0",link_casing:"#e0e0e0",major_casing_late:"#e0e0e0",highway_casing_late:"#e0e0e0",other:"#ebebeb",minor_service:"#ebebeb",minor_a:"#ebebeb",minor_b:"#ffffff",link:"#ffffff",major_casing_early:"#e0e0e0",major:"#ffffff",highway_casing_early:"#e0e0e0",highway:"#ffffff",railway:"#a7b1b3",boundaries:"#adadad",bridges_other_casing:"#e0e0e0",bridges_minor_casing:"#e0e0e0",bridges_link_casing:"#e0e0e0",bridges_major_casing:"#e0e0e0",bridges_highway_casing:"#e0e0e0",bridges_other:"#ebebeb",bridges_minor:"#ffffff",bridges_link:"#ffffff",bridges_major:"#f5f5f5",bridges_highway:"#ffffff",roads_label_minor:"#91888b",roads_label_minor_halo:"#ffffff",roads_label_major:"#938a8d",roads_label_major_halo:"#ffffff",ocean_label:"#728dd4",subplace_label:"#8f8f8f",subplace_label_halo:"#e0e0e0",city_label:"#5c5c5c",city_label_halo:"#e0e0e0",state_label:"#b3b3b3",state_label_halo:"#e0e0e0",country_label:"#a3a3a3",address_label:"#91888b",address_label_halo:"#ffffff",pois:{blue:"#1A8CBD",green:"#20834D",lapis:"#315BCF",pink:"#EF56BA",red:"#F2567A",slategray:"#6A5B8F",tangerine:"#CB6704",turquoise:"#00C3D4"},landcover:{grassland:"rgba(210, 239, 207, 1)",barren:"rgba(255, 243, 215, 1)",urban_area:"rgba(230, 230, 230, 1)",farmland:"rgba(216, 239, 210, 1)",glacier:"rgba(255, 255, 255, 1)",scrub:"rgba(234, 239, 210, 1)",forest:"rgba(196, 231, 210, 1)"}},Uq={background:"#34373d",earth:"#1f1f1f",park_a:"#1c2421",park_b:"#192a24",hospital:"#252424",industrial:"#222222",school:"#262323",wood_a:"#202121",wood_b:"#202121",pedestrian:"#1e1e1e",scrub_a:"#222323",scrub_b:"#222323",glacier:"#1c1c1c",sand:"#212123",beach:"#28282a",aerodrome:"#1e1e1e",runway:"#333333",water:"#31353f",zoo:"#222323",military:"#242323",tunnel_other_casing:"#141414",tunnel_minor_casing:"#141414",tunnel_link_casing:"#141414",tunnel_major_casing:"#141414",tunnel_highway_casing:"#141414",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",pier:"#333333",buildings:"#111111",minor_service_casing:"#1f1f1f",minor_casing:"#1f1f1f",link_casing:"#1f1f1f",major_casing_late:"#1f1f1f",highway_casing_late:"#1f1f1f",other:"#333333",minor_service:"#333333",minor_a:"#3d3d3d",minor_b:"#333333",link:"#3d3d3d",major_casing_early:"#1f1f1f",major:"#3d3d3d",highway_casing_early:"#1f1f1f",highway:"#474747",railway:"#000000",boundaries:"#5b6374",bridges_other_casing:"#2b2b2b",bridges_minor_casing:"#1f1f1f",bridges_link_casing:"#1f1f1f",bridges_major_casing:"#1f1f1f",bridges_highway_casing:"#1f1f1f",bridges_other:"#333333",bridges_minor:"#333333",bridges_link:"#3d3d3d",bridges_major:"#3d3d3d",bridges_highway:"#474747",roads_label_minor:"#525252",roads_label_minor_halo:"#1f1f1f",roads_label_major:"#666666",roads_label_major_halo:"#1f1f1f",ocean_label:"#717784",subplace_label:"#525252",subplace_label_halo:"#1f1f1f",city_label:"#7a7a7a",city_label_halo:"#212121",state_label:"#3d3d3d",state_label_halo:"#1f1f1f",country_label:"#5c5c5c",address_label:"#525252",address_label_halo:"#1f1f1f",pois:{blue:"#4299BB",green:"#30C573",lapis:"#2B5CEA",pink:"#EF56BA",red:"#F2567A",slategray:"#93939F",tangerine:"#F19B6E",turquoise:"#00C3D4"},landcover:{grassland:"rgba(30, 41, 31, 1)",barren:"rgba(38, 38, 36, 1)",urban_area:"rgba(28, 28, 28, 1)",farmland:"rgba(31, 36, 32, 1)",glacier:"rgba(43, 43, 43, 1)",scrub:"rgba(34, 36, 30, 1)",forest:"rgba(28, 41, 37, 1)"}},Hq={background:"#ffffff",earth:"#ffffff",park_a:"#fcfcfc",park_b:"#fcfcfc",hospital:"#f8f8f8",industrial:"#fcfcfc",school:"#f8f8f8",wood_a:"#fafafa",wood_b:"#fafafa",pedestrian:"#fdfdfd",scrub_a:"#fafafa",scrub_b:"#fafafa",glacier:"#fcfcfc",sand:"#fafafa",beach:"#f6f6f6",aerodrome:"#fdfdfd",runway:"#efefef",water:"#dcdcdc",zoo:"#f7f7f7",military:"#fcfcfc",tunnel_other_casing:"#d6d6d6",tunnel_minor_casing:"#fcfcfc",tunnel_link_casing:"#fcfcfc",tunnel_major_casing:"#fcfcfc",tunnel_highway_casing:"#fcfcfc",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",pier:"#efefef",buildings:"#efefef",minor_service_casing:"#ffffff",minor_casing:"#ffffff",link_casing:"#ffffff",major_casing_late:"#ffffff",highway_casing_late:"#ffffff",other:"#f5f5f5",minor_service:"#f5f5f5",minor_a:"#ebebeb",minor_b:"#f5f5f5",link:"#ebebeb",major_casing_early:"#ffffff",major:"#ebebeb",highway_casing_early:"#ffffff",highway:"#ebebeb",railway:"#d6d6d6",boundaries:"#adadad",bridges_other_casing:"#ffffff",bridges_minor_casing:"#ffffff",bridges_link_casing:"#ffffff",bridges_major_casing:"#ffffff",bridges_highway_casing:"#ffffff",bridges_other:"#f5f5f5",bridges_minor:"#f5f5f5",bridges_link:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#adadad",roads_label_minor_halo:"#ffffff",roads_label_major:"#999999",roads_label_major_halo:"#ffffff",ocean_label:"#adadad",subplace_label:"#8f8f8f",subplace_label_halo:"#ffffff",city_label:"#5c5c5c",city_label_halo:"#ffffff",state_label:"#b3b3b3",state_label_halo:"#ffffff",country_label:"#b8b8b8",address_label:"#adadad",address_label_halo:"#ffffff"},Wq={background:"#a3a3a3",earth:"#cccccc",park_a:"#c2c2c2",park_b:"#c2c2c2",hospital:"#d0d0d0",industrial:"#c6c6c6",school:"#d0d0d0",wood_a:"#c2c2c2",wood_b:"#c2c2c2",pedestrian:"#c4c4c4",scrub_a:"#c2c2c2",scrub_b:"#c2c2c2",glacier:"#d2d2d2",sand:"#d2d2d2",beach:"#d2d2d2",aerodrome:"#c9c9c9",runway:"#f5f5f5",water:"#a3a3a3",zoo:"#c7c7c7",military:"#bfbfbf",tunnel_other_casing:"#b8b8b8",tunnel_minor_casing:"#b8b8b8",tunnel_link_casing:"#b8b8b8",tunnel_major_casing:"#b8b8b8",tunnel_highway_casing:"#b8b8b8",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",pier:"#b8b8b8",buildings:"#e0e0e0",minor_service_casing:"#cccccc",minor_casing:"#cccccc",link_casing:"#cccccc",major_casing_late:"#cccccc",highway_casing_late:"#cccccc",other:"#e0e0e0",minor_service:"#e0e0e0",minor_a:"#ebebeb",minor_b:"#e0e0e0",link:"#ebebeb",major_casing_early:"#cccccc",major:"#ebebeb",highway_casing_early:"#cccccc",highway:"#ebebeb",railway:"#f5f5f5",boundaries:"#5c5c5c",bridges_other_casing:"#cccccc",bridges_minor_casing:"#cccccc",bridges_link_casing:"#cccccc",bridges_major_casing:"#cccccc",bridges_highway_casing:"#cccccc",bridges_other:"#e0e0e0",bridges_minor:"#e0e0e0",bridges_link:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#999999",roads_label_minor_halo:"#e0e0e0",roads_label_major:"#8f8f8f",roads_label_major_halo:"#ebebeb",ocean_label:"#7a7a7a",subplace_label:"#7a7a7a",subplace_label_halo:"#cccccc",city_label:"#474747",city_label_halo:"#cccccc",state_label:"#999999",state_label_halo:"#cccccc",country_label:"#858585",address_label:"#999999",address_label_halo:"#e0e0e0"},Xq={background:"#2b2b2b",earth:"#141414",park_a:"#181818",park_b:"#181818",hospital:"#1d1d1d",industrial:"#101010",school:"#111111",wood_a:"#1a1a1a",wood_b:"#1a1a1a",pedestrian:"#191919",scrub_a:"#1c1c1c",scrub_b:"#1c1c1c",glacier:"#191919",sand:"#161616",beach:"#1f1f1f",aerodrome:"#191919",runway:"#323232",water:"#333333",zoo:"#191919",military:"#121212",tunnel_other_casing:"#101010",tunnel_minor_casing:"#101010",tunnel_link_casing:"#101010",tunnel_major_casing:"#101010",tunnel_highway_casing:"#101010",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",pier:"#0a0a0a",buildings:"#0a0a0a",minor_service_casing:"#141414",minor_casing:"#141414",link_casing:"#141414",major_casing_late:"#141414",highway_casing_late:"#141414",other:"#1f1f1f",minor_service:"#1f1f1f",minor_a:"#292929",minor_b:"#1f1f1f",link:"#1f1f1f",major_casing_early:"#141414",major:"#292929",highway_casing_early:"#141414",highway:"#292929",railway:"#292929",boundaries:"#707070",bridges_other_casing:"#141414",bridges_minor_casing:"#141414",bridges_link_casing:"#141414",bridges_major_casing:"#141414",bridges_highway_casing:"#141414",bridges_other:"#1f1f1f",bridges_minor:"#1f1f1f",bridges_link:"#292929",bridges_major:"#292929",bridges_highway:"#292929",roads_label_minor:"#525252",roads_label_minor_halo:"#141414",roads_label_major:"#5c5c5c",roads_label_major_halo:"#141414",ocean_label:"#707070",subplace_label:"#5c5c5c",subplace_label_halo:"#141414",city_label:"#999999",city_label_halo:"#141414",state_label:"#3d3d3d",state_label_halo:"#141414",country_label:"#707070",address_label:"#525252",address_label_halo:"#141414"};function qq(e){switch(e){case"light":return Nq;case"dark":return Uq;case"white":return Hq;case"grayscale":return Wq;case"black":return Xq}throw new Error("Flavor not found")}ko(qq,"namedFlavor");function lM(e,t,i){let a=[];return i!=null&&i.labelsOnly||(a=aM(e,t)),i!=null&&i.lang&&(a=a.concat(oM(e,t,i.lang))),a}ko(lM,"layers");var Lm,uv,_8;function Cb(e,t){if(!Lm)Lm=t;else if(!uv)uv=t;else{var i="var sharedChunk = {}; ("+Lm+")(sharedChunk); ("+uv+")(sharedChunk);",a={};Lm(a),_8=t(a),typeof window<"u"&&(_8.workerUrl=window.URL.createObjectURL(new Blob([i],{type:"text/javascript"})))}}Cb(["exports"],function(e){class t{constructor(U,J){this.start=U,this.end=J,this.points=[],this.append=this.append.bind(this),this.prepend=this.prepend.bind(this)}append(U,J){this.points.push(Math.round(U),Math.round(J))}prepend(U,J){this.points.splice(0,0,Math.round(U),Math.round(J))}lineString(){return this.toArray()}isEmpty(){return this.points.length<2}appendFragment(U){this.points.push(...U.points),this.end=U.end}toArray(){return this.points}}const i=[[],[[[1,2],[0,1]]],[[[2,1],[1,2]]],[[[2,1],[0,1]]],[[[1,0],[2,1]]],[[[1,2],[0,1]],[[1,0],[2,1]]],[[[1,0],[1,2]]],[[[1,0],[0,1]]],[[[0,1],[1,0]]],[[[1,2],[1,0]]],[[[0,1],[1,0]],[[2,1],[1,2]]],[[[2,1],[1,0]]],[[[0,1],[2,1]]],[[[1,2],[2,1]]],[[[0,1],[1,2]]],[]];function a(Y,U,J,ue){return U=U*2+ue[0],J=J*2+ue[1],U+J*(Y+1)*2}function h(Y,U,J){return(U-Y)/(J-Y)}function d(Y,U,J=4096,ue=1){if(!Y)return{};const pe=J/(U.width-1);let Ze,ke,rt,bt,ze,gt;const Ut={},$t=new Map,Mr=new Map;function Wr(gr,lr,Xr){gr[0]===0?Xr(pe*(gt-1),pe*(ze-h(rt,lr,Ze))):gr[0]===2?Xr(pe*gt,pe*(ze-h(bt,lr,ke))):gr[1]===0?Xr(pe*(gt-h(ke,lr,Ze)),pe*(ze-1)):Xr(pe*(gt-h(bt,lr,rt)),pe*ze)}for(ze=1-ue;ze<U.height+ue;ze++){ke=U.get(0,ze-1),bt=U.get(0,ze);let gr=Math.min(ke,bt),lr=Math.max(ke,bt);for(gt=1-ue;gt<U.width+ue;gt++){Ze=ke,rt=bt,ke=U.get(gt,ze-1),bt=U.get(gt,ze);const Xr=gr,ft=lr;if(gr=Math.min(ke,bt),lr=Math.max(ke,bt),isNaN(Ze)||isNaN(ke)||isNaN(bt)||isNaN(rt))continue;const Bt=Math.min(Xr,gr),mr=Math.max(ft,lr),Wt=Math.ceil(Bt/Y)*Y,vi=Math.floor(mr/Y)*Y;for(let Gr=Wt;Gr<=vi;Gr+=Y){const mi=Ze>Gr,gi=ke>Gr,Gi=rt>Gr,Ln=bt>Gr;for(const Ei of i[(mi?8:0)|(gi?4:0)|(Ln?2:0)|(Gi?1:0)]){let on=$t.get(Gr);on||$t.set(Gr,on=new Map);let zn=Mr.get(Gr);zn||Mr.set(Gr,zn=new Map);const ti=Ei[0],ln=Ei[1],pn=a(U.width,gt,ze,ti),Vi=a(U.width,gt,ze,ln);let di,fa;if(di=zn.get(pn))if(zn.delete(pn),fa=on.get(Vi))if(on.delete(Vi),di===fa){if(Wr(ln,Gr,di.append),!di.isEmpty()){let Kn=Ut[Gr];Kn||(Ut[Gr]=Kn=[]),Kn.push(di.lineString())}}else di.appendFragment(fa),zn.set(di.end=fa.end,di);else Wr(ln,Gr,di.append),zn.set(di.end=Vi,di);else if(di=on.get(Vi))on.delete(Vi),Wr(ti,Gr,di.prepend),on.set(di.start=pn,di);else{const Kn=new t(pn,Vi);Wr(ti,Gr,Kn.append),Wr(ln,Gr,Kn.append),on.set(pn,Kn),zn.set(Vi,Kn)}}}}}for(const[gr,lr]of $t.entries()){let Xr=null;for(const ft of lr.values())ft.isEmpty()||(Xr==null&&(Xr=Ut[gr]||(Ut[gr]=[])),Xr.push(ft.lineString()))}return Ut}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function p(Y,U){var J={};for(var ue in Y)Object.prototype.hasOwnProperty.call(Y,ue)&&U.indexOf(ue)<0&&(J[ue]=Y[ue]);if(Y!=null&&typeof Object.getOwnPropertySymbols=="function")for(var pe=0,ue=Object.getOwnPropertySymbols(Y);pe<ue.length;pe++)U.indexOf(ue[pe])<0&&Object.prototype.propertyIsEnumerable.call(Y,ue[pe])&&(J[ue[pe]]=Y[ue[pe]]);return J}function s(Y,U,J,ue){function pe(Ze){return Ze instanceof J?Ze:new J(function(ke){ke(Ze)})}return new(J||(J=Promise))(function(Ze,ke){function rt(gt){try{ze(ue.next(gt))}catch(Ut){ke(Ut)}}function bt(gt){try{ze(ue.throw(gt))}catch(Ut){ke(Ut)}}function ze(gt){gt.done?Ze(gt.value):pe(gt.value).then(rt,bt)}ze((ue=ue.apply(Y,U||[])).next())})}function w(Y){const U=Object.entries(Y);return U.sort(([J],[ue])=>J<ue?-1:J>ue?1:0),U}function A(Y){return w(Y).map(([U,J])=>[U,...typeof J=="number"?[J]:J].join("*")).join("~")}function z(Y){return Object.fromEntries(Y.split("~").map(U=>U.split("*").map(Number)).map(([U,...J])=>[U,J]))}function B(Y){var{thresholds:U}=Y,J=p(Y,["thresholds"]);return w(Object.assign({thresholds:A(U)},J)).map(([ue,pe])=>`${encodeURIComponent(ue)}=${encodeURIComponent(pe)}`).join("&")}function D(Y){return Object.fromEntries(Y.replace(/^.*\?/,"").split("&").map(U=>{const J=U.split("=").map(decodeURIComponent),ue=J[0];let pe=J[1];switch(ue){case"thresholds":pe=z(pe);break;case"extent":case"multiplier":case"overzoom":case"buffer":pe=Number(pe)}return[ue,pe]}))}function V(Y){return w(Y).map(([U,J])=>`${encodeURIComponent(U)}=${encodeURIComponent(J)}`).join(",")}function W(Y,U){const{thresholds:J}=Y,ue=p(Y,["thresholds"]);let pe=[],Ze=-1/0;return Object.entries(J).forEach(([ke,rt])=>{const bt=Number(ke);bt<=U&&bt>Ze&&(Ze=bt,pe=typeof rt=="number"?[rt]:rt)}),Object.assign({levels:pe},ue)}function S(Y){const U=new ArrayBuffer(Y.byteLength);return new Uint8Array(U).set(new Uint8Array(Y)),U}function j(Y,U){return Y.then(J=>{var{data:ue}=J,pe=p(J,["data"]);let Ze=ue;return U&&(Ze=new Float32Array(ue.length),Ze.set(ue)),Object.assign(Object.assign({},pe),{data:Ze,transferrables:[Ze.buffer]})})}function ne(Y){return Y.then(({arrayBuffer:U})=>{const J=S(U);return{arrayBuffer:J,transferrables:[J]}})}let te=null;function Q(){return te==null&&(te=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),te||!1}let N=null;function re(){if(N==null&&(N=!1,Q()&&typeof VideoFrame<"u")){const J=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(J){for(let pe=0;pe<5*5;pe++){const Ze=pe*4;J.fillStyle=`rgb(${Ze},${Ze+1},${Ze+2})`,J.fillRect(pe%5,Math.floor(pe/5),1,1)}const ue=J.getImageData(0,0,5,5).data;for(let pe=0;pe<5*5*4;pe++)if(pe%4!==3&&ue[pe]!==pe){N=!0;break}}}return N||!1}function oe(Y,U,J){let ue=()=>{};const pe=setTimeout(()=>{ue(new Error("timed out")),J==null||J.abort()},Y);ve(J,()=>{ue(new Error("aborted")),clearTimeout(pe)});const Ze=new Promise((ke,rt)=>{ue=rt});return Promise.race([Ze,U.finally(()=>clearTimeout(pe))])}function ve(Y,U){U&&(Y==null||Y.signal.addEventListener("abort",U))}function Pe(Y){var U;return!!(!((U=Y==null?void 0:Y.signal)===null||U===void 0)&&U.aborted)}let $=0;class le{constructor(U=100){this.size=()=>this.items.size,this.get=(J,ue,pe)=>{let Ze=this.items.get(J);if(Ze)Ze.lastUsed=++$,Ze.waiting++;else{const ze=new AbortController,gt=ue(J,ze);Ze={abortController:ze,item:gt,lastUsed:++$,waiting:1},this.items.set(J,Ze),this.prune()}const ke=this.items,rt=Ze.item.then(ze=>ze,ze=>(ke.delete(J),Promise.reject(ze)));let bt=!1;return ve(pe,()=>{var ze;Ze&&Ze.abortController&&!bt&&(bt=!0,--Ze.waiting<=0&&((ze=Ze.abortController)===null||ze===void 0||ze.abort(),ke.delete(J)))}),rt},this.clear=()=>this.items.clear(),this.maxSize=U,this.items=new Map}prune(){if(this.items.size>this.maxSize){let U,J=1/0;this.items.forEach((ue,pe)=>{ue.lastUsed<J&&(J=ue.lastUsed,U=pe)}),typeof U<"u"&&this.items.delete(U)}}}let Me,Ve,Be,q;function me(Y,U,J){return s(this,void 0,void 0,function*(){const ue=yield createImageBitmap(Y);return Pe(J)?null:Ee(ue,U)})}function Ee(Y,U){return Me||(Me=new OffscreenCanvas(Y.width,Y.height),Ve=Me.getContext("2d",{willReadFrequently:!0})),We(Y,U,Me,Ve)}function Ne(Y,U,J){return s(this,void 0,void 0,function*(){var ue,pe,Ze;const ke=yield createImageBitmap(Y);if(Pe(J))return null;const rt=new VideoFrame(ke,{timestamp:0});try{if(!(((ue=rt==null?void 0:rt.format)===null||ue===void 0?void 0:ue.startsWith("BGR"))||((pe=rt==null?void 0:rt.format)===null||pe===void 0?void 0:pe.startsWith("RGB"))))throw new Error(`Unrecognized format: ${rt==null?void 0:rt.format}`);const ze=(Ze=rt==null?void 0:rt.format)===null||Ze===void 0?void 0:Ze.startsWith("BGR"),gt=rt.allocationSize(),Ut=new Uint8ClampedArray(gt);if(yield rt.copyTo(Ut),ze)for(let $t=0;$t<Ut.length;$t+=4){const Mr=Ut[$t];Ut[$t]=Ut[$t+2],Ut[$t+2]=Mr}return ot(ke.width,ke.height,U,Ut)}catch{return Pe(J)?null:Ee(ke,U)}finally{rt.close()}})}function $e(Y,U,J){return s(this,void 0,void 0,function*(){Be||(Be=document.createElement("canvas"),q=Be.getContext("2d",{willReadFrequently:!0}));const ue=new Image;ve(J,()=>ue.src="");const pe=yield new Promise((Ze,ke)=>{ue.onload=()=>{Pe(J)||Ze(ue),URL.revokeObjectURL(ue.src),ue.onload=null},ue.onerror=()=>ke(new Error("Could not load image.")),ue.src=Y.size?URL.createObjectURL(Y):""});return We(pe,U,Be,q)})}function ye(Y,U,J){return self.actor.send("decodeImage",[],J,void 0,Y,U)}function ge(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}const Ye=re()?Ne:Q()?me:ge()?ye:$e;function We(Y,U,J,ue){if(J.width=Y.width,J.height=Y.height,!ue)throw new Error("failed to get context");ue.drawImage(Y,0,0,Y.width,Y.height);const pe=ue.getImageData(0,0,Y.width,Y.height).data;return ot(Y.width,Y.height,U,pe)}function ot(Y,U,J,ue){const pe=J==="mapbox"?(ke,rt,bt)=>-1e4+(ke*256*256+rt*256+bt)*.1:(ke,rt,bt)=>ke*256+rt+bt/256-32768,Ze=new Float32Array(Y*U);for(let ke=0;ke<ue.length;ke+=4)Ze[ke/4]=pe(ue[ke],ue[ke+1],ue[ke+2]);return{width:Y,height:U,data:Ze}}const Se=-12e3,Ce=9e3;function It(Y){return!isNaN(Y)&&Y>=Se&&Y<=Ce}class Lt{constructor(U,J,ue){this.split=(pe,Ze,ke)=>{if(pe===0)return this;const rt=1<<pe,bt=Ze*this.width/rt,ze=ke*this.height/rt;return new Lt(this.width/rt,this.height/rt,(gt,Ut)=>this.get(gt+bt,Ut+ze))},this.subsamplePixelCenters=pe=>{const Ze=(bt,ze,gt)=>isNaN(bt)?ze:isNaN(ze)?bt:bt+(ze-bt)*gt;if(pe<=1)return this;const ke=.5-1/(2*pe),rt=(bt,ze)=>{const gt=bt/pe-ke,Ut=ze/pe-ke,$t=Math.floor(gt),Mr=Math.floor(Ut),Wr=this.get($t,Mr),gr=this.get($t+1,Mr),lr=this.get($t,Mr+1),Xr=this.get($t+1,Mr+1),ft=gt-$t,Bt=Ut-Mr,mr=Ze(Wr,gr,ft),Wt=Ze(lr,Xr,ft);return Ze(mr,Wt,Bt)};return new Lt(this.width*pe,this.height*pe,rt)},this.averagePixelCentersToGrid=(pe=1)=>new Lt(this.width+1,this.height+1,(Ze,ke)=>{let rt=0,bt=0,ze=0;for(let gt=Ze-pe;gt<Ze+pe;gt++)for(let Ut=ke-pe;Ut<ke+pe;Ut++)isNaN(ze=this.get(gt,Ut))||(bt++,rt+=ze);return bt===0?NaN:rt/bt}),this.scaleElevation=pe=>pe===1?this:new Lt(this.width,this.height,(Ze,ke)=>this.get(Ze,ke)*pe),this.materialize=(pe=2)=>{const Ze=this.width+2*pe,ke=new Float32Array(Ze*(this.height+2*pe));let rt=0;for(let bt=-pe;bt<this.height+pe;bt++)for(let ze=-pe;ze<this.width+pe;ze++)ke[rt++]=this.get(ze,bt);return new Lt(this.width,this.height,(bt,ze)=>ke[(ze+pe)*Ze+bt+pe])},this.get=ue,this.width=U,this.height=J}static fromRawDem(U){return new Lt(U.width,U.height,(J,ue)=>{const pe=U.data[ue*U.width+J];return It(pe)?pe:NaN})}static combineNeighbors(U){if(U.length!==9)throw new Error("Must include a tile plus 8 neighbors");const J=U[4];if(!J)return;const ue=J.width,pe=J.height;return new Lt(ue,pe,(Ze,ke)=>{let rt=0;ke<0?ke+=pe:ke<pe?rt+=3:(ke-=pe,rt+=6),Ze<0?Ze+=ue:Ze<ue?rt+=1:(Ze-=ue,rt+=2);const bt=U[rt];return bt?bt.get(Ze,ke):NaN})}}const Xt=65536*65536,Jt=1/Xt,dr=12,zt=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),Zt=0,Ot=1,Yt=2,Ar=5;class yr{constructor(U=new Uint8Array(16)){this.buf=ArrayBuffer.isView(U)?U:new Uint8Array(U),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(U,J,ue=this.length){for(;this.pos<ue;){const pe=this.readVarint(),Ze=pe>>3,ke=this.pos;this.type=pe&7,U(Ze,J,this),this.pos===ke&&this.skip(pe)}return J}readMessage(U,J){return this.readFields(U,J,this.readVarint()+this.pos)}readFixed32(){const U=this.dataView.getUint32(this.pos,!0);return this.pos+=4,U}readSFixed32(){const U=this.dataView.getInt32(this.pos,!0);return this.pos+=4,U}readFixed64(){const U=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Xt;return this.pos+=8,U}readSFixed64(){const U=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Xt;return this.pos+=8,U}readFloat(){const U=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,U}readDouble(){const U=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,U}readVarint(U){const J=this.buf;let ue,pe;return pe=J[this.pos++],ue=pe&127,pe<128||(pe=J[this.pos++],ue|=(pe&127)<<7,pe<128)||(pe=J[this.pos++],ue|=(pe&127)<<14,pe<128)||(pe=J[this.pos++],ue|=(pe&127)<<21,pe<128)?ue:(pe=J[this.pos],ue|=(pe&15)<<28,kr(ue,U,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const U=this.readVarint();return U%2===1?(U+1)/-2:U/2}readBoolean(){return!!this.readVarint()}readString(){const U=this.readVarint()+this.pos,J=this.pos;return this.pos=U,U-J>=dr&&zt?zt.decode(this.buf.subarray(J,U)):Te(this.buf,J,U)}readBytes(){const U=this.readVarint()+this.pos,J=this.buf.subarray(this.pos,U);return this.pos=U,J}readPackedVarint(U=[],J){const ue=this.readPackedEnd();for(;this.pos<ue;)U.push(this.readVarint(J));return U}readPackedSVarint(U=[]){const J=this.readPackedEnd();for(;this.pos<J;)U.push(this.readSVarint());return U}readPackedBoolean(U=[]){const J=this.readPackedEnd();for(;this.pos<J;)U.push(this.readBoolean());return U}readPackedFloat(U=[]){const J=this.readPackedEnd();for(;this.pos<J;)U.push(this.readFloat());return U}readPackedDouble(U=[]){const J=this.readPackedEnd();for(;this.pos<J;)U.push(this.readDouble());return U}readPackedFixed32(U=[]){const J=this.readPackedEnd();for(;this.pos<J;)U.push(this.readFixed32());return U}readPackedSFixed32(U=[]){const J=this.readPackedEnd();for(;this.pos<J;)U.push(this.readSFixed32());return U}readPackedFixed64(U=[]){const J=this.readPackedEnd();for(;this.pos<J;)U.push(this.readFixed64());return U}readPackedSFixed64(U=[]){const J=this.readPackedEnd();for(;this.pos<J;)U.push(this.readSFixed64());return U}readPackedEnd(){return this.type===Yt?this.readVarint()+this.pos:this.pos+1}skip(U){const J=U&7;if(J===Zt)for(;this.buf[this.pos++]>127;);else if(J===Yt)this.pos=this.readVarint()+this.pos;else if(J===Ar)this.pos+=4;else if(J===Ot)this.pos+=8;else throw new Error(`Unimplemented type: ${J}`)}writeTag(U,J){this.writeVarint(U<<3|J)}realloc(U){let J=this.length||16;for(;J<this.pos+U;)J*=2;if(J!==this.length){const ue=new Uint8Array(J);ue.set(this.buf),this.buf=ue,this.dataView=new DataView(ue.buffer),this.length=J}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(U){this.realloc(4),this.dataView.setInt32(this.pos,U,!0),this.pos+=4}writeSFixed32(U){this.realloc(4),this.dataView.setInt32(this.pos,U,!0),this.pos+=4}writeFixed64(U){this.realloc(8),this.dataView.setInt32(this.pos,U&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(U*Jt),!0),this.pos+=8}writeSFixed64(U){this.realloc(8),this.dataView.setInt32(this.pos,U&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(U*Jt),!0),this.pos+=8}writeVarint(U){if(U=+U||0,U>268435455||U<0){Dr(U,this);return}this.realloc(4),this.buf[this.pos++]=U&127|(U>127?128:0),!(U<=127)&&(this.buf[this.pos++]=(U>>>=7)&127|(U>127?128:0),!(U<=127)&&(this.buf[this.pos++]=(U>>>=7)&127|(U>127?128:0),!(U<=127)&&(this.buf[this.pos++]=U>>>7&127)))}writeSVarint(U){this.writeVarint(U<0?-U*2-1:U*2)}writeBoolean(U){this.writeVarint(+U)}writeString(U){U=String(U),this.realloc(U.length*4),this.pos++;const J=this.pos;this.pos=Ge(this.buf,U,this.pos);const ue=this.pos-J;ue>=128&&ui(J,ue,this),this.pos=J-1,this.writeVarint(ue),this.pos+=ue}writeFloat(U){this.realloc(4),this.dataView.setFloat32(this.pos,U,!0),this.pos+=4}writeDouble(U){this.realloc(8),this.dataView.setFloat64(this.pos,U,!0),this.pos+=8}writeBytes(U){const J=U.length;this.writeVarint(J),this.realloc(J);for(let ue=0;ue<J;ue++)this.buf[this.pos++]=U[ue]}writeRawMessage(U,J){this.pos++;const ue=this.pos;U(J,this);const pe=this.pos-ue;pe>=128&&ui(ue,pe,this),this.pos=ue-1,this.writeVarint(pe),this.pos+=pe}writeMessage(U,J,ue){this.writeTag(U,Yt),this.writeRawMessage(J,ue)}writePackedVarint(U,J){J.length&&this.writeMessage(U,dn,J)}writePackedSVarint(U,J){J.length&&this.writeMessage(U,Xi,J)}writePackedBoolean(U,J){J.length&&this.writeMessage(U,xi,J)}writePackedFloat(U,J){J.length&&this.writeMessage(U,fn,J)}writePackedDouble(U,J){J.length&&this.writeMessage(U,Pr,J)}writePackedFixed32(U,J){J.length&&this.writeMessage(U,Fi,J)}writePackedSFixed32(U,J){J.length&&this.writeMessage(U,ct,J)}writePackedFixed64(U,J){J.length&&this.writeMessage(U,be,J)}writePackedSFixed64(U,J){J.length&&this.writeMessage(U,we,J)}writeBytesField(U,J){this.writeTag(U,Yt),this.writeBytes(J)}writeFixed32Field(U,J){this.writeTag(U,Ar),this.writeFixed32(J)}writeSFixed32Field(U,J){this.writeTag(U,Ar),this.writeSFixed32(J)}writeFixed64Field(U,J){this.writeTag(U,Ot),this.writeFixed64(J)}writeSFixed64Field(U,J){this.writeTag(U,Ot),this.writeSFixed64(J)}writeVarintField(U,J){this.writeTag(U,Zt),this.writeVarint(J)}writeSVarintField(U,J){this.writeTag(U,Zt),this.writeSVarint(J)}writeStringField(U,J){this.writeTag(U,Yt),this.writeString(J)}writeFloatField(U,J){this.writeTag(U,Ar),this.writeFloat(J)}writeDoubleField(U,J){this.writeTag(U,Ot),this.writeDouble(J)}writeBooleanField(U,J){this.writeVarintField(U,+J)}}function kr(Y,U,J){const ue=J.buf;let pe,Ze;if(Ze=ue[J.pos++],pe=(Ze&112)>>4,Ze<128||(Ze=ue[J.pos++],pe|=(Ze&127)<<3,Ze<128)||(Ze=ue[J.pos++],pe|=(Ze&127)<<10,Ze<128)||(Ze=ue[J.pos++],pe|=(Ze&127)<<17,Ze<128)||(Ze=ue[J.pos++],pe|=(Ze&127)<<24,Ze<128)||(Ze=ue[J.pos++],pe|=(Ze&1)<<31,Ze<128))return Tr(Y,pe,U);throw new Error("Expected varint not more than 10 bytes")}function Tr(Y,U,J){return J?U*4294967296+(Y>>>0):(U>>>0)*4294967296+(Y>>>0)}function Dr(Y,U){let J,ue;if(Y>=0?(J=Y%4294967296|0,ue=Y/4294967296|0):(J=~(-Y%4294967296),ue=~(-Y/4294967296),J^4294967295?J=J+1|0:(J=0,ue=ue+1|0)),Y>=18446744073709552e3||Y<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");U.realloc(10),hi(J,ue,U),ni(ue,U)}function hi(Y,U,J){J.buf[J.pos++]=Y&127|128,Y>>>=7,J.buf[J.pos++]=Y&127|128,Y>>>=7,J.buf[J.pos++]=Y&127|128,Y>>>=7,J.buf[J.pos++]=Y&127|128,Y>>>=7,J.buf[J.pos]=Y&127}function ni(Y,U){const J=(Y&7)<<4;U.buf[U.pos++]|=J|((Y>>>=3)?128:0),Y&&(U.buf[U.pos++]=Y&127|((Y>>>=7)?128:0),Y&&(U.buf[U.pos++]=Y&127|((Y>>>=7)?128:0),Y&&(U.buf[U.pos++]=Y&127|((Y>>>=7)?128:0),Y&&(U.buf[U.pos++]=Y&127|((Y>>>=7)?128:0),Y&&(U.buf[U.pos++]=Y&127)))))}function ui(Y,U,J){const ue=U<=16383?1:U<=2097151?2:U<=268435455?3:Math.floor(Math.log(U)/(Math.LN2*7));J.realloc(ue);for(let pe=J.pos-1;pe>=Y;pe--)J.buf[pe+ue]=J.buf[pe]}function dn(Y,U){for(let J=0;J<Y.length;J++)U.writeVarint(Y[J])}function Xi(Y,U){for(let J=0;J<Y.length;J++)U.writeSVarint(Y[J])}function fn(Y,U){for(let J=0;J<Y.length;J++)U.writeFloat(Y[J])}function Pr(Y,U){for(let J=0;J<Y.length;J++)U.writeDouble(Y[J])}function xi(Y,U){for(let J=0;J<Y.length;J++)U.writeBoolean(Y[J])}function Fi(Y,U){for(let J=0;J<Y.length;J++)U.writeFixed32(Y[J])}function ct(Y,U){for(let J=0;J<Y.length;J++)U.writeSFixed32(Y[J])}function be(Y,U){for(let J=0;J<Y.length;J++)U.writeFixed64(Y[J])}function we(Y,U){for(let J=0;J<Y.length;J++)U.writeSFixed64(Y[J])}function Te(Y,U,J){let ue="",pe=U;for(;pe<J;){const Ze=Y[pe];let ke=null,rt=Ze>239?4:Ze>223?3:Ze>191?2:1;if(pe+rt>J)break;let bt,ze,gt;rt===1?Ze<128&&(ke=Ze):rt===2?(bt=Y[pe+1],(bt&192)===128&&(ke=(Ze&31)<<6|bt&63,ke<=127&&(ke=null))):rt===3?(bt=Y[pe+1],ze=Y[pe+2],(bt&192)===128&&(ze&192)===128&&(ke=(Ze&15)<<12|(bt&63)<<6|ze&63,(ke<=2047||ke>=55296&&ke<=57343)&&(ke=null))):rt===4&&(bt=Y[pe+1],ze=Y[pe+2],gt=Y[pe+3],(bt&192)===128&&(ze&192)===128&&(gt&192)===128&&(ke=(Ze&15)<<18|(bt&63)<<12|(ze&63)<<6|gt&63,(ke<=65535||ke>=1114112)&&(ke=null))),ke===null?(ke=65533,rt=1):ke>65535&&(ke-=65536,ue+=String.fromCharCode(ke>>>10&1023|55296),ke=56320|ke&1023),ue+=String.fromCharCode(ke),pe+=rt}return ue}function Ge(Y,U,J){for(let ue=0,pe,Ze;ue<U.length;ue++){if(pe=U.charCodeAt(ue),pe>55295&&pe<57344)if(Ze)if(pe<56320){Y[J++]=239,Y[J++]=191,Y[J++]=189,Ze=pe;continue}else pe=Ze-55296<<10|pe-56320|65536,Ze=null;else{pe>56319||ue+1===U.length?(Y[J++]=239,Y[J++]=191,Y[J++]=189):Ze=pe;continue}else Ze&&(Y[J++]=239,Y[J++]=191,Y[J++]=189,Ze=null);pe<128?Y[J++]=pe:(pe<2048?Y[J++]=pe>>6|192:(pe<65536?Y[J++]=pe>>12|224:(Y[J++]=pe>>18|240,Y[J++]=pe>>12&63|128),Y[J++]=pe>>6&63|128),Y[J++]=pe&63|128)}return J}var He;(function(Y){Y[Y.UNKNOWN=0]="UNKNOWN",Y[Y.POINT=1]="POINT",Y[Y.LINESTRING=2]="LINESTRING",Y[Y.POLYGON=3]="POLYGON"})(He||(He={}));function nt(Y){const U=new yr;for(const J in Y.layers){const ue=Y.layers[J];ue.extent||(ue.extent=Y.extent),U.writeMessage(3,yt,Object.assign(Object.assign({},ue),{id:J}))}return U.finish()}function yt(Y,U){if(!U)throw new Error("pbf undefined");U.writeVarintField(15,2),U.writeStringField(1,Y.id||""),U.writeVarintField(5,Y.extent||4096);const J={keys:[],values:[],keycache:{},valuecache:{}};for(const ue of Y.features)J.feature=ue,U.writeMessage(2,ut,J);for(const ue of J.keys)U.writeStringField(3,ue);for(const ue of J.values)U.writeMessage(4,st,ue)}function ut(Y,U){const J=Y.feature;if(!J||!U)throw new Error;U.writeMessage(2,St,Y),U.writeVarintField(3,J.type),U.writeMessage(4,sr,J)}function St(Y,U){const J=Y.feature;if(!J||!U)throw new Error;const ue=Y.keys,pe=Y.values,Ze=Y.keycache,ke=Y.valuecache;for(const rt in J.properties){let bt=J.properties[rt],ze=Ze[rt];if(bt===null)continue;typeof ze>"u"&&(ue.push(rt),ze=ue.length-1,Ze[rt]=ze),U.writeVarint(ze);const gt=typeof bt;gt!=="string"&&gt!=="boolean"&&gt!=="number"&&(bt=JSON.stringify(bt));const Ut=`${gt}:${bt}`;let $t=ke[Ut];typeof $t>"u"&&(pe.push(bt),$t=pe.length-1,ke[Ut]=$t),U.writeVarint($t)}}function Vt(Y,U){return(U<<3)+(Y&7)}function Ft(Y){return Y<<1^Y>>31}function sr(Y,U){if(!U)throw new Error;const J=Y.geometry,ue=Y.type;let pe=0,Ze=0;for(const ke of J){let rt=1;ue===He.POINT&&(rt=ke.length/2),U.writeVarint(Vt(1,rt));const bt=ke.length/2,ze=ue===He.POLYGON?bt-1:bt;for(let gt=0;gt<ze;gt++){gt===1&&ue!==1&&U.writeVarint(Vt(2,ze-1));const Ut=ke[gt*2]-pe,$t=ke[gt*2+1]-Ze;U.writeVarint(Ft(Ut)),U.writeVarint(Ft($t)),pe+=Ut,Ze+=$t}ue===He.POLYGON&&U.writeVarint(Vt(7,1))}}function st(Y,U){if(!U)throw new Error;typeof Y=="string"?U.writeStringField(1,Y):typeof Y=="boolean"?U.writeBooleanField(7,Y):typeof Y=="number"&&(Y%1!==0?U.writeDoubleField(3,Y):Y<0?U.writeSVarintField(6,Y):U.writeVarintField(5,Y))}const qe=typeof performance<"u"?performance:void 0,Ct=qe?qe.timeOrigin||new Date().getTime()-qe.now():new Date().getTime();function wt(Y){var U;return JSON.parse(JSON.stringify(((U=qe==null?void 0:qe.getEntriesByName)===null||U===void 0?void 0:U.call(qe,Y))||[]))}function jt(){return qe?qe.now():new Date().getTime()}function ie(Y){const U=[];for(const J of Y)U.push(...J);return U}class k{constructor(U){this.marks={},this.urls=[],this.fetched=[],this.resources=[],this.tilesFetched=0,this.timeOrigin=Ct,this.finish=J=>{this.markFinish();const ue=bt=>{const ze=this.marks[bt]||[],gt=Math.max(...ze.map($t=>Math.max(...$t))),Ut=Math.min(...ze.map($t=>Math.min(...$t)));return Number.isFinite(gt)?gt-Ut:void 0},pe=ue("main")||0,Ze=ue("fetch"),ke=ue("decode"),rt=ue("isoline");return{url:J,tilesUsed:this.tilesFetched,origin:this.timeOrigin,marks:this.marks,resources:[...this.resources,...ie(this.fetched.map(wt))],duration:pe,fetch:Ze,decode:ke,process:rt,wait:pe-(Ze||0)-(ke||0)-(rt||0)}},this.error=J=>Object.assign(Object.assign({},this.finish(J)),{error:!0}),this.marker=J=>{var ue;this.marks[J]||(this.marks[J]=[]);const pe=[jt()];return(ue=this.marks[J])===null||ue===void 0||ue.push(pe),()=>pe.push(jt())},this.useTile=J=>{this.urls.indexOf(J)<0&&(this.urls.push(J),this.tilesFetched++)},this.fetchTile=J=>{this.fetched.indexOf(J)<0&&this.fetched.push(J)},this.addAll=J=>{var ue;this.tilesFetched+=J.tilesUsed;const pe=J.origin-this.timeOrigin;for(const Ze in J.marks){const ke=Ze;(this.marks[ke]||(this.marks[ke]=[])).push(...((ue=J.marks[ke])===null||ue===void 0?void 0:ue.map(bt=>bt.map(ze=>ze+pe)))||[])}this.resources.push(...J.resources.map(Ze=>M(Ze,pe)))},this.markFinish=this.marker(U)}}const C=/(Start$|End$|^start|^end)/;function M(Y,U){const J={};for(const ue in Y)Y[ue]!==0&&C.test(ue)?J[ue]=Number(Y[ue])+U:J[ue]=Y[ue];return J}const P=(Y,U)=>s(void 0,void 0,void 0,function*(){const J={signal:U.signal},ue=yield fetch(Y,J);if(!ue.ok)throw new Error(`Bad response: ${ue.status} for ${Y}`);return{data:yield ue.blob(),expires:ue.headers.get("expires")||void 0,cacheControl:ue.headers.get("cache-control")||void 0}});class O{constructor(U){this.loaded=Promise.resolve(),this.fetchAndParseTile=(J,ue,pe,Ze,ke)=>{const rt=this,bt=this.demUrlPattern.replace("{z}",J.toString()).replace("{x}",ue.toString()).replace("{y}",pe.toString());return ke==null||ke.useTile(bt),this.parsedCache.get(bt,(ze,gt)=>s(this,void 0,void 0,function*(){const Ut=yield rt.fetchTile(J,ue,pe,gt,ke);if(Pe(gt))throw new Error("canceled");const $t=rt.decodeImage(Ut.data,rt.encoding,gt),Mr=ke==null?void 0:ke.marker("decode"),Wr=yield $t;return Mr==null||Mr(),Wr}),Ze)},this.tileCache=new le(U.cacheSize),this.parsedCache=new le(U.cacheSize),this.contourCache=new le(U.cacheSize),this.timeoutMs=U.timeoutMs,this.demUrlPattern=U.demUrlPattern,this.encoding=U.encoding,this.maxzoom=U.maxzoom,this.decodeImage=U.decodeImage||Ye,this.getTile=U.getTile||P}fetchTile(U,J,ue,pe,Ze){const ke=this.demUrlPattern.replace("{z}",U.toString()).replace("{x}",J.toString()).replace("{y}",ue.toString());return Ze==null||Ze.useTile(ke),this.tileCache.get(ke,(rt,bt)=>{Ze==null||Ze.fetchTile(ke);const ze=Ze==null?void 0:Ze.marker("fetch");return oe(this.timeoutMs,this.getTile(ke,bt).finally(()=>ze==null?void 0:ze()),bt)},pe)}fetchDem(U,J,ue,pe,Ze,ke){return s(this,void 0,void 0,function*(){const rt=Math.min(U-(pe.overzoom||0),this.maxzoom),bt=U-rt,ze=1<<bt,gt=Math.floor(J/ze),Ut=Math.floor(ue/ze),$t=yield this.fetchAndParseTile(rt,gt,Ut,Ze,ke);return Lt.fromRawDem($t).split(bt,J%ze,ue%ze)})}fetchContourTile(U,J,ue,pe,Ze,ke){const{levels:rt,multiplier:bt=1,buffer:ze=1,extent:gt=4096,contourLayer:Ut="contours",elevationKey:$t="ele",levelKey:Mr="level",subsampleBelow:Wr=100}=pe;if(!rt||rt.length===0)return Promise.resolve({arrayBuffer:new ArrayBuffer(0)});const gr=[U,J,ue,V(pe)].join("/");return this.contourCache.get(gr,(lr,Xr)=>s(this,void 0,void 0,function*(){const ft=1<<U,Bt=[];for(let gi=ue-1;gi<=ue+1;gi++)for(let Gi=J-1;Gi<=J+1;Gi++)Bt.push(gi<0||gi>=ft?void 0:this.fetchDem(U,(Gi+ft)%ft,gi,pe,Xr,ke));const mr=yield Promise.all(Bt);let Wt=Lt.combineNeighbors(mr);if(!Wt||Pe(Xr))return{arrayBuffer:new Uint8Array().buffer};const vi=ke==null?void 0:ke.marker("isoline");if(Wt.width>=Wr)Wt=Wt.materialize(2);else for(;Wt.width<Wr;)Wt=Wt.subsamplePixelCenters(2).materialize(2);Wt=Wt.averagePixelCentersToGrid().scaleElevation(bt).materialize(1);const Gr=d(rt[0],Wt,gt,ze);vi==null||vi();const mi=nt({extent:gt,layers:{[Ut]:{features:Object.entries(Gr).map(([gi,Gi])=>{const Ln=Number(gi);return{type:He.LINESTRING,geometry:Gi,properties:{[$t]:Ln,[Mr]:Math.max(...rt.map((Ei,on)=>Ln%Ei===0?on:0))}}})}}});return vi==null||vi(),{arrayBuffer:mi.buffer}}),Ze)}}let xe=0;class he{constructor(U,J,ue=2e4){this.callbacks={},this.cancels={},this.dest=U,this.timeoutMs=ue,this.dest.onmessage=pe=>s(this,[pe],void 0,function*({data:Ze}){const ke=Ze;if(ke.type==="cancel"){const rt=this.cancels[ke.id];delete this.cancels[ke.id],rt==null||rt.abort()}else if(ke.type==="response"){const rt=this.callbacks[ke.id];delete this.callbacks[ke.id],rt&&rt(ke.error?new Error(ke.error):void 0,ke.response,ke.timings)}else if(ke.type==="request"){const rt=new k("worker"),bt=J[ke.name],ze=new AbortController,gt=bt.apply(bt,[...ke.args,ze,rt]),Ut=`${ke.name}_${ke.id}`;if(ke.id&&gt){this.cancels[ke.id]=ze;try{const $t=yield gt,Mr=$t==null?void 0:$t.transferrables;this.postMessage({id:ke.id,type:"response",response:$t,timings:rt.finish(Ut)},Mr)}catch($t){this.postMessage({id:ke.id,type:"response",error:($t==null?void 0:$t.toString())||"error",timings:rt.finish(Ut)})}delete this.cancels[ke.id]}}})}postMessage(U,J){this.dest.postMessage(U,J||[])}send(U,J,ue,pe,...Ze){const ke=++xe,rt=new Promise((bt,ze)=>{this.postMessage({id:ke,type:"request",name:U,args:Ze},J),this.callbacks[ke]=(gt,Ut,$t)=>{pe==null||pe.addAll($t),gt?ze(gt):bt(Ut)}});return ve(ue,()=>{delete this.callbacks[ke],this.postMessage({id:ke,type:"cancel"})}),oe(this.timeoutMs,rt,ue)}}e.A=he,e.H=Lt,e.L=O,e.T=k,e._=s,e.a=D,e.b=d,e.c=ot,e.d=Ye,e.e=B,e.f=ne,e.g=W,e.p=j});Cb(["./shared"],function(e){const t=h=>Promise.reject(new Error(`No manager registered for ${h}`));class i{constructor(){this.managers={},this.init=(d,p)=>(this.managers[d.managerId]=new e.L(d),Promise.resolve()),this.fetchTile=(d,p,s,w,A,z)=>{var B;return((B=this.managers[d])===null||B===void 0?void 0:B.fetchTile(p,s,w,A,z))||t(d)},this.fetchAndParseTile=(d,p,s,w,A,z)=>{var B;return e.p(((B=this.managers[d])===null||B===void 0?void 0:B.fetchAndParseTile(p,s,w,A,z))||t(d),!0)},this.fetchContourTile=(d,p,s,w,A,z,B)=>{var D;return e.f(((D=this.managers[d])===null||D===void 0?void 0:D.fetchContourTile(p,s,w,A,z,B))||t(d))}}}const a=typeof self<"u"?self:typeof window<"u"?window:globalThis;a.actor=new e.A(a,new i)});Cb(["./shared"],function(e){const t={workerUrl:""};let i,a=0;class h{constructor(){this.decodeImage=(D,V,W)=>e.p(e.d(D,V,W),!1)}}function d(){if(!i){const B=new Worker(t.workerUrl),D=new h;i=new e.A(B,D)}return i}class p{constructor(D){this.fetchTile=(W,S,j,ne,te)=>this.actor.send("fetchTile",[],ne,te,this.managerId,W,S,j),this.fetchAndParseTile=(W,S,j,ne,te)=>this.actor.send("fetchAndParseTile",[],ne,te,this.managerId,W,S,j),this.fetchContourTile=(W,S,j,ne,te,Q)=>this.actor.send("fetchContourTile",[],te,Q,this.managerId,W,S,j,ne);const V=this.managerId=++a;this.actor=D.actor||d(),this.loaded=this.actor.send("init",[],new AbortController,void 0,Object.assign(Object.assign({},D),{managerId:V}))}}Blob.prototype.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Promise((D,V)=>{const W=new FileReader;W.onload=S=>{var j;return D((j=S.target)===null||j===void 0?void 0:j.result)},W.onerror=V,W.readAsArrayBuffer(this)})});const s=B=>(D,V)=>{if(V instanceof AbortController)return B(D,V);{const W=new AbortController;return B(D,W).then(S=>V(void 0,S.data,S.cacheControl,S.expires),S=>V(S)).catch(S=>V(S)),{cancel:()=>W.abort()}}},w=new Set;class A{constructor({url:D,cacheSize:V=100,id:W="dem",encoding:S="terrarium",maxzoom:j=12,worker:ne=!0,timeoutMs:te=1e4,actor:Q}){this.timingCallbacks=[],this.onTiming=ve=>{this.timingCallbacks.push(ve)},this.setupMaplibre=ve=>{ve.addProtocol(this.sharedDemProtocolId,this.sharedDemProtocol),ve.addProtocol(this.contourProtocolId,this.contourProtocol)},this.sharedDemProtocolV4=(ve,Pe)=>e._(this,void 0,void 0,function*(){const[$,le,Me]=this.parseUrl(ve.url),Ve=new e.T("main");let Be;try{const q=yield this.manager.fetchTile($,le,Me,Pe,Ve);return Be=Ve.finish(ve.url),{data:yield q.data.arrayBuffer(),cacheControl:q.cacheControl,expires:q.expires}}catch(q){throw Be=Ve.error(ve.url),q}finally{this.timingCallbacks.forEach(q=>q(Be))}}),this.contourProtocolV4=(ve,Pe)=>e._(this,void 0,void 0,function*(){const $=new e.T("main");let le;try{const[Me,Ve,Be]=this.parseUrl(ve.url),q=e.a(ve.url),me=yield this.manager.fetchContourTile(Me,Ve,Be,e.g(q,Me),Pe,$);return le=$.finish(ve.url),{data:me.arrayBuffer}}catch(Me){throw le=$.error(ve.url),Me}finally{this.timingCallbacks.forEach(Me=>Me(le))}}),this.contourProtocol=s(this.contourProtocolV4),this.sharedDemProtocol=s(this.sharedDemProtocolV4),this.contourProtocolUrl=ve=>`${this.contourProtocolUrlBase}?${e.e(ve)}`;let N=W,re=1;for(;w.has(N);)N=W+re++;w.add(N),this.sharedDemProtocolId=`${N}-shared`,this.contourProtocolId=`${N}-contour`,this.sharedDemProtocolUrl=`${this.sharedDemProtocolId}://{z}/{x}/{y}`,this.contourProtocolUrlBase=`${this.contourProtocolId}://{z}/{x}/{y}`;const oe=ne?p:e.L;this.manager=new oe({demUrlPattern:D,cacheSize:V,encoding:S,maxzoom:j,timeoutMs:te,actor:Q})}getDemTile(D,V,W,S){return this.manager.fetchAndParseTile(D,V,W,S||new AbortController)}parseUrl(D){const[,V,W,S]=/\/\/(\d+)\/(\d+)\/(\d+)/.exec(D)||[];return[Number(V),Number(W),Number(S)]}}return{generateIsolines:e.b,DemSource:A,HeightTile:e.H,LocalDemManager:e.L,decodeParsedImage:e.c,set workerUrl(B){t.workerUrl=B},get workerUrl(){return t.workerUrl}}});const Yq={background:"rgba(255, 255, 255, 1)",earth:"rgba(246, 244, 236, 1)",park_b:"#d9e8c3ff",hospital:"rgba(237, 235, 232, 1)",industrial:"rgba(228, 226, 223, 1)",school:"rgba(235, 233, 230, 1)",wood_b:"#d4e0b8ff",pedestrian:"#f2f1edff",scrub_b:"#dfe0b8ff",glacier:"#ffffff",sand:"rgba(252, 237, 210, 1)",beach:"rgba(250, 230, 195, 1)",aerodrome:"rgba(245, 245, 248, 1)",runway:"rgba(193, 195, 217, 1)",water:"#c2dff5ff",pier:"#d6f4f3",zoo:"rgba(155, 182, 145, 1)",tunnel_other_casing:"rgba(245, 238, 225, 1)",tunnel_minor_casing:"rgba(245, 238, 225, 1)",tunnel_link_casing:"rgba(245, 238, 225, 1)",tunnel_major_casing:"rgba(245, 238, 225, 1)",tunnel_highway_casing:"rgba(245, 238, 225, 1)",tunnel_other:"rgba(226, 222, 210, 1)",tunnel_minor:"rgba(226, 222, 210, 1)",tunnel_major:"rgba(210, 206, 196, 1)",tunnel_highway:"rgba(210, 206, 196, 1)",buildings:"rgba(242, 236, 225, 1)",minor_service_casing:"rgba(245, 238, 225, 1)",minor_casing:"rgba(245, 238, 225, 1)",major_casing_late:"rgba(245, 238, 225, 1)",highway_casing_late:"rgba(245, 238, 225, 1)",other:"rgba(198, 196, 193, 1)",minor_service:"rgba(198, 196, 193, 1)",minor_a:"#c5c3c0",minor_b:"#c5c3c0",link:"rgba(198, 196, 193, 1)",major_casing_early:"rgba(245, 238, 225, 1)",major:"rgba(178, 176, 173, 1)",highway_casing_early:"rgba(245, 238, 225, 1)",highway:"rgba(178, 176, 173, 1)",railway:"rgba(193, 193, 193, 1)",boundaries:"#c5b48b",bridges_other_casing:"rgba(252, 248, 240, 1)",bridges_minor_casing:"rgba(252, 248, 240, 1)",bridges_major_casing:"rgba(252, 248, 240, 1)",bridges_highway_casing:"rgba(252, 248, 240, 1)",bridges_other:"rgba(195, 193, 190, 1)",bridges_minor:"rgba(195, 193, 190, 1)",bridges_major:"rgba(172, 170, 167, 1)",bridges_highway:"rgba(172, 170, 167, 1)",roads_label_minor:"rgba(138, 137, 134, 1)",roads_label_minor_halo:"rgba(245, 238, 225, 1)",roads_label_major:"rgba(123, 122, 119, 1)",roads_label_major_halo:"rgba(245, 238, 225, 1)",ocean_label:"rgba(67, 145, 155, 1)",subplace_label:"rgba(172, 168, 160, 1)",subplace_label_halo:"rgba(245, 238, 225, 1)",city_label:"#5c5c5c",city_label_halo:"#f8f3e8",state_label:"rgba(170, 165, 155, 1)",state_label_halo:"rgba(0,0,0,0)",country_label:"rgba(145, 141, 134, 1)",address_label:"#5c5c5c",address_label_halo:"rgba(245, 238, 225, 1)",regular:"Metropolis Semi Bold",bold:"Metropolis Bold",italic:"Metropolis Semi Bold Italic",landcover:{grassland:"rgba(240, 242, 232, 1)",barren:"rgba(0, 40, 140, 1)",urban_area:"rgba(242, 240, 237, 1)",farmland:"rgba(246, 248, 237, 1)",glacier:"rgba(255, 249, 235, 1)",scrub:"rgba(255, 236, 29, 1)",forest:"rgba(236, 240, 225, 1)"}};function Kq(e,t,i,a){const h=lM("protomaps",Yq,{lang:e});return h.forEach(d=>{d.id==="buildings"&&(d.paint&&"fill-outline-color"in d.paint&&(d.paint["fill-outline-color"]="rgba(139, 134, 123, 1)"),d.paint&&"fill-opacity"in d.paint&&(d.paint["fill-opacity"]=.5))}),{version:8,glyphs:"/fonts/{fontstack}/{range}.pbf",sprite:"https://protomaps.github.io/basemaps-assets/sprites/v4/light",sources:{protomaps:{type:"vector",url:`https://api.protomaps.com/tiles/v4.json?key=${Cq}`,attribution:'Â© <a href="https://openstreetmap.org">OpenStreetMap</a>'}},layers:h}}var $q=zr('<link rel="stylesheet" href="https://unpkg.com/maplibre-gl@3.4.0/dist/maplibre-gl.css"/> <div class="polka fixed inset-0 h-full w-full bg-size-[25px_25px]"></div> <!> <!> <!> <!> <!> <!> <!>',1);function Jq(e,t){Ur(t,!0),Yi(()=>{Su.init()});const i="map-container",a="maps-sorted-by-edition.json";let h=fr(null),d=fr(null),p=fr(!1),s=fr(!1),w=null;pv(()=>{T(h)||Ne()}),pv(()=>{document.addEventListener("pointermove",qe=>{Fg.x=qe.x,Fg.y=qe.y})});let A=fr(!1),z=Xs(new Du),B=pt(()=>{if(!T(A))return;const qe=new Map;for(const{number:Ct,...wt}of z.values())(qe.get(Ct)??qe.set(Ct,[]).get(Ct)).unshift({number:Ct,...wt});return qe}),D=fr(null),V=pt(()=>{var qe;return T(D)&&z.get((qe=T(D).properties)==null?void 0:qe.id)||null}),W=fr(null),S=pt(()=>{var qe;return T(W)&&z.get((qe=T(W).properties)==null?void 0:qe.id)||null}),j=fr(null),ne=fr(null);Yi(()=>{var wt,jt;if(!T(h))return;const qe=N.values().map((ie,k)=>({id:k,type:"Feature",geometry:structuredClone(ie.polygon),properties:{id:ie.id}})).map(ie=>{const C=46+Math.floor(Math.random()*10),M=90+Math.floor(Math.random()*5);return ie.properties.skeletonColor=`hsl(44, ${C}%, ${M}%)`,ie}).toArray(),Ct=N.values().map((ie,k)=>({id:k,type:"Feature",geometry:by(structuredClone(ie.polygon)).geometry,properties:{year:ie.yearEnd,num:ie.number+"."+ie.position}})).toArray();(wt=T(h).getSource("map-outlines"))==null||wt.setData({type:"FeatureCollection",features:qe}),(jt=T(h).getSource("map-labels"))==null||jt.setData({type:"FeatureCollection",features:Ct})});let te=fr(null),Q=fr(Xs({yearStart:1865,yearEnd:1983,edition:"All",bis:!1,type:void 0})),N=new Du,re=new Du,oe=new Du;setInterval(()=>{var Ct,wt;if(!T(A))return;const qe=(wt=(Ct=T(d))==null?void 0:Ct.renderer)==null?void 0:wt.mapsInViewport;if(qe){for(const jt of re.keys())qe.has(jt)||re.delete(jt);for(const jt of oe.keys())(!qe.has(jt)||!N.has(jt))&&oe.delete(jt);for(const jt of qe)re.has(jt)||re.set(jt,z.get(jt)),!oe.has(jt)&&N.has(jt)&&oe.set(jt,z.get(jt))}},100),Yi(()=>{var qe,Ct;T(d)&&((Ct=(qe=T(d).renderer)==null?void 0:qe.tileCache)==null||Ct.addEventListener(nr.MAPTILELOADED,wt=>{var k,C,M;const jt=(k=wt.data)==null?void 0:k.mapId,ie=z.get(jt);ie&&((M=(C=T(d))==null?void 0:C.renderer)!=null&&M.mapsInViewport.has(ie.id))&&oe.set(jt,ie)}))});let ve=fr(!1);async function Pe(qe){return""}let $=fr("");function le(qe){var xe;if(!T(B)||T(ne))return;let Ct=0;qe.yearStart=Math.min(qe.yearEnd-1,qe.yearStart);const wt=[],jt=[];T(B).forEach(he=>{let Y,U,J,ue;for(const Ze of he){const{x:ke,y:rt,yearEnd:bt,edition:ze,bis:gt,type:Ut,id:$t}=Ze;Ct=Math.max(Ct,bt);const Mr=qe.yearEnd>1894?qe.yearEnd:1894,Wr=qe.edition!=="All"||bt<=Mr,gr=qe.edition==="All"||ze===qe.edition,lr=qe.type?Ut===qe.type:!Ut,Xr=qe.bis===!0||!gt;if(!(Wr&&gr&&lr&&Xr))continue;const Bt=bt>=qe.yearStart&&bt<=qe.yearEnd?wt:jt;if(Y===void 0){if(Bt.push($t),[Y,U]=[ke,rt],!Y&&!U)break}else if(U&&ke===Y&&rt===-U){if(Bt.push($t),U=0,!Y)break}else if(Y&&!J&&ke===-Y){if(Bt.push($t),[J,ue]=[ke,rt],!U&&!rt)break}else if(ue&&ke===J&&rt===-ue&&(Bt.push($t),ue=0,!U))break}}),qe.yearEnd=Math.min(Ct,qe.yearEnd);const ie=wt.concat(jt),k=N.keys().toArray(),C=k.filter(he=>!ie.includes(he)),M=ie.filter(he=>!k.includes(he)),P=new Map,O={applyMask:!0,transformationType:"thinPlateSpline",saturation:1};wt.forEach(he=>P.set(he,{...O,visible:!0})),C.forEach(he=>P.set(he,{...O,visible:!1})),jt.forEach(he=>P.set(he,{...O,visible:!0,saturation:0})),(xe=T(d))==null||xe.setMapsOptionsByMapId(P),C.forEach(he=>N.delete(he)),M.forEach(he=>{const Y=z.get(he);Y&&N.set(he,Y)}),Pt($,`Je ziet nu kaarten van <i class="font-[700]">${Math.round(qe.yearEnd)}</i> en ouder`)}let Me=fr(Xs({baseMap:"none",protoMapsWaterInFront:!1,protomapsLabelsInFront:!1,historicMapsOpacity:100,overlay:"none"}));Yi(()=>{if(!(!T(p)||T(ne))&&(Ve(T(Me).baseMap==="protomaps"),T(Me).baseMap==="protomaps"&&Be(T(Me).protoMapsWaterInFront),T(Me).baseMap==="protomaps"&&q(T(Me).protomapsLabelsInFront),me(T(Me).baseMap==="ahn"),Ee(T(Me).baseMap==="satelliet"),T(d)&&T(d).setLayerOptions({opacity:T(Me).historicMapsOpacity/100}),T(h)&&T(h).getLayer("map-outlines-skeleton"))){const qe=T(Me).historicMapsOpacity<100?"none":"visible";T(h).setLayoutProperty("map-outlines-skeleton","visibility",qe)}}),Yi(()=>{T(p)&&(T(Me).overlay!=="waterschapsgrenzen"&&(T(h).getLayer("overlay-waterschapsgrenzen")&&T(h).removeLayer("overlay-waterschapsgrenzen"),T(h).getSource("pdok-waterschapsgrenzen")&&T(h).removeSource("pdok-waterschapsgrenzen")),T(Me).overlay!=="gemeentegrenzen"&&(T(h).getLayer("overlay-gemeentegrenzen")&&T(h).removeLayer("overlay-gemeentegrenzen"),T(h).getSource("pdok-gemeentegrenzen")&&T(h).removeSource("pdok-gemeentegrenzen")),T(Me).overlay==="waterschapsgrenzen"&&(T(h).getSource("pdok-waterschapsgrenzen")||Xt()),T(Me).overlay==="gemeentegrenzen"&&(T(h).getSource("pdok-gemeentegrenzen")||Jt()))});function Ve(qe){var wt;if(!T(p))return;(((wt=T(h))==null?void 0:wt.getStyle().layers)||[]).forEach(jt=>{var ie;(jt.source==="protomaps"||jt.type==="background")&&((ie=T(h))==null||ie.setLayoutProperty(jt.id,"visibility",qe?"visible":"none"))})}function Be(qe){if(!T(p))return;["water","water_stream","water_river"].forEach(wt=>{T(h).getLayer(wt)&&T(h).moveLayer(wt,qe?"map-outlines-labels":"landuse_pedestrian")})}function q(qe){if(!T(p))return;["address_label","waterway_label","roads_oneway","roads_labels_minor","water_label_ocean","earth_label_islands","water_label_lakes","roads_shields","roads_labels_major","places_subplace","places_region","places_locality","places_country","city_label"].forEach(wt=>{T(h).getLayer(wt)&&T(h).moveLayer(wt,qe?"map-outlines-labels":"map-outlines-skeleton")})}function me(qe){var Ct,wt;T(p)&&(Ct=T(h))!=null&&Ct.getLayer("dsm-05-layer")&&((wt=T(h))==null||wt.setLayoutProperty("dsm-05-layer","visibility",qe?"visible":"none"))}function Ee(qe){var Ct;T(p)&&(Ct=T(h))!=null&&Ct.getLayer("satelliet-layer")&&T(h).setLayoutProperty("satelliet-layer","visibility",qe?"visible":"none")}function Ne(){const qe=ct(),Ct=[qe.lng,qe.lat],wt=qe.zoom;T(Q).yearStart=qe.yearStart,T(Q).yearEnd=qe.yearEnd,T(Q).edition=qe.edition,T(Q).bis=qe.bis,T(Q).type=qe.type;const jt=new kC;T_.addProtocol("pmtiles",jt.tile);const ie=Kq("nl");ie.layers.forEach(C=>{C.layout={...C.layout,visibility:"none"}}),Pt(h,new T_.Map({container:i,style:ie,center:Ct,zoom:wt,minZoom:5.5,maxZoom:16,maxPitch:0,minPitch:0,maxBounds:[[-12,47],[22,57]],bearing:0,dragRotate:!1,touchPitch:!1,touchRotate:!1,attributionControl:!1,preserveDrawingBuffer:!0}),!0),T(h).dragRotate.disable(),T(h).keyboard.disable(),T(h).touchZoomRotate.disableRotation(),T(h).addControl(new T_.ScaleControl({unit:"metric"}),"bottom-right");const k=T(h).getCanvas();k&&k.removeAttribute("tabindex"),T(h).on("load",async()=>{Pt(p,!0),Lt(),Pt(d,new YZ,!0),T(h).addLayer(T(d)),T(d).setLayerOptions({visible:!1}),T(d).getWarpedMapList().options.animatedOptions.push("opacity"),T(h).addSource("user-location",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),T(h).addLayer({id:"user-location",type:"circle",source:"user-location",paint:{"circle-radius":["interpolate",["linear"],["zoom"],0,6,22,20],"circle-color":"#f4a","circle-opacity":0,"circle-stroke-color":"#ffffff","circle-stroke-width":["interpolate",["linear"],["zoom"],0,0,22,6],"circle-stroke-opacity":0,"circle-opacity-transition":{duration:400},"circle-radius-transition":{duration:400},"circle-stroke-width-transition":{duration:700},"circle-stroke-opacity-transition":{duration:400}}}),await ye(a),ge(),T(h).on("move",fn),fn(),T(h).on("moveend",Fi),T(h).on("mousemove","map-outlines-fill",dn),T(h).on("mouseleave","map-outlines-fill",Xi),qe&&qe.baseMap&&(T(Me).baseMap=qe.baseMap),qe&&qe.protoMapsWaterInFront&&(T(Me).protoMapsWaterInFront=qe.protoMapsWaterInFront),qe&&qe.protoMapsLabelsInFront&&(T(Me).protoMapsLabelsInFront=qe.protoMapsLabelsInFront),T(Me).historicMapsOpacity=qe.historicMapsOpacity,setTimeout(()=>{if(qe.selectedSheetId){const C=z.get(qe.selectedSheetId);C&&ui(C)}if(qe.pinnedSheetId){const C=z.get(qe.pinnedSheetId);C&&Pt(j,C,!0)}},500)})}function $e(qe){const{id:Ct,width:wt,height:jt,tiles:ie}=qe.resource;return{"@context":"http://iiif.io/api/image/2/context.json","@id":Ct,profile:"http://iiif.io/api/image/2/level2.json",protocol:"http://iiif.io/api/image",width:wt,height:jt,tiles:ie}}async function ye(qe){if(!T(h)||!T(d))return;const wt=await(await fetch(qe)).json();T(h).on("maptilesloadedfromsprites",()=>{Pt(A,!0),le(T(Q))});const jt=wt.map($e);T(d).addImageInfos(jt);const ie=wt.map(async C=>{const M=await T(d).addGeoreferencedMap(C),P=T(d).getWarpedMap(M),O=[P==null?void 0:P.geoMask.concat([P==null?void 0:P.geoMask[0]])],xe={id:M,manifestId:C.resource.partOf[0].id,polygon:{type:"Polygon",coordinates:O},geoFullMaskBbox:P==null?void 0:P.geoFullMaskBbox,...C._meta};z.set(M,xe)});await Promise.all(ie);const k=await fetch("/sprites/regular-sheets-128.json").then(C=>C.json());T(d).addSprites(k,window.location.origin+"/sprites/regular-sheets-128.jpg",[3072,3078]),T(h).addSource("map-outlines",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),T(h).addSource("map-labels",{type:"geojson",data:{type:"FeatureCollection",features:[]}})}function ge(){if(!T(h))return;T(h).addLayer({id:"map-outlines-skeleton",type:"fill",source:"map-outlines",paint:{"fill-color":["get","skeletonColor"]}},"warped-map-layer"),T(h).addLayer({id:"map-outlines-labels",type:"symbol",source:"map-labels",layout:{"text-font":["literal",["Metropolis Bold"]],"text-field":["to-string",["get","year"]],"text-size":["interpolate",["exponential",1.2],["zoom"],5,6,6,9,7,12,8,15,9,17,10,18,12,22,14,26,15,28,20,28],"text-allow-overlap":!0},paint:{"text-color":"#65e","text-halo-color":"#eeeeff","text-halo-width":1,"text-opacity":0}}),T(h).addLayer({id:"map-outlines-numbers",type:"symbol",source:"map-labels",layout:{"text-font":["literal",["Metropolis Bold"]],"text-field":["to-string",["get","num"]],"text-size":["interpolate",["exponential",1.2],["zoom"],5,6,6,9,7,12,8,15,9,17,10,18,12,22,14,26,15,28,20,28],"text-allow-overlap":!0},paint:{"text-color":"#65e","text-halo-color":"#eeeeff","text-halo-width":1,"text-opacity-transition":{duration:1e3},"text-opacity":0}}),T(h).addLayer({id:"map-outlines-fill",type:"fill",source:"map-outlines",paint:{"fill-color":"#f4a","fill-opacity":["coalesce",["feature-state","animated-fill-opacity"],0]}}),T(h).addLayer({id:"map-outlines-stroke",type:"line",source:"map-outlines",paint:{"line-color":"#f4a","line-width":1,"line-opacity":["coalesce",["feature-state","animated-stroke-opacity"],0]}});let qe=null,Ct=null,wt=null;T(h).doubleClickZoom.disable(),T(h).on("click","map-outlines-fill",jt=>{var P,O,xe;const ie=jt.lngLat,k=(P=jt.features)==null?void 0:P[0],C=k==null?void 0:k.id,M=(O=k==null?void 0:k.properties)==null?void 0:O.id;if(T(Yt)&&M){ui(z.get(M));return}Ce(!0,ie),qe&&clearTimeout(qe),qe=setTimeout(()=>{Ce(!1,ie)},1500),T(W)&&((xe=T(W).properties)==null?void 0:xe.id)===M&&M&&ui(z.get(M)),Pt(W,k,!0),C!==void 0&&(Ct!==null&&Ct!==C&&(wt&&clearTimeout(wt),It(Ct,"animated-fill-opacity",0,50)),Ct!==C&&(Ct=C,It(C,"animated-fill-opacity",.25,300,()=>{wt=setTimeout(()=>{Ct===C&&(It(C,"animated-fill-opacity",0,500),Ct=null)},1e3)}),ot&&clearTimeout(ot),ot=setTimeout(()=>Pt(W,null),2500)))})}const Ye={},We={};let ot=null;function Se(qe=2500){ot&&(clearTimeout(ot),ot=setTimeout(()=>Pt(W,null),qe))}function Ce(qe,Ct={lng:5.63,lat:52.16},wt=3,jt=300){if(T(Yt)&&!qe)return;const ie=T(h).getSource("map-outlines");if(!ie||!ie._data)return;const k=ie._data.features;setTimeout(()=>Pt(ve,qe,!0),100);const C=qe?.1:0;T(h).setPaintProperty("map-outlines-fill","fill-opacity",["max",["coalesce",["feature-state","animated-fill-opacity"],0],["case",["boolean",["feature-state","hover"],!1],C,0]]),k.forEach(M=>{const P=M.id;if(P===void 0)return;if(We[P]&&(clearTimeout(We[P]),delete We[P]),!qe){It(P,"animated-stroke-opacity",0,500);return}const[O,xe]=M.geometry.coordinates[0][0],he=Ct.lng-O,Y=Ct.lat-xe,U=Math.sqrt(he**2+Y**2),J=U*jt,ue=Math.max(0,.5-U/wt);We[P]=setTimeout(()=>{It(P,"animated-stroke-opacity",ue,500),delete We[P]},J)})}function It(qe,Ct,wt,jt,ie){const k=`${qe}-${Ct}`;Ye[k]&&cancelAnimationFrame(Ye[k]);const C=performance.now(),M=T(h).getFeatureState({source:"map-outlines",id:qe}),P=(M==null?void 0:M[Ct])!==void 0?M[Ct]:0;if(Math.abs(P-wt)<.01){delete Ye[k],ie&&ie();return}function O(xe){let Y=(xe-C)/jt;Y>1&&(Y=1);const U=P+(wt-P)*Y;T(h).setFeatureState({source:"map-outlines",id:qe},{[Ct]:U}),Y<1?Ye[k]=requestAnimationFrame(O):(delete Ye[k],ie&&ie())}Ye[k]=requestAnimationFrame(O)}function Lt(){T(h)&&(T(h).addSource("dsm-05",{type:"raster",tiles:["https://service.pdok.nl/rws/ahn/wms/v1_0?REQUEST=GetMap&SERVICE=WMS&VERSION=1.3.0&FORMAT=image/png&STYLES=&TRANSPARENT=TRUE&LAYERS=dsm_05m&TILED=true&WIDTH=256&HEIGHT=256&CRS=EPSG:3857&BBOX={bbox-epsg-3857}"],tileSize:256}),T(h).addLayer({id:"dsm-05-layer",type:"raster",source:"dsm-05",layout:{visibility:"none"},paint:{}}),T(h).addSource("satelliet",{type:"raster",tiles:["https://service.pdok.nl/hwh/luchtfotorgb/wms/v1_0?service=WMS&version=1.1.1&request=GetMap&layers=Actueel_ortho25&styles=&format=image/jpeg&transparent=true&height=256&width=256&srs=EPSG:3857&bbox={bbox-epsg-3857}"],tileSize:256,scheme:"tms",minzoom:6,maxzoom:20,attribution:"PDOK"}),T(h).addLayer({id:"satelliet-layer",type:"raster",source:"satelliet",layout:{visibility:"none"},paint:{}}))}function Xt(){!T(h)||T(h).getSource("pdok-waterschapsgrenzen")||(T(h).addSource("pdok-waterschapsgrenzen",{type:"raster",tiles:["https://service.pdok.nl/hwh/waterschappen-waterschapsgrenzen-imso/wms/v2_0?SERVICE=WMS&REQUEST=GetMap&VERSION=1.3.0&LAYERS=waterschap&STYLES=&FORMAT=image/png&TRANSPARENT=true&CRS=EPSG:3857&WIDTH=256&HEIGHT=256&BBOX={bbox-epsg-3857}"],tileSize:256}),T(h).addLayer({id:"overlay-waterschapsgrenzen",type:"raster",source:"pdok-waterschapsgrenzen",layout:{visibility:"visible"}}))}function Jt(){!T(h)||T(h).getSource("pdok-gemeentegrenzen")||(T(h).addSource("pdok-gemeentegrenzen",{type:"raster",tiles:["https://service.pdok.nl/kadaster/bestuurlijkegebieden/wms/v1_0?SERVICE=WMS&REQUEST=GetMap&VERSION=1.3.0&LAYERS=Gemeentegebied&STYLES=&FORMAT=image/png&TRANSPARENT=true&CRS=EPSG:3857&WIDTH=256&HEIGHT=256&BBOX={bbox-epsg-3857}"],tileSize:256}),T(h).addLayer({id:"overlay-gemeentegrenzen",type:"raster",source:"pdok-gemeentegrenzen",layout:{visibility:"visible"}}))}function dr(qe){var jt,ie;const{geometry:Ct,bbox:wt}=qe;if(wt){const[k,C,M,P]=wt;(jt=T(h))==null||jt.fitBounds([[k,C],[M,P]],{padding:40,maxZoom:12,duration:250})}else if((Ct==null?void 0:Ct.type)==="Point"){const[k,C]=Ct.coordinates;(ie=T(h))==null||ie.flyTo({center:[k,C],zoom:12,speed:.8,curve:1.4,essential:!0,duration:250})}}async function zt(){const Ct=await(await fetch("https://ipapi.co/json/")).json();return{lat:Ct.latitude,lng:Ct.longitude}}function Zt(qe,Ct){const wt={minLat:50.5,maxLat:53.7,minLng:3,maxLng:7.5};return qe>=wt.minLat&&qe<=wt.maxLat&&Ct>=wt.minLng&&Ct<=wt.maxLng}async function Ot(){try{const qe=await jq().catch(async()=>await zt()),{lat:Ct,lng:wt}=qe;if(!Zt(Ct,wt)){alert("Je bent te ver buiten Nederland!");return}if(T(h)){const jt=T(h).getSource("user-location");jt&&(jt.setData({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[wt,Ct]},properties:{}}]}),T(h).setPaintProperty("user-location","circle-opacity",1),T(h).setPaintProperty("user-location","circle-stroke-opacity",1),T(h).setPaintProperty("user-location","circle-radius",10))}Pt(s,!0),dr({geometry:{type:"Point",coordinates:[wt,Ct]},properties:{label:"Your location"}}),w&&clearTimeout(w),w=setTimeout(()=>{T(h).setPaintProperty("user-location","circle-opacity",0),T(h).setPaintProperty("user-location","circle-stroke-opacity",0),T(h).setPaintProperty("user-location","circle-radius",6),setTimeout(()=>{var ie;const jt=(ie=T(h))==null?void 0:ie.getSource("user-location");jt&&jt.setData({type:"FeatureCollection",features:[]}),Pt(s,!1),w=null},400)},2500)}catch(qe){console.error(qe),alert("Kon locatie niet bepalen.")}}let Yt=fr(!1);function Ar(qe=!T(Yt)){var Ct,wt,jt,ie;return Pt(Yt,qe,!0),Ce(qe,{lng:5.63,lat:52.16},100,150),qe&&T(ne)&&((Ct=T(h))==null||Ct.setLayoutProperty("map-outlines-numbers","visibility",qe?"visible":"none"),(wt=T(h))==null||wt.setLayoutProperty("map-outlines-stroke","visibility",qe?"visible":"none"),(jt=T(h))==null||jt.setLayoutProperty("map-outlines-fill","visibility",qe?"visible":"none")),(ie=T(h))==null||ie.setPaintProperty("map-outlines-numbers","text-opacity",+qe),qe}function yr(qe=!0){T(p)&&(T(h).setPaintProperty("map-outlines-labels","text-opacity-transition",{duration:300}),T(h).setPaintProperty("map-outlines-labels","text-opacity",qe?1:0))}let kr=Xs([]),Tr=null;function Dr(qe=!0){const Ct={center:T(h).getCenter(),zoom:T(h).getZoom(),bearing:T(h).getBearing(),pitch:T(h).getPitch()};return qe&&kr.push(Ct),Ct}function hi(qe=kr.pop(),Ct={duration:500}){var M,P,O;if(!T(h)||!qe||!T(d))return;const{center:wt,zoom:jt,bearing:ie,pitch:k}=qe;T(h).easeTo({center:wt,zoom:jt,bearing:ie,pitch:k,...Ct});const C=new Map;if(C.set((M=T(ne))==null?void 0:M.id,{visible:!1,transformationType:"thinPlateSpline",applyMask:!0}),T(d).setMapsOptionsByMapId(C),Tr){for(const xe in Tr)T(h).setLayoutProperty(xe,"visibility",Tr[xe]);Tr=null}T(h).setLayoutProperty("map-outlines-skeleton","visibility","visible"),Ar(!1),T(ne)&&((O=T(d))==null||O.setMapOptions((P=T(ne))==null?void 0:P.id,{transformationType:"thinPlateSpline",applyMask:!0}),Pt(ne,null)),le(T(Q))}function ni(qe){var jt,ie;if(!T(ne)||!T(d)||!T(h))return;const Ct=new Map;Ct.set((jt=T(ne))==null?void 0:jt.id,{visible:!1,transformationType:"thinPlateSpline",applyMask:!0}),Ct.set(qe==null?void 0:qe.id,{visible:!0,transformationType:"straight",saturation:1,applyMask:!1}),T(d).setMapsOptionsByMapId(Ct);const wt=(ie=T(d))==null?void 0:ie.getMapsBbox([qe.id],{projection:{definition:"EPSG:4326"}});if(wt){const[k,C,M,P]=wt;T(h).fitBounds([[k,C],[M,P]],{padding:50,animate:!1})}Pt(ne,qe,!0)}function ui(qe,Ct){var k,C,M;if(!T(h)||!T(d))return;Pt(W,null),Ar(!1),Tr={};const wt=T(h).getStyle().layers;for(const P of wt)if(!P.id.includes("warped-map-layer-")){const O=T(h).getLayoutProperty(P.id,"visibility");Tr[P.id]=O||"visible",O!=="none"&&T(h).setLayoutProperty(P.id,"visibility","none")}T(d).setLayerOptions({opacity:1});const{id:jt}=qe,ie=N.keys().filter(P=>P!=jt).toArray();if((k=T(d))==null||k.setMapsOptions(ie,{visible:!1}),(C=T(d))==null||C.setMapOptions(jt,{visible:!0,transformationType:"straight",saturation:1,opacity:1,applyMask:!1}),Pt(ne,qe,!0),Dr(),Ct)T(h).easeTo(Ct);else{const P=(M=T(d))==null?void 0:M.getMapsBbox([qe.id],{projection:{definition:"EPSG:4326"}});if(P){const[O,xe,he,Y]=P;setTimeout(()=>T(h).fitBounds([[O,xe],[he,Y]],{padding:88,speed:2,curve:1.8,essential:!0}),250)}}}function dn(qe){var wt,jt;if(!T(h))return;const Ct=(wt=qe.features)==null?void 0:wt[0];Ct&&(T(D)&&T(D)!==Ct&&T(h).setFeatureState({source:"map-outlines",id:(jt=T(D))==null?void 0:jt.id},{hover:!1}),Pt(D,Ct,!0),T(h).setFeatureState({source:"map-outlines",id:T(D).id},{hover:!0}))}function Xi(){!T(h)||!T(D)||(T(h).setFeatureState({source:"map-outlines",id:T(D).id},{hover:!1}),Pt(D,null))}function fn(){if(!T(h))return;const qe=T(h).getBounds();Pt(te,{type:"Feature",geometry:{type:"Polygon",coordinates:[[[qe.getWest(),qe.getNorth()],[qe.getEast(),qe.getNorth()],[qe.getEast(),qe.getSouth()],[qe.getWest(),qe.getSouth()],[qe.getWest(),qe.getNorth()]]]},properties:{}},!0)}Yi(()=>{T(ne),Fi()});const Pr={zoom:6.5,lat:51.75,lng:5.5,yearStart:1865,yearEnd:1983,edition:"All",bis:!1,type:void 0,selectedSheetId:null,pinnedSheetId:null,baseMap:"none",protoMapsWaterInFront:!1,protoMapsLabelsInFront:!1,historicMapsOpacity:100};function xi(){!T(p)||!T(A)||(hi(),T(h).easeTo({center:[Pr.lng,Pr.lat],zoom:Pr.zoom,pitch:0,bearing:0}),T(Me).historicMapsOpacity=Pr.historicMapsOpacity)}function Fi(){if(!T(p)||!T(A))return;const qe=new URLSearchParams,Ct=T(h).getCenter(),wt=(rt,bt,ze)=>{bt!==ze&&qe.set(rt,String(bt))},jt=T(h).getZoom(),ie=Ct.lat,k=Ct.lng,C=ie.toFixed(3),M=k.toFixed(3),P=Pr.lat.toFixed(3),O=Pr.lng.toFixed(3),xe=C===P,he=M===O;if(!xe||!he){const ze=`${xe?"":C}_${he?"":M}`;qe.set("c",ze)}wt("zoom",jt.toFixed(2),Pr.zoom.toFixed(2));const Y=String(T(Q).yearStart),U=String(Math.round(T(Q).yearEnd)),J=T(Q).yearStart===Pr.yearStart,ue=Math.round(T(Q).yearEnd)===Pr.yearEnd;if(!J||!ue){let rt;J?rt=`_${U}`:ue?rt=`${Y}_`:rt=`${Y}_${U}`,qe.set("period",rt)}wt("editie",String(T(Q).edition),String(Pr.edition));const pe=T(Q).bis?"1":"0";wt("bis",pe,Pr.bis?"1":"0"),T(Q).type&&qe.set("type",T(Q).type),T(ne)&&qe.set("blad",T(ne).id),T(j)&&qe.set("pinned",T(j).id),wt("achtergrondkaart",String(T(Me).baseMap),String(Pr.baseMap));const Ze=T(Me).protoMapsWaterInFront?"1":"0";wt("pwf",Ze,Pr.protoMapsWaterInFront?"1":"0");const ke=T(Me).protomapsLabelsInFront?"1":"0";wt("plf",ke,Pr.protoMapsLabelsInFront?"1":"0"),wt("opacity",String(T(Me).historicMapsOpacity),String(Pr.historicMapsOpacity)),aT(`?${qe.toString()}`,{replaceState:!0,noScroll:!0})}function ct(){const qe=new URLSearchParams(window.location.search),Ct=(J,ue)=>{const pe=parseFloat(J??"");return Number.isFinite(pe)?pe:ue},wt=(J,ue)=>{const pe=parseInt(J??"");return Number.isFinite(pe)?pe:ue},jt=(J,ue,pe)=>{const Ze=qe.get(J);return Ze===null?pe:ue(Ze)};if(window.location.hash.startsWith("#/"))return Pr;let ie=Pr.lat,k=Pr.lng;const C=qe.get("c");if(C){const[J,ue]=C.split("_"),pe=parseFloat(J);J&&Number.isFinite(pe)&&(ie=pe);const Ze=parseFloat(ue);ue&&Number.isFinite(Ze)&&(k=Ze)}let M=Pr.yearStart,P=Pr.yearEnd;const O=qe.get("period");if(O){const[J,ue]=O.split("_"),pe=parseInt(J);J&&Number.isFinite(pe)&&(M=pe);const Ze=parseInt(ue);ue&&Number.isFinite(Ze)&&(P=Ze)}const xe=(J,ue)=>Ct(qe.get(J),ue),he=(J,ue)=>wt(qe.get(J),ue),Y=qe.get("editie"),U=Y==="All"||Y===null?"All":Number(Y);return{zoom:xe("zoom",Pr.zoom),lat:ie,lng:k,yearStart:M,yearEnd:P,edition:U,bis:jt("bis",J=>J==="1",Pr.bis),type:qe.get("type")??Pr.type,selectedSheetId:qe.get("blad")??Pr.selectedSheetId,pinnedSheetId:qe.get("pinned")??Pr.pinnedSheetId,baseMap:qe.get("achtergrondkaart")??Pr.baseMap,protoMapsWaterInFront:jt("pwf",J=>J==="1",Pr.protoMapsWaterInFront),protoMapsLabelsInFront:jt("plf",J=>J==="1",Pr.protoMapsLabelsInFront),historicMapsOpacity:he("opacity",Pr.historicMapsOpacity)}}function be(){T(h)&&T(h).zoomIn({duration:250})}function we(){T(h)&&T(h).zoomOut({duration:250})}Yi(()=>{if(!T(p))return;const qe=T(ne)?10:140,Ct=document.querySelector(".maplibregl-ctrl-bottom-left"),wt=document.querySelector(".maplibregl-ctrl-bottom-right");Ct&&Ct.style.setProperty("bottom",qe+"px","important"),wt&&wt.style.setProperty("bottom",qe+"px","important")});var Te=$q();Tn("keydown",pl,qe=>{qe.key.toLowerCase()=="="&&be(),qe.key.toLowerCase()=="-"&&we(),qe.key.toLowerCase()=="w"&&T(Me).baseMap=="protomaps"&&(T(Me).protoMapsWaterInFront=!T(Me).protoMapsWaterInFront),qe.key.toLowerCase()=="t"&&T(Me).baseMap=="protomaps"&&(T(Me).protomapsLabelsInFront=!T(Me).protomapsLabelsInFront),qe.key=="Escape"&&(Pt(W,null),Ce(!1),Ar(!1))}),Tn("popstate",pl,()=>{const qe=ct();if(qe.selectedSheetId){const Ct=z.get(qe.selectedSheetId);Ct&&ui(Ct)}});var Ge=Gt(lt(Te),2);pr(Ge,"id",i);var He=Gt(Ge,2);{var nt=qe=>{nM(qe,{get content(){return T($)}})};Qe(He,qe=>{T(ne)||qe(nt)})}var yt=Gt(He,2);_q(yt,{get clickedHistoricMap(){return T(S)},get selectedHistoricMap(){return T(ne)},setHistoricMapView:ui,setSheetIndexVisibility:Ar,extendClickedMapTimeout:Se,saveMapView:Dr,restoreView:hi,get pinnedHistoricMap(){return T(j)},set pinnedHistoricMap(qe){Pt(j,qe,!0)}});var ut=Gt(yt,2);{var St=qe=>{Vq(qe,{get selectedHistoricMap(){return T(ne)},flyToFeature:dr,flyToUserLocation:Ot,setGridVisibility:Ce,zoomIn:be,zoomOut:we,get layerOptions(){return T(Me)},set layerOptions(Ct){Pt(Me,Ct,!0)},get userLocationActive(){return T(s)},set userLocationActive(Ct){Pt(s,Ct,!0)}})};Qe(ut,qe=>{T(p)&&qe(St)})}var Vt=Gt(ut,2);kW(Vt,{get historicMapsLoaded(){return T(A)},resetState:xi});var Ft=Gt(Vt,2);{let qe=pt(()=>T(A)&&!T(ne));uq(Ft,{get visible(){return T(qe)},get historicMapsLoaded(){return T(A)},get historicMapsById(){return z},get hoveredHistoricMap(){return T(V)},get mapsInViewport(){return re},applyFilter:le,getHistoricMapThumbnail:Pe,setLabelVisibility:yr,setGridVisibility:Ce,get filter(){return T(Q)},set filter(Ct){Pt(Q,Ct,!0)}})}var sr=Gt(Ft,2);BW(sr,{get visibleHistoricMaps(){return N},get visibleHistoricMapsInViewport(){return oe},get viewportPolygon(){return T(te)},get hoveredHistoricMap(){return T(V)},get sheetIndexVisible(){return T(Yt)},get clickedHistoricMap(){return T(S)},get selectedHistoricMap(){return T(ne)},get historicMapsLoaded(){return T(A)},getHistoricMapThumbnail:Pe,restoreView:hi});var st=Gt(sr,2);KX(st,{get warpedMapLayer(){return T(d)},get historicMapsById(){return z},get visibleHistoricMapsInViewport(){return oe},get viewportPolygon(){return T(te)},get clickedHistoricMap(){return T(S)},get selectedHistoricMap(){return T(ne)},get hoveredHistoricMap(){return T(V)},get sheetIndexVisible(){return T(Yt)},changeHistoricMapView:ni,getHistoricMapThumbnail:Pe}),$r(()=>Bi(Ge,`
		touch-action: auto; 
		background-color: ${T(ne)?"#fffaff":"#fafaff"}; 
		background-image: radial-gradient(${T(ne)?"#fef":"#eef"} 2.5px, transparent 2.5px)
	`)),se(e,Te),Hr()}var Qq=zr('<div class="fixed inset-0 h-[100dvh] w-full overflow-hidden"><!></div>');function fY(e){var t=Qq(),i=Rt(t);Jq(i,{}),Tt(t),se(e,t)}export{fY as component};
